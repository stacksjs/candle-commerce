// @bun
var vy=Object.create;var{getPrototypeOf:my,defineProperty:bq,getOwnPropertyNames:Sy}=Object;var gy=Object.prototype.hasOwnProperty;var by=(q,E,y)=>{y=q!=null?vy(my(q)):{};let n=E||!q||!q.__esModule?bq(y,"default",{value:q,enumerable:!0}):y;for(let J of Sy(q))if(!gy.call(n,J))bq(n,J,{get:()=>q[J],enumerable:!0});return n};var X=(q,E)=>()=>(E||q((E={exports:{}}).exports,E),E.exports);var T=import.meta.require;var I=X((iy)=>{iy.fromCallback=function(q){return Object.defineProperty(function(...E){if(typeof E[E.length-1]==="function")q.apply(this,E);else return new Promise((y,n)=>{E.push((J,O)=>J!=null?n(J):y(O)),q.apply(this,E)})},"name",{value:q.name})};iy.fromPromise=function(q){return Object.defineProperty(function(...E){let y=E[E.length-1];if(typeof y!=="function")return q.apply(this,E);else E.pop(),q.apply(this,E).then((n)=>y(null,n),y)},"name",{value:q.name})}});var hq=X((AO,iq)=>{var o=T("constants"),py=process.cwd,Lq=null,cy=process.env.GRACEFUL_FS_PLATFORM||process.platform;process.cwd=function(){if(!Lq)Lq=py.call(process);return Lq};try{process.cwd()}catch(q){}if(typeof process.chdir==="function"){if(Pq=process.chdir,process.chdir=function(q){Lq=null,Pq.call(process,q)},Object.setPrototypeOf)Object.setPrototypeOf(process.chdir,Pq)}var Pq;iq.exports=oy;function oy(q){if(o.hasOwnProperty("O_SYMLINK")&&process.version.match(/^v0\.6\.[0-2]|^v0\.5\./))E(q);if(!q.lutimes)y(q);if(q.chown=O(q.chown),q.fchown=O(q.fchown),q.lchown=O(q.lchown),q.chmod=n(q.chmod),q.fchmod=n(q.fchmod),q.lchmod=n(q.lchmod),q.chownSync=_(q.chownSync),q.fchownSync=_(q.fchownSync),q.lchownSync=_(q.lchownSync),q.chmodSync=J(q.chmodSync),q.fchmodSync=J(q.fchmodSync),q.lchmodSync=J(q.lchmodSync),q.stat=U(q.stat),q.fstat=U(q.fstat),q.lstat=U(q.lstat),q.statSync=R(q.statSync),q.fstatSync=R(q.fstatSync),q.lstatSync=R(q.lstatSync),q.chmod&&!q.lchmod)q.lchmod=function(V,A,L){if(L)process.nextTick(L)},q.lchmodSync=function(){};if(q.chown&&!q.lchown)q.lchown=function(V,A,L,K){if(K)process.nextTick(K)},q.lchownSync=function(){};if(cy==="win32")q.rename=typeof q.rename!=="function"?q.rename:function(V){function A(L,K,P){var N=Date.now(),C=0;V(L,K,function j(h){if(h&&(h.code==="EACCES"||h.code==="EPERM"||h.code==="EBUSY")&&Date.now()-N<60000){if(setTimeout(function(){q.stat(K,function(m,nq){if(m&&m.code==="ENOENT")V(L,K,j);else P(h)})},C),C<100)C+=10;return}if(P)P(h)})}if(Object.setPrototypeOf)Object.setPrototypeOf(A,V);return A}(q.rename);q.read=typeof q.read!=="function"?q.read:function(V){function A(L,K,P,N,C,j){var h;if(j&&typeof j==="function"){var m=0;h=function(nq,Sq,gq){if(nq&&nq.code==="EAGAIN"&&m<10)return m++,V.call(q,L,K,P,N,C,h);j.apply(this,arguments)}}return V.call(q,L,K,P,N,C,h)}if(Object.setPrototypeOf)Object.setPrototypeOf(A,V);return A}(q.read),q.readSync=typeof q.readSync!=="function"?q.readSync:function(V){return function(A,L,K,P,N){var C=0;while(!0)try{return V.call(q,A,L,K,P,N)}catch(j){if(j.code==="EAGAIN"&&C<10){C++;continue}throw j}}}(q.readSync);function E(V){V.lchmod=function(A,L,K){V.open(A,o.O_WRONLY|o.O_SYMLINK,L,function(P,N){if(P){if(K)K(P);return}V.fchmod(N,L,function(C){V.close(N,function(j){if(K)K(C||j)})})})},V.lchmodSync=function(A,L){var K=V.openSync(A,o.O_WRONLY|o.O_SYMLINK,L),P=!0,N;try{N=V.fchmodSync(K,L),P=!1}finally{if(P)try{V.closeSync(K)}catch(C){}else V.closeSync(K)}return N}}function y(V){if(o.hasOwnProperty("O_SYMLINK")&&V.futimes)V.lutimes=function(A,L,K,P){V.open(A,o.O_SYMLINK,function(N,C){if(N){if(P)P(N);return}V.futimes(C,L,K,function(j){V.close(C,function(h){if(P)P(j||h)})})})},V.lutimesSync=function(A,L,K){var P=V.openSync(A,o.O_SYMLINK),N,C=!0;try{N=V.futimesSync(P,L,K),C=!1}finally{if(C)try{V.closeSync(P)}catch(j){}else V.closeSync(P)}return N};else if(V.futimes)V.lutimes=function(A,L,K,P){if(P)process.nextTick(P)},V.lutimesSync=function(){}}function n(V){if(!V)return V;return function(A,L,K){return V.call(q,A,L,function(P){if($(P))P=null;if(K)K.apply(this,arguments)})}}function J(V){if(!V)return V;return function(A,L){try{return V.call(q,A,L)}catch(K){if(!$(K))throw K}}}function O(V){if(!V)return V;return function(A,L,K,P){return V.call(q,A,L,K,function(N){if($(N))N=null;if(P)P.apply(this,arguments)})}}function _(V){if(!V)return V;return function(A,L,K){try{return V.call(q,A,L,K)}catch(P){if(!$(P))throw P}}}function U(V){if(!V)return V;return function(A,L,K){if(typeof L==="function")K=L,L=null;function P(N,C){if(C){if(C.uid<0)C.uid+=4294967296;if(C.gid<0)C.gid+=4294967296}if(K)K.apply(this,arguments)}return L?V.call(q,A,L,P):V.call(q,A,P)}}function R(V){if(!V)return V;return function(A,L){var K=L?V.call(q,A,L):V.call(q,A);if(K){if(K.uid<0)K.uid+=4294967296;if(K.gid<0)K.gid+=4294967296}return K}}function $(V){if(!V)return!0;if(V.code==="ENOSYS")return!0;var A=!process.getuid||process.getuid()!==0;if(A){if(V.code==="EINVAL"||V.code==="EPERM")return!0}return!1}}});var cq=X((GO,pq)=>{var lq=T("stream").Stream;pq.exports=dy;function dy(q){return{ReadStream:E,WriteStream:y};function E(n,J){if(!(this instanceof E))return new E(n,J);lq.call(this);var O=this;this.path=n,this.fd=null,this.readable=!0,this.paused=!1,this.flags="r",this.mode=438,this.bufferSize=65536,J=J||{};var _=Object.keys(J);for(var U=0,R=_.length;U<R;U++){var $=_[U];this[$]=J[$]}if(this.encoding)this.setEncoding(this.encoding);if(this.start!==void 0){if(typeof this.start!=="number")throw TypeError("start must be a Number");if(this.end===void 0)this.end=1/0;else if(typeof this.end!=="number")throw TypeError("end must be a Number");if(this.start>this.end)throw new Error("start must be <= end");this.pos=this.start}if(this.fd!==null){process.nextTick(function(){O._read()});return}q.open(this.path,this.flags,this.mode,function(V,A){if(V){O.emit("error",V),O.readable=!1;return}O.fd=A,O.emit("open",A),O._read()})}function y(n,J){if(!(this instanceof y))return new y(n,J);lq.call(this),this.path=n,this.fd=null,this.writable=!0,this.flags="w",this.encoding="binary",this.mode=438,this.bytesWritten=0,J=J||{};var O=Object.keys(J);for(var _=0,U=O.length;_<U;_++){var R=O[_];this[R]=J[R]}if(this.start!==void 0){if(typeof this.start!=="number")throw TypeError("start must be a Number");if(this.start<0)throw new Error("start must be >= zero");this.pos=this.start}if(this.busy=!1,this._queue=[],this.fd===null)this._open=q.open,this._queue.push([this._open,this.path,this.flags,this.mode,void 0]),this.flush()}}});var dq=X((XO,oq)=>{oq.exports=ry;var fy=Object.getPrototypeOf||function(q){return q.__proto__};function ry(q){if(q===null||typeof q!=="object")return q;if(q instanceof Object)var E={__proto__:fy(q)};else var E=Object.create(null);return Object.getOwnPropertyNames(q).forEach(function(y){Object.defineProperty(E,y,Object.getOwnPropertyDescriptor(q,y))}),E}});var s=X((YO,Dq)=>{var B=T("fs"),ay=hq(),ey=cq(),ty=dq(),Aq=T("util"),F,Xq;if(typeof Symbol==="function"&&typeof Symbol.for==="function")F=Symbol.for("graceful-fs.queue"),Xq=Symbol.for("graceful-fs.previous");else F="___graceful-fs.queue",Xq="___graceful-fs.previous";function sy(){}function rq(q,E){Object.defineProperty(q,F,{get:function(){return E}})}var a=sy;if(Aq.debuglog)a=Aq.debuglog("gfs4");else if(/\bgfs4\b/i.test(process.env.NODE_DEBUG||""))a=function(){var q=Aq.format.apply(Aq,arguments);q="GFS4: "+q.split(/\n/).join(`
GFS4: `),console.error(q)};if(!B[F]){if(jq=global[F]||[],rq(B,jq),B.close=function(q){function E(y,n){return q.call(B,y,function(J){if(!J)fq();if(typeof n==="function")n.apply(this,arguments)})}return Object.defineProperty(E,Xq,{value:q}),E}(B.close),B.closeSync=function(q){function E(y){q.apply(B,arguments),fq()}return Object.defineProperty(E,Xq,{value:q}),E}(B.closeSync),/\bgfs4\b/i.test(process.env.NODE_DEBUG||""))process.on("exit",function(){a(B[F]),T("assert").equal(B[F].length,0)})}var jq;if(!global[F])rq(global,B[F]);Dq.exports=wq(ty(B));if(process.env.TEST_GRACEFUL_FS_GLOBAL_PATCH&&!B.__patched)Dq.exports=wq(B),B.__patched=!0;function wq(q){ay(q),q.gracefulify=wq,q.createReadStream=Sq,q.createWriteStream=gq;var E=q.readFile;q.readFile=y;function y(z,Z,Y){if(typeof Z==="function")Y=Z,Z=null;return W(z,Z,Y);function W(M,u,w,D){return E(M,u,function(H){if(H&&(H.code==="EMFILE"||H.code==="ENFILE"))t([W,[M,u,w],H,D||Date.now(),Date.now()]);else if(typeof w==="function")w.apply(this,arguments)})}}var n=q.writeFile;q.writeFile=J;function J(z,Z,Y,W){if(typeof Y==="function")W=Y,Y=null;return M(z,Z,Y,W);function M(u,w,D,H,k){return n(u,w,D,function(x){if(x&&(x.code==="EMFILE"||x.code==="ENFILE"))t([M,[u,w,D,H],x,k||Date.now(),Date.now()]);else if(typeof H==="function")H.apply(this,arguments)})}}var O=q.appendFile;if(O)q.appendFile=_;function _(z,Z,Y,W){if(typeof Y==="function")W=Y,Y=null;return M(z,Z,Y,W);function M(u,w,D,H,k){return O(u,w,D,function(x){if(x&&(x.code==="EMFILE"||x.code==="ENFILE"))t([M,[u,w,D,H],x,k||Date.now(),Date.now()]);else if(typeof H==="function")H.apply(this,arguments)})}}var U=q.copyFile;if(U)q.copyFile=R;function R(z,Z,Y,W){if(typeof Y==="function")W=Y,Y=0;return M(z,Z,Y,W);function M(u,w,D,H,k){return U(u,w,D,function(x){if(x&&(x.code==="EMFILE"||x.code==="ENFILE"))t([M,[u,w,D,H],x,k||Date.now(),Date.now()]);else if(typeof H==="function")H.apply(this,arguments)})}}var $=q.readdir;q.readdir=A;var V=/^v[0-5]\./;function A(z,Z,Y){if(typeof Z==="function")Y=Z,Z=null;var W=V.test(process.version)?function u(w,D,H,k){return $(w,M(w,D,H,k))}:function u(w,D,H,k){return $(w,D,M(w,D,H,k))};return W(z,Z,Y);function M(u,w,D,H){return function(k,x){if(k&&(k.code==="EMFILE"||k.code==="ENFILE"))t([W,[u,w,D],k,H||Date.now(),Date.now()]);else{if(x&&x.sort)x.sort();if(typeof D==="function")D.call(this,k,x)}}}}if(process.version.substr(0,4)==="v0.8"){var L=ey(q);j=L.ReadStream,m=L.WriteStream}var K=q.ReadStream;if(K)j.prototype=Object.create(K.prototype),j.prototype.open=h;var P=q.WriteStream;if(P)m.prototype=Object.create(P.prototype),m.prototype.open=nq;Object.defineProperty(q,"ReadStream",{get:function(){return j},set:function(z){j=z},enumerable:!0,configurable:!0}),Object.defineProperty(q,"WriteStream",{get:function(){return m},set:function(z){m=z},enumerable:!0,configurable:!0});var N=j;Object.defineProperty(q,"FileReadStream",{get:function(){return N},set:function(z){N=z},enumerable:!0,configurable:!0});var C=m;Object.defineProperty(q,"FileWriteStream",{get:function(){return C},set:function(z){C=z},enumerable:!0,configurable:!0});function j(z,Z){if(this instanceof j)return K.apply(this,arguments),this;else return j.apply(Object.create(j.prototype),arguments)}function h(){var z=this;Rq(z.path,z.flags,z.mode,function(Z,Y){if(Z){if(z.autoClose)z.destroy();z.emit("error",Z)}else z.fd=Y,z.emit("open",Y),z.read()})}function m(z,Z){if(this instanceof m)return P.apply(this,arguments),this;else return m.apply(Object.create(m.prototype),arguments)}function nq(){var z=this;Rq(z.path,z.flags,z.mode,function(Z,Y){if(Z)z.destroy(),z.emit("error",Z);else z.fd=Y,z.emit("open",Y)})}function Sq(z,Z){return new q.ReadStream(z,Z)}function gq(z,Z){return new q.WriteStream(z,Z)}var $y=q.open;q.open=Rq;function Rq(z,Z,Y,W){if(typeof Y==="function")W=Y,Y=null;return M(z,Z,Y,W);function M(u,w,D,H,k){return $y(u,w,D,function(x,zO){if(x&&(x.code==="EMFILE"||x.code==="ENFILE"))t([M,[u,w,D,H],x,k||Date.now(),Date.now()]);else if(typeof H==="function")H.apply(this,arguments)})}}return q}function t(q){a("ENQUEUE",q[0].name,q[1]),B[F].push(q),Bq()}var Gq;function fq(){var q=Date.now();for(var E=0;E<B[F].length;++E)if(B[F][E].length>2)B[F][E][3]=q,B[F][E][4]=q;Bq()}function Bq(){if(clearTimeout(Gq),Gq=void 0,B[F].length===0)return;var q=B[F].shift(),E=q[0],y=q[1],n=q[2],J=q[3],O=q[4];if(J===void 0)a("RETRY",E.name,y),E.apply(null,y);else if(Date.now()-J>=60000){a("TIMEOUT",E.name,y);var _=y.pop();if(typeof _==="function")_.call(null,n)}else{var U=Date.now()-O,R=Math.max(O-J,1),$=Math.min(R*1.2,100);if(U>=$)a("RETRY",E.name,y),E.apply(null,y.concat([J]));else B[F].push(q)}if(Gq===void 0)Gq=setTimeout(Bq,0)}});var g=X((uq)=>{var aq=I().fromCallback,S=s(),qn=["access","appendFile","chmod","chown","close","copyFile","cp","fchmod","fchown","fdatasync","fstat","fsync","ftruncate","futimes","glob","lchmod","lchown","lutimes","link","lstat","mkdir","mkdtemp","open","opendir","readdir","readFile","readlink","realpath","rename","rm","rmdir","stat","statfs","symlink","truncate","unlink","utimes","writeFile"].filter((q)=>{return typeof S[q]==="function"});Object.assign(uq,S);qn.forEach((q)=>{uq[q]=aq(S[q])});uq.exists=function(q,E){if(typeof E==="function")return S.exists(q,E);return new Promise((y)=>{return S.exists(q,y)})};uq.read=function(q,E,y,n,J,O){if(typeof O==="function")return S.read(q,E,y,n,J,O);return new Promise((_,U)=>{S.read(q,E,y,n,J,(R,$,V)=>{if(R)return U(R);_({bytesRead:$,buffer:V})})})};uq.write=function(q,E,...y){if(typeof y[y.length-1]==="function")return S.write(q,E,...y);return new Promise((n,J)=>{S.write(q,E,...y,(O,_,U)=>{if(O)return J(O);n({bytesWritten:_,buffer:U})})})};uq.readv=function(q,E,...y){if(typeof y[y.length-1]==="function")return S.readv(q,E,...y);return new Promise((n,J)=>{S.readv(q,E,...y,(O,_,U)=>{if(O)return J(O);n({bytesRead:_,buffers:U})})})};uq.writev=function(q,E,...y){if(typeof y[y.length-1]==="function")return S.writev(q,E,...y);return new Promise((n,J)=>{S.writev(q,E,...y,(O,_,U)=>{if(O)return J(O);n({bytesWritten:_,buffers:U})})})};if(typeof S.realpath.native==="function")uq.realpath.native=aq(S.realpath.native);else process.emitWarning("fs.realpath.native is not a function. Is fs being monkey-patched?","Warning","fs-extra-WARN0003")});var tq=X((Vn,eq)=>{var _n=T("path");Vn.checkPath=function q(E){if(process.platform==="win32"){if(/[<>:"|?*]/.test(E.replace(_n.parse(E).root,""))){let n=new Error(`Path contains invalid characters: ${E}`);throw n.code="EINVAL",n}}}});var yE=X((Un,Tq)=>{var sq=g(),{checkPath:qE}=tq(),EE=(q)=>{let E={mode:511};if(typeof q==="number")return q;return{...E,...q}.mode};Un.makeDir=async(q,E)=>{return qE(q),sq.mkdir(q,{mode:EE(E),recursive:!0})};Un.makeDirSync=(q,E)=>{return qE(q),sq.mkdirSync(q,{mode:EE(E),recursive:!0})}});var l=X((HO,nE)=>{var Pn=I().fromPromise,{makeDir:An,makeDirSync:Iq}=yE(),Qq=Pn(An);nE.exports={mkdirs:Qq,mkdirsSync:Iq,mkdirp:Qq,mkdirpSync:Iq,ensureDir:Qq,ensureDirSync:Iq}});var d=X((NO,OE)=>{var Gn=I().fromPromise,JE=g();function Xn(q){return JE.access(q).then(()=>!0).catch(()=>!1)}OE.exports={pathExists:Gn(Xn),pathExistsSync:JE.existsSync}});var Wq=X((xO,_E)=>{var qq=g(),Yn=I().fromPromise;async function Zn(q,E,y){let n=await qq.open(q,"r+"),J=null;try{await qq.futimes(n,E,y)}finally{try{await qq.close(n)}catch(O){J=O}}if(J)throw J}function Cn(q,E,y){let n=qq.openSync(q,"r+");return qq.futimesSync(n,E,y),qq.closeSync(n)}_E.exports={utimesMillis:Yn(Zn),utimesMillisSync:Cn}});var e=X((RO,zE)=>{var Eq=g(),Q=T("path"),VE=I().fromPromise;function Hn(q,E,y){let n=y.dereference?(J)=>Eq.stat(J,{bigint:!0}):(J)=>Eq.lstat(J,{bigint:!0});return Promise.all([n(q),n(E).catch((J)=>{if(J.code==="ENOENT")return null;throw J})]).then(([J,O])=>({srcStat:J,destStat:O}))}function Nn(q,E,y){let n,J=y.dereference?(_)=>Eq.statSync(_,{bigint:!0}):(_)=>Eq.lstatSync(_,{bigint:!0}),O=J(q);try{n=J(E)}catch(_){if(_.code==="ENOENT")return{srcStat:O,destStat:null};throw _}return{srcStat:O,destStat:n}}async function xn(q,E,y,n){let{srcStat:J,destStat:O}=await Hn(q,E,n);if(O){if(Jq(J,O)){let _=Q.basename(q),U=Q.basename(E);if(y==="move"&&_!==U&&_.toLowerCase()===U.toLowerCase())return{srcStat:J,destStat:O,isChangingCase:!0};throw new Error("Source and destination must not be the same.")}if(J.isDirectory()&&!O.isDirectory())throw new Error(`Cannot overwrite non-directory '${E}' with directory '${q}'.`);if(!J.isDirectory()&&O.isDirectory())throw new Error(`Cannot overwrite directory '${E}' with non-directory '${q}'.`)}if(J.isDirectory()&&Mq(q,E))throw new Error(Yq(q,E,y));return{srcStat:J,destStat:O}}function Rn(q,E,y,n){let{srcStat:J,destStat:O}=Nn(q,E,n);if(O){if(Jq(J,O)){let _=Q.basename(q),U=Q.basename(E);if(y==="move"&&_!==U&&_.toLowerCase()===U.toLowerCase())return{srcStat:J,destStat:O,isChangingCase:!0};throw new Error("Source and destination must not be the same.")}if(J.isDirectory()&&!O.isDirectory())throw new Error(`Cannot overwrite non-directory '${E}' with directory '${q}'.`);if(!J.isDirectory()&&O.isDirectory())throw new Error(`Cannot overwrite directory '${E}' with non-directory '${q}'.`)}if(J.isDirectory()&&Mq(q,E))throw new Error(Yq(q,E,y));return{srcStat:J,destStat:O}}async function KE(q,E,y,n){let J=Q.resolve(Q.dirname(q)),O=Q.resolve(Q.dirname(y));if(O===J||O===Q.parse(O).root)return;let _;try{_=await Eq.stat(O,{bigint:!0})}catch(U){if(U.code==="ENOENT")return;throw U}if(Jq(E,_))throw new Error(Yq(q,y,n));return KE(q,E,O,n)}function UE(q,E,y,n){let J=Q.resolve(Q.dirname(q)),O=Q.resolve(Q.dirname(y));if(O===J||O===Q.parse(O).root)return;let _;try{_=Eq.statSync(O,{bigint:!0})}catch(U){if(U.code==="ENOENT")return;throw U}if(Jq(E,_))throw new Error(Yq(q,y,n));return UE(q,E,O,n)}function Jq(q,E){return E.ino!==void 0&&E.dev!==void 0&&E.ino===q.ino&&E.dev===q.dev}function Mq(q,E){let y=Q.resolve(q).split(Q.sep).filter((J)=>J),n=Q.resolve(E).split(Q.sep).filter((J)=>J);return y.every((J,O)=>n[O]===J)}function Yq(q,E,y){return`Cannot ${y} '${q}' to a subdirectory of itself, '${E}'.`}zE.exports={checkPaths:VE(xn),checkPathsSync:Rn,checkParentPaths:VE(KE),checkParentPathsSync:UE,isSrcSubdir:Mq,areIdentical:Jq}});var XE=X((jO,GE)=>{var v=g(),Oq=T("path"),{mkdirs:jn}=l(),{pathExists:wn}=d(),{utimesMillis:Bn}=Wq(),_q=e();async function Dn(q,E,y={}){if(typeof y==="function")y={filter:y};if(y.clobber="clobber"in y?!!y.clobber:!0,y.overwrite="overwrite"in y?!!y.overwrite:y.clobber,y.preserveTimestamps&&process.arch==="ia32")process.emitWarning(`Using the preserveTimestamps option in 32-bit node is not recommended;

	see https://github.com/jprichardson/node-fs-extra/issues/269`,"Warning","fs-extra-WARN0001");let{srcStat:n,destStat:J}=await _q.checkPaths(q,E,"copy",y);if(await _q.checkParentPaths(q,n,E,"copy"),!await PE(q,E,y))return;let _=Oq.dirname(E);if(!await wn(_))await jn(_);await AE(J,q,E,y)}async function PE(q,E,y){if(!y.filter)return!0;return y.filter(q,E)}async function AE(q,E,y,n){let O=await(n.dereference?v.stat:v.lstat)(E);if(O.isDirectory())return Qn(O,q,E,y,n);if(O.isFile()||O.isCharacterDevice()||O.isBlockDevice())return un(O,q,E,y,n);if(O.isSymbolicLink())return Wn(q,E,y,n);if(O.isSocket())throw new Error(`Cannot copy a socket file: ${E}`);if(O.isFIFO())throw new Error(`Cannot copy a FIFO pipe: ${E}`);throw new Error(`Unknown file: ${E}`)}async function un(q,E,y,n,J){if(!E)return LE(q,y,n,J);if(J.overwrite)return await v.unlink(n),LE(q,y,n,J);if(J.errorOnExist)throw new Error(`'${n}' already exists`)}async function LE(q,E,y,n){if(await v.copyFile(E,y),n.preserveTimestamps){if(Tn(q.mode))await In(y,q.mode);let J=await v.stat(E);await Bn(y,J.atime,J.mtime)}return v.chmod(y,q.mode)}function Tn(q){return(q&128)===0}function In(q,E){return v.chmod(q,E|128)}async function Qn(q,E,y,n,J){if(!E)await v.mkdir(n);let O=[];for await(let _ of await v.opendir(y)){let U=Oq.join(y,_.name),R=Oq.join(n,_.name);O.push(PE(U,R,J).then(($)=>{if($)return _q.checkPaths(U,R,"copy",J).then(({destStat:V})=>{return AE(V,U,R,J)})}))}if(await Promise.all(O),!E)await v.chmod(n,q.mode)}async function Wn(q,E,y,n){let J=await v.readlink(E);if(n.dereference)J=Oq.resolve(process.cwd(),J);if(!q)return v.symlink(J,y);let O=null;try{O=await v.readlink(y)}catch(_){if(_.code==="EINVAL"||_.code==="UNKNOWN")return v.symlink(J,y);throw _}if(n.dereference)O=Oq.resolve(process.cwd(),O);if(_q.isSrcSubdir(J,O))throw new Error(`Cannot copy '${J}' to a subdirectory of itself, '${O}'.`);if(_q.isSrcSubdir(O,J))throw new Error(`Cannot overwrite '${O}' with '${J}'.`);return await v.unlink(y),v.symlink(J,y)}GE.exports=Dn});var NE=X((wO,HE)=>{var b=s(),Vq=T("path"),Mn=l().mkdirsSync,kn=Wq().utimesMillisSync,Kq=e();function Fn(q,E,y){if(typeof y==="function")y={filter:y};if(y=y||{},y.clobber="clobber"in y?!!y.clobber:!0,y.overwrite="overwrite"in y?!!y.overwrite:y.clobber,y.preserveTimestamps&&process.arch==="ia32")process.emitWarning(`Using the preserveTimestamps option in 32-bit node is not recommended;

	see https://github.com/jprichardson/node-fs-extra/issues/269`,"Warning","fs-extra-WARN0002");let{srcStat:n,destStat:J}=Kq.checkPathsSync(q,E,"copy",y);if(Kq.checkParentPathsSync(q,n,E,"copy"),y.filter&&!y.filter(q,E))return;let O=Vq.dirname(E);if(!b.existsSync(O))Mn(O);return YE(J,q,E,y)}function YE(q,E,y,n){let O=(n.dereference?b.statSync:b.lstatSync)(E);if(O.isDirectory())return hn(O,q,E,y,n);else if(O.isFile()||O.isCharacterDevice()||O.isBlockDevice())return $n(O,q,E,y,n);else if(O.isSymbolicLink())return cn(q,E,y,n);else if(O.isSocket())throw new Error(`Cannot copy a socket file: ${E}`);else if(O.isFIFO())throw new Error(`Cannot copy a FIFO pipe: ${E}`);throw new Error(`Unknown file: ${E}`)}function $n(q,E,y,n,J){if(!E)return ZE(q,y,n,J);return vn(q,y,n,J)}function vn(q,E,y,n){if(n.overwrite)return b.unlinkSync(y),ZE(q,E,y,n);else if(n.errorOnExist)throw new Error(`'${y}' already exists`)}function ZE(q,E,y,n){if(b.copyFileSync(E,y),n.preserveTimestamps)mn(q.mode,E,y);return kq(y,q.mode)}function mn(q,E,y){if(Sn(q))gn(y,q);return bn(E,y)}function Sn(q){return(q&128)===0}function gn(q,E){return kq(q,E|128)}function kq(q,E){return b.chmodSync(q,E)}function bn(q,E){let y=b.statSync(q);return kn(E,y.atime,y.mtime)}function hn(q,E,y,n,J){if(!E)return ln(q.mode,y,n,J);return CE(y,n,J)}function ln(q,E,y,n){return b.mkdirSync(y),CE(E,y,n),kq(y,q)}function CE(q,E,y){let n=b.opendirSync(q);try{let J;while((J=n.readSync())!==null)pn(J.name,q,E,y)}finally{n.closeSync()}}function pn(q,E,y,n){let J=Vq.join(E,q),O=Vq.join(y,q);if(n.filter&&!n.filter(J,O))return;let{destStat:_}=Kq.checkPathsSync(J,O,"copy",n);return YE(_,J,O,n)}function cn(q,E,y,n){let J=b.readlinkSync(E);if(n.dereference)J=Vq.resolve(process.cwd(),J);if(!q)return b.symlinkSync(J,y);else{let O;try{O=b.readlinkSync(y)}catch(_){if(_.code==="EINVAL"||_.code==="UNKNOWN")return b.symlinkSync(J,y);throw _}if(n.dereference)O=Vq.resolve(process.cwd(),O);if(Kq.isSrcSubdir(J,O))throw new Error(`Cannot copy '${J}' to a subdirectory of itself, '${O}'.`);if(Kq.isSrcSubdir(O,J))throw new Error(`Cannot overwrite '${O}' with '${J}'.`);return on(J,y)}}function on(q,E){return b.unlinkSync(E),b.symlinkSync(q,E)}HE.exports=Fn});var Zq=X((BO,xE)=>{var dn=I().fromPromise;xE.exports={copy:dn(XE()),copySync:NE()}});var Uq=X((DO,jE)=>{var RE=s(),fn=I().fromCallback;function rn(q,E){RE.rm(q,{recursive:!0,force:!0},E)}function an(q){RE.rmSync(q,{recursive:!0,force:!0})}jE.exports={remove:fn(rn),removeSync:an}});var WE=X((uO,QE)=>{var en=I().fromPromise,DE=g(),uE=T("path"),TE=l(),IE=Uq(),wE=en(async function q(E){let y;try{y=await DE.readdir(E)}catch{return TE.mkdirs(E)}return Promise.all(y.map((n)=>IE.remove(uE.join(E,n))))});function BE(q){let E;try{E=DE.readdirSync(q)}catch{return TE.mkdirsSync(q)}E.forEach((y)=>{y=uE.join(q,y),IE.removeSync(y)})}QE.exports={emptyDirSync:BE,emptydirSync:BE,emptyDir:wE,emptydir:wE}});var $E=X((TO,FE)=>{var tn=I().fromPromise,ME=T("path"),c=g(),kE=l();async function sn(q){let E;try{E=await c.stat(q)}catch{}if(E&&E.isFile())return;let y=ME.dirname(q),n=null;try{n=await c.stat(y)}catch(J){if(J.code==="ENOENT"){await kE.mkdirs(y),await c.writeFile(q,"");return}else throw J}if(n.isDirectory())await c.writeFile(q,"");else await c.readdir(y)}function qJ(q){let E;try{E=c.statSync(q)}catch{}if(E&&E.isFile())return;let y=ME.dirname(q);try{if(!c.statSync(y).isDirectory())c.readdirSync(y)}catch(n){if(n&&n.code==="ENOENT")kE.mkdirsSync(y);else throw n}c.writeFileSync(q,"")}FE.exports={createFile:tn(sn),createFileSync:qJ}});var bE=X((IO,gE)=>{var EJ=I().fromPromise,vE=T("path"),f=g(),mE=l(),{pathExists:yJ}=d(),{areIdentical:SE}=e();async function nJ(q,E){let y;try{y=await f.lstat(E)}catch{}let n;try{n=await f.lstat(q)}catch(_){throw _.message=_.message.replace("lstat","ensureLink"),_}if(y&&SE(n,y))return;let J=vE.dirname(E);if(!await yJ(J))await mE.mkdirs(J);await f.link(q,E)}function JJ(q,E){let y;try{y=f.lstatSync(E)}catch{}try{let O=f.lstatSync(q);if(y&&SE(O,y))return}catch(O){throw O.message=O.message.replace("lstat","ensureLink"),O}let n=vE.dirname(E);if(f.existsSync(n))return f.linkSync(q,E);return mE.mkdirsSync(n),f.linkSync(q,E)}gE.exports={createLink:EJ(nJ),createLinkSync:JJ}});var hE=X((QO,iE)=>{var r=T("path"),zq=g(),{pathExists:OJ}=d(),_J=I().fromPromise;async function VJ(q,E){if(r.isAbsolute(q)){try{await zq.lstat(q)}catch(O){throw O.message=O.message.replace("lstat","ensureSymlink"),O}return{toCwd:q,toDst:q}}let y=r.dirname(E),n=r.join(y,q);if(await OJ(n))return{toCwd:n,toDst:q};try{await zq.lstat(q)}catch(O){throw O.message=O.message.replace("lstat","ensureSymlink"),O}return{toCwd:q,toDst:r.relative(y,q)}}function KJ(q,E){if(r.isAbsolute(q)){if(!zq.existsSync(q))throw new Error("absolute srcpath does not exist");return{toCwd:q,toDst:q}}let y=r.dirname(E),n=r.join(y,q);if(zq.existsSync(n))return{toCwd:n,toDst:q};if(!zq.existsSync(q))throw new Error("relative srcpath does not exist");return{toCwd:q,toDst:r.relative(y,q)}}iE.exports={symlinkPaths:_J(VJ),symlinkPathsSync:KJ}});var cE=X((WO,pE)=>{var lE=g(),UJ=I().fromPromise;async function zJ(q,E){if(E)return E;let y;try{y=await lE.lstat(q)}catch{return"file"}return y&&y.isDirectory()?"dir":"file"}function LJ(q,E){if(E)return E;let y;try{y=lE.lstatSync(q)}catch{return"file"}return y&&y.isDirectory()?"dir":"file"}pE.exports={symlinkType:UJ(zJ),symlinkTypeSync:LJ}});var rE=X((MO,fE)=>{var PJ=I().fromPromise,oE=T("path"),p=g(),{mkdirs:AJ,mkdirsSync:GJ}=l(),{symlinkPaths:XJ,symlinkPathsSync:YJ}=hE(),{symlinkType:ZJ,symlinkTypeSync:CJ}=cE(),{pathExists:HJ}=d(),{areIdentical:dE}=e();async function NJ(q,E,y){let n;try{n=await p.lstat(E)}catch{}if(n&&n.isSymbolicLink()){let[U,R]=await Promise.all([p.stat(q),p.stat(E)]);if(dE(U,R))return}let J=await XJ(q,E);q=J.toDst;let O=await ZJ(J.toCwd,y),_=oE.dirname(E);if(!await HJ(_))await AJ(_);return p.symlink(q,E,O)}function xJ(q,E,y){let n;try{n=p.lstatSync(E)}catch{}if(n&&n.isSymbolicLink()){let U=p.statSync(q),R=p.statSync(E);if(dE(U,R))return}let J=YJ(q,E);q=J.toDst,y=CJ(J.toCwd,y);let O=oE.dirname(E);if(p.existsSync(O))return p.symlinkSync(q,E,y);return GJ(O),p.symlinkSync(q,E,y)}fE.exports={createSymlink:PJ(NJ),createSymlinkSync:xJ}});var ny=X((kO,yy)=>{var{createFile:aE,createFileSync:eE}=$E(),{createLink:tE,createLinkSync:sE}=bE(),{createSymlink:qy,createSymlinkSync:Ey}=rE();yy.exports={createFile:aE,createFileSync:eE,ensureFile:aE,ensureFileSync:eE,createLink:tE,createLinkSync:sE,ensureLink:tE,ensureLinkSync:sE,createSymlink:qy,createSymlinkSync:Ey,ensureSymlink:qy,ensureSymlinkSync:Ey}});var Cq=X((FO,Jy)=>{function RJ(q,{EOL:E=`
`,finalEOL:y=!0,replacer:n=null,spaces:J}={}){let O=y?E:"";return JSON.stringify(q,n,J).replace(/\n/g,E)+O}function jJ(q){if(Buffer.isBuffer(q))q=q.toString("utf8");return q.replace(/^\uFEFF/,"")}Jy.exports={stringify:RJ,stripBom:jJ}});var Ky=X(($O,Vy)=>{var yq;try{yq=s()}catch(q){yq=T("fs")}var Hq=I(),{stringify:Oy,stripBom:_y}=Cq();async function wJ(q,E={}){if(typeof E==="string")E={encoding:E};let y=E.fs||yq,n="throws"in E?E.throws:!0,J=await Hq.fromCallback(y.readFile)(q,E);J=_y(J);let O;try{O=JSON.parse(J,E?E.reviver:null)}catch(_){if(n)throw _.message=`${q}: ${_.message}`,_;else return null}return O}var BJ=Hq.fromPromise(wJ);function DJ(q,E={}){if(typeof E==="string")E={encoding:E};let y=E.fs||yq,n="throws"in E?E.throws:!0;try{let J=y.readFileSync(q,E);return J=_y(J),JSON.parse(J,E.reviver)}catch(J){if(n)throw J.message=`${q}: ${J.message}`,J;else return null}}async function uJ(q,E,y={}){let n=y.fs||yq,J=Oy(E,y);await Hq.fromCallback(n.writeFile)(q,J,y)}var TJ=Hq.fromPromise(uJ);function IJ(q,E,y={}){let n=y.fs||yq,J=Oy(E,y);return n.writeFileSync(q,J,y)}var QJ={readFile:BJ,readFileSync:DJ,writeFile:TJ,writeFileSync:IJ};Vy.exports=QJ});var zy=X((vO,Uy)=>{var Nq=Ky();Uy.exports={readJson:Nq.readFile,readJsonSync:Nq.readFileSync,writeJson:Nq.writeFile,writeJsonSync:Nq.writeFileSync}});var xq=X((mO,Ay)=>{var WJ=I().fromPromise,Fq=g(),Ly=T("path"),Py=l(),MJ=d().pathExists;async function kJ(q,E,y="utf-8"){let n=Ly.dirname(q);if(!await MJ(n))await Py.mkdirs(n);return Fq.writeFile(q,E,y)}function FJ(q,...E){let y=Ly.dirname(q);if(!Fq.existsSync(y))Py.mkdirsSync(y);Fq.writeFileSync(q,...E)}Ay.exports={outputFile:WJ(kJ),outputFileSync:FJ}});var Xy=X((SO,Gy)=>{var{stringify:$J}=Cq(),{outputFile:vJ}=xq();async function mJ(q,E,y={}){let n=$J(E,y);await vJ(q,n,y)}Gy.exports=mJ});var Zy=X((gO,Yy)=>{var{stringify:SJ}=Cq(),{outputFileSync:gJ}=xq();function bJ(q,E,y){let n=SJ(E,y);gJ(q,n,y)}Yy.exports=bJ});var Hy=X((bO,Cy)=>{var iJ=I().fromPromise,i=zy();i.outputJson=iJ(Xy());i.outputJsonSync=Zy();i.outputJSON=i.outputJson;i.outputJSONSync=i.outputJsonSync;i.writeJSON=i.writeJson;i.writeJSONSync=i.writeJsonSync;i.readJSON=i.readJson;i.readJSONSync=i.readJsonSync;Cy.exports=i});var wy=X((iO,jy)=>{var hJ=g(),Ny=T("path"),{copy:lJ}=Zq(),{remove:Ry}=Uq(),{mkdirp:pJ}=l(),{pathExists:cJ}=d(),xy=e();async function oJ(q,E,y={}){let n=y.overwrite||y.clobber||!1,{srcStat:J,isChangingCase:O=!1}=await xy.checkPaths(q,E,"move",y);await xy.checkParentPaths(q,J,E,"move");let _=Ny.dirname(E);if(Ny.parse(_).root!==_)await pJ(_);return dJ(q,E,n,O)}async function dJ(q,E,y,n){if(!n){if(y)await Ry(E);else if(await cJ(E))throw new Error("dest already exists.")}try{await hJ.rename(q,E)}catch(J){if(J.code!=="EXDEV")throw J;await fJ(q,E,y)}}async function fJ(q,E,y){return await lJ(q,E,{overwrite:y,errorOnExist:!0,preserveTimestamps:!0}),Ry(q)}jy.exports=oJ});var Iy=X((hO,Ty)=>{var Dy=s(),vq=T("path"),rJ=Zq().copySync,uy=Uq().removeSync,aJ=l().mkdirpSync,By=e();function eJ(q,E,y){y=y||{};let n=y.overwrite||y.clobber||!1,{srcStat:J,isChangingCase:O=!1}=By.checkPathsSync(q,E,"move",y);if(By.checkParentPathsSync(q,J,E,"move"),!tJ(E))aJ(vq.dirname(E));return sJ(q,E,n,O)}function tJ(q){let E=vq.dirname(q);return vq.parse(E).root===E}function sJ(q,E,y,n){if(n)return $q(q,E,y);if(y)return uy(E),$q(q,E,y);if(Dy.existsSync(E))throw new Error("dest already exists.");return $q(q,E,y)}function $q(q,E,y){try{Dy.renameSync(q,E)}catch(n){if(n.code!=="EXDEV")throw n;return qO(q,E,y)}}function qO(q,E,y){return rJ(q,E,{overwrite:y,errorOnExist:!0,preserveTimestamps:!0}),uy(q)}Ty.exports=eJ});var Wy=X((lO,Qy)=>{var EO=I().fromPromise;Qy.exports={move:EO(wy()),moveSync:Iy()}});var ky=X((pO,My)=>{My.exports={...g(),...Zq(),...WE(),...ny(),...Hy(),...l(),...Wy(),...xq(),...d(),...Uq()}});var mq=by(ky(),1);import nO from"process";import{projectPath as JO}from"@stacksjs/path";import{ValidationBoolean as OO,ValidationEnum as _O,ValidationNumber as VO}from"@stacksjs/validation";import{schema as G}from"@stacksjs/validation";var Fy={APP_NAME:{validation:G.string(),default:"Stacks"},APP_ENV:{validation:G.enum(["local","dev","stage","prod"]),default:"local"},APP_KEY:{validation:G.string(),default:"base64:1234567890"},PORT:{validation:G.number(),default:3000},PORT_BACKEND:{validation:G.number(),default:3000},PORT_ADMIN:{validation:G.number(),default:3000},PORT_LIBRARY:{validation:G.number(),default:3000},PORT_DESKTOP:{validation:G.number(),default:3000},PORT_EMAIL:{validation:G.number(),default:3000},PORT_DOCS:{validation:G.number(),default:3000},PORT_INSPECT:{validation:G.number(),default:3000},PORT_API:{validation:G.number(),default:3000},PORT_SYSTEM_TRAY:{validation:G.number(),default:3000},APP_MAINTENANCE:{validation:G.boolean(),default:!1},DEBUG:{validation:G.boolean(),default:!1},API_PREFIX:{validation:G.string(),default:"/api"},DOCS_PREFIX:{validation:G.string(),default:"/docs"},DB_CONNECTION:{validation:G.enum(["mysql","sqlite","postgres"]),default:"mysql"},DB_HOST:{validation:G.string(),default:"localhost"},DB_PORT:{validation:G.number(),default:3306},AWS_ACCOUNT_ID:{validation:G.string(),default:""},AWS_ACCESS_KEY_ID:{validation:G.string(),default:""},AWS_SECRET_ACCESS_KEY:{validation:G.string(),default:""},AWS_DEFAULT_REGION:{validation:G.string(),default:""},AWS_DEFAULT_PASSWORD:{validation:G.string(),default:""},MAIL_MAILER:{validation:G.enum(["ses","sendmail","log","smtp"]),default:"ses"},MAIL_HOST:{validation:G.string(),default:""},MAIL_PORT:{validation:G.number(),default:465},MAIL_USERNAME:{validation:G.string(),default:""},MAIL_PASSWORD:{validation:G.string(),default:""},MAIL_FROM_ADDRESS:{validation:G.string(),default:""},SEARCH_ENGINE_DRIVER:{validation:G.enum(["meilisearch","algolia","typesense"]),default:"meilisearch"},STRIPE_SECRET_KEY:{validation:G.string(),default:""},STRIPE_PUBLISHABLE_KEY:{validation:G.string(),default:""},MEILISEARCH_HOST:{validation:G.string(),default:""},MEILISEARCH_KEY:{validation:G.string(),default:""},FRONTEND_APP_ENV:{validation:G.enum(["development","staging","production"]),default:"development"},FRONTEND_APP_URL:{validation:G.string(),default:""}};var yO={APP_ENV:["local","dev","development","staging","prod","production"],DB_CONNECTION:["mysql","sqlite","postgres","dynamodb"],MAIL_MAILER:["smtp","mailgun","ses","postmark","sendmail","log"],SEARCH_ENGINE_DRIVER:["opensearch"],FRONTEND_APP_ENV:["development","staging","production"]},fO=Object.entries(Fy).reduce((q,[E,y])=>{if(typeof y==="object"&&y!==null&&"validation"in y)return q[E]=y.validation.name,q;let n;switch(typeof y){case"string":n="string";break;case"number":n="number";break;case"boolean":n="boolean";break;default:if(Array.isArray(y)){n="enum";break}if(typeof y==="object"&&y!==null){let J=y.name;if(J==="string"||J==="number"||J==="boolean"){n=J;break}if(!J&&E in yO){n="enum";break}console.error("Unknown env value type",typeof y)}throw new Error(`Invalid env value for ${E}`)}return q[E]=n,q},{});var KO={get:(q,E)=>{let y=q[E];if(typeof y==="string"&&/^\d+$/.test(y)&&E!=="AWS_ACCOUNT_ID")return Number(y);if(typeof y==="string"&&/^true|false$/.test(y))return y==="true";if(y instanceof _O)return q[E];if(y instanceof OO)return!!q[E];if(y instanceof VO)return Number(q[E]);return y}};function UO(){return typeof Bun!=="undefined"?Bun.env:nO.env}var sO=new Proxy(UO(),KO);function q_(q,E,y){let n=y?.path||JO(".env"),O=mq.default.readFileSync(n,"utf-8").split(`
`),_=O.findIndex((U)=>U.startsWith(`${q}=`));if(_!==-1)O[_]=`${q}=${E}`;else O.push(`${q}=${E}`);mq.default.writeFileSync(n,O.join(`
`))}export{q_ as writeEnv,UO as process,yO as envEnum,sO as env};
