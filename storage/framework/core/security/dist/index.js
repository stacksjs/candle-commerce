// @bun
var sY=Object.create;var{getPrototypeOf:tY,defineProperty:JY,getOwnPropertyNames:eY}=Object;var Yq=Object.prototype.hasOwnProperty;var d=(Y,$,O)=>{O=Y!=null?sY(tY(Y)):{};let H=$||!Y||!Y.__esModule?JY(O,"default",{value:Y,enumerable:!0}):O;for(let g of eY(Y))if(!Yq.call(H,g))JY(H,g,{get:()=>Y[g],enumerable:!0});return H};var p=(Y,$)=>()=>($||Y(($={exports:{}}).exports,$),$.exports);var FY=import.meta.require;var h=p((c,zY)=>{(function(Y,$){if(typeof c==="object")zY.exports=c=$();else if(typeof define==="function"&&define.amd)define([],$);else Y.CryptoJS=$()})(c,function(){var Y=Y||function($,O){var H;if(typeof window!=="undefined"&&window.crypto)H=window.crypto;if(typeof self!=="undefined"&&self.crypto)H=self.crypto;if(typeof globalThis!=="undefined"&&globalThis.crypto)H=globalThis.crypto;if(!H&&typeof window!=="undefined"&&window.msCrypto)H=window.msCrypto;if(!H&&typeof global!=="undefined"&&global.crypto)H=global.crypto;if(!H)try{H=FY("crypto")}catch(q){}var g=function(){if(H){if(typeof H.getRandomValues==="function")try{return H.getRandomValues(new Uint32Array(1))[0]}catch(q){}if(typeof H.randomBytes==="function")try{return H.randomBytes(4).readInt32LE()}catch(q){}}throw new Error("Native crypto module could not be used to get secure random number.")},I=Object.create||function(){function q(){}return function(Q){var K;return q.prototype=Q,K=new q,q.prototype=null,K}}(),C={},Z=C.lib={},U=Z.Base=function(){return{extend:function(q){var Q=I(this);if(q)Q.mixIn(q);if(!Q.hasOwnProperty("init")||this.init===Q.init)Q.init=function(){Q.$super.init.apply(this,arguments)};return Q.init.prototype=Q,Q.$super=this,Q},create:function(){var q=this.extend();return q.init.apply(q,arguments),q},init:function(){},mixIn:function(q){for(var Q in q)if(q.hasOwnProperty(Q))this[Q]=q[Q];if(q.hasOwnProperty("toString"))this.toString=q.toString},clone:function(){return this.init.prototype.extend(this)}}}(),W=Z.WordArray=U.extend({init:function(q,Q){if(q=this.words=q||[],Q!=O)this.sigBytes=Q;else this.sigBytes=q.length*4},toString:function(q){return(q||A).stringify(this)},concat:function(q){var Q=this.words,K=q.words,G=this.sigBytes,X=q.sigBytes;if(this.clamp(),G%4)for(var w=0;w<X;w++){var B=K[w>>>2]>>>24-w%4*8&255;Q[G+w>>>2]|=B<<24-(G+w)%4*8}else for(var T=0;T<X;T+=4)Q[G+T>>>2]=K[T>>>2];return this.sigBytes+=X,this},clamp:function(){var q=this.words,Q=this.sigBytes;q[Q>>>2]&=4294967295<<32-Q%4*8,q.length=$.ceil(Q/4)},clone:function(){var q=U.clone.call(this);return q.words=this.words.slice(0),q},random:function(q){var Q=[];for(var K=0;K<q;K+=4)Q.push(g());return new W.init(Q,q)}}),J=C.enc={},A=J.Hex={stringify:function(q){var{words:Q,sigBytes:K}=q,G=[];for(var X=0;X<K;X++){var w=Q[X>>>2]>>>24-X%4*8&255;G.push((w>>>4).toString(16)),G.push((w&15).toString(16))}return G.join("")},parse:function(q){var Q=q.length,K=[];for(var G=0;G<Q;G+=2)K[G>>>3]|=parseInt(q.substr(G,2),16)<<24-G%8*4;return new W.init(K,Q/2)}},F=J.Latin1={stringify:function(q){var{words:Q,sigBytes:K}=q,G=[];for(var X=0;X<K;X++){var w=Q[X>>>2]>>>24-X%4*8&255;G.push(String.fromCharCode(w))}return G.join("")},parse:function(q){var Q=q.length,K=[];for(var G=0;G<Q;G++)K[G>>>2]|=(q.charCodeAt(G)&255)<<24-G%4*8;return new W.init(K,Q)}},z=J.Utf8={stringify:function(q){try{return decodeURIComponent(escape(F.stringify(q)))}catch(Q){throw new Error("Malformed UTF-8 data")}},parse:function(q){return F.parse(unescape(encodeURIComponent(q)))}},R=Z.BufferedBlockAlgorithm=U.extend({reset:function(){this._data=new W.init,this._nDataBytes=0},_append:function(q){if(typeof q=="string")q=z.parse(q);this._data.concat(q),this._nDataBytes+=q.sigBytes},_process:function(q){var Q,K=this._data,G=K.words,X=K.sigBytes,w=this.blockSize,B=w*4,T=X/B;if(q)T=$.ceil(T);else T=$.max((T|0)-this._minBufferSize,0);var k=T*w,M=$.min(k*4,X);if(k){for(var E=0;E<k;E+=w)this._doProcessBlock(G,E);Q=G.splice(0,k),K.sigBytes-=M}return new W.init(Q,M)},clone:function(){var q=U.clone.call(this);return q._data=this._data.clone(),q},_minBufferSize:0}),n=Z.Hasher=R.extend({cfg:U.extend(),init:function(q){this.cfg=this.cfg.extend(q),this.reset()},reset:function(){R.reset.call(this),this._doReset()},update:function(q){return this._append(q),this._process(),this},finalize:function(q){if(q)this._append(q);var Q=this._doFinalize();return Q},blockSize:16,_createHelper:function(q){return function(Q,K){return new q.init(K).finalize(Q)}},_createHmacHelper:function(q){return function(Q,K){return new u.HMAC.init(q,K).finalize(Q)}}}),u=C.algo={};return C}(Math);return Y})});var ZY=p((o,OY)=>{(function(Y,$){if(typeof o==="object")OY.exports=o=$(h());else if(typeof define==="function"&&define.amd)define(["./core"],$);else $(Y.CryptoJS)})(o,function(Y){return function(){var $=Y,O=$.lib,H=O.WordArray,g=$.enc,I=g.Base64={stringify:function(Z){var{words:U,sigBytes:W}=Z,J=this._map;Z.clamp();var A=[];for(var F=0;F<W;F+=3){var z=U[F>>>2]>>>24-F%4*8&255,R=U[F+1>>>2]>>>24-(F+1)%4*8&255,n=U[F+2>>>2]>>>24-(F+2)%4*8&255,u=z<<16|R<<8|n;for(var q=0;q<4&&F+q*0.75<W;q++)A.push(J.charAt(u>>>6*(3-q)&63))}var Q=J.charAt(64);if(Q)while(A.length%4)A.push(Q);return A.join("")},parse:function(Z){var U=Z.length,W=this._map,J=this._reverseMap;if(!J){J=this._reverseMap=[];for(var A=0;A<W.length;A++)J[W.charCodeAt(A)]=A}var F=W.charAt(64);if(F){var z=Z.indexOf(F);if(z!==-1)U=z}return C(Z,U,J)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="};function C(Z,U,W){var J=[],A=0;for(var F=0;F<U;F++)if(F%4){var z=W[Z.charCodeAt(F-1)]<<F%4*2,R=W[Z.charCodeAt(F)]>>>6-F%4*2,n=z|R;J[A>>>2]|=n<<24-A%4*8,A++}return H.create(J,A)}}(),Y.enc.Base64})});var EY=p((r,WY)=>{(function(Y,$){if(typeof r==="object")WY.exports=r=$(h());else if(typeof define==="function"&&define.amd)define(["./core"],$);else $(Y.CryptoJS)})(r,function(Y){return function($){var O=Y,H=O.lib,g=H.WordArray,I=H.Hasher,C=O.algo,Z=[];(function(){for(var z=0;z<64;z++)Z[z]=$.abs($.sin(z+1))*4294967296|0})();var U=C.MD5=I.extend({_doReset:function(){this._hash=new g.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(z,R){for(var n=0;n<16;n++){var u=R+n,q=z[u];z[u]=(q<<8|q>>>24)&16711935|(q<<24|q>>>8)&4278255360}var Q=this._hash.words,K=z[R+0],G=z[R+1],X=z[R+2],w=z[R+3],B=z[R+4],T=z[R+5],k=z[R+6],M=z[R+7],E=z[R+8],j=z[R+9],v=z[R+10],D=z[R+11],m=z[R+12],x=z[R+13],l=z[R+14],S=z[R+15],V=Q[0],N=Q[1],P=Q[2],L=Q[3];V=W(V,N,P,L,K,7,Z[0]),L=W(L,V,N,P,G,12,Z[1]),P=W(P,L,V,N,X,17,Z[2]),N=W(N,P,L,V,w,22,Z[3]),V=W(V,N,P,L,B,7,Z[4]),L=W(L,V,N,P,T,12,Z[5]),P=W(P,L,V,N,k,17,Z[6]),N=W(N,P,L,V,M,22,Z[7]),V=W(V,N,P,L,E,7,Z[8]),L=W(L,V,N,P,j,12,Z[9]),P=W(P,L,V,N,v,17,Z[10]),N=W(N,P,L,V,D,22,Z[11]),V=W(V,N,P,L,m,7,Z[12]),L=W(L,V,N,P,x,12,Z[13]),P=W(P,L,V,N,l,17,Z[14]),N=W(N,P,L,V,S,22,Z[15]),V=J(V,N,P,L,G,5,Z[16]),L=J(L,V,N,P,k,9,Z[17]),P=J(P,L,V,N,D,14,Z[18]),N=J(N,P,L,V,K,20,Z[19]),V=J(V,N,P,L,T,5,Z[20]),L=J(L,V,N,P,v,9,Z[21]),P=J(P,L,V,N,S,14,Z[22]),N=J(N,P,L,V,B,20,Z[23]),V=J(V,N,P,L,j,5,Z[24]),L=J(L,V,N,P,l,9,Z[25]),P=J(P,L,V,N,w,14,Z[26]),N=J(N,P,L,V,E,20,Z[27]),V=J(V,N,P,L,x,5,Z[28]),L=J(L,V,N,P,X,9,Z[29]),P=J(P,L,V,N,M,14,Z[30]),N=J(N,P,L,V,m,20,Z[31]),V=A(V,N,P,L,T,4,Z[32]),L=A(L,V,N,P,E,11,Z[33]),P=A(P,L,V,N,D,16,Z[34]),N=A(N,P,L,V,l,23,Z[35]),V=A(V,N,P,L,G,4,Z[36]),L=A(L,V,N,P,B,11,Z[37]),P=A(P,L,V,N,M,16,Z[38]),N=A(N,P,L,V,v,23,Z[39]),V=A(V,N,P,L,x,4,Z[40]),L=A(L,V,N,P,K,11,Z[41]),P=A(P,L,V,N,w,16,Z[42]),N=A(N,P,L,V,k,23,Z[43]),V=A(V,N,P,L,j,4,Z[44]),L=A(L,V,N,P,m,11,Z[45]),P=A(P,L,V,N,S,16,Z[46]),N=A(N,P,L,V,X,23,Z[47]),V=F(V,N,P,L,K,6,Z[48]),L=F(L,V,N,P,M,10,Z[49]),P=F(P,L,V,N,l,15,Z[50]),N=F(N,P,L,V,T,21,Z[51]),V=F(V,N,P,L,m,6,Z[52]),L=F(L,V,N,P,w,10,Z[53]),P=F(P,L,V,N,v,15,Z[54]),N=F(N,P,L,V,G,21,Z[55]),V=F(V,N,P,L,E,6,Z[56]),L=F(L,V,N,P,S,10,Z[57]),P=F(P,L,V,N,k,15,Z[58]),N=F(N,P,L,V,x,21,Z[59]),V=F(V,N,P,L,B,6,Z[60]),L=F(L,V,N,P,D,10,Z[61]),P=F(P,L,V,N,X,15,Z[62]),N=F(N,P,L,V,j,21,Z[63]),Q[0]=Q[0]+V|0,Q[1]=Q[1]+N|0,Q[2]=Q[2]+P|0,Q[3]=Q[3]+L|0},_doFinalize:function(){var z=this._data,R=z.words,n=this._nDataBytes*8,u=z.sigBytes*8;R[u>>>5]|=128<<24-u%32;var q=$.floor(n/4294967296),Q=n;R[(u+64>>>9<<4)+15]=(q<<8|q>>>24)&16711935|(q<<24|q>>>8)&4278255360,R[(u+64>>>9<<4)+14]=(Q<<8|Q>>>24)&16711935|(Q<<24|Q>>>8)&4278255360,z.sigBytes=(R.length+1)*4,this._process();var K=this._hash,G=K.words;for(var X=0;X<4;X++){var w=G[X];G[X]=(w<<8|w>>>24)&16711935|(w<<24|w>>>8)&4278255360}return K},clone:function(){var z=I.clone.call(this);return z._hash=this._hash.clone(),z}});function W(z,R,n,u,q,Q,K){var G=z+(R&n|~R&u)+q+K;return(G<<Q|G>>>32-Q)+R}function J(z,R,n,u,q,Q,K){var G=z+(R&u|n&~u)+q+K;return(G<<Q|G>>>32-Q)+R}function A(z,R,n,u,q,Q,K){var G=z+(R^n^u)+q+K;return(G<<Q|G>>>32-Q)+R}function F(z,R,n,u,q,Q,K){var G=z+(n^(R|~u))+q+K;return(G<<Q|G>>>32-Q)+R}O.MD5=I._createHelper(U),O.HmacMD5=I._createHmacHelper(U)}(Math),Y.MD5})});var AY=p((a,RY)=>{(function(Y,$){if(typeof a==="object")RY.exports=a=$(h());else if(typeof define==="function"&&define.amd)define(["./core"],$);else $(Y.CryptoJS)})(a,function(Y){return function(){var $=Y,O=$.lib,H=O.WordArray,g=O.Hasher,I=$.algo,C=[],Z=I.SHA1=g.extend({_doReset:function(){this._hash=new H.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(U,W){var J=this._hash.words,A=J[0],F=J[1],z=J[2],R=J[3],n=J[4];for(var u=0;u<80;u++){if(u<16)C[u]=U[W+u]|0;else{var q=C[u-3]^C[u-8]^C[u-14]^C[u-16];C[u]=q<<1|q>>>31}var Q=(A<<5|A>>>27)+n+C[u];if(u<20)Q+=(F&z|~F&R)+1518500249;else if(u<40)Q+=(F^z^R)+1859775393;else if(u<60)Q+=(F&z|F&R|z&R)-1894007588;else Q+=(F^z^R)-899497514;n=R,R=z,z=F<<30|F>>>2,F=A,A=Q}J[0]=J[0]+A|0,J[1]=J[1]+F|0,J[2]=J[2]+z|0,J[3]=J[3]+R|0,J[4]=J[4]+n|0},_doFinalize:function(){var U=this._data,W=U.words,J=this._nDataBytes*8,A=U.sigBytes*8;return W[A>>>5]|=128<<24-A%32,W[(A+64>>>9<<4)+14]=Math.floor(J/4294967296),W[(A+64>>>9<<4)+15]=J,U.sigBytes=W.length*4,this._process(),this._hash},clone:function(){var U=g.clone.call(this);return U._hash=this._hash.clone(),U}});$.SHA1=g._createHelper(Z),$.HmacSHA1=g._createHmacHelper(Z)}(),Y.SHA1})});var HY=p((s,vY)=>{(function(Y,$){if(typeof s==="object")vY.exports=s=$(h());else if(typeof define==="function"&&define.amd)define(["./core"],$);else $(Y.CryptoJS)})(s,function(Y){(function(){var $=Y,O=$.lib,H=O.Base,g=$.enc,I=g.Utf8,C=$.algo,Z=C.HMAC=H.extend({init:function(U,W){if(U=this._hasher=new U.init,typeof W=="string")W=I.parse(W);var J=U.blockSize,A=J*4;if(W.sigBytes>A)W=U.finalize(W);W.clamp();var F=this._oKey=W.clone(),z=this._iKey=W.clone(),R=F.words,n=z.words;for(var u=0;u<J;u++)R[u]^=1549556828,n[u]^=909522486;F.sigBytes=z.sigBytes=A,this.reset()},reset:function(){var U=this._hasher;U.reset(),U.update(this._iKey)},update:function(U){return this._hasher.update(U),this},finalize:function(U){var W=this._hasher,J=W.finalize(U);W.reset();var A=W.finalize(this._oKey.clone().concat(J));return A}})})()})});var VY=p((t,TY)=>{(function(Y,$,O){if(typeof t==="object")TY.exports=t=$(h(),AY(),HY());else if(typeof define==="function"&&define.amd)define(["./core","./sha1","./hmac"],$);else $(Y.CryptoJS)})(t,function(Y){return function(){var $=Y,O=$.lib,H=O.Base,g=O.WordArray,I=$.algo,C=I.MD5,Z=I.EvpKDF=H.extend({cfg:H.extend({keySize:4,hasher:C,iterations:1}),init:function(U){this.cfg=this.cfg.extend(U)},compute:function(U,W){var J,A=this.cfg,F=A.hasher.create(),z=g.create(),R=z.words,n=A.keySize,u=A.iterations;while(R.length<n){if(J)F.update(J);J=F.update(U).finalize(W),F.reset();for(var q=1;q<u;q++)J=F.finalize(J),F.reset();z.concat(J)}return z.sigBytes=n*4,z}});$.EvpKDF=function(U,W,J){return Z.create(J).compute(U,W)}}(),Y.EvpKDF})});var XY=p((e,UY)=>{(function(Y,$,O){if(typeof e==="object")UY.exports=e=$(h(),VY());else if(typeof define==="function"&&define.amd)define(["./core","./evpkdf"],$);else $(Y.CryptoJS)})(e,function(Y){Y.lib.Cipher||function($){var O=Y,H=O.lib,g=H.Base,I=H.WordArray,C=H.BufferedBlockAlgorithm,Z=O.enc,U=Z.Utf8,W=Z.Base64,J=O.algo,A=J.EvpKDF,F=H.Cipher=C.extend({cfg:g.extend(),createEncryptor:function(E,j){return this.create(this._ENC_XFORM_MODE,E,j)},createDecryptor:function(E,j){return this.create(this._DEC_XFORM_MODE,E,j)},init:function(E,j,v){this.cfg=this.cfg.extend(v),this._xformMode=E,this._key=j,this.reset()},reset:function(){C.reset.call(this),this._doReset()},process:function(E){return this._append(E),this._process()},finalize:function(E){if(E)this._append(E);var j=this._doFinalize();return j},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function E(j){if(typeof j=="string")return M;else return B}return function(j){return{encrypt:function(v,D,m){return E(D).encrypt(j,v,D,m)},decrypt:function(v,D,m){return E(D).decrypt(j,v,D,m)}}}}()}),z=H.StreamCipher=F.extend({_doFinalize:function(){var E=this._process(!0);return E},blockSize:1}),R=O.mode={},n=H.BlockCipherMode=g.extend({createEncryptor:function(E,j){return this.Encryptor.create(E,j)},createDecryptor:function(E,j){return this.Decryptor.create(E,j)},init:function(E,j){this._cipher=E,this._iv=j}}),u=R.CBC=function(){var E=n.extend();E.Encryptor=E.extend({processBlock:function(v,D){var m=this._cipher,x=m.blockSize;j.call(this,v,D,x),m.encryptBlock(v,D),this._prevBlock=v.slice(D,D+x)}}),E.Decryptor=E.extend({processBlock:function(v,D){var m=this._cipher,x=m.blockSize,l=v.slice(D,D+x);m.decryptBlock(v,D),j.call(this,v,D,x),this._prevBlock=l}});function j(v,D,m){var x,l=this._iv;if(l)x=l,this._iv=$;else x=this._prevBlock;for(var S=0;S<m;S++)v[D+S]^=x[S]}return E}(),q=O.pad={},Q=q.Pkcs7={pad:function(E,j){var v=j*4,D=v-E.sigBytes%v,m=D<<24|D<<16|D<<8|D,x=[];for(var l=0;l<D;l+=4)x.push(m);var S=I.create(x,D);E.concat(S)},unpad:function(E){var j=E.words[E.sigBytes-1>>>2]&255;E.sigBytes-=j}},K=H.BlockCipher=F.extend({cfg:F.cfg.extend({mode:u,padding:Q}),reset:function(){var E;F.reset.call(this);var j=this.cfg,v=j.iv,D=j.mode;if(this._xformMode==this._ENC_XFORM_MODE)E=D.createEncryptor;else E=D.createDecryptor,this._minBufferSize=1;if(this._mode&&this._mode.__creator==E)this._mode.init(this,v&&v.words);else this._mode=E.call(D,this,v&&v.words),this._mode.__creator=E},_doProcessBlock:function(E,j){this._mode.processBlock(E,j)},_doFinalize:function(){var E,j=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE)j.pad(this._data,this.blockSize),E=this._process(!0);else E=this._process(!0),j.unpad(E);return E},blockSize:4}),G=H.CipherParams=g.extend({init:function(E){this.mixIn(E)},toString:function(E){return(E||this.formatter).stringify(this)}}),X=O.format={},w=X.OpenSSL={stringify:function(E){var j,v=E.ciphertext,D=E.salt;if(D)j=I.create([1398893684,1701076831]).concat(D).concat(v);else j=v;return j.toString(W)},parse:function(E){var j,v=W.parse(E),D=v.words;if(D[0]==1398893684&&D[1]==1701076831)j=I.create(D.slice(2,4)),D.splice(0,4),v.sigBytes-=16;return G.create({ciphertext:v,salt:j})}},B=H.SerializableCipher=g.extend({cfg:g.extend({format:w}),encrypt:function(E,j,v,D){D=this.cfg.extend(D);var m=E.createEncryptor(v,D),x=m.finalize(j),l=m.cfg;return G.create({ciphertext:x,key:v,iv:l.iv,algorithm:E,mode:l.mode,padding:l.padding,blockSize:E.blockSize,formatter:D.format})},decrypt:function(E,j,v,D){D=this.cfg.extend(D),j=this._parse(j,D.format);var m=E.createDecryptor(v,D).finalize(j.ciphertext);return m},_parse:function(E,j){if(typeof E=="string")return j.parse(E,this);else return E}}),T=O.kdf={},k=T.OpenSSL={execute:function(E,j,v,D,m){if(!D)D=I.random(8);if(!m)var x=A.create({keySize:j+v}).compute(E,D);else var x=A.create({keySize:j+v,hasher:m}).compute(E,D);var l=I.create(x.words.slice(j),v*4);return x.sigBytes=j*4,G.create({key:x,iv:l,salt:D})}},M=H.PasswordBasedCipher=B.extend({cfg:B.cfg.extend({kdf:k}),encrypt:function(E,j,v,D){D=this.cfg.extend(D);var m=D.kdf.execute(v,E.keySize,E.ivSize,D.salt,D.hasher);D.iv=m.iv;var x=B.encrypt.call(this,E,j,m.key,D);return x.mixIn(m),x},decrypt:function(E,j,v,D){D=this.cfg.extend(D),j=this._parse(j,D.format);var m=D.kdf.execute(v,E.keySize,E.ivSize,j.salt,D.hasher);D.iv=m.iv;var x=B.decrypt.call(this,E,j,m.key,D);return x}})}()})});var IY=p((YY,uY)=>{(function(Y,$,O){if(typeof YY==="object")uY.exports=YY=$(h(),ZY(),EY(),VY(),XY());else if(typeof define==="function"&&define.amd)define(["./core","./enc-base64","./md5","./evpkdf","./cipher-core"],$);else $(Y.CryptoJS)})(YY,function(Y){return function(){var $=Y,O=$.lib,H=O.BlockCipher,g=$.algo,I=[],C=[],Z=[],U=[],W=[],J=[],A=[],F=[],z=[],R=[];(function(){var q=[];for(var Q=0;Q<256;Q++)if(Q<128)q[Q]=Q<<1;else q[Q]=Q<<1^283;var K=0,G=0;for(var Q=0;Q<256;Q++){var X=G^G<<1^G<<2^G<<3^G<<4;X=X>>>8^X&255^99,I[K]=X,C[X]=K;var w=q[K],B=q[w],T=q[B],k=q[X]*257^X*16843008;Z[K]=k<<24|k>>>8,U[K]=k<<16|k>>>16,W[K]=k<<8|k>>>24,J[K]=k;var k=T*16843009^B*65537^w*257^K*16843008;if(A[X]=k<<24|k>>>8,F[X]=k<<16|k>>>16,z[X]=k<<8|k>>>24,R[X]=k,!K)K=G=1;else K=w^q[q[q[T^w]]],G^=q[q[G]]}})();var n=[0,1,2,4,8,16,32,64,128,27,54],u=g.AES=H.extend({_doReset:function(){var q;if(this._nRounds&&this._keyPriorReset===this._key)return;var Q=this._keyPriorReset=this._key,K=Q.words,G=Q.sigBytes/4,X=this._nRounds=G+6,w=(X+1)*4,B=this._keySchedule=[];for(var T=0;T<w;T++)if(T<G)B[T]=K[T];else{if(q=B[T-1],!(T%G))q=q<<8|q>>>24,q=I[q>>>24]<<24|I[q>>>16&255]<<16|I[q>>>8&255]<<8|I[q&255],q^=n[T/G|0]<<24;else if(G>6&&T%G==4)q=I[q>>>24]<<24|I[q>>>16&255]<<16|I[q>>>8&255]<<8|I[q&255];B[T]=B[T-G]^q}var k=this._invKeySchedule=[];for(var M=0;M<w;M++){var T=w-M;if(M%4)var q=B[T];else var q=B[T-4];if(M<4||T<=4)k[M]=q;else k[M]=A[I[q>>>24]]^F[I[q>>>16&255]]^z[I[q>>>8&255]]^R[I[q&255]]}},encryptBlock:function(q,Q){this._doCryptBlock(q,Q,this._keySchedule,Z,U,W,J,I)},decryptBlock:function(q,Q){var K=q[Q+1];q[Q+1]=q[Q+3],q[Q+3]=K,this._doCryptBlock(q,Q,this._invKeySchedule,A,F,z,R,C);var K=q[Q+1];q[Q+1]=q[Q+3],q[Q+3]=K},_doCryptBlock:function(q,Q,K,G,X,w,B,T){var k=this._nRounds,M=q[Q]^K[0],E=q[Q+1]^K[1],j=q[Q+2]^K[2],v=q[Q+3]^K[3],D=4;for(var m=1;m<k;m++){var x=G[M>>>24]^X[E>>>16&255]^w[j>>>8&255]^B[v&255]^K[D++],l=G[E>>>24]^X[j>>>16&255]^w[v>>>8&255]^B[M&255]^K[D++],S=G[j>>>24]^X[v>>>16&255]^w[M>>>8&255]^B[E&255]^K[D++],V=G[v>>>24]^X[M>>>16&255]^w[E>>>8&255]^B[j&255]^K[D++];M=x,E=l,j=S,v=V}var x=(T[M>>>24]<<24|T[E>>>16&255]<<16|T[j>>>8&255]<<8|T[v&255])^K[D++],l=(T[E>>>24]<<24|T[j>>>16&255]<<16|T[v>>>8&255]<<8|T[M&255])^K[D++],S=(T[j>>>24]<<24|T[v>>>16&255]<<16|T[M>>>8&255]<<8|T[E&255])^K[D++],V=(T[v>>>24]<<24|T[M>>>16&255]<<16|T[E>>>8&255]<<8|T[j&255])^K[D++];q[Q]=x,q[Q+1]=l,q[Q+2]=S,q[Q+3]=V},keySize:8});$.AES=H._createHelper(u)}(),Y.AES})});var DY=p((qY,wY)=>{(function(Y,$){if(typeof qY==="object")wY.exports=qY=$(h());else if(typeof define==="function"&&define.amd)define(["./core"],$);else $(Y.CryptoJS)})(qY,function(Y){return Y.enc.Utf8})});var NY=d(IY(),1),gY=d(DY(),1);import{config as mY}from"@stacksjs/config";function Rq(Y,$){let O=$||mY.app.key;if(!O)throw new Error("APP_KEY is not defined");return NY.default.encrypt(Y,O).toString()}function Aq(Y,$){let O=$||mY.app.key;if(!O)throw new Error("APP_KEY is not defined");return NY.default.decrypt(Y,O).toString(gY.default)}var oY=d(EY(),1);import{hashing as i}from"@stacksjs/config";var _=typeof Buffer==="function",xY=typeof TextDecoder==="function"?new TextDecoder:void 0,nY=typeof TextEncoder==="function"?new TextEncoder:void 0;var f=Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="),$Y=((Y)=>{let $={};return Y.forEach((O,H)=>$[O]=H),$})(f),qq=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,b=String.fromCharCode.bind(String),kY=typeof Uint8Array.from==="function"?Uint8Array.from.bind(Uint8Array):(Y)=>new Uint8Array(Array.prototype.slice.call(Y,0)),MY=(Y)=>Y.replace(/=/g,"").replace(/[+\/]/g,($)=>$=="+"?"-":"_"),lY=(Y)=>Y.replace(/[^A-Za-z0-9\+\/]/g,""),bY=(Y)=>{let $,O,H,g,I="",C=Y.length%3;for(let Z=0;Z<Y.length;){if((O=Y.charCodeAt(Z++))>255||(H=Y.charCodeAt(Z++))>255||(g=Y.charCodeAt(Z++))>255)throw new TypeError("invalid character found");$=O<<16|H<<8|g,I+=f[$>>18&63]+f[$>>12&63]+f[$>>6&63]+f[$&63]}return C?I.slice(0,C-3)+"===".substring(C):I},jY=typeof btoa==="function"?(Y)=>btoa(Y):_?(Y)=>Buffer.from(Y,"binary").toString("base64"):bY,PY=_?(Y)=>Buffer.from(Y).toString("base64"):(Y)=>{let O=[];for(let H=0,g=Y.length;H<g;H+=4096)O.push(b.apply(null,Y.subarray(H,H+4096)));return jY(O.join(""))},QY=(Y,$=!1)=>$?MY(PY(Y)):PY(Y),$q=(Y)=>{if(Y.length<2){var $=Y.charCodeAt(0);return $<128?Y:$<2048?b(192|$>>>6)+b(128|$&63):b(224|$>>>12&15)+b(128|$>>>6&63)+b(128|$&63)}else{var $=65536+(Y.charCodeAt(0)-55296)*1024+(Y.charCodeAt(1)-56320);return b(240|$>>>18&7)+b(128|$>>>12&63)+b(128|$>>>6&63)+b(128|$&63)}},Qq=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,SY=(Y)=>Y.replace(Qq,$q),CY=_?(Y)=>Buffer.from(Y,"utf8").toString("base64"):nY?(Y)=>PY(nY.encode(Y)):(Y)=>jY(SY(Y)),y=(Y,$=!1)=>$?MY(CY(Y)):CY(Y),BY=(Y)=>y(Y,!0),Zq=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,Eq=(Y)=>{switch(Y.length){case 4:var $=(7&Y.charCodeAt(0))<<18|(63&Y.charCodeAt(1))<<12|(63&Y.charCodeAt(2))<<6|63&Y.charCodeAt(3),O=$-65536;return b((O>>>10)+55296)+b((O&1023)+56320);case 3:return b((15&Y.charCodeAt(0))<<12|(63&Y.charCodeAt(1))<<6|63&Y.charCodeAt(2));default:return b((31&Y.charCodeAt(0))<<6|63&Y.charCodeAt(1))}},pY=(Y)=>Y.replace(Zq,Eq),hY=(Y)=>{if(Y=Y.replace(/\s+/g,""),!qq.test(Y))throw new TypeError("malformed base64.");Y+="==".slice(2-(Y.length&3));let $,O="",H,g;for(let I=0;I<Y.length;)$=$Y[Y.charAt(I++)]<<18|$Y[Y.charAt(I++)]<<12|(H=$Y[Y.charAt(I++)])<<6|(g=$Y[Y.charAt(I++)]),O+=H===64?b($>>16&255):g===64?b($>>16&255,$>>8&255):b($>>16&255,$>>8&255,$&255);return O},KY=typeof atob==="function"?(Y)=>atob(lY(Y)):_?(Y)=>Buffer.from(Y,"base64").toString("binary"):hY,yY=_?(Y)=>kY(Buffer.from(Y,"base64")):(Y)=>kY(KY(Y).split("").map(($)=>$.charCodeAt(0))),_Y=(Y)=>yY(dY(Y)),Vq=_?(Y)=>Buffer.from(Y,"base64").toString("utf8"):xY?(Y)=>xY.decode(yY(Y)):(Y)=>pY(KY(Y)),dY=(Y)=>lY(Y.replace(/[-_]/g,($)=>$=="-"?"+":"/")),LY=(Y)=>Vq(dY(Y)),Dq=(Y)=>{if(typeof Y!=="string")return!1;let $=Y.replace(/\s+/g,"").replace(/={0,2}$/,"");return!/[^\s0-9a-zA-Z\+/]/.test($)||!/[^\s0-9a-zA-Z\-_]/.test($)},fY=(Y)=>{return{value:Y,enumerable:!1,writable:!0,configurable:!0}},iY=function(){let Y=($,O)=>Object.defineProperty(String.prototype,$,fY(O));Y("fromBase64",function(){return LY(this)}),Y("toBase64",function($){return y(this,$)}),Y("toBase64URI",function(){return y(this,!0)}),Y("toBase64URL",function(){return y(this,!0)}),Y("toUint8Array",function(){return _Y(this)})},cY=function(){let Y=($,O)=>Object.defineProperty(Uint8Array.prototype,$,fY(O));Y("toBase64",function($){return QY(this,$)}),Y("toBase64URI",function(){return QY(this,!0)}),Y("toBase64URL",function(){return QY(this,!0)})},Nq=()=>{iY(),cY()},GY={version:"3.7.7",VERSION:"3.7.7",atob:KY,atobPolyfill:hY,btoa:jY,btoaPolyfill:bY,fromBase64:LY,toBase64:y,encode:y,encodeURI:BY,encodeURL:BY,utob:SY,btou:pY,decode:LY,isValid:Dq,fromUint8Array:QY,toUint8Array:_Y,extendString:iY,extendUint8Array:cY,extendBuiltins:Nq};async function Xq(Y,$){if($?.algorithm==="argon2")return await Lq(Y,{type:"argon2id"});if($?.algorithm==="bcrypt")return await Pq(Y);if($?.algorithm==="base64")return Gq(Y);throw new Error("Unsupported algorithm")}async function uq(Y,$,O){if(O==="argon2")return await jq(Y,$);if(O==="bcrypt")return await Kq(Y,$);if(O==="base64")return Jq(Y,$);throw new Error("Unsupported algorithm")}async function Pq(Y){if(!i.bcrypt)throw new Error("Bcrypt hashing is not configured");return await Bun.password.hash(Y,{algorithm:"bcrypt",cost:i.bcrypt.cost})}async function Lq(Y,$){if(!i.argon2)throw new Error("Argon2 hashing is not configured");return await Bun.password.hash(Y,{algorithm:$?.type||"argon2id",memoryCost:i.argon2.memory,timeCost:i.argon2.time})}async function jq(Y,$){return await Bun.password.verify(Y,$)}async function Kq(Y,$){return await Bun.password.verify(Y,$)}function Gq(Y){return GY.encode(Y)}function Jq(Y,$){return GY.decode($)===Y}function Iq(Y){return oY.default(Y)}var rY=d(ZY(),1),aY=d(DY(),1);import{getRandomValues as Fq}from"crypto";function gq(){let Y=Fq(new Uint8Array(32)),$=aY.default.parse(Y.toString());return`base64:${rY.default.stringify($)}`}export{uq as verifyHash,Iq as md5Encode,Xq as makeHash,gq as generateAppKey,Rq as encrypt,Aq as decrypt,Kq as bcryptVerify,Pq as bcryptEncode,Jq as base64Verify,Gq as base64Encode,jq as argon2Verify,Lq as argon2Encode};
