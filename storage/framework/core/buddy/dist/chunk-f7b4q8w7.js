import{Sc as $,Tc as de}from"./chunk-dy44vw1s.js";import{Wc as m,Xc as Se,ld as Ot}from"./chunk-mwyf46cf.js";import{td as _r,ud as Ie,yd as or,zd as Nr}from"./chunk-c0tfr62j.js";import{Ed as kr}from"./chunk-x9e3h3eh.js";import{Rd as ue}from"./chunk-0gcz8bd6.js";import{Vd as Ue}from"./chunk-jpw6wb6x.js";import{_d as Xr}from"./chunk-mp45a05d.js";import{ae as _,fe as zr}from"./chunk-1krazvx7.js";function Zr(e){return e}var Gt=(e)=>(t)=>async(r)=>{if(!m.isInstance(r.request))return t(r);let{request:o}=r,{handlerProtocol:n=""}=e.requestHandler.metadata||{};if(n.indexOf("h2")>=0&&!o.headers[":authority"])delete o.headers.host,o.headers[":authority"]=o.hostname+(o.port?":"+o.port:"");else if(!o.headers.host){let s=o.hostname;if(o.port!=null)s+=`:${o.port}`;o.headers.host=s}return t(r)},Vt={name:"hostHeaderMiddleware",step:"build",priority:"low",tags:["HOST"],override:!0},Qr=(e)=>({applyToStack:(t)=>{t.add(Gt(e),Vt)}});var Bt=()=>(e,t)=>async(r)=>{try{let o=await e(r),{clientName:n,commandName:s,logger:i,dynamoDbDocumentClientOptions:a={}}=t,{overrideInputFilterSensitiveLog:c,overrideOutputFilterSensitiveLog:p}=a,u=c??t.inputFilterSensitiveLog,x=p??t.outputFilterSensitiveLog,{$metadata:l,...d}=o.output;return i?.info?.({clientName:n,commandName:s,input:u(r.input),output:x(d),metadata:l}),o}catch(o){let{clientName:n,commandName:s,logger:i,dynamoDbDocumentClientOptions:a={}}=t,{overrideInputFilterSensitiveLog:c}=a,p=c??t.inputFilterSensitiveLog;throw i?.error?.({clientName:n,commandName:s,input:p(r.input),error:o,metadata:o.$metadata}),o}},Wt={name:"loggerMiddleware",tags:["LOGGER"],step:"initialize",override:!0},to=(e)=>({applyToStack:(t)=>{t.add(Bt(),Wt)}});var te="X-Amzn-Trace-Id",Yt="AWS_LAMBDA_FUNCTION_NAME",jt="_X_AMZN_TRACE_ID",zt=(e)=>(t)=>async(r)=>{let{request:o}=r;if(!m.isInstance(o)||e.runtime!=="node")return t(r);let n=Object.keys(o.headers??{}).find((c)=>c.toLowerCase()===te.toLowerCase())??te;if(o.headers.hasOwnProperty(n))return t(r);let s=process.env[Yt],i=process.env[jt],a=(c)=>typeof c==="string"&&c.length>0;if(a(s)&&a(i))o.headers[te]=i;return t({...r,request:o})},Xt={step:"build",tags:["RECURSION_DETECTION"],name:"recursionDetectionMiddleware",override:!0,priority:"low"},io=(e)=>({applyToStack:(t)=>{t.add(zt(e),Xt)}});var ye=_(Ie(),1),re=void 0;function Ht(e){if(e===void 0)return!0;return typeof e==="string"&&e.length<=50}function co(e){let t=ye.normalizeProvider(e.userAgentAppId??re),{customUserAgent:r}=e;return Object.assign(e,{customUserAgent:typeof r==="string"?[[r]]:r,userAgentAppId:async()=>{let o=await t();if(!Ht(o)){let n=e.logger?.constructor?.name==="NoOpLogger"||!e.logger?console:e.logger;if(typeof o!=="string")n?.warn("userAgentAppId must be a string or undefined.");else if(o.length>50)n?.warn("The provided userAgentAppId exceeds the maximum length of 50 characters.")}return o}})}class qt{constructor({size:e,params:t}){if(this.data=new Map,this.parameters=[],this.capacity=e??50,t)this.parameters=t}get(e,t){let r=this.hash(e);if(r===!1)return t();if(!this.data.has(r)){if(this.data.size>this.capacity+10){let o=this.data.keys(),n=0;while(!0){let{value:s,done:i}=o.next();if(this.data.delete(s),i||++n>10)break}}this.data.set(r,t())}return this.data.get(r)}size(){return this.data.size}hash(e){let t="",{parameters:r}=this;if(r.length===0)return!1;for(let o of r){let n=String(e[o]??"");if(n.includes("|;"))return!1;t+=n+"|;"}return t}}var Jt=new RegExp("^(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}$"),U=(e)=>Jt.test(e)||e.startsWith("[")&&e.endsWith("]");var Kt=new RegExp("^(?!.*-$)(?!-)[a-zA-Z0-9-]{1,63}$"),v=(e,t=!1)=>{if(!t)return Kt.test(e);let r=e.split(".");for(let o of r)if(!v(o))return!1;return!0};var M={};var h="endpoints";function E(e){if(typeof e!=="object"||e==null)return e;if("ref"in e)return`$${E(e.ref)}`;if("fn"in e)return`${e.fn}(${(e.argv||[]).map(E).join(", ")})`;return JSON.stringify(e,null,2)}class f extends Error{constructor(e){super(e);this.name="EndpointError"}}var De=(e,t)=>e===t;var Ce=(e)=>{let t=e.split("."),r=[];for(let o of t){let n=o.indexOf("[");if(n!==-1){if(o.indexOf("]")!==o.length-1)throw new f(`Path: '${e}' does not end with ']'`);let s=o.slice(n+1,-1);if(Number.isNaN(parseInt(s)))throw new f(`Invalid array index: '${s}' in path: '${e}'`);if(n!==0)r.push(o.slice(0,n));r.push(s)}else r.push(o)}return r};var G=(e,t)=>Ce(t).reduce((r,o)=>{if(typeof r!=="object")throw new f(`Index '${o}' in '${t}' not found in '${JSON.stringify(e)}'`);else if(Array.isArray(r))return r[parseInt(o)];return r[o]},e);var Pe=(e)=>e!=null;var be=(e)=>!e;var V=_(Ue(),1);var oe={[V.EndpointURLScheme.HTTP]:80,[V.EndpointURLScheme.HTTPS]:443},ve=(e)=>{let t=(()=>{try{if(e instanceof URL)return e;if(typeof e==="object"&&"hostname"in e){let{hostname:l,port:d,protocol:I="",path:k="",query:Lt={}}=e,we=new URL(`${I}//${l}${d?`:${d}`:""}${k}`);return we.search=Object.entries(Lt).map(([Ft,kt])=>`${Ft}=${kt}`).join("&"),we}return new URL(e)}catch(l){return null}})();if(!t)return console.error(`Unable to parse ${JSON.stringify(e)} as a whatwg URL.`),null;let r=t.href,{host:o,hostname:n,pathname:s,protocol:i,search:a}=t;if(a)return null;let c=i.slice(0,-1);if(!Object.values(V.EndpointURLScheme).includes(c))return null;let p=U(n),u=r.includes(`${o}:${oe[c]}`)||typeof e==="string"&&e.includes(`${o}:${oe[c]}`),x=`${o}${u?`:${oe[c]}`:""}`;return{scheme:c,authority:x,path:s,normalizedPath:s.endsWith("/")?s:`${s}/`,isIp:p}};var Me=(e,t)=>e===t;var $e=(e,t,r,o)=>{if(t>=r||e.length<r)return null;if(!o)return e.substring(t,r);return e.substring(e.length-r,e.length-t)};var Le=(e)=>encodeURIComponent(e).replace(/[!*'()]/g,(t)=>`%${t.charCodeAt(0).toString(16).toUpperCase()}`);var Fe={booleanEquals:De,getAttr:G,isSet:Pe,isValidHostLabel:v,not:be,parseURL:ve,stringEquals:Me,substring:$e,uriEncode:Le};var B=(e,t)=>{let r=[],o={...t.endpointParams,...t.referenceRecord},n=0;while(n<e.length){let s=e.indexOf("{",n);if(s===-1){r.push(e.slice(n));break}r.push(e.slice(n,s));let i=e.indexOf("}",s);if(i===-1){r.push(e.slice(s));break}if(e[s+1]==="{"&&e[i+1]==="}")r.push(e.slice(s+1,i)),n=i+2;let a=e.substring(s+1,i);if(a.includes("#")){let[c,p]=a.split("#");r.push(G(o[c],p))}else r.push(o[a]);n=i+1}return r.join("")};var ke=({ref:e},t)=>{return{...t.endpointParams,...t.referenceRecord}[e]};var T=(e,t,r)=>{if(typeof e==="string")return B(e,r);else if(e.fn)return W(e,r);else if(e.ref)return ke(e,r);throw new f(`'${t}': ${String(e)} is not a string, function or reference.`)};var W=({fn:e,argv:t},r)=>{let o=t.map((s)=>["boolean","number"].includes(typeof s)?s:T(s,"arg",r)),n=e.split(".");if(n[0]in M&&n[1]!=null)return M[n[0]][n[1]](...o);return Fe[e](...o)};var Ge=({assign:e,...t},r)=>{if(e&&e in r.referenceRecord)throw new f(`'${e}' is already defined in Reference Record.`);let o=W(t,r);return r.logger?.debug?.(`${h} evaluateCondition: ${E(t)} = ${E(o)}`),{result:o===""?!0:!!o,...e!=null&&{toAssign:{name:e,value:o}}}};var y=(e=[],t)=>{let r={};for(let o of e){let{result:n,toAssign:s}=Ge(o,{...t,referenceRecord:{...t.referenceRecord,...r}});if(!n)return{result:n};if(s)r[s.name]=s.value,t.logger?.debug?.(`${h} assign: ${s.name} := ${E(s.value)}`)}return{result:!0,referenceRecord:r}};var Ve=(e,t)=>Object.entries(e).reduce((r,[o,n])=>({...r,[o]:n.map((s)=>{let i=T(s,"Header value entry",t);if(typeof i!=="string")throw new f(`Header '${o}' value '${i}' is not a string`);return i})}),{});var ne=(e,t)=>{if(Array.isArray(e))return e.map((r)=>ne(r,t));switch(typeof e){case"string":return B(e,t);case"object":if(e===null)throw new f(`Unexpected endpoint property: ${e}`);return Y(e,t);case"boolean":return e;default:throw new f(`Unexpected endpoint property type: ${typeof e}`)}};var Y=(e,t)=>Object.entries(e).reduce((r,[o,n])=>({...r,[o]:ne(n,t)}),{});var Be=(e,t)=>{let r=T(e,"Endpoint URL",t);if(typeof r==="string")try{return new URL(r)}catch(o){throw console.error(`Failed to construct URL with ${r}`,o),o}throw new f(`Endpoint URL must be a string, got ${typeof r}`)};var We=(e,t)=>{let{conditions:r,endpoint:o}=e,{result:n,referenceRecord:s}=y(r,t);if(!n)return;let i={...t,referenceRecord:{...t.referenceRecord,...s}},{url:a,properties:c,headers:p}=o;return t.logger?.debug?.(`${h} Resolving endpoint from template: ${E(o)}`),{...p!=null&&{headers:Ve(p,i)},...c!=null&&{properties:Y(c,i)},url:Be(a,i)}};var Ye=(e,t)=>{let{conditions:r,error:o}=e,{result:n,referenceRecord:s}=y(r,t);if(!n)return;throw new f(T(o,"Error",{...t,referenceRecord:{...t.referenceRecord,...s}}))};var je=(e,t)=>{let{conditions:r,rules:o}=e,{result:n,referenceRecord:s}=y(r,t);if(!n)return;return j(o,{...t,referenceRecord:{...t.referenceRecord,...s}})};var j=(e,t)=>{for(let r of e)if(r.type==="endpoint"){let o=We(r,t);if(o)return o}else if(r.type==="error")Ye(r,t);else if(r.type==="tree"){let o=je(r,t);if(o)return o}else throw new f(`Unknown endpoint rule: ${r}`);throw new f("Rules evaluation failed")};var Zt=(e,t)=>{let{endpointParams:r,logger:o}=t,{parameters:n,rules:s}=e;t.logger?.debug?.(`${h} Initial EndpointParams: ${E(r)}`);let i=Object.entries(n).filter(([,p])=>p.default!=null).map(([p,u])=>[p,u.default]);if(i.length>0)for(let[p,u]of i)r[p]=r[p]??u;let a=Object.entries(n).filter(([,p])=>p.required).map(([p])=>p);for(let p of a)if(r[p]==null)throw new f(`Missing required parameter: '${p}'`);let c=j(s,{endpointParams:r,logger:o,referenceRecord:{}});return t.logger?.debug?.(`${h} Resolved endpoint: ${E(c)}`),c};var se=(e,t=!1)=>{if(t){for(let r of e.split("."))if(!se(r))return!1;return!0}if(!v(e))return!1;if(e.length<3||e.length>63)return!1;if(e!==e.toLowerCase())return!1;if(U(e))return!1;return!0};var ze=(e)=>{let t=e.split(":");if(t.length<6)return null;let[r,o,n,s,i,...a]=t;if(r!=="arn"||o===""||n===""||a.join(":")==="")return null;let c=a.map((p)=>p.split("/")).flat();return{partition:o,service:n,region:s,accountId:i,resourceId:c}};var Xe={partitions:[{id:"aws",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-east-1",name:"aws",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^(us|eu|ap|sa|ca|me|af|il|mx)\\-\\w+\\-\\d+$",regions:{"af-south-1":{description:"Africa (Cape Town)"},"ap-east-1":{description:"Asia Pacific (Hong Kong)"},"ap-east-2":{description:"Asia Pacific (Taipei)"},"ap-northeast-1":{description:"Asia Pacific (Tokyo)"},"ap-northeast-2":{description:"Asia Pacific (Seoul)"},"ap-northeast-3":{description:"Asia Pacific (Osaka)"},"ap-south-1":{description:"Asia Pacific (Mumbai)"},"ap-south-2":{description:"Asia Pacific (Hyderabad)"},"ap-southeast-1":{description:"Asia Pacific (Singapore)"},"ap-southeast-2":{description:"Asia Pacific (Sydney)"},"ap-southeast-3":{description:"Asia Pacific (Jakarta)"},"ap-southeast-4":{description:"Asia Pacific (Melbourne)"},"ap-southeast-5":{description:"Asia Pacific (Malaysia)"},"ap-southeast-7":{description:"Asia Pacific (Thailand)"},"aws-global":{description:"AWS Standard global region"},"ca-central-1":{description:"Canada (Central)"},"ca-west-1":{description:"Canada West (Calgary)"},"eu-central-1":{description:"Europe (Frankfurt)"},"eu-central-2":{description:"Europe (Zurich)"},"eu-north-1":{description:"Europe (Stockholm)"},"eu-south-1":{description:"Europe (Milan)"},"eu-south-2":{description:"Europe (Spain)"},"eu-west-1":{description:"Europe (Ireland)"},"eu-west-2":{description:"Europe (London)"},"eu-west-3":{description:"Europe (Paris)"},"il-central-1":{description:"Israel (Tel Aviv)"},"me-central-1":{description:"Middle East (UAE)"},"me-south-1":{description:"Middle East (Bahrain)"},"mx-central-1":{description:"Mexico (Central)"},"sa-east-1":{description:"South America (Sao Paulo)"},"us-east-1":{description:"US East (N. Virginia)"},"us-east-2":{description:"US East (Ohio)"},"us-west-1":{description:"US West (N. California)"},"us-west-2":{description:"US West (Oregon)"}}},{id:"aws-cn",outputs:{dnsSuffix:"amazonaws.com.cn",dualStackDnsSuffix:"api.amazonwebservices.com.cn",implicitGlobalRegion:"cn-northwest-1",name:"aws-cn",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^cn\\-\\w+\\-\\d+$",regions:{"aws-cn-global":{description:"AWS China global region"},"cn-north-1":{description:"China (Beijing)"},"cn-northwest-1":{description:"China (Ningxia)"}}},{id:"aws-us-gov",outputs:{dnsSuffix:"amazonaws.com",dualStackDnsSuffix:"api.aws",implicitGlobalRegion:"us-gov-west-1",name:"aws-us-gov",supportsDualStack:!0,supportsFIPS:!0},regionRegex:"^us\\-gov\\-\\w+\\-\\d+$",regions:{"aws-us-gov-global":{description:"AWS GovCloud (US) global region"},"us-gov-east-1":{description:"AWS GovCloud (US-East)"},"us-gov-west-1":{description:"AWS GovCloud (US-West)"}}},{id:"aws-iso",outputs:{dnsSuffix:"c2s.ic.gov",dualStackDnsSuffix:"c2s.ic.gov",implicitGlobalRegion:"us-iso-east-1",name:"aws-iso",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^us\\-iso\\-\\w+\\-\\d+$",regions:{"aws-iso-global":{description:"AWS ISO (US) global region"},"us-iso-east-1":{description:"US ISO East"},"us-iso-west-1":{description:"US ISO WEST"}}},{id:"aws-iso-b",outputs:{dnsSuffix:"sc2s.sgov.gov",dualStackDnsSuffix:"sc2s.sgov.gov",implicitGlobalRegion:"us-isob-east-1",name:"aws-iso-b",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^us\\-isob\\-\\w+\\-\\d+$",regions:{"aws-iso-b-global":{description:"AWS ISOB (US) global region"},"us-isob-east-1":{description:"US ISOB East (Ohio)"}}},{id:"aws-iso-e",outputs:{dnsSuffix:"cloud.adc-e.uk",dualStackDnsSuffix:"cloud.adc-e.uk",implicitGlobalRegion:"eu-isoe-west-1",name:"aws-iso-e",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^eu\\-isoe\\-\\w+\\-\\d+$",regions:{"aws-iso-e-global":{description:"AWS ISOE (Europe) global region"},"eu-isoe-west-1":{description:"EU ISOE West"}}},{id:"aws-iso-f",outputs:{dnsSuffix:"csp.hci.ic.gov",dualStackDnsSuffix:"csp.hci.ic.gov",implicitGlobalRegion:"us-isof-south-1",name:"aws-iso-f",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^us\\-isof\\-\\w+\\-\\d+$",regions:{"aws-iso-f-global":{description:"AWS ISOF global region"},"us-isof-east-1":{description:"US ISOF EAST"},"us-isof-south-1":{description:"US ISOF SOUTH"}}},{id:"aws-eusc",outputs:{dnsSuffix:"amazonaws.eu",dualStackDnsSuffix:"amazonaws.eu",implicitGlobalRegion:"eusc-de-east-1",name:"aws-eusc",supportsDualStack:!1,supportsFIPS:!0},regionRegex:"^eusc\\-(de)\\-\\w+\\-\\d+$",regions:{"eusc-de-east-1":{description:"EU (Germany)"}}}],version:"1.1"};var er=Xe,tr="",He=(e)=>{let{partitions:t}=er;for(let o of t){let{regions:n,outputs:s}=o;for(let[i,a]of Object.entries(n))if(i===e)return{...s,...a}}for(let o of t){let{regionRegex:n,outputs:s}=o;if(new RegExp(n).test(e))return{...s}}let r=t.find((o)=>o.id==="aws");if(!r)throw new Error("Provided region was not found in the partition array or regex, and default partition with id 'aws' doesn't exist.");return{...r.outputs}};var qe=()=>tr;var rr={isVirtualHostableS3Bucket:se,parseArn:ze,partition:He};M.aws=rr;var R=_(or(),1),nr=/\d{12}\.ddb/;async function Je(e,t,r){if(r.request?.headers?.["smithy-protocol"]==="rpc-v2-cbor")R.setFeature(e,"PROTOCOL_RPC_V2_CBOR","M");if(typeof t.retryStrategy==="function"){let s=await t.retryStrategy();if(typeof s.acquireInitialRetryToken==="function")if(s.constructor?.name?.includes("Adaptive"))R.setFeature(e,"RETRY_MODE_ADAPTIVE","F");else R.setFeature(e,"RETRY_MODE_STANDARD","E");else R.setFeature(e,"RETRY_MODE_LEGACY","D")}if(typeof t.accountIdEndpointMode==="function"){let s=e.endpointV2;if(String(s?.url?.hostname).match(nr))R.setFeature(e,"ACCOUNT_ID_ENDPOINT","O");switch(await t.accountIdEndpointMode?.()){case"disabled":R.setFeature(e,"ACCOUNT_ID_MODE_DISABLED","Q");break;case"preferred":R.setFeature(e,"ACCOUNT_ID_MODE_PREFERRED","P");break;case"required":R.setFeature(e,"ACCOUNT_ID_MODE_REQUIRED","R");break}}let n=e.__smithy_context?.selectedHttpAuthScheme?.identity;if(n?.$source){let s=n;if(s.accountId)R.setFeature(e,"RESOLVED_ACCOUNT_ID","T");for(let[i,a]of Object.entries(s.$source??{}))R.setFeature(e,i,a)}}var ie="user-agent",z="x-amz-user-agent",ae=" ",X="/",Ke=/[^\!\$\%\&\'\*\+\-\.\^\_\`\|\~\d\w]/g,Ze=/[^\!\$\%\&\'\*\+\-\.\^\_\`\|\~\d\w\#]/g,ce="-";function Qe(e){let t="";for(let r in e){let o=e[r];if(t.length+o.length+1<=1024){if(t.length)t+=","+o;else t+=o;continue}break}return t}var sr=(e)=>(t,r)=>async(o)=>{let{request:n}=o;if(!m.isInstance(n))return t(o);let{headers:s}=n,i=r?.userAgent?.map(H)||[],a=(await e.defaultUserAgentProvider()).map(H);await Je(r,e,o);let c=r;a.push(`m/${Qe(Object.assign({},r.__smithy_context?.features,c.__aws_sdk_context?.features))}`);let p=e?.customUserAgent?.map(H)||[],u=await e.userAgentAppId();if(u)a.push(H([`app/${u}`]));let x=qe(),l=(x?[x]:[]).concat([...a,...i,...p]).join(ae),d=[...a.filter((I)=>I.startsWith("aws-sdk-")),...p].join(ae);if(e.runtime!=="browser"){if(d)s[z]=s[z]?`${s[ie]} ${d}`:d;s[ie]=l}else s[z]=l;return t({...o,request:n})},H=(e)=>{let t=e[0].split(X).map((i)=>i.replace(Ke,ce)).join(X),r=e[1]?.replace(Ze,ce),o=t.indexOf(X),n=t.substring(0,o),s=t.substring(o+1);if(n==="api")s=s.toLowerCase();return[n,s,r].filter((i)=>i&&i.length>0).reduce((i,a,c)=>{switch(c){case 0:return a;case 1:return`${i}/${a}`;default:return`${i}#${a}`}},"")},ir={name:"getUserAgentMiddleware",step:"build",priority:"low",tags:["SET_USER_AGENT","USER_AGENT"],override:!0},qs=(e)=>({applyToStack:(t)=>{t.add(sr(e),ir)}});var q=(e)=>typeof e==="string"&&(e.startsWith("fips-")||e.endsWith("-fips"));var pe=(e)=>q(e)?["fips-aws-global","aws-fips"].includes(e)?"us-east-1":e.replace(/fips-(dkr-|prod-)?|-fips/,""):e;var si=(e)=>{let{region:t,useFipsEndpoint:r}=e;if(!t)throw new Error("Region is missing");return Object.assign(e,{region:async()=>{if(typeof t==="string")return pe(t);let o=await t();return pe(o)},useFipsEndpoint:async()=>{let o=typeof t==="string"?t:await t();if(q(o))return!0;return typeof r!=="function"?Promise.resolve(!!r):r()}})};var D=(e,t,r)=>{if(!(t in e))return;if(e[t]==="true")return!0;if(e[t]==="false")return!1;throw new Error(`Cannot load ${r} "${t}". Expected "true" or "false", got ${e[t]}.`)};var O;(function(e){e.ENV="env",e.CONFIG="shared config entry"})(O||(O={}));var ar="AWS_USE_DUALSTACK_ENDPOINT",cr="use_dualstack_endpoint";var Ei={environmentVariableSelector:(e)=>D(e,ar,O.ENV),configFileSelector:(e)=>D(e,cr,O.CONFIG),default:!1};var pr="AWS_USE_FIPS_ENDPOINT",fr="use_fips_endpoint";var xi={environmentVariableSelector:(e)=>D(e,pr,O.ENV),configFileSelector:(e)=>D(e,fr,O.CONFIG),default:!1};var fe=_(Ue(),1),et=(e)=>e[fe.SMITHY_CONTEXT_KEY]||(e[fe.SMITHY_CONTEXT_KEY]={});var A=(e)=>{if(typeof e==="function")return e;let t=Promise.resolve(e);return()=>t};var tt={environmentVariableSelector:(e)=>e.AWS_REGION,configFileSelector:(e)=>e.region,default:()=>{throw new Error("Region is missing")}},Li={preferredFile:"credentials"};var rt="content-length";function ur(e){return(t)=>async(r)=>{let o=r.request;if(m.isInstance(o)){let{body:n,headers:s}=o;if(n&&Object.keys(s).map((i)=>i.toLowerCase()).indexOf(rt)===-1)try{let i=e(n);o.headers={...o.headers,[rt]:String(i)}}catch(i){}}return t({...r,request:o})}}var dr={step:"build",tags:["SET_CONTENT_LENGTH","CONTENT_LENGTH"],name:"contentLengthMiddleware",override:!0},fa=(e)=>({applyToStack:(t)=>{t.add(ur(e.bodyLengthChecker),dr)}});var ut=_(_r(),1);var pt=_(Ie(),1);var ot=async(e)=>{let t=e?.Bucket||"";if(typeof e.Bucket==="string")e.Bucket=t.replace(/#/g,encodeURIComponent("#")).replace(/\?/g,encodeURIComponent("?"));if(Rr(t)){if(e.ForcePathStyle===!0)throw new Error("Path-style addressing cannot be used with ARN buckets")}else if(!gr(t)||t.indexOf(".")!==-1&&!String(e.Endpoint).startsWith("http:")||t.toLowerCase()!==t||t.length<3)e.ForcePathStyle=!0;if(e.DisableMultiRegionAccessPoints)e.disableMultiRegionAccessPoints=!0,e.DisableMRAP=!0;return e},lr=/^[a-z0-9][a-z0-9\.\-]{1,61}[a-z0-9]$/,mr=/(\d+\.){3}\d+/,Er=/\.\./;var gr=(e)=>lr.test(e)&&!mr.test(e)&&!Er.test(e),Rr=(e)=>{let[t,r,o,,,n]=e.split(":"),s=t==="arn"&&e.split(":").length>=6,i=Boolean(s&&r&&o&&n);if(s&&!i)throw new Error(`Invalid ARN: ${e} was an invalid ARN.`);return i};var nt=(e,t,r)=>{let o=async()=>{let n=r[e]??r[t];if(typeof n==="function")return n();return n};if(e==="credentialScope"||t==="CredentialScope")return async()=>{let n=typeof r.credentials==="function"?await r.credentials():r.credentials;return n?.credentialScope??n?.CredentialScope};if(e==="accountId"||t==="AccountId")return async()=>{let n=typeof r.credentials==="function"?await r.credentials():r.credentials;return n?.accountId??n?.AccountId};if(e==="endpoint"||t==="endpoint")return async()=>{let n=await o();if(n&&typeof n==="object"){if("url"in n)return n.url.href;if("hostname"in n){let{protocol:s,hostname:i,port:a,path:c}=n;return`${s}//${i}${a?":"+a:""}${c}`}}return n};return o};var st="AWS_ENDPOINT_URL",it="endpoint_url",at=(e)=>({environmentVariableSelector:(t)=>{let r=e.split(" ").map((s)=>s.toUpperCase()),o=t[[st,...r].join("_")];if(o)return o;let n=t[st];if(n)return n;return},configFileSelector:(t,r)=>{if(r&&t.services){let n=r[["services",t.services].join(ue)];if(n){let s=e.split(" ").map((a)=>a.toLowerCase()),i=n[[s.join("_"),it].join(ue)];if(i)return i}}let o=t[it];if(o)return o;return},default:void 0});var J=async(e)=>$(at(e??""))();var K=(e)=>{if(typeof e==="object"){if("url"in e)return de(e.url);return e}return de(e)};var ct=async(e,t,r,o)=>{if(!r.endpoint){let i;if(r.serviceConfiguredEndpoint)i=await r.serviceConfiguredEndpoint();else i=await J(r.serviceId);if(i)r.endpoint=()=>Promise.resolve(K(i))}let n=await xr(e,t,r);if(typeof r.endpointProvider!=="function")throw new Error("config.endpointProvider is not set.");return r.endpointProvider(n,o)},xr=async(e,t,r)=>{let o={},n=t?.getEndpointParameterInstructions?.()||{};for(let[s,i]of Object.entries(n))switch(i.type){case"staticContextParams":o[s]=i.value;break;case"contextParams":o[s]=e[i.name];break;case"clientContextParams":case"builtInParams":o[s]=await nt(i.name,s,r)();break;case"operationContextParams":o[s]=i.get(e);break;default:throw new Error("Unrecognized endpoint parameter instruction: "+JSON.stringify(i))}if(Object.keys(n).length===0)Object.assign(o,r);if(String(r.serviceId).toLowerCase()==="s3")await ot(o);return o};var ft=({config:e,instructions:t})=>{return(r,o)=>async(n)=>{if(e.endpoint)pt.setFeature(o,"ENDPOINT_OVERRIDE","N");let s=await ct(n.input,{getEndpointParameterInstructions(){return t}},{...e},o);o.endpointV2=s,o.authSchemes=s.properties?.authSchemes;let i=o.authSchemes?.[0];if(i){o.signing_region=i.signingRegion,o.signing_service=i.signingName;let c=et(o)?.selectedHttpAuthScheme?.httpAuthOption;if(c)c.signingProperties=Object.assign(c.signingProperties||{},{signing_region:i.signingRegion,signingRegion:i.signingRegion,signing_service:i.signingName,signingName:i.signingName,signingRegionSet:i.signingRegionSet},i.properties)}return r({...n})}};var Sr={step:"serialize",tags:["ENDPOINT_PARAMETERS","ENDPOINT_V2","ENDPOINT"],name:"endpointV2Middleware",override:!0,relation:"before",toMiddleware:ut.serializerMiddlewareOption.name},ba=(e,t)=>({applyToStack:(r)=>{r.addRelativeTo(ft({config:e,instructions:t}),Sr)}});var La=(e)=>{let t=e.tls??!0,{endpoint:r,useDualstackEndpoint:o,useFipsEndpoint:n}=e,s=r!=null?async()=>K(await A(r)()):void 0,a=Object.assign(e,{endpoint:s,tls:t,isCustomEndpoint:!!r,useDualstackEndpoint:A(o??!1),useFipsEndpoint:A(n??!1)}),c=void 0;return a.serviceConfiguredEndpoint=async()=>{if(e.serviceId&&!c)c=J(e.serviceId);return c},a};var g;(function(e){e.STANDARD="standard",e.ADAPTIVE="adaptive"})(g||(g={}));var N=3,dt=g.STANDARD;var lt=["BandwidthLimitExceeded","EC2ThrottledException","LimitExceededException","PriorRequestNotComplete","ProvisionedThroughputExceededException","RequestLimitExceeded","RequestThrottled","RequestThrottledException","SlowDown","ThrottledException","Throttling","ThrottlingException","TooManyRequestsException","TransactionInProgressException"],mt=["TimeoutError","RequestTimeout","RequestTimeoutException"],Et=[500,502,503,504],gt=["ECONNRESET","ECONNREFUSED","EPIPE","ETIMEDOUT"],Rt=["EHOSTUNREACH","ENETUNREACH","ENOTFOUND"];var hr=(e)=>e.$metadata?.clockSkewCorrected,Ar=(e)=>{let t=new Set(["Failed to fetch","NetworkError when attempting to fetch resource","The Internet connection appears to be offline","Load failed","Network request failed"]);if(!(e&&e instanceof TypeError))return!1;return t.has(e.message)},C=(e)=>e.$metadata?.httpStatusCode===429||lt.includes(e.name)||e.$retryable?.throttling==!0,L=(e,t=0)=>hr(e)||mt.includes(e.name)||gt.includes(e?.code||"")||Rt.includes(e?.code||"")||Et.includes(e.$metadata?.httpStatusCode||0)||Ar(e)||e.cause!==void 0&&t<=10&&L(e.cause,t+1),xt=(e)=>{if(e.$metadata?.httpStatusCode!==void 0){let t=e.$metadata.httpStatusCode;if(500<=t&&t<=599&&!L(e))return!0;return!1}return!1};class P{constructor(e){this.currentCapacity=0,this.enabled=!1,this.lastMaxRate=0,this.measuredTxRate=0,this.requestCount=0,this.lastTimestamp=0,this.timeWindow=0,this.beta=e?.beta??0.7,this.minCapacity=e?.minCapacity??1,this.minFillRate=e?.minFillRate??0.5,this.scaleConstant=e?.scaleConstant??0.4,this.smooth=e?.smooth??0.8;let t=this.getCurrentTimeInSeconds();this.lastThrottleTime=t,this.lastTxRateBucket=Math.floor(this.getCurrentTimeInSeconds()),this.fillRate=this.minFillRate,this.maxCapacity=this.minCapacity}getCurrentTimeInSeconds(){return Date.now()/1000}async getSendToken(){return this.acquireTokenBucket(1)}async acquireTokenBucket(e){if(!this.enabled)return;if(this.refillTokenBucket(),e>this.currentCapacity){let t=(e-this.currentCapacity)/this.fillRate*1000;await new Promise((r)=>P.setTimeoutFn(r,t))}this.currentCapacity=this.currentCapacity-e}refillTokenBucket(){let e=this.getCurrentTimeInSeconds();if(!this.lastTimestamp){this.lastTimestamp=e;return}let t=(e-this.lastTimestamp)*this.fillRate;this.currentCapacity=Math.min(this.maxCapacity,this.currentCapacity+t),this.lastTimestamp=e}updateClientSendingRate(e){let t;if(this.updateMeasuredRate(),C(e)){let o=!this.enabled?this.measuredTxRate:Math.min(this.measuredTxRate,this.fillRate);this.lastMaxRate=o,this.calculateTimeWindow(),this.lastThrottleTime=this.getCurrentTimeInSeconds(),t=this.cubicThrottle(o),this.enableTokenBucket()}else this.calculateTimeWindow(),t=this.cubicSuccess(this.getCurrentTimeInSeconds());let r=Math.min(t,2*this.measuredTxRate);this.updateTokenBucketRate(r)}calculateTimeWindow(){this.timeWindow=this.getPrecise(Math.pow(this.lastMaxRate*(1-this.beta)/this.scaleConstant,0.3333333333333333))}cubicThrottle(e){return this.getPrecise(e*this.beta)}cubicSuccess(e){return this.getPrecise(this.scaleConstant*Math.pow(e-this.lastThrottleTime-this.timeWindow,3)+this.lastMaxRate)}enableTokenBucket(){this.enabled=!0}updateTokenBucketRate(e){this.refillTokenBucket(),this.fillRate=Math.max(e,this.minFillRate),this.maxCapacity=Math.max(e,this.minCapacity),this.currentCapacity=Math.min(this.currentCapacity,this.maxCapacity)}updateMeasuredRate(){let e=this.getCurrentTimeInSeconds(),t=Math.floor(e*2)/2;if(this.requestCount++,t>this.lastTxRateBucket){let r=this.requestCount/(t-this.lastTxRateBucket);this.measuredTxRate=this.getPrecise(r*this.smooth+this.measuredTxRate*(1-this.smooth)),this.requestCount=0,this.lastTxRateBucket=t}}getPrecise(e){return parseFloat(e.toFixed(8))}}P.setTimeoutFn=setTimeout;var w=100,F=20000,le=500,Z=500,me=5,Ee=10,ge=1,Q="amz-sdk-invocation-id",ee="amz-sdk-request";var _t=()=>{let e=w;return{computeNextBackoffDelay:(o)=>{return Math.floor(Math.min(F,Math.random()*2**o*e))},setDelayBase:(o)=>{e=o}}};var Re=({retryDelay:e,retryCount:t,retryCost:r})=>{return{getRetryCount:()=>t,getRetryDelay:()=>Math.min(F,e),getRetryCost:()=>r}};class b{constructor(e){this.maxAttempts=e,this.mode=g.STANDARD,this.capacity=Z,this.retryBackoffStrategy=_t(),this.maxAttemptsProvider=typeof e==="function"?e:async()=>e}async acquireInitialRetryToken(e){return Re({retryDelay:w,retryCount:0})}async refreshRetryTokenForRetry(e,t){let r=await this.getMaxAttempts();if(this.shouldRetry(e,t,r)){let o=t.errorType;this.retryBackoffStrategy.setDelayBase(o==="THROTTLING"?le:w);let n=this.retryBackoffStrategy.computeNextBackoffDelay(e.getRetryCount()),s=t.retryAfterHint?Math.max(t.retryAfterHint.getTime()-Date.now()||0,n):n,i=this.getCapacityCost(o);return this.capacity-=i,Re({retryDelay:s,retryCount:e.getRetryCount()+1,retryCost:i})}throw new Error("No retry token available")}recordSuccess(e){this.capacity=Math.max(Z,this.capacity+(e.getRetryCost()??ge))}getCapacity(){return this.capacity}async getMaxAttempts(){try{return await this.maxAttemptsProvider()}catch(e){return console.warn(`Max attempts provider could not resolve. Using default of ${N}`),N}}shouldRetry(e,t,r){return e.getRetryCount()+1<r&&this.capacity>=this.getCapacityCost(t.errorType)&&this.isRetryableError(t.errorType)}getCapacityCost(e){return e==="TRANSIENT"?Ee:me}isRetryableError(e){return e==="THROTTLING"||e==="TRANSIENT"}}class xe{constructor(e,t){this.maxAttemptsProvider=e,this.mode=g.ADAPTIVE;let{rateLimiter:r}=t??{};this.rateLimiter=r??new P,this.standardRetryStrategy=new b(e)}async acquireInitialRetryToken(e){return await this.rateLimiter.getSendToken(),this.standardRetryStrategy.acquireInitialRetryToken(e)}async refreshRetryTokenForRetry(e,t){return this.rateLimiter.updateClientSendingRate(t),this.standardRetryStrategy.refreshRetryTokenForRetry(e,t)}recordSuccess(e){this.rateLimiter.updateClientSendingRate({}),this.standardRetryStrategy.recordSuccess(e)}}var St="AWS_MAX_ATTEMPTS",ht="max_attempts",Cc={environmentVariableSelector:(e)=>{let t=e[St];if(!t)return;let r=parseInt(t);if(Number.isNaN(r))throw new Error(`Environment variable ${St} mast be a number, got "${t}"`);return r},configFileSelector:(e)=>{let t=e[ht];if(!t)return;let r=parseInt(t);if(Number.isNaN(r))throw new Error(`Shared config file entry ${ht} mast be a number, got "${t}"`);return r},default:N},Pc=(e)=>{let{retryStrategy:t,retryMode:r,maxAttempts:o}=e,n=A(o??N);return Object.assign(e,{maxAttempts:n,retryStrategy:async()=>{if(t)return t;if(await A(r)()===g.ADAPTIVE)return new xe(n);return new b(n)}})},Tr="AWS_RETRY_MODE",Or="retry_mode",bc={environmentVariableSelector:(e)=>e[Tr],configFileSelector:(e)=>e[Or],default:dt};var S=_(Nr(),1),vc=S.default.v1,Mc=S.default.v3,At=S.default.v4,$c=S.default.v5,Lc=S.default.NIL,Fc=S.default.version,kc=S.default.validate,Gc=S.default.stringify,Vc=S.default.parse;import{Readable as wr}from"stream";var Tt=(e)=>e?.body instanceof wr||typeof ReadableStream!=="undefined"&&e?.body instanceof ReadableStream;var _e=(e)=>{if(e instanceof Error)return e;if(e instanceof Object)return Object.assign(new Error,e);if(typeof e==="string")return new Error(e);return new Error(`AWS SDK error wrapper for ${e}`)};var Ir=(e)=>(t,r)=>async(o)=>{let n=await e.retryStrategy(),s=await e.maxAttempts();if(yr(n)){n=n;let i=await n.acquireInitialRetryToken(r.partition_id),a=new Error,c=0,p=0,{request:u}=o,x=m.isInstance(u);if(x)u.headers[Q]=At();while(!0)try{if(x)u.headers[ee]=`attempt=${c+1}; max=${s}`;let{response:l,output:d}=await t(o);return n.recordSuccess(i),d.$metadata.attempts=c+1,d.$metadata.totalRetryDelay=p,{response:l,output:d}}catch(l){let d=Dr(l);if(a=_e(l),x&&Tt(u))throw(r.logger instanceof Ot?console:r.logger)?.warn("An error was encountered in a non-retryable streaming request."),a;try{i=await n.refreshRetryTokenForRetry(i,d)}catch(k){if(!a.$metadata)a.$metadata={};throw a.$metadata.attempts=c+1,a.$metadata.totalRetryDelay=p,a}c=i.getRetryCount();let I=i.getRetryDelay();p+=I,await new Promise((k)=>setTimeout(k,I))}}else{if(n=n,n?.mode)r.userAgent=[...r.userAgent||[],["cfg/retry-mode",n.mode]];return n.retry(t,o)}},yr=(e)=>typeof e.acquireInitialRetryToken!=="undefined"&&typeof e.refreshRetryTokenForRetry!=="undefined"&&typeof e.recordSuccess!=="undefined",Dr=(e)=>{let t={error:e,errorType:Cr(e)},r=br(e.$response);if(r)t.retryAfterHint=r;return t},Cr=(e)=>{if(C(e))return"THROTTLING";if(L(e))return"TRANSIENT";if(xt(e))return"SERVER_ERROR";return"CLIENT_ERROR"},Pr={name:"retryMiddleware",tags:["RETRY"],step:"finalizeRequest",priority:"high",override:!0},Qc=(e)=>({applyToStack:(t)=>{t.add(Ir(e),Pr)}}),br=(e)=>{if(!Se.isInstance(e))return;let t=Object.keys(e.headers).find((s)=>s.toLowerCase()==="retry-after");if(!t)return;let r=e.headers[t],o=Number(r);if(!Number.isNaN(o))return new Date(o*1000);return new Date(r)};import{platform as Ur,release as vr}from"os";import{env as wt,versions as Mr}from"process";var he={isCrtAvailable:!1};var Nt=()=>{if(he.isCrtAvailable)return["md/crt-avail"];return null};var Vp=({serviceId:e,clientVersion:t})=>{return async(r)=>{let o=[["aws-sdk-js",t],["ua","2.1"],[`os/${Ur()}`,vr()],["lang/js"],["md/nodejs",`${Mr.node}`]],n=Nt();if(n)o.push(n);if(e)o.push([`api/${e}`,t]);if(wt.AWS_EXECUTION_ENV)o.push([`exec-env/${wt.AWS_EXECUTION_ENV}`]);let s=await r?.userAgentAppId?.();return s?[...o,[`app/${s}`]]:[...o]}};var $r="AWS_SDK_UA_APP_ID",Lr="sdk_ua_app_id",Fr="sdk-ua-app-id",jp={environmentVariableSelector:(e)=>e[$r],configFileSelector:(e)=>e[Lr]??e[Fr],default:re};var It=(e)=>typeof ArrayBuffer==="function"&&e instanceof ArrayBuffer||Object.prototype.toString.call(e)==="[object ArrayBuffer]";import{Buffer as Ae}from"buffer";var Te=(e,t=0,r=e.byteLength-t)=>{if(!It(e))throw new TypeError(`The "input" argument must be ArrayBuffer. Received type ${typeof e} (${e})`);return Ae.from(e,t,r)},yt=(e,t)=>{if(typeof e!=="string")throw new TypeError(`The "input" argument must be of type string. Received type ${typeof e} (${e})`);return t?Ae.from(e,t):Ae.from(e)};var Ct=_(kr(),1);import{Buffer as Gr}from"buffer";import{createHash as Vr,createHmac as Br}from"crypto";class Wr{constructor(e,t){this.algorithmIdentifier=e,this.secret=t,this.reset()}update(e,t){this.hash.update(Ct.toUint8Array(Dt(e,t)))}digest(){return Promise.resolve(this.hash.digest())}reset(){this.hash=this.secret?Br(this.algorithmIdentifier,Dt(this.secret)):Vr(this.algorithmIdentifier)}}function Dt(e,t){if(Gr.isBuffer(e))return e;if(typeof e==="string")return yt(e,t);if(ArrayBuffer.isView(e))return Te(e.buffer,e.byteOffset,e.byteLength);return Te(e)}import{fstatSync as Yr,lstatSync as jr}from"fs";var sf=(e)=>{if(!e)return 0;if(typeof e==="string")return Buffer.byteLength(e);else if(typeof e.byteLength==="number")return e.byteLength;else if(typeof e.size==="number")return e.size;else if(typeof e.start==="number"&&typeof e.end==="number")return e.end+1-e.start;else if(typeof e.path==="string"||Buffer.isBuffer(e.path))return jr(e.path).size;else if(typeof e.fd==="number")return Yr(e.fd).size;throw new Error(`Body Length computation failed for ${e}`)};var $t=_(Xr(),1);var Pt="AWS_EXECUTION_ENV",Oe="AWS_REGION",Ne="AWS_DEFAULT_REGION",bt="AWS_EC2_METADATA_DISABLED",Ut=["in-region","cross-region","mobile","standard","legacy"],vt="/latest/meta-data/placement/region";var Mt={environmentVariableSelector:(e)=>{return e.AWS_DEFAULTS_MODE},configFileSelector:(e)=>{return e.defaults_mode},default:"legacy"};var gf=({region:e=$(tt),defaultsMode:t=$(Mt)}={})=>$t.memoize(async()=>{let r=typeof t==="function"?await t():t;switch(r?.toLowerCase()){case"auto":return Hr(e);case"in-region":case"cross-region":case"mobile":case"standard":case"legacy":return Promise.resolve(r?.toLocaleLowerCase());case void 0:return Promise.resolve("legacy");default:throw new Error(`Invalid parameter for "defaultsMode", expect ${Ut.join(", ")}, got ${r}`)}}),Hr=async(e)=>{if(e){let t=typeof e==="function"?await e():e,r=await qr();if(!r)return"standard";if(t===r)return"in-region";else return"cross-region"}return"standard"},qr=async()=>{if(process.env[Pt]&&(process.env[Oe]||process.env[Ne]))return process.env[Oe]??process.env[Ne];if(!process.env[bt])try{let{getInstanceMetadataEndpoint:e,httpRequest:t}=await import("./chunk-ba2f3xh4.js"),r=await e();return(await t({...r,path:vt})).toString()}catch(e){}};var Sf=(e)=>{return{setRegion(t){e.region=t},region(){return e.region}}},hf=(e)=>{return{region:e.region()}};export{Zr as mc,Qr as nc,to as oc,io as pc,co as qc,qt as rc,M as sc,Zt as tc,rr as uc,qs as vc,Ei as wc,xi as xc,et as yc,A as zc,tt as Ac,Li as Bc,si as Cc,fa as Dc,ba as Ec,La as Fc,dt as Gc,Cc as Hc,Pc as Ic,bc as Jc,Qc as Kc,Vp as Lc,jp as Mc,Wr as Nc,sf as Oc,gf as Pc,Sf as Qc,hf as Rc};
