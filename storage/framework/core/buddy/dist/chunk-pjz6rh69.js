// @bun
import{ke as eJ,me as X,pe as I}from"./chunk-9ph3hk3r.js";var T=X(($y)=>{$y.fromCallback=function(q){return Object.defineProperty(function(...E){if(typeof E[E.length-1]==="function")q.apply(this,E);else return new Promise((y,n)=>{E.push((J,O)=>J!=null?n(J):y(O)),q.apply(this,E)})},"name",{value:q.name})};$y.fromPromise=function(q){return Object.defineProperty(function(...E){let y=E[E.length-1];if(typeof y!=="function")return q.apply(this,E);else E.pop(),q.apply(this,E).then((n)=>y(null,n),y)},"name",{value:q.name})}});var iq=X((_O,bq)=>{var o=I("constants"),Sy=process.cwd,Lq=null,gy=process.env.GRACEFUL_FS_PLATFORM||process.platform;process.cwd=function(){if(!Lq)Lq=Sy.call(process);return Lq};try{process.cwd()}catch(q){}if(typeof process.chdir==="function"){if(Pq=process.chdir,process.chdir=function(q){Lq=null,Pq.call(process,q)},Object.setPrototypeOf)Object.setPrototypeOf(process.chdir,Pq)}var Pq;bq.exports=by;function by(q){if(o.hasOwnProperty("O_SYMLINK")&&process.version.match(/^v0\.6\.[0-2]|^v0\.5\./))E(q);if(!q.lutimes)y(q);if(q.chown=O(q.chown),q.fchown=O(q.fchown),q.lchown=O(q.lchown),q.chmod=n(q.chmod),q.fchmod=n(q.fchmod),q.lchmod=n(q.lchmod),q.chownSync=V(q.chownSync),q.fchownSync=V(q.fchownSync),q.lchownSync=V(q.lchownSync),q.chmodSync=J(q.chmodSync),q.fchmodSync=J(q.fchmodSync),q.lchmodSync=J(q.lchmodSync),q.stat=U(q.stat),q.fstat=U(q.fstat),q.lstat=U(q.lstat),q.statSync=R(q.statSync),q.fstatSync=R(q.fstatSync),q.lstatSync=R(q.lstatSync),q.chmod&&!q.lchmod)q.lchmod=function(_,A,L){if(L)process.nextTick(L)},q.lchmodSync=function(){};if(q.chown&&!q.lchown)q.lchown=function(_,A,L,K){if(K)process.nextTick(K)},q.lchownSync=function(){};if(gy==="win32")q.rename=typeof q.rename!=="function"?q.rename:function(_){function A(L,K,P){var N=Date.now(),C=0;_(L,K,function j(h){if(h&&(h.code==="EACCES"||h.code==="EPERM"||h.code==="EBUSY")&&Date.now()-N<60000){if(setTimeout(function(){q.stat(K,function(m,nq){if(m&&m.code==="ENOENT")_(L,K,j);else P(h)})},C),C<100)C+=10;return}if(P)P(h)})}if(Object.setPrototypeOf)Object.setPrototypeOf(A,_);return A}(q.rename);q.read=typeof q.read!=="function"?q.read:function(_){function A(L,K,P,N,C,j){var h;if(j&&typeof j==="function"){var m=0;h=function(nq,Sq,gq){if(nq&&nq.code==="EAGAIN"&&m<10)return m++,_.call(q,L,K,P,N,C,h);j.apply(this,arguments)}}return _.call(q,L,K,P,N,C,h)}if(Object.setPrototypeOf)Object.setPrototypeOf(A,_);return A}(q.read),q.readSync=typeof q.readSync!=="function"?q.readSync:function(_){return function(A,L,K,P,N){var C=0;while(!0)try{return _.call(q,A,L,K,P,N)}catch(j){if(j.code==="EAGAIN"&&C<10){C++;continue}throw j}}}(q.readSync);function E(_){_.lchmod=function(A,L,K){_.open(A,o.O_WRONLY|o.O_SYMLINK,L,function(P,N){if(P){if(K)K(P);return}_.fchmod(N,L,function(C){_.close(N,function(j){if(K)K(C||j)})})})},_.lchmodSync=function(A,L){var K=_.openSync(A,o.O_WRONLY|o.O_SYMLINK,L),P=!0,N;try{N=_.fchmodSync(K,L),P=!1}finally{if(P)try{_.closeSync(K)}catch(C){}else _.closeSync(K)}return N}}function y(_){if(o.hasOwnProperty("O_SYMLINK")&&_.futimes)_.lutimes=function(A,L,K,P){_.open(A,o.O_SYMLINK,function(N,C){if(N){if(P)P(N);return}_.futimes(C,L,K,function(j){_.close(C,function(h){if(P)P(j||h)})})})},_.lutimesSync=function(A,L,K){var P=_.openSync(A,o.O_SYMLINK),N,C=!0;try{N=_.futimesSync(P,L,K),C=!1}finally{if(C)try{_.closeSync(P)}catch(j){}else _.closeSync(P)}return N};else if(_.futimes)_.lutimes=function(A,L,K,P){if(P)process.nextTick(P)},_.lutimesSync=function(){}}function n(_){if(!_)return _;return function(A,L,K){return _.call(q,A,L,function(P){if($(P))P=null;if(K)K.apply(this,arguments)})}}function J(_){if(!_)return _;return function(A,L){try{return _.call(q,A,L)}catch(K){if(!$(K))throw K}}}function O(_){if(!_)return _;return function(A,L,K,P){return _.call(q,A,L,K,function(N){if($(N))N=null;if(P)P.apply(this,arguments)})}}function V(_){if(!_)return _;return function(A,L,K){try{return _.call(q,A,L,K)}catch(P){if(!$(P))throw P}}}function U(_){if(!_)return _;return function(A,L,K){if(typeof L==="function")K=L,L=null;function P(N,C){if(C){if(C.uid<0)C.uid+=4294967296;if(C.gid<0)C.gid+=4294967296}if(K)K.apply(this,arguments)}return L?_.call(q,A,L,P):_.call(q,A,P)}}function R(_){if(!_)return _;return function(A,L){var K=L?_.call(q,A,L):_.call(q,A);if(K){if(K.uid<0)K.uid+=4294967296;if(K.gid<0)K.gid+=4294967296}return K}}function $(_){if(!_)return!0;if(_.code==="ENOSYS")return!0;var A=!process.getuid||process.getuid()!==0;if(A){if(_.code==="EINVAL"||_.code==="EPERM")return!0}return!1}}});var pq=X((KO,lq)=>{var hq=I("stream").Stream;lq.exports=iy;function iy(q){return{ReadStream:E,WriteStream:y};function E(n,J){if(!(this instanceof E))return new E(n,J);hq.call(this);var O=this;this.path=n,this.fd=null,this.readable=!0,this.paused=!1,this.flags="r",this.mode=438,this.bufferSize=65536,J=J||{};var V=Object.keys(J);for(var U=0,R=V.length;U<R;U++){var $=V[U];this[$]=J[$]}if(this.encoding)this.setEncoding(this.encoding);if(this.start!==void 0){if(typeof this.start!=="number")throw TypeError("start must be a Number");if(this.end===void 0)this.end=1/0;else if(typeof this.end!=="number")throw TypeError("end must be a Number");if(this.start>this.end)throw new Error("start must be <= end");this.pos=this.start}if(this.fd!==null){process.nextTick(function(){O._read()});return}q.open(this.path,this.flags,this.mode,function(_,A){if(_){O.emit("error",_),O.readable=!1;return}O.fd=A,O.emit("open",A),O._read()})}function y(n,J){if(!(this instanceof y))return new y(n,J);hq.call(this),this.path=n,this.fd=null,this.writable=!0,this.flags="w",this.encoding="binary",this.mode=438,this.bytesWritten=0,J=J||{};var O=Object.keys(J);for(var V=0,U=O.length;V<U;V++){var R=O[V];this[R]=J[R]}if(this.start!==void 0){if(typeof this.start!=="number")throw TypeError("start must be a Number");if(this.start<0)throw new Error("start must be >= zero");this.pos=this.start}if(this.busy=!1,this._queue=[],this.fd===null)this._open=q.open,this._queue.push([this._open,this.path,this.flags,this.mode,void 0]),this.flush()}}});var oq=X((UO,cq)=>{cq.exports=ly;var hy=Object.getPrototypeOf||function(q){return q.__proto__};function ly(q){if(q===null||typeof q!=="object")return q;if(q instanceof Object)var E={__proto__:hy(q)};else var E=Object.create(null);return Object.getOwnPropertyNames(q).forEach(function(y){Object.defineProperty(E,y,Object.getOwnPropertyDescriptor(q,y))}),E}});var s=X((zO,Dq)=>{var B=I("fs"),py=iq(),cy=pq(),oy=oq(),Aq=I("util"),F,Xq;if(typeof Symbol==="function"&&typeof Symbol.for==="function")F=Symbol.for("graceful-fs.queue"),Xq=Symbol.for("graceful-fs.previous");else F="___graceful-fs.queue",Xq="___graceful-fs.previous";function dy(){}function fq(q,E){Object.defineProperty(q,F,{get:function(){return E}})}var a=dy;if(Aq.debuglog)a=Aq.debuglog("gfs4");else if(/\bgfs4\b/i.test(process.env.NODE_DEBUG||""))a=function(){var q=Aq.format.apply(Aq,arguments);q="GFS4: "+q.split(/\n/).join(`
GFS4: `),console.error(q)};if(!B[F]){if(jq=global[F]||[],fq(B,jq),B.close=function(q){function E(y,n){return q.call(B,y,function(J){if(!J)dq();if(typeof n==="function")n.apply(this,arguments)})}return Object.defineProperty(E,Xq,{value:q}),E}(B.close),B.closeSync=function(q){function E(y){q.apply(B,arguments),dq()}return Object.defineProperty(E,Xq,{value:q}),E}(B.closeSync),/\bgfs4\b/i.test(process.env.NODE_DEBUG||""))process.on("exit",function(){a(B[F]),I("assert").equal(B[F].length,0)})}var jq;if(!global[F])fq(global,B[F]);Dq.exports=wq(oy(B));if(process.env.TEST_GRACEFUL_FS_GLOBAL_PATCH&&!B.__patched)Dq.exports=wq(B),B.__patched=!0;function wq(q){py(q),q.gracefulify=wq,q.createReadStream=Sq,q.createWriteStream=gq;var E=q.readFile;q.readFile=y;function y(z,Z,Y){if(typeof Z==="function")Y=Z,Z=null;return W(z,Z,Y);function W(M,u,w,D){return E(M,u,function(H){if(H&&(H.code==="EMFILE"||H.code==="ENFILE"))t([W,[M,u,w],H,D||Date.now(),Date.now()]);else if(typeof w==="function")w.apply(this,arguments)})}}var n=q.writeFile;q.writeFile=J;function J(z,Z,Y,W){if(typeof Y==="function")W=Y,Y=null;return M(z,Z,Y,W);function M(u,w,D,H,k){return n(u,w,D,function(x){if(x&&(x.code==="EMFILE"||x.code==="ENFILE"))t([M,[u,w,D,H],x,k||Date.now(),Date.now()]);else if(typeof H==="function")H.apply(this,arguments)})}}var O=q.appendFile;if(O)q.appendFile=V;function V(z,Z,Y,W){if(typeof Y==="function")W=Y,Y=null;return M(z,Z,Y,W);function M(u,w,D,H,k){return O(u,w,D,function(x){if(x&&(x.code==="EMFILE"||x.code==="ENFILE"))t([M,[u,w,D,H],x,k||Date.now(),Date.now()]);else if(typeof H==="function")H.apply(this,arguments)})}}var U=q.copyFile;if(U)q.copyFile=R;function R(z,Z,Y,W){if(typeof Y==="function")W=Y,Y=0;return M(z,Z,Y,W);function M(u,w,D,H,k){return U(u,w,D,function(x){if(x&&(x.code==="EMFILE"||x.code==="ENFILE"))t([M,[u,w,D,H],x,k||Date.now(),Date.now()]);else if(typeof H==="function")H.apply(this,arguments)})}}var $=q.readdir;q.readdir=A;var _=/^v[0-5]\./;function A(z,Z,Y){if(typeof Z==="function")Y=Z,Z=null;var W=_.test(process.version)?function u(w,D,H,k){return $(w,M(w,D,H,k))}:function u(w,D,H,k){return $(w,D,M(w,D,H,k))};return W(z,Z,Y);function M(u,w,D,H){return function(k,x){if(k&&(k.code==="EMFILE"||k.code==="ENFILE"))t([W,[u,w,D],k,H||Date.now(),Date.now()]);else{if(x&&x.sort)x.sort();if(typeof D==="function")D.call(this,k,x)}}}}if(process.version.substr(0,4)==="v0.8"){var L=cy(q);j=L.ReadStream,m=L.WriteStream}var K=q.ReadStream;if(K)j.prototype=Object.create(K.prototype),j.prototype.open=h;var P=q.WriteStream;if(P)m.prototype=Object.create(P.prototype),m.prototype.open=nq;Object.defineProperty(q,"ReadStream",{get:function(){return j},set:function(z){j=z},enumerable:!0,configurable:!0}),Object.defineProperty(q,"WriteStream",{get:function(){return m},set:function(z){m=z},enumerable:!0,configurable:!0});var N=j;Object.defineProperty(q,"FileReadStream",{get:function(){return N},set:function(z){N=z},enumerable:!0,configurable:!0});var C=m;Object.defineProperty(q,"FileWriteStream",{get:function(){return C},set:function(z){C=z},enumerable:!0,configurable:!0});function j(z,Z){if(this instanceof j)return K.apply(this,arguments),this;else return j.apply(Object.create(j.prototype),arguments)}function h(){var z=this;Rq(z.path,z.flags,z.mode,function(Z,Y){if(Z){if(z.autoClose)z.destroy();z.emit("error",Z)}else z.fd=Y,z.emit("open",Y),z.read()})}function m(z,Z){if(this instanceof m)return P.apply(this,arguments),this;else return m.apply(Object.create(m.prototype),arguments)}function nq(){var z=this;Rq(z.path,z.flags,z.mode,function(Z,Y){if(Z)z.destroy(),z.emit("error",Z);else z.fd=Y,z.emit("open",Y)})}function Sq(z,Z){return new q.ReadStream(z,Z)}function gq(z,Z){return new q.WriteStream(z,Z)}var Fy=q.open;q.open=Rq;function Rq(z,Z,Y,W){if(typeof Y==="function")W=Y,Y=null;return M(z,Z,Y,W);function M(u,w,D,H,k){return Fy(u,w,D,function(x,OO){if(x&&(x.code==="EMFILE"||x.code==="ENFILE"))t([M,[u,w,D,H],x,k||Date.now(),Date.now()]);else if(typeof H==="function")H.apply(this,arguments)})}}return q}function t(q){a("ENQUEUE",q[0].name,q[1]),B[F].push(q),Bq()}var Gq;function dq(){var q=Date.now();for(var E=0;E<B[F].length;++E)if(B[F][E].length>2)B[F][E][3]=q,B[F][E][4]=q;Bq()}function Bq(){if(clearTimeout(Gq),Gq=void 0,B[F].length===0)return;var q=B[F].shift(),E=q[0],y=q[1],n=q[2],J=q[3],O=q[4];if(J===void 0)a("RETRY",E.name,y),E.apply(null,y);else if(Date.now()-J>=60000){a("TIMEOUT",E.name,y);var V=y.pop();if(typeof V==="function")V.call(null,n)}else{var U=Date.now()-O,R=Math.max(O-J,1),$=Math.min(R*1.2,100);if(U>=$)a("RETRY",E.name,y),E.apply(null,y.concat([J]));else B[F].push(q)}if(Gq===void 0)Gq=setTimeout(Bq,0)}});var g=X((uq)=>{var rq=T().fromCallback,S=s(),fy=["access","appendFile","chmod","chown","close","copyFile","cp","fchmod","fchown","fdatasync","fstat","fsync","ftruncate","futimes","glob","lchmod","lchown","lutimes","link","lstat","mkdir","mkdtemp","open","opendir","readdir","readFile","readlink","realpath","rename","rm","rmdir","stat","statfs","symlink","truncate","unlink","utimes","writeFile"].filter((q)=>{return typeof S[q]==="function"});Object.assign(uq,S);fy.forEach((q)=>{uq[q]=rq(S[q])});uq.exists=function(q,E){if(typeof E==="function")return S.exists(q,E);return new Promise((y)=>{return S.exists(q,y)})};uq.read=function(q,E,y,n,J,O){if(typeof O==="function")return S.read(q,E,y,n,J,O);return new Promise((V,U)=>{S.read(q,E,y,n,J,(R,$,_)=>{if(R)return U(R);V({bytesRead:$,buffer:_})})})};uq.write=function(q,E,...y){if(typeof y[y.length-1]==="function")return S.write(q,E,...y);return new Promise((n,J)=>{S.write(q,E,...y,(O,V,U)=>{if(O)return J(O);n({bytesWritten:V,buffer:U})})})};uq.readv=function(q,E,...y){if(typeof y[y.length-1]==="function")return S.readv(q,E,...y);return new Promise((n,J)=>{S.readv(q,E,...y,(O,V,U)=>{if(O)return J(O);n({bytesRead:V,buffers:U})})})};uq.writev=function(q,E,...y){if(typeof y[y.length-1]==="function")return S.writev(q,E,...y);return new Promise((n,J)=>{S.writev(q,E,...y,(O,V,U)=>{if(O)return J(O);n({bytesWritten:V,buffers:U})})})};if(typeof S.realpath.native==="function")uq.realpath.native=rq(S.realpath.native);else process.emitWarning("fs.realpath.native is not a function. Is fs being monkey-patched?","Warning","fs-extra-WARN0003")});var eq=X((En,aq)=>{var qn=I("path");En.checkPath=function q(E){if(process.platform==="win32"){if(/[<>:"|?*]/.test(E.replace(qn.parse(E).root,""))){let n=new Error(`Path contains invalid characters: ${E}`);throw n.code="EINVAL",n}}}});var EE=X((nn,Tq)=>{var tq=g(),{checkPath:sq}=eq(),qE=(q)=>{let E={mode:511};if(typeof q==="number")return q;return{...E,...q}.mode};nn.makeDir=async(q,E)=>{return sq(q),tq.mkdir(q,{mode:qE(E),recursive:!0})};nn.makeDirSync=(q,E)=>{return sq(q),tq.mkdirSync(q,{mode:qE(E),recursive:!0})}});var l=X((AO,yE)=>{var Vn=T().fromPromise,{makeDir:_n,makeDirSync:Iq}=EE(),Qq=Vn(_n);yE.exports={mkdirs:Qq,mkdirsSync:Iq,mkdirp:Qq,mkdirpSync:Iq,ensureDir:Qq,ensureDirSync:Iq}});var d=X((GO,JE)=>{var Kn=T().fromPromise,nE=g();function Un(q){return nE.access(q).then(()=>!0).catch(()=>!1)}JE.exports={pathExists:Kn(Un),pathExistsSync:nE.existsSync}});var Wq=X((XO,OE)=>{var qq=g(),zn=T().fromPromise;async function Ln(q,E,y){let n=await qq.open(q,"r+"),J=null;try{await qq.futimes(n,E,y)}finally{try{await qq.close(n)}catch(O){J=O}}if(J)throw J}function Pn(q,E,y){let n=qq.openSync(q,"r+");return qq.futimesSync(n,E,y),qq.closeSync(n)}OE.exports={utimesMillis:zn(Ln),utimesMillisSync:Pn}});var e=X((YO,UE)=>{var Eq=g(),Q=I("path"),VE=T().fromPromise;function An(q,E,y){let n=y.dereference?(J)=>Eq.stat(J,{bigint:!0}):(J)=>Eq.lstat(J,{bigint:!0});return Promise.all([n(q),n(E).catch((J)=>{if(J.code==="ENOENT")return null;throw J})]).then(([J,O])=>({srcStat:J,destStat:O}))}function Gn(q,E,y){let n,J=y.dereference?(V)=>Eq.statSync(V,{bigint:!0}):(V)=>Eq.lstatSync(V,{bigint:!0}),O=J(q);try{n=J(E)}catch(V){if(V.code==="ENOENT")return{srcStat:O,destStat:null};throw V}return{srcStat:O,destStat:n}}async function Xn(q,E,y,n){let{srcStat:J,destStat:O}=await An(q,E,n);if(O){if(Jq(J,O)){let V=Q.basename(q),U=Q.basename(E);if(y==="move"&&V!==U&&V.toLowerCase()===U.toLowerCase())return{srcStat:J,destStat:O,isChangingCase:!0};throw new Error("Source and destination must not be the same.")}if(J.isDirectory()&&!O.isDirectory())throw new Error(`Cannot overwrite non-directory '${E}' with directory '${q}'.`);if(!J.isDirectory()&&O.isDirectory())throw new Error(`Cannot overwrite directory '${E}' with non-directory '${q}'.`)}if(J.isDirectory()&&Mq(q,E))throw new Error(Yq(q,E,y));return{srcStat:J,destStat:O}}function Yn(q,E,y,n){let{srcStat:J,destStat:O}=Gn(q,E,n);if(O){if(Jq(J,O)){let V=Q.basename(q),U=Q.basename(E);if(y==="move"&&V!==U&&V.toLowerCase()===U.toLowerCase())return{srcStat:J,destStat:O,isChangingCase:!0};throw new Error("Source and destination must not be the same.")}if(J.isDirectory()&&!O.isDirectory())throw new Error(`Cannot overwrite non-directory '${E}' with directory '${q}'.`);if(!J.isDirectory()&&O.isDirectory())throw new Error(`Cannot overwrite directory '${E}' with non-directory '${q}'.`)}if(J.isDirectory()&&Mq(q,E))throw new Error(Yq(q,E,y));return{srcStat:J,destStat:O}}async function _E(q,E,y,n){let J=Q.resolve(Q.dirname(q)),O=Q.resolve(Q.dirname(y));if(O===J||O===Q.parse(O).root)return;let V;try{V=await Eq.stat(O,{bigint:!0})}catch(U){if(U.code==="ENOENT")return;throw U}if(Jq(E,V))throw new Error(Yq(q,y,n));return _E(q,E,O,n)}function KE(q,E,y,n){let J=Q.resolve(Q.dirname(q)),O=Q.resolve(Q.dirname(y));if(O===J||O===Q.parse(O).root)return;let V;try{V=Eq.statSync(O,{bigint:!0})}catch(U){if(U.code==="ENOENT")return;throw U}if(Jq(E,V))throw new Error(Yq(q,y,n));return KE(q,E,O,n)}function Jq(q,E){return E.ino&&E.dev&&E.ino===q.ino&&E.dev===q.dev}function Mq(q,E){let y=Q.resolve(q).split(Q.sep).filter((J)=>J),n=Q.resolve(E).split(Q.sep).filter((J)=>J);return y.every((J,O)=>n[O]===J)}function Yq(q,E,y){return`Cannot ${y} '${q}' to a subdirectory of itself, '${E}'.`}UE.exports={checkPaths:VE(Xn),checkPathsSync:Yn,checkParentPaths:VE(_E),checkParentPathsSync:KE,isSrcSubdir:Mq,areIdentical:Jq}});var GE=X((ZO,AE)=>{var v=g(),Oq=I("path"),{mkdirs:Zn}=l(),{pathExists:Cn}=d(),{utimesMillis:Hn}=Wq(),Vq=e();async function Nn(q,E,y={}){if(typeof y==="function")y={filter:y};if(y.clobber="clobber"in y?!!y.clobber:!0,y.overwrite="overwrite"in y?!!y.overwrite:y.clobber,y.preserveTimestamps&&process.arch==="ia32")process.emitWarning(`Using the preserveTimestamps option in 32-bit node is not recommended;

	see https://github.com/jprichardson/node-fs-extra/issues/269`,"Warning","fs-extra-WARN0001");let{srcStat:n,destStat:J}=await Vq.checkPaths(q,E,"copy",y);if(await Vq.checkParentPaths(q,n,E,"copy"),!await LE(q,E,y))return;let V=Oq.dirname(E);if(!await Cn(V))await Zn(V);await PE(J,q,E,y)}async function LE(q,E,y){if(!y.filter)return!0;return y.filter(q,E)}async function PE(q,E,y,n){let O=await(n.dereference?v.stat:v.lstat)(E);if(O.isDirectory())return wn(O,q,E,y,n);if(O.isFile()||O.isCharacterDevice()||O.isBlockDevice())return xn(O,q,E,y,n);if(O.isSymbolicLink())return Bn(q,E,y,n);if(O.isSocket())throw new Error(`Cannot copy a socket file: ${E}`);if(O.isFIFO())throw new Error(`Cannot copy a FIFO pipe: ${E}`);throw new Error(`Unknown file: ${E}`)}async function xn(q,E,y,n,J){if(!E)return zE(q,y,n,J);if(J.overwrite)return await v.unlink(n),zE(q,y,n,J);if(J.errorOnExist)throw new Error(`'${n}' already exists`)}async function zE(q,E,y,n){if(await v.copyFile(E,y),n.preserveTimestamps){if(Rn(q.mode))await jn(y,q.mode);let J=await v.stat(E);await Hn(y,J.atime,J.mtime)}return v.chmod(y,q.mode)}function Rn(q){return(q&128)===0}function jn(q,E){return v.chmod(q,E|128)}async function wn(q,E,y,n,J){if(!E)await v.mkdir(n);let O=[];for await(let V of await v.opendir(y)){let U=Oq.join(y,V.name),R=Oq.join(n,V.name);O.push(LE(U,R,J).then(($)=>{if($)return Vq.checkPaths(U,R,"copy",J).then(({destStat:_})=>{return PE(_,U,R,J)})}))}if(await Promise.all(O),!E)await v.chmod(n,q.mode)}async function Bn(q,E,y,n){let J=await v.readlink(E);if(n.dereference)J=Oq.resolve(process.cwd(),J);if(!q)return v.symlink(J,y);let O=null;try{O=await v.readlink(y)}catch(V){if(V.code==="EINVAL"||V.code==="UNKNOWN")return v.symlink(J,y);throw V}if(n.dereference)O=Oq.resolve(process.cwd(),O);if(Vq.isSrcSubdir(J,O))throw new Error(`Cannot copy '${J}' to a subdirectory of itself, '${O}'.`);if(Vq.isSrcSubdir(O,J))throw new Error(`Cannot overwrite '${O}' with '${J}'.`);return await v.unlink(y),v.symlink(J,y)}AE.exports=Nn});var HE=X((CO,CE)=>{var b=s(),_q=I("path"),Dn=l().mkdirsSync,un=Wq().utimesMillisSync,Kq=e();function Tn(q,E,y){if(typeof y==="function")y={filter:y};if(y=y||{},y.clobber="clobber"in y?!!y.clobber:!0,y.overwrite="overwrite"in y?!!y.overwrite:y.clobber,y.preserveTimestamps&&process.arch==="ia32")process.emitWarning(`Using the preserveTimestamps option in 32-bit node is not recommended;

	see https://github.com/jprichardson/node-fs-extra/issues/269`,"Warning","fs-extra-WARN0002");let{srcStat:n,destStat:J}=Kq.checkPathsSync(q,E,"copy",y);if(Kq.checkParentPathsSync(q,n,E,"copy"),y.filter&&!y.filter(q,E))return;let O=_q.dirname(E);if(!b.existsSync(O))Dn(O);return XE(J,q,E,y)}function XE(q,E,y,n){let O=(n.dereference?b.statSync:b.lstatSync)(E);if(O.isDirectory())return $n(O,q,E,y,n);else if(O.isFile()||O.isCharacterDevice()||O.isBlockDevice())return In(O,q,E,y,n);else if(O.isSymbolicLink())return Sn(q,E,y,n);else if(O.isSocket())throw new Error(`Cannot copy a socket file: ${E}`);else if(O.isFIFO())throw new Error(`Cannot copy a FIFO pipe: ${E}`);throw new Error(`Unknown file: ${E}`)}function In(q,E,y,n,J){if(!E)return YE(q,y,n,J);return Qn(q,y,n,J)}function Qn(q,E,y,n){if(n.overwrite)return b.unlinkSync(y),YE(q,E,y,n);else if(n.errorOnExist)throw new Error(`'${y}' already exists`)}function YE(q,E,y,n){if(b.copyFileSync(E,y),n.preserveTimestamps)Wn(q.mode,E,y);return kq(y,q.mode)}function Wn(q,E,y){if(Mn(q))kn(y,q);return Fn(E,y)}function Mn(q){return(q&128)===0}function kn(q,E){return kq(q,E|128)}function kq(q,E){return b.chmodSync(q,E)}function Fn(q,E){let y=b.statSync(q);return un(E,y.atime,y.mtime)}function $n(q,E,y,n,J){if(!E)return vn(q.mode,y,n,J);return ZE(y,n,J)}function vn(q,E,y,n){return b.mkdirSync(y),ZE(E,y,n),kq(y,q)}function ZE(q,E,y){let n=b.opendirSync(q);try{let J;while((J=n.readSync())!==null)mn(J.name,q,E,y)}finally{n.closeSync()}}function mn(q,E,y,n){let J=_q.join(E,q),O=_q.join(y,q);if(n.filter&&!n.filter(J,O))return;let{destStat:V}=Kq.checkPathsSync(J,O,"copy",n);return XE(V,J,O,n)}function Sn(q,E,y,n){let J=b.readlinkSync(E);if(n.dereference)J=_q.resolve(process.cwd(),J);if(!q)return b.symlinkSync(J,y);else{let O;try{O=b.readlinkSync(y)}catch(V){if(V.code==="EINVAL"||V.code==="UNKNOWN")return b.symlinkSync(J,y);throw V}if(n.dereference)O=_q.resolve(process.cwd(),O);if(Kq.isSrcSubdir(J,O))throw new Error(`Cannot copy '${J}' to a subdirectory of itself, '${O}'.`);if(Kq.isSrcSubdir(O,J))throw new Error(`Cannot overwrite '${O}' with '${J}'.`);return gn(J,y)}}function gn(q,E){return b.unlinkSync(E),b.symlinkSync(q,E)}CE.exports=Tn});var Zq=X((HO,NE)=>{var bn=T().fromPromise;NE.exports={copy:bn(GE()),copySync:HE()}});var Uq=X((NO,RE)=>{var xE=s(),hn=T().fromCallback;function ln(q,E){xE.rm(q,{recursive:!0,force:!0},E)}function pn(q){xE.rmSync(q,{recursive:!0,force:!0})}RE.exports={remove:hn(ln),removeSync:pn}});var QE=X((xO,IE)=>{var cn=T().fromPromise,BE=g(),DE=I("path"),uE=l(),TE=Uq(),jE=cn(async function q(E){let y;try{y=await BE.readdir(E)}catch{return uE.mkdirs(E)}return Promise.all(y.map((n)=>TE.remove(DE.join(E,n))))});function wE(q){let E;try{E=BE.readdirSync(q)}catch{return uE.mkdirsSync(q)}E.forEach((y)=>{y=DE.join(q,y),TE.removeSync(y)})}IE.exports={emptyDirSync:wE,emptydirSync:wE,emptyDir:jE,emptydir:jE}});var FE=X((RO,kE)=>{var on=T().fromPromise,WE=I("path"),c=g(),ME=l();async function dn(q){let E;try{E=await c.stat(q)}catch{}if(E&&E.isFile())return;let y=WE.dirname(q),n=null;try{n=await c.stat(y)}catch(J){if(J.code==="ENOENT"){await ME.mkdirs(y),await c.writeFile(q,"");return}else throw J}if(n.isDirectory())await c.writeFile(q,"");else await c.readdir(y)}function fn(q){let E;try{E=c.statSync(q)}catch{}if(E&&E.isFile())return;let y=WE.dirname(q);try{if(!c.statSync(y).isDirectory())c.readdirSync(y)}catch(n){if(n&&n.code==="ENOENT")ME.mkdirsSync(y);else throw n}c.writeFileSync(q,"")}kE.exports={createFile:on(dn),createFileSync:fn}});var gE=X((jO,SE)=>{var rn=T().fromPromise,$E=I("path"),f=g(),vE=l(),{pathExists:an}=d(),{areIdentical:mE}=e();async function en(q,E){let y;try{y=await f.lstat(E)}catch{}let n;try{n=await f.lstat(q)}catch(V){throw V.message=V.message.replace("lstat","ensureLink"),V}if(y&&mE(n,y))return;let J=$E.dirname(E);if(!await an(J))await vE.mkdirs(J);await f.link(q,E)}function tn(q,E){let y;try{y=f.lstatSync(E)}catch{}try{let O=f.lstatSync(q);if(y&&mE(O,y))return}catch(O){throw O.message=O.message.replace("lstat","ensureLink"),O}let n=$E.dirname(E);if(f.existsSync(n))return f.linkSync(q,E);return vE.mkdirsSync(n),f.linkSync(q,E)}SE.exports={createLink:rn(en),createLinkSync:tn}});var iE=X((wO,bE)=>{var r=I("path"),zq=g(),{pathExists:sn}=d(),qJ=T().fromPromise;async function EJ(q,E){if(r.isAbsolute(q)){try{await zq.lstat(q)}catch(O){throw O.message=O.message.replace("lstat","ensureSymlink"),O}return{toCwd:q,toDst:q}}let y=r.dirname(E),n=r.join(y,q);if(await sn(n))return{toCwd:n,toDst:q};try{await zq.lstat(q)}catch(O){throw O.message=O.message.replace("lstat","ensureSymlink"),O}return{toCwd:q,toDst:r.relative(y,q)}}function yJ(q,E){if(r.isAbsolute(q)){if(!zq.existsSync(q))throw new Error("absolute srcpath does not exist");return{toCwd:q,toDst:q}}let y=r.dirname(E),n=r.join(y,q);if(zq.existsSync(n))return{toCwd:n,toDst:q};if(!zq.existsSync(q))throw new Error("relative srcpath does not exist");return{toCwd:q,toDst:r.relative(y,q)}}bE.exports={symlinkPaths:qJ(EJ),symlinkPathsSync:yJ}});var pE=X((BO,lE)=>{var hE=g(),nJ=T().fromPromise;async function JJ(q,E){if(E)return E;let y;try{y=await hE.lstat(q)}catch{return"file"}return y&&y.isDirectory()?"dir":"file"}function OJ(q,E){if(E)return E;let y;try{y=hE.lstatSync(q)}catch{return"file"}return y&&y.isDirectory()?"dir":"file"}lE.exports={symlinkType:nJ(JJ),symlinkTypeSync:OJ}});var fE=X((DO,dE)=>{var VJ=T().fromPromise,cE=I("path"),p=g(),{mkdirs:_J,mkdirsSync:KJ}=l(),{symlinkPaths:UJ,symlinkPathsSync:zJ}=iE(),{symlinkType:LJ,symlinkTypeSync:PJ}=pE(),{pathExists:AJ}=d(),{areIdentical:oE}=e();async function GJ(q,E,y){let n;try{n=await p.lstat(E)}catch{}if(n&&n.isSymbolicLink()){let[U,R]=await Promise.all([p.stat(q),p.stat(E)]);if(oE(U,R))return}let J=await UJ(q,E);q=J.toDst;let O=await LJ(J.toCwd,y),V=cE.dirname(E);if(!await AJ(V))await _J(V);return p.symlink(q,E,O)}function XJ(q,E,y){let n;try{n=p.lstatSync(E)}catch{}if(n&&n.isSymbolicLink()){let U=p.statSync(q),R=p.statSync(E);if(oE(U,R))return}let J=zJ(q,E);q=J.toDst,y=PJ(J.toCwd,y);let O=cE.dirname(E);if(p.existsSync(O))return p.symlinkSync(q,E,y);return KJ(O),p.symlinkSync(q,E,y)}dE.exports={createSymlink:VJ(GJ),createSymlinkSync:XJ}});var yy=X((uO,Ey)=>{var{createFile:rE,createFileSync:aE}=FE(),{createLink:eE,createLinkSync:tE}=gE(),{createSymlink:sE,createSymlinkSync:qy}=fE();Ey.exports={createFile:rE,createFileSync:aE,ensureFile:rE,ensureFileSync:aE,createLink:eE,createLinkSync:tE,ensureLink:eE,ensureLinkSync:tE,createSymlink:sE,createSymlinkSync:qy,ensureSymlink:sE,ensureSymlinkSync:qy}});var Cq=X((TO,ny)=>{function YJ(q,{EOL:E=`
`,finalEOL:y=!0,replacer:n=null,spaces:J}={}){let O=y?E:"";return JSON.stringify(q,n,J).replace(/\n/g,E)+O}function ZJ(q){if(Buffer.isBuffer(q))q=q.toString("utf8");return q.replace(/^\uFEFF/,"")}ny.exports={stringify:YJ,stripBom:ZJ}});var _y=X((IO,Vy)=>{var yq;try{yq=s()}catch(q){yq=I("fs")}var Hq=T(),{stringify:Jy,stripBom:Oy}=Cq();async function CJ(q,E={}){if(typeof E==="string")E={encoding:E};let y=E.fs||yq,n="throws"in E?E.throws:!0,J=await Hq.fromCallback(y.readFile)(q,E);J=Oy(J);let O;try{O=JSON.parse(J,E?E.reviver:null)}catch(V){if(n)throw V.message=`${q}: ${V.message}`,V;else return null}return O}var HJ=Hq.fromPromise(CJ);function NJ(q,E={}){if(typeof E==="string")E={encoding:E};let y=E.fs||yq,n="throws"in E?E.throws:!0;try{let J=y.readFileSync(q,E);return J=Oy(J),JSON.parse(J,E.reviver)}catch(J){if(n)throw J.message=`${q}: ${J.message}`,J;else return null}}async function xJ(q,E,y={}){let n=y.fs||yq,J=Jy(E,y);await Hq.fromCallback(n.writeFile)(q,J,y)}var RJ=Hq.fromPromise(xJ);function jJ(q,E,y={}){let n=y.fs||yq,J=Jy(E,y);return n.writeFileSync(q,J,y)}var wJ={readFile:HJ,readFileSync:NJ,writeFile:RJ,writeFileSync:jJ};Vy.exports=wJ});var Uy=X((QO,Ky)=>{var Nq=_y();Ky.exports={readJson:Nq.readFile,readJsonSync:Nq.readFileSync,writeJson:Nq.writeFile,writeJsonSync:Nq.writeFileSync}});var xq=X((WO,Py)=>{var BJ=T().fromPromise,Fq=g(),zy=I("path"),Ly=l(),DJ=d().pathExists;async function uJ(q,E,y="utf-8"){let n=zy.dirname(q);if(!await DJ(n))await Ly.mkdirs(n);return Fq.writeFile(q,E,y)}function TJ(q,...E){let y=zy.dirname(q);if(!Fq.existsSync(y))Ly.mkdirsSync(y);Fq.writeFileSync(q,...E)}Py.exports={outputFile:BJ(uJ),outputFileSync:TJ}});var Gy=X((MO,Ay)=>{var{stringify:IJ}=Cq(),{outputFile:QJ}=xq();async function WJ(q,E,y={}){let n=IJ(E,y);await QJ(q,n,y)}Ay.exports=WJ});var Yy=X((kO,Xy)=>{var{stringify:MJ}=Cq(),{outputFileSync:kJ}=xq();function FJ(q,E,y){let n=MJ(E,y);kJ(q,n,y)}Xy.exports=FJ});var Cy=X((FO,Zy)=>{var $J=T().fromPromise,i=Uy();i.outputJson=$J(Gy());i.outputJsonSync=Yy();i.outputJSON=i.outputJson;i.outputJSONSync=i.outputJsonSync;i.writeJSON=i.writeJson;i.writeJSONSync=i.writeJsonSync;i.readJSON=i.readJson;i.readJSONSync=i.readJsonSync;Zy.exports=i});var jy=X(($O,Ry)=>{var vJ=g(),Hy=I("path"),{copy:mJ}=Zq(),{remove:xy}=Uq(),{mkdirp:SJ}=l(),{pathExists:gJ}=d(),Ny=e();async function bJ(q,E,y={}){let n=y.overwrite||y.clobber||!1,{srcStat:J,isChangingCase:O=!1}=await Ny.checkPaths(q,E,"move",y);await Ny.checkParentPaths(q,J,E,"move");let V=Hy.dirname(E);if(Hy.parse(V).root!==V)await SJ(V);return iJ(q,E,n,O)}async function iJ(q,E,y,n){if(!n){if(y)await xy(E);else if(await gJ(E))throw new Error("dest already exists.")}try{await vJ.rename(q,E)}catch(J){if(J.code!=="EXDEV")throw J;await hJ(q,E,y)}}async function hJ(q,E,y){return await mJ(q,E,{overwrite:y,errorOnExist:!0,preserveTimestamps:!0}),xy(q)}Ry.exports=bJ});var Ty=X((vO,uy)=>{var By=s(),vq=I("path"),lJ=Zq().copySync,Dy=Uq().removeSync,pJ=l().mkdirpSync,wy=e();function cJ(q,E,y){y=y||{};let n=y.overwrite||y.clobber||!1,{srcStat:J,isChangingCase:O=!1}=wy.checkPathsSync(q,E,"move",y);if(wy.checkParentPathsSync(q,J,E,"move"),!oJ(E))pJ(vq.dirname(E));return dJ(q,E,n,O)}function oJ(q){let E=vq.dirname(q);return vq.parse(E).root===E}function dJ(q,E,y,n){if(n)return $q(q,E,y);if(y)return Dy(E),$q(q,E,y);if(By.existsSync(E))throw new Error("dest already exists.");return $q(q,E,y)}function $q(q,E,y){try{By.renameSync(q,E)}catch(n){if(n.code!=="EXDEV")throw n;return fJ(q,E,y)}}function fJ(q,E,y){return lJ(q,E,{overwrite:y,errorOnExist:!0,preserveTimestamps:!0}),Dy(q)}uy.exports=cJ});var Qy=X((mO,Iy)=>{var rJ=T().fromPromise;Iy.exports={move:rJ(jy()),moveSync:Ty()}});var My=X((SO,Wy)=>{Wy.exports={...g(),...Zq(),...QE(),...yy(),...Cy(),...l(),...Qy(),...xq(),...d(),...Uq()}});var mq=eJ(My(),1);import tJ from"process";import{projectPath as sJ}from"@stacksjs/path";import{ValidationBoolean as qO,ValidationEnum as EO,ValidationNumber as yO}from"@stacksjs/validation";import{schema as G}from"@stacksjs/validation";var ky={APP_NAME:{validation:G.string(),default:"Stacks"},APP_ENV:{validation:G.enum(["local","dev","stage","prod"]),default:"local"},APP_KEY:{validation:G.string(),default:"base64:1234567890"},PORT:{validation:G.number(),default:3000},PORT_BACKEND:{validation:G.number(),default:3000},PORT_ADMIN:{validation:G.number(),default:3000},PORT_LIBRARY:{validation:G.number(),default:3000},PORT_DESKTOP:{validation:G.number(),default:3000},PORT_EMAIL:{validation:G.number(),default:3000},PORT_DOCS:{validation:G.number(),default:3000},PORT_INSPECT:{validation:G.number(),default:3000},PORT_API:{validation:G.number(),default:3000},PORT_SYSTEM_TRAY:{validation:G.number(),default:3000},APP_MAINTENANCE:{validation:G.boolean(),default:!1},DEBUG:{validation:G.boolean(),default:!1},API_PREFIX:{validation:G.string(),default:"/api"},DOCS_PREFIX:{validation:G.string(),default:"/docs"},DB_CONNECTION:{validation:G.enum(["mysql","sqlite","postgres"]),default:"mysql"},DB_HOST:{validation:G.string(),default:"localhost"},DB_PORT:{validation:G.number(),default:3306},AWS_ACCOUNT_ID:{validation:G.string(),default:""},AWS_ACCESS_KEY_ID:{validation:G.string(),default:""},AWS_SECRET_ACCESS_KEY:{validation:G.string(),default:""},AWS_DEFAULT_REGION:{validation:G.string(),default:""},AWS_DEFAULT_PASSWORD:{validation:G.string(),default:""},MAIL_MAILER:{validation:G.enum(["ses","sendmail","log","smtp"]),default:"ses"},MAIL_HOST:{validation:G.string(),default:""},MAIL_PORT:{validation:G.number(),default:465},MAIL_USERNAME:{validation:G.string(),default:""},MAIL_PASSWORD:{validation:G.string(),default:""},MAIL_FROM_ADDRESS:{validation:G.string(),default:""},SEARCH_ENGINE_DRIVER:{validation:G.enum(["meilisearch","algolia","typesense"]),default:"meilisearch"},STRIPE_SECRET_KEY:{validation:G.string(),default:""},STRIPE_PUBLISHABLE_KEY:{validation:G.string(),default:""},MEILISEARCH_HOST:{validation:G.string(),default:""},MEILISEARCH_KEY:{validation:G.string(),default:""},FRONTEND_APP_ENV:{validation:G.enum(["development","staging","production"]),default:"development"},FRONTEND_APP_URL:{validation:G.string(),default:""}};var aJ={APP_ENV:["local","dev","development","staging","prod","production"],DB_CONNECTION:["mysql","sqlite","postgres","dynamodb"],MAIL_MAILER:["smtp","mailgun","ses","postmark","sendmail","log"],SEARCH_ENGINE_DRIVER:["opensearch"],FRONTEND_APP_ENV:["development","staging","production"]},hO=Object.entries(ky).reduce((q,[E,y])=>{if(typeof y==="object"&&y!==null&&"validation"in y)return q[E]=y.validation.name,q;let n;switch(typeof y){case"string":n="string";break;case"number":n="number";break;case"boolean":n="boolean";break;default:if(Array.isArray(y)){n="enum";break}if(typeof y==="object"&&y!==null){let J=y.name;if(J==="string"||J==="number"||J==="boolean"){n=J;break}if(!J&&E in aJ){n="enum";break}console.error("Unknown env value type",typeof y)}throw new Error(`Invalid env value for ${E}`)}return q[E]=n,q},{});var nO={get:(q,E)=>{let y=q[E];if(typeof y==="string"&&/^\d+$/.test(y)&&E!=="AWS_ACCOUNT_ID")return Number(y);if(typeof y==="string"&&/^true|false$/.test(y))return y==="true";if(y instanceof EO)return q[E];if(y instanceof qO)return!!q[E];if(y instanceof yO)return Number(q[E]);return y}};function JO(){return typeof Bun!=="undefined"?Bun.env:tJ.env}var dO=new Proxy(JO(),nO);function fO(q,E,y){let n=y?.path||sJ(".env"),O=mq.default.readFileSync(n,"utf-8").split(`
`),V=O.findIndex((U)=>U.startsWith(`${q}=`));if(V!==-1)O[V]=`${q}=${E}`;else O.push(`${q}=${E}`);mq.default.writeFileSync(n,O.join(`
`))}export{fO as writeEnv,JO as process,aJ as envEnum,dO as env};
