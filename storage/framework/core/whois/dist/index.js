// @bun
var wz=Object.create;var{getPrototypeOf:qz,defineProperty:F1,getOwnPropertyNames:$z}=Object;var Jz=Object.prototype.hasOwnProperty;var zq=(w,q,$)=>{$=w!=null?wz(qz(w)):{};let J=q||!w||!w.__esModule?F1($,"default",{value:w,enumerable:!0}):$;for(let z of $z(w))if(!Jz.call(J,z))F1(J,z,{get:()=>w[z],enumerable:!0});return J};var D=(w,q)=>()=>(q||w((q={exports:{}}).exports,q),q.exports);var T=import.meta.require;var P=D((_z)=>{_z.fromCallback=function(w){return Object.defineProperty(function(...q){if(typeof q[q.length-1]==="function")w.apply(this,q);else return new Promise(($,J)=>{q.push((z,Y)=>z!=null?J(z):$(Y)),w.apply(this,q)})},"name",{value:w.name})};_z.fromPromise=function(w){return Object.defineProperty(function(...q){let $=q[q.length-1];if(typeof $!=="function")return w.apply(this,q);else q.pop(),w.apply(this,q).then((J)=>$(null,J),$)},"name",{value:w.name})}});var r1=D((QO,p1)=>{var Cw=T("constants"),iz=process.cwd,Xq=null,Pz=process.env.GRACEFUL_FS_PLATFORM||process.platform;process.cwd=function(){if(!Xq)Xq=iz.call(process);return Xq};try{process.cwd()}catch(w){}if(typeof process.chdir==="function"){if(Gq=process.chdir,process.chdir=function(w){Xq=null,Gq.call(process,w)},Object.setPrototypeOf)Object.setPrototypeOf(process.chdir,Gq)}var Gq;p1.exports=vz;function vz(w){if(Cw.hasOwnProperty("O_SYMLINK")&&process.version.match(/^v0\.6\.[0-2]|^v0\.5\./))q(w);if(!w.lutimes)$(w);if(w.chown=Y(w.chown),w.fchown=Y(w.fchown),w.lchown=Y(w.lchown),w.chmod=J(w.chmod),w.fchmod=J(w.fchmod),w.lchmod=J(w.lchmod),w.chownSync=M(w.chownSync),w.fchownSync=M(w.fchownSync),w.lchownSync=M(w.lchownSync),w.chmodSync=z(w.chmodSync),w.fchmodSync=z(w.fchmodSync),w.lchmodSync=z(w.lchmodSync),w.stat=K(w.stat),w.fstat=K(w.fstat),w.lstat=K(w.lstat),w.statSync=U(w.statSync),w.fstatSync=U(w.fstatSync),w.lstatSync=U(w.lstatSync),w.chmod&&!w.lchmod)w.lchmod=function(Z,Q,y){if(y)process.nextTick(y)},w.lchmodSync=function(){};if(w.chown&&!w.lchown)w.lchown=function(Z,Q,y,X){if(X)process.nextTick(X)},w.lchownSync=function(){};if(Pz==="win32")w.rename=typeof w.rename!=="function"?w.rename:function(Z){function Q(y,X,W){var x=Date.now(),B=0;Z(y,X,function F(qw){if(qw&&(qw.code==="EACCES"||qw.code==="EPERM"||qw.code==="EBUSY")&&Date.now()-x<60000){if(setTimeout(function(){w.stat(X,function(a,dw){if(a&&a.code==="ENOENT")Z(y,X,F);else W(qw)})},B),B<100)B+=10;return}if(W)W(qw)})}if(Object.setPrototypeOf)Object.setPrototypeOf(Q,Z);return Q}(w.rename);w.read=typeof w.read!=="function"?w.read:function(Z){function Q(y,X,W,x,B,F){var qw;if(F&&typeof F==="function"){var a=0;qw=function(dw,E1,j1){if(dw&&dw.code==="EAGAIN"&&a<10)return a++,Z.call(w,y,X,W,x,B,qw);F.apply(this,arguments)}}return Z.call(w,y,X,W,x,B,qw)}if(Object.setPrototypeOf)Object.setPrototypeOf(Q,Z);return Q}(w.read),w.readSync=typeof w.readSync!=="function"?w.readSync:function(Z){return function(Q,y,X,W,x){var B=0;while(!0)try{return Z.call(w,Q,y,X,W,x)}catch(F){if(F.code==="EAGAIN"&&B<10){B++;continue}throw F}}}(w.readSync);function q(Z){Z.lchmod=function(Q,y,X){Z.open(Q,Cw.O_WRONLY|Cw.O_SYMLINK,y,function(W,x){if(W){if(X)X(W);return}Z.fchmod(x,y,function(B){Z.close(x,function(F){if(X)X(B||F)})})})},Z.lchmodSync=function(Q,y){var X=Z.openSync(Q,Cw.O_WRONLY|Cw.O_SYMLINK,y),W=!0,x;try{x=Z.fchmodSync(X,y),W=!1}finally{if(W)try{Z.closeSync(X)}catch(B){}else Z.closeSync(X)}return x}}function $(Z){if(Cw.hasOwnProperty("O_SYMLINK")&&Z.futimes)Z.lutimes=function(Q,y,X,W){Z.open(Q,Cw.O_SYMLINK,function(x,B){if(x){if(W)W(x);return}Z.futimes(B,y,X,function(F){Z.close(B,function(qw){if(W)W(F||qw)})})})},Z.lutimesSync=function(Q,y,X){var W=Z.openSync(Q,Cw.O_SYMLINK),x,B=!0;try{x=Z.futimesSync(W,y,X),B=!1}finally{if(B)try{Z.closeSync(W)}catch(F){}else Z.closeSync(W)}return x};else if(Z.futimes)Z.lutimes=function(Q,y,X,W){if(W)process.nextTick(W)},Z.lutimesSync=function(){}}function J(Z){if(!Z)return Z;return function(Q,y,X){return Z.call(w,Q,y,function(W){if(G(W))W=null;if(X)X.apply(this,arguments)})}}function z(Z){if(!Z)return Z;return function(Q,y){try{return Z.call(w,Q,y)}catch(X){if(!G(X))throw X}}}function Y(Z){if(!Z)return Z;return function(Q,y,X,W){return Z.call(w,Q,y,X,function(x){if(G(x))x=null;if(W)W.apply(this,arguments)})}}function M(Z){if(!Z)return Z;return function(Q,y,X){try{return Z.call(w,Q,y,X)}catch(W){if(!G(W))throw W}}}function K(Z){if(!Z)return Z;return function(Q,y,X){if(typeof y==="function")X=y,y=null;function W(x,B){if(B){if(B.uid<0)B.uid+=4294967296;if(B.gid<0)B.gid+=4294967296}if(X)X.apply(this,arguments)}return y?Z.call(w,Q,y,W):Z.call(w,Q,W)}}function U(Z){if(!Z)return Z;return function(Q,y){var X=y?Z.call(w,Q,y):Z.call(w,Q);if(X){if(X.uid<0)X.uid+=4294967296;if(X.gid<0)X.gid+=4294967296}return X}}function G(Z){if(!Z)return!0;if(Z.code==="ENOSYS")return!0;var Q=!process.getuid||process.getuid()!==0;if(Q){if(Z.code==="EINVAL"||Z.code==="EPERM")return!0}return!1}}});var e1=D((yO,o1)=>{var a1=T("stream").Stream;o1.exports=kz;function kz(w){return{ReadStream:q,WriteStream:$};function q(J,z){if(!(this instanceof q))return new q(J,z);a1.call(this);var Y=this;this.path=J,this.fd=null,this.readable=!0,this.paused=!1,this.flags="r",this.mode=438,this.bufferSize=65536,z=z||{};var M=Object.keys(z);for(var K=0,U=M.length;K<U;K++){var G=M[K];this[G]=z[G]}if(this.encoding)this.setEncoding(this.encoding);if(this.start!==void 0){if(typeof this.start!=="number")throw TypeError("start must be a Number");if(this.end===void 0)this.end=1/0;else if(typeof this.end!=="number")throw TypeError("end must be a Number");if(this.start>this.end)throw new Error("start must be <= end");this.pos=this.start}if(this.fd!==null){process.nextTick(function(){Y._read()});return}w.open(this.path,this.flags,this.mode,function(Z,Q){if(Z){Y.emit("error",Z),Y.readable=!1;return}Y.fd=Q,Y.emit("open",Q),Y._read()})}function $(J,z){if(!(this instanceof $))return new $(J,z);a1.call(this),this.path=J,this.fd=null,this.writable=!0,this.flags="w",this.encoding="binary",this.mode=438,this.bytesWritten=0,z=z||{};var Y=Object.keys(z);for(var M=0,K=Y.length;M<K;M++){var U=Y[M];this[U]=z[U]}if(this.start!==void 0){if(typeof this.start!=="number")throw TypeError("start must be a Number");if(this.start<0)throw new Error("start must be >= zero");this.pos=this.start}if(this.busy=!1,this._queue=[],this.fd===null)this._open=w.open,this._queue.push([this._open,this.path,this.flags,this.mode,void 0]),this.flush()}}});var s1=D((WO,t1)=>{t1.exports=Sz;var uz=Object.getPrototypeOf||function(w){return w.__proto__};function Sz(w){if(w===null||typeof w!=="object")return w;if(w instanceof Object)var q={__proto__:uz(w)};else var q=Object.create(null);return Object.getOwnPropertyNames(w).forEach(function($){Object.defineProperty(q,$,Object.getOwnPropertyDescriptor(w,$))}),q}});var kw=D((DO,rq)=>{var m=T("fs"),hz=r1(),nz=e1(),cz=s1(),Qq=T("util"),l,Wq;if(typeof Symbol==="function"&&typeof Symbol.for==="function")l=Symbol.for("graceful-fs.queue"),Wq=Symbol.for("graceful-fs.previous");else l="___graceful-fs.queue",Wq="___graceful-fs.previous";function lz(){}function q$(w,q){Object.defineProperty(w,l,{get:function(){return q}})}var Tw=lz;if(Qq.debuglog)Tw=Qq.debuglog("gfs4");else if(/\bgfs4\b/i.test(process.env.NODE_DEBUG||""))Tw=function(){var w=Qq.format.apply(Qq,arguments);w="GFS4: "+w.split(/\n/).join(`
GFS4: `),console.error(w)};if(!m[l]){if(dq=global[l]||[],q$(m,dq),m.close=function(w){function q($,J){return w.call(m,$,function(z){if(!z)w$();if(typeof J==="function")J.apply(this,arguments)})}return Object.defineProperty(q,Wq,{value:w}),q}(m.close),m.closeSync=function(w){function q($){w.apply(m,arguments),w$()}return Object.defineProperty(q,Wq,{value:w}),q}(m.closeSync),/\bgfs4\b/i.test(process.env.NODE_DEBUG||""))process.on("exit",function(){Tw(m[l]),T("assert").equal(m[l].length,0)})}var dq;if(!global[l])q$(global,m[l]);rq.exports=fq(cz(m));if(process.env.TEST_GRACEFUL_FS_GLOBAL_PATCH&&!m.__patched)rq.exports=fq(m),m.__patched=!0;function fq(w){hz(w),w.gracefulify=fq,w.createReadStream=E1,w.createWriteStream=j1;var q=w.readFile;w.readFile=$;function $(H,C,N){if(typeof C==="function")N=C,C=null;return S(H,C,N);function S(h,i,A,_){return q(h,i,function(E){if(E&&(E.code==="EMFILE"||E.code==="ENFILE"))vw([S,[h,i,A],E,_||Date.now(),Date.now()]);else if(typeof A==="function")A.apply(this,arguments)})}}var J=w.writeFile;w.writeFile=z;function z(H,C,N,S){if(typeof N==="function")S=N,N=null;return h(H,C,N,S);function h(i,A,_,E,n){return J(i,A,_,function(R){if(R&&(R.code==="EMFILE"||R.code==="ENFILE"))vw([h,[i,A,_,E],R,n||Date.now(),Date.now()]);else if(typeof E==="function")E.apply(this,arguments)})}}var Y=w.appendFile;if(Y)w.appendFile=M;function M(H,C,N,S){if(typeof N==="function")S=N,N=null;return h(H,C,N,S);function h(i,A,_,E,n){return Y(i,A,_,function(R){if(R&&(R.code==="EMFILE"||R.code==="ENFILE"))vw([h,[i,A,_,E],R,n||Date.now(),Date.now()]);else if(typeof E==="function")E.apply(this,arguments)})}}var K=w.copyFile;if(K)w.copyFile=U;function U(H,C,N,S){if(typeof N==="function")S=N,N=0;return h(H,C,N,S);function h(i,A,_,E,n){return K(i,A,_,function(R){if(R&&(R.code==="EMFILE"||R.code==="ENFILE"))vw([h,[i,A,_,E],R,n||Date.now(),Date.now()]);else if(typeof E==="function")E.apply(this,arguments)})}}var G=w.readdir;w.readdir=Q;var Z=/^v[0-5]\./;function Q(H,C,N){if(typeof C==="function")N=C,C=null;var S=Z.test(process.version)?function i(A,_,E,n){return G(A,h(A,_,E,n))}:function i(A,_,E,n){return G(A,_,h(A,_,E,n))};return S(H,C,N);function h(i,A,_,E){return function(n,R){if(n&&(n.code==="EMFILE"||n.code==="ENFILE"))vw([S,[i,A,_],n,E||Date.now(),Date.now()]);else{if(R&&R.sort)R.sort();if(typeof _==="function")_.call(this,n,R)}}}}if(process.version.substr(0,4)==="v0.8"){var y=nz(w);F=y.ReadStream,a=y.WriteStream}var X=w.ReadStream;if(X)F.prototype=Object.create(X.prototype),F.prototype.open=qw;var W=w.WriteStream;if(W)a.prototype=Object.create(W.prototype),a.prototype.open=dw;Object.defineProperty(w,"ReadStream",{get:function(){return F},set:function(H){F=H},enumerable:!0,configurable:!0}),Object.defineProperty(w,"WriteStream",{get:function(){return a},set:function(H){a=H},enumerable:!0,configurable:!0});var x=F;Object.defineProperty(w,"FileReadStream",{get:function(){return x},set:function(H){x=H},enumerable:!0,configurable:!0});var B=a;Object.defineProperty(w,"FileWriteStream",{get:function(){return B},set:function(H){B=H},enumerable:!0,configurable:!0});function F(H,C){if(this instanceof F)return X.apply(this,arguments),this;else return F.apply(Object.create(F.prototype),arguments)}function qw(){var H=this;_q(H.path,H.flags,H.mode,function(C,N){if(C){if(H.autoClose)H.destroy();H.emit("error",C)}else H.fd=N,H.emit("open",N),H.read()})}function a(H,C){if(this instanceof a)return W.apply(this,arguments),this;else return a.apply(Object.create(a.prototype),arguments)}function dw(){var H=this;_q(H.path,H.flags,H.mode,function(C,N){if(C)H.destroy(),H.emit("error",C);else H.fd=N,H.emit("open",N)})}function E1(H,C){return new w.ReadStream(H,C)}function j1(H,C){return new w.WriteStream(H,C)}var sJ=w.open;w.open=_q;function _q(H,C,N,S){if(typeof N==="function")S=N,N=null;return h(H,C,N,S);function h(i,A,_,E,n){return sJ(i,A,_,function(R,qZ){if(R&&(R.code==="EMFILE"||R.code==="ENFILE"))vw([h,[i,A,_,E],R,n||Date.now(),Date.now()]);else if(typeof E==="function")E.apply(this,arguments)})}}return w}function vw(w){Tw("ENQUEUE",w[0].name,w[1]),m[l].push(w),pq()}var yq;function w$(){var w=Date.now();for(var q=0;q<m[l].length;++q)if(m[l][q].length>2)m[l][q][3]=w,m[l][q][4]=w;pq()}function pq(){if(clearTimeout(yq),yq=void 0,m[l].length===0)return;var w=m[l].shift(),q=w[0],$=w[1],J=w[2],z=w[3],Y=w[4];if(z===void 0)Tw("RETRY",q.name,$),q.apply(null,$);else if(Date.now()-z>=60000){Tw("TIMEOUT",q.name,$);var M=$.pop();if(typeof M==="function")M.call(null,J)}else{var K=Date.now()-Y,U=Math.max(Y-z,1),G=Math.min(U*1.2,100);if(K>=G)Tw("RETRY",q.name,$),q.apply(null,$.concat([z]));else m[l].push(w)}if(yq===void 0)yq=setTimeout(pq,0)}});var e=D((aq)=>{var $$=P().fromCallback,o=kw(),dz=["access","appendFile","chmod","chown","close","copyFile","cp","fchmod","fchown","fdatasync","fstat","fsync","ftruncate","futimes","glob","lchmod","lchown","lutimes","link","lstat","mkdir","mkdtemp","open","opendir","readdir","readFile","readlink","realpath","rename","rm","rmdir","stat","statfs","symlink","truncate","unlink","utimes","writeFile"].filter((w)=>{return typeof o[w]==="function"});Object.assign(aq,o);dz.forEach((w)=>{aq[w]=$$(o[w])});aq.exists=function(w,q){if(typeof q==="function")return o.exists(w,q);return new Promise(($)=>{return o.exists(w,$)})};aq.read=function(w,q,$,J,z,Y){if(typeof Y==="function")return o.read(w,q,$,J,z,Y);return new Promise((M,K)=>{o.read(w,q,$,J,z,(U,G,Z)=>{if(U)return K(U);M({bytesRead:G,buffer:Z})})})};aq.write=function(w,q,...$){if(typeof $[$.length-1]==="function")return o.write(w,q,...$);return new Promise((J,z)=>{o.write(w,q,...$,(Y,M,K)=>{if(Y)return z(Y);J({bytesWritten:M,buffer:K})})})};aq.readv=function(w,q,...$){if(typeof $[$.length-1]==="function")return o.readv(w,q,...$);return new Promise((J,z)=>{o.readv(w,q,...$,(Y,M,K)=>{if(Y)return z(Y);J({bytesRead:M,buffers:K})})})};aq.writev=function(w,q,...$){if(typeof $[$.length-1]==="function")return o.writev(w,q,...$);return new Promise((J,z)=>{o.writev(w,q,...$,(Y,M,K)=>{if(Y)return z(Y);J({bytesWritten:M,buffers:K})})})};if(typeof o.realpath.native==="function")aq.realpath.native=$$(o.realpath.native);else process.emitWarning("fs.realpath.native is not a function. Is fs being monkey-patched?","Warning","fs-extra-WARN0003")});var z$=D((tz,J$)=>{var ez=T("path");tz.checkPath=function w(q){if(process.platform==="win32"){if(/[<>:"|?*]/.test(q.replace(ez.parse(q).root,""))){let J=new Error(`Path contains invalid characters: ${q}`);throw J.code="EINVAL",J}}}});var K$=D((w9,oq)=>{var Y$=e(),{checkPath:M$}=z$(),Z$=(w)=>{let q={mode:511};if(typeof w==="number")return w;return{...q,...w}.mode};w9.makeDir=async(w,q)=>{return M$(w),Y$.mkdir(w,{mode:Z$(q),recursive:!0})};w9.makeDirSync=(w,q)=>{return M$(w),Y$.mkdirSync(w,{mode:Z$(q),recursive:!0})}});var Kw=D((NO,U$)=>{var J9=P().fromPromise,{makeDir:z9,makeDirSync:eq}=K$(),tq=J9(z9);U$.exports={mkdirs:tq,mkdirsSync:eq,mkdirp:tq,mkdirpSync:eq,ensureDir:tq,ensureDirSync:eq}});var Ew=D((xO,X$)=>{var Y9=P().fromPromise,O$=e();function M9(w){return O$.access(w).then(()=>!0).catch(()=>!1)}X$.exports={pathExists:Y9(M9),pathExistsSync:O$.existsSync}});var sq=D((BO,G$)=>{var uw=e(),Z9=P().fromPromise;async function K9(w,q,$){let J=await uw.open(w,"r+"),z=null;try{await uw.futimes(J,q,$)}finally{try{await uw.close(J)}catch(Y){z=Y}}if(z)throw z}function U9(w,q,$){let J=uw.openSync(w,"r+");return uw.futimesSync(J,q,$),uw.closeSync(J)}G$.exports={utimesMillis:Z9(K9),utimesMillisSync:U9}});var Lw=D((CO,D$)=>{var Sw=e(),v=T("path"),Q$=P().fromPromise;function O9(w,q,$){let J=$.dereference?(z)=>Sw.stat(z,{bigint:!0}):(z)=>Sw.lstat(z,{bigint:!0});return Promise.all([J(w),J(q).catch((z)=>{if(z.code==="ENOENT")return null;throw z})]).then(([z,Y])=>({srcStat:z,destStat:Y}))}function X9(w,q,$){let J,z=$.dereference?(M)=>Sw.statSync(M,{bigint:!0}):(M)=>Sw.lstatSync(M,{bigint:!0}),Y=z(w);try{J=z(q)}catch(M){if(M.code==="ENOENT")return{srcStat:Y,destStat:null};throw M}return{srcStat:Y,destStat:J}}async function G9(w,q,$,J){let{srcStat:z,destStat:Y}=await O9(w,q,J);if(Y){if(aw(z,Y)){let M=v.basename(w),K=v.basename(q);if($==="move"&&M!==K&&M.toLowerCase()===K.toLowerCase())return{srcStat:z,destStat:Y,isChangingCase:!0};throw new Error("Source and destination must not be the same.")}if(z.isDirectory()&&!Y.isDirectory())throw new Error(`Cannot overwrite non-directory '${q}' with directory '${w}'.`);if(!z.isDirectory()&&Y.isDirectory())throw new Error(`Cannot overwrite directory '${q}' with non-directory '${w}'.`)}if(z.isDirectory()&&w1(w,q))throw new Error(Dq(w,q,$));return{srcStat:z,destStat:Y}}function Q9(w,q,$,J){let{srcStat:z,destStat:Y}=X9(w,q,J);if(Y){if(aw(z,Y)){let M=v.basename(w),K=v.basename(q);if($==="move"&&M!==K&&M.toLowerCase()===K.toLowerCase())return{srcStat:z,destStat:Y,isChangingCase:!0};throw new Error("Source and destination must not be the same.")}if(z.isDirectory()&&!Y.isDirectory())throw new Error(`Cannot overwrite non-directory '${q}' with directory '${w}'.`);if(!z.isDirectory()&&Y.isDirectory())throw new Error(`Cannot overwrite directory '${q}' with non-directory '${w}'.`)}if(z.isDirectory()&&w1(w,q))throw new Error(Dq(w,q,$));return{srcStat:z,destStat:Y}}async function y$(w,q,$,J){let z=v.resolve(v.dirname(w)),Y=v.resolve(v.dirname($));if(Y===z||Y===v.parse(Y).root)return;let M;try{M=await Sw.stat(Y,{bigint:!0})}catch(K){if(K.code==="ENOENT")return;throw K}if(aw(q,M))throw new Error(Dq(w,$,J));return y$(w,q,Y,J)}function W$(w,q,$,J){let z=v.resolve(v.dirname(w)),Y=v.resolve(v.dirname($));if(Y===z||Y===v.parse(Y).root)return;let M;try{M=Sw.statSync(Y,{bigint:!0})}catch(K){if(K.code==="ENOENT")return;throw K}if(aw(q,M))throw new Error(Dq(w,$,J));return W$(w,q,Y,J)}function aw(w,q){return q.ino!==void 0&&q.dev!==void 0&&q.ino===w.ino&&q.dev===w.dev}function w1(w,q){let $=v.resolve(w).split(v.sep).filter((z)=>z),J=v.resolve(q).split(v.sep).filter((z)=>z);return $.every((z,Y)=>J[Y]===z)}function Dq(w,q,$){return`Cannot ${$} '${w}' to a subdirectory of itself, '${q}'.`}D$.exports={checkPaths:Q$(G9),checkPathsSync:Q9,checkParentPaths:Q$(y$),checkParentPathsSync:W$,isSrcSubdir:w1,areIdentical:aw}});var B$=D((EO,x$)=>{var p=e(),ow=T("path"),{mkdirs:y9}=Kw(),{pathExists:W9}=Ew(),{utimesMillis:D9}=sq(),ew=Lw();async function H9(w,q,$={}){if(typeof $==="function")$={filter:$};if($.clobber="clobber"in $?!!$.clobber:!0,$.overwrite="overwrite"in $?!!$.overwrite:$.clobber,$.preserveTimestamps&&process.arch==="ia32")process.emitWarning(`Using the preserveTimestamps option in 32-bit node is not recommended;

	see https://github.com/jprichardson/node-fs-extra/issues/269`,"Warning","fs-extra-WARN0001");let{srcStat:J,destStat:z}=await ew.checkPaths(w,q,"copy",$);if(await ew.checkParentPaths(w,J,q,"copy"),!await V$(w,q,$))return;let M=ow.dirname(q);if(!await W9(M))await y9(M);await N$(z,w,q,$)}async function V$(w,q,$){if(!$.filter)return!0;return $.filter(w,q)}async function N$(w,q,$,J){let Y=await(J.dereference?p.stat:p.lstat)(q);if(Y.isDirectory())return B9(Y,w,q,$,J);if(Y.isFile()||Y.isCharacterDevice()||Y.isBlockDevice())return V9(Y,w,q,$,J);if(Y.isSymbolicLink())return C9(w,q,$,J);if(Y.isSocket())throw new Error(`Cannot copy a socket file: ${q}`);if(Y.isFIFO())throw new Error(`Cannot copy a FIFO pipe: ${q}`);throw new Error(`Unknown file: ${q}`)}async function V9(w,q,$,J,z){if(!q)return H$(w,$,J,z);if(z.overwrite)return await p.unlink(J),H$(w,$,J,z);if(z.errorOnExist)throw new Error(`'${J}' already exists`)}async function H$(w,q,$,J){if(await p.copyFile(q,$),J.preserveTimestamps){if(N9(w.mode))await x9($,w.mode);let z=await p.stat(q);await D9($,z.atime,z.mtime)}return p.chmod($,w.mode)}function N9(w){return(w&128)===0}function x9(w,q){return p.chmod(w,q|128)}async function B9(w,q,$,J,z){if(!q)await p.mkdir(J);let Y=[];for await(let M of await p.opendir($)){let K=ow.join($,M.name),U=ow.join(J,M.name);Y.push(V$(K,U,z).then((G)=>{if(G)return ew.checkPaths(K,U,"copy",z).then(({destStat:Z})=>{return N$(Z,K,U,z)})}))}if(await Promise.all(Y),!q)await p.chmod(J,w.mode)}async function C9(w,q,$,J){let z=await p.readlink(q);if(J.dereference)z=ow.resolve(process.cwd(),z);if(!w)return p.symlink(z,$);let Y=null;try{Y=await p.readlink($)}catch(M){if(M.code==="EINVAL"||M.code==="UNKNOWN")return p.symlink(z,$);throw M}if(J.dereference)Y=ow.resolve(process.cwd(),Y);if(ew.isSrcSubdir(z,Y))throw new Error(`Cannot copy '${z}' to a subdirectory of itself, '${Y}'.`);if(ew.isSrcSubdir(Y,z))throw new Error(`Cannot overwrite '${Y}' with '${z}'.`);return await p.unlink($),p.symlink(z,$)}x$.exports=H9});var R$=D((jO,F$)=>{var t=kw(),tw=T("path"),E9=Kw().mkdirsSync,j9=sq().utimesMillisSync,sw=Lw();function F9(w,q,$){if(typeof $==="function")$={filter:$};if($=$||{},$.clobber="clobber"in $?!!$.clobber:!0,$.overwrite="overwrite"in $?!!$.overwrite:$.clobber,$.preserveTimestamps&&process.arch==="ia32")process.emitWarning(`Using the preserveTimestamps option in 32-bit node is not recommended;

	see https://github.com/jprichardson/node-fs-extra/issues/269`,"Warning","fs-extra-WARN0002");let{srcStat:J,destStat:z}=sw.checkPathsSync(w,q,"copy",$);if(sw.checkParentPathsSync(w,J,q,"copy"),$.filter&&!$.filter(w,q))return;let Y=tw.dirname(q);if(!t.existsSync(Y))E9(Y);return C$(z,w,q,$)}function C$(w,q,$,J){let Y=(J.dereference?t.statSync:t.lstatSync)(q);if(Y.isDirectory())return _9(Y,w,q,$,J);else if(Y.isFile()||Y.isCharacterDevice()||Y.isBlockDevice())return R9(Y,w,q,$,J);else if(Y.isSymbolicLink())return i9(w,q,$,J);else if(Y.isSocket())throw new Error(`Cannot copy a socket file: ${q}`);else if(Y.isFIFO())throw new Error(`Cannot copy a FIFO pipe: ${q}`);throw new Error(`Unknown file: ${q}`)}function R9(w,q,$,J,z){if(!q)return E$(w,$,J,z);return T9(w,$,J,z)}function T9(w,q,$,J){if(J.overwrite)return t.unlinkSync($),E$(w,q,$,J);else if(J.errorOnExist)throw new Error(`'${$}' already exists`)}function E$(w,q,$,J){if(t.copyFileSync(q,$),J.preserveTimestamps)L9(w.mode,q,$);return q1($,w.mode)}function L9(w,q,$){if(I9(w))A9($,w);return m9(q,$)}function I9(w){return(w&128)===0}function A9(w,q){return q1(w,q|128)}function q1(w,q){return t.chmodSync(w,q)}function m9(w,q){let $=t.statSync(w);return j9(q,$.atime,$.mtime)}function _9(w,q,$,J,z){if(!q)return g9(w.mode,$,J,z);return j$($,J,z)}function g9(w,q,$,J){return t.mkdirSync($),j$(q,$,J),q1($,w)}function j$(w,q,$){let J=t.opendirSync(w);try{let z;while((z=J.readSync())!==null)b9(z.name,w,q,$)}finally{J.closeSync()}}function b9(w,q,$,J){let z=tw.join(q,w),Y=tw.join($,w);if(J.filter&&!J.filter(z,Y))return;let{destStat:M}=sw.checkPathsSync(z,Y,"copy",J);return C$(M,z,Y,J)}function i9(w,q,$,J){let z=t.readlinkSync(q);if(J.dereference)z=tw.resolve(process.cwd(),z);if(!w)return t.symlinkSync(z,$);else{let Y;try{Y=t.readlinkSync($)}catch(M){if(M.code==="EINVAL"||M.code==="UNKNOWN")return t.symlinkSync(z,$);throw M}if(J.dereference)Y=tw.resolve(process.cwd(),Y);if(sw.isSrcSubdir(z,Y))throw new Error(`Cannot copy '${z}' to a subdirectory of itself, '${Y}'.`);if(sw.isSrcSubdir(Y,z))throw new Error(`Cannot overwrite '${Y}' with '${z}'.`);return P9(z,$)}}function P9(w,q){return t.unlinkSync(q),t.symlinkSync(w,q)}F$.exports=F9});var Hq=D((FO,T$)=>{var v9=P().fromPromise;T$.exports={copy:v9(B$()),copySync:R$()}});var wq=D((RO,I$)=>{var L$=kw(),k9=P().fromCallback;function u9(w,q){L$.rm(w,{recursive:!0,force:!0},q)}function S9(w){L$.rmSync(w,{recursive:!0,force:!0})}I$.exports={remove:k9(u9),removeSync:S9}});var v$=D((TO,P$)=>{var h9=P().fromPromise,_$=e(),g$=T("path"),b$=Kw(),i$=wq(),A$=h9(async function w(q){let $;try{$=await _$.readdir(q)}catch{return b$.mkdirs(q)}return Promise.all($.map((J)=>i$.remove(g$.join(q,J))))});function m$(w){let q;try{q=_$.readdirSync(w)}catch{return b$.mkdirsSync(w)}q.forEach(($)=>{$=g$.join(w,$),i$.removeSync($)})}P$.exports={emptyDirSync:m$,emptydirSync:m$,emptyDir:A$,emptydir:A$}});var h$=D((LO,S$)=>{var n9=P().fromPromise,k$=T("path"),Vw=e(),u$=Kw();async function c9(w){let q;try{q=await Vw.stat(w)}catch{}if(q&&q.isFile())return;let $=k$.dirname(w),J=null;try{J=await Vw.stat($)}catch(z){if(z.code==="ENOENT"){await u$.mkdirs($),await Vw.writeFile(w,"");return}else throw z}if(J.isDirectory())await Vw.writeFile(w,"");else await Vw.readdir($)}function l9(w){let q;try{q=Vw.statSync(w)}catch{}if(q&&q.isFile())return;let $=k$.dirname(w);try{if(!Vw.statSync($).isDirectory())Vw.readdirSync($)}catch(J){if(J&&J.code==="ENOENT")u$.mkdirsSync($);else throw J}Vw.writeFileSync(w,"")}S$.exports={createFile:n9(c9),createFileSync:l9}});var f$=D((IO,d$)=>{var d9=P().fromPromise,n$=T("path"),jw=e(),c$=Kw(),{pathExists:f9}=Ew(),{areIdentical:l$}=Lw();async function p9(w,q){let $;try{$=await jw.lstat(q)}catch{}let J;try{J=await jw.lstat(w)}catch(M){throw M.message=M.message.replace("lstat","ensureLink"),M}if($&&l$(J,$))return;let z=n$.dirname(q);if(!await f9(z))await c$.mkdirs(z);await jw.link(w,q)}function r9(w,q){let $;try{$=jw.lstatSync(q)}catch{}try{let Y=jw.lstatSync(w);if($&&l$(Y,$))return}catch(Y){throw Y.message=Y.message.replace("lstat","ensureLink"),Y}let J=n$.dirname(q);if(jw.existsSync(J))return jw.linkSync(w,q);return c$.mkdirsSync(J),jw.linkSync(w,q)}d$.exports={createLink:d9(p9),createLinkSync:r9}});var r$=D((AO,p$)=>{var Fw=T("path"),qq=e(),{pathExists:a9}=Ew(),o9=P().fromPromise;async function e9(w,q){if(Fw.isAbsolute(w)){try{await qq.lstat(w)}catch(Y){throw Y.message=Y.message.replace("lstat","ensureSymlink"),Y}return{toCwd:w,toDst:w}}let $=Fw.dirname(q),J=Fw.join($,w);if(await a9(J))return{toCwd:J,toDst:w};try{await qq.lstat(w)}catch(Y){throw Y.message=Y.message.replace("lstat","ensureSymlink"),Y}return{toCwd:w,toDst:Fw.relative($,w)}}function t9(w,q){if(Fw.isAbsolute(w)){if(!qq.existsSync(w))throw new Error("absolute srcpath does not exist");return{toCwd:w,toDst:w}}let $=Fw.dirname(q),J=Fw.join($,w);if(qq.existsSync(J))return{toCwd:J,toDst:w};if(!qq.existsSync(w))throw new Error("relative srcpath does not exist");return{toCwd:w,toDst:Fw.relative($,w)}}p$.exports={symlinkPaths:o9(e9),symlinkPathsSync:t9}});var e$=D((mO,o$)=>{var a$=e(),s9=P().fromPromise;async function wY(w,q){if(q)return q;let $;try{$=await a$.lstat(w)}catch{return"file"}return $&&$.isDirectory()?"dir":"file"}function qY(w,q){if(q)return q;let $;try{$=a$.lstatSync(w)}catch{return"file"}return $&&$.isDirectory()?"dir":"file"}o$.exports={symlinkType:s9(wY),symlinkTypeSync:qY}});var q0=D((_O,w0)=>{var $Y=P().fromPromise,t$=T("path"),Xw=e(),{mkdirs:JY,mkdirsSync:zY}=Kw(),{symlinkPaths:YY,symlinkPathsSync:MY}=r$(),{symlinkType:ZY,symlinkTypeSync:KY}=e$(),{pathExists:UY}=Ew(),{areIdentical:s$}=Lw();async function OY(w,q,$){let J;try{J=await Xw.lstat(q)}catch{}if(J&&J.isSymbolicLink()){let[K,U]=await Promise.all([Xw.stat(w),Xw.stat(q)]);if(s$(K,U))return}let z=await YY(w,q);w=z.toDst;let Y=await ZY(z.toCwd,$),M=t$.dirname(q);if(!await UY(M))await JY(M);return Xw.symlink(w,q,Y)}function XY(w,q,$){let J;try{J=Xw.lstatSync(q)}catch{}if(J&&J.isSymbolicLink()){let K=Xw.statSync(w),U=Xw.statSync(q);if(s$(K,U))return}let z=MY(w,q);w=z.toDst,$=KY(z.toCwd,$);let Y=t$.dirname(q);if(Xw.existsSync(Y))return Xw.symlinkSync(w,q,$);return zY(Y),Xw.symlinkSync(w,q,$)}w0.exports={createSymlink:$Y(OY),createSymlinkSync:XY}});var U0=D((gO,K0)=>{var{createFile:$0,createFileSync:J0}=h$(),{createLink:z0,createLinkSync:Y0}=f$(),{createSymlink:M0,createSymlinkSync:Z0}=q0();K0.exports={createFile:$0,createFileSync:J0,ensureFile:$0,ensureFileSync:J0,createLink:z0,createLinkSync:Y0,ensureLink:z0,ensureLinkSync:Y0,createSymlink:M0,createSymlinkSync:Z0,ensureSymlink:M0,ensureSymlinkSync:Z0}});var Vq=D((bO,O0)=>{function GY(w,{EOL:q=`
`,finalEOL:$=!0,replacer:J=null,spaces:z}={}){let Y=$?q:"";return JSON.stringify(w,J,z).replace(/\n/g,q)+Y}function QY(w){if(Buffer.isBuffer(w))w=w.toString("utf8");return w.replace(/^\uFEFF/,"")}O0.exports={stringify:GY,stripBom:QY}});var y0=D((iO,Q0)=>{var hw;try{hw=kw()}catch(w){hw=T("fs")}var Nq=P(),{stringify:X0,stripBom:G0}=Vq();async function yY(w,q={}){if(typeof q==="string")q={encoding:q};let $=q.fs||hw,J="throws"in q?q.throws:!0,z=await Nq.fromCallback($.readFile)(w,q);z=G0(z);let Y;try{Y=JSON.parse(z,q?q.reviver:null)}catch(M){if(J)throw M.message=`${w}: ${M.message}`,M;else return null}return Y}var WY=Nq.fromPromise(yY);function DY(w,q={}){if(typeof q==="string")q={encoding:q};let $=q.fs||hw,J="throws"in q?q.throws:!0;try{let z=$.readFileSync(w,q);return z=G0(z),JSON.parse(z,q.reviver)}catch(z){if(J)throw z.message=`${w}: ${z.message}`,z;else return null}}async function HY(w,q,$={}){let J=$.fs||hw,z=X0(q,$);await Nq.fromCallback(J.writeFile)(w,z,$)}var VY=Nq.fromPromise(HY);function NY(w,q,$={}){let J=$.fs||hw,z=X0(q,$);return J.writeFileSync(w,z,$)}var xY={readFile:WY,readFileSync:DY,writeFile:VY,writeFileSync:NY};Q0.exports=xY});var D0=D((PO,W0)=>{var xq=y0();W0.exports={readJson:xq.readFile,readJsonSync:xq.readFileSync,writeJson:xq.writeFile,writeJsonSync:xq.writeFileSync}});var Bq=D((vO,N0)=>{var BY=P().fromPromise,$1=e(),H0=T("path"),V0=Kw(),CY=Ew().pathExists;async function EY(w,q,$="utf-8"){let J=H0.dirname(w);if(!await CY(J))await V0.mkdirs(J);return $1.writeFile(w,q,$)}function jY(w,...q){let $=H0.dirname(w);if(!$1.existsSync($))V0.mkdirsSync($);$1.writeFileSync(w,...q)}N0.exports={outputFile:BY(EY),outputFileSync:jY}});var B0=D((kO,x0)=>{var{stringify:FY}=Vq(),{outputFile:RY}=Bq();async function TY(w,q,$={}){let J=FY(q,$);await RY(w,J,$)}x0.exports=TY});var E0=D((uO,C0)=>{var{stringify:LY}=Vq(),{outputFileSync:IY}=Bq();function AY(w,q,$){let J=LY(q,$);IY(w,J,$)}C0.exports=AY});var F0=D((SO,j0)=>{var mY=P().fromPromise,s=D0();s.outputJson=mY(B0());s.outputJsonSync=E0();s.outputJSON=s.outputJson;s.outputJSONSync=s.outputJsonSync;s.writeJSON=s.writeJson;s.writeJSONSync=s.writeJsonSync;s.readJSON=s.readJson;s.readJSONSync=s.readJsonSync;j0.exports=s});var A0=D((hO,I0)=>{var _Y=e(),R0=T("path"),{copy:gY}=Hq(),{remove:L0}=wq(),{mkdirp:bY}=Kw(),{pathExists:iY}=Ew(),T0=Lw();async function PY(w,q,$={}){let J=$.overwrite||$.clobber||!1,{srcStat:z,isChangingCase:Y=!1}=await T0.checkPaths(w,q,"move",$);await T0.checkParentPaths(w,z,q,"move");let M=R0.dirname(q);if(R0.parse(M).root!==M)await bY(M);return vY(w,q,J,Y)}async function vY(w,q,$,J){if(!J){if($)await L0(q);else if(await iY(q))throw new Error("dest already exists.")}try{await _Y.rename(w,q)}catch(z){if(z.code!=="EXDEV")throw z;await kY(w,q,$)}}async function kY(w,q,$){return await gY(w,q,{overwrite:$,errorOnExist:!0,preserveTimestamps:!0}),L0(w)}I0.exports=PY});var i0=D((nO,b0)=>{var _0=kw(),z1=T("path"),uY=Hq().copySync,g0=wq().removeSync,SY=Kw().mkdirpSync,m0=Lw();function hY(w,q,$){$=$||{};let J=$.overwrite||$.clobber||!1,{srcStat:z,isChangingCase:Y=!1}=m0.checkPathsSync(w,q,"move",$);if(m0.checkParentPathsSync(w,z,q,"move"),!nY(q))SY(z1.dirname(q));return cY(w,q,J,Y)}function nY(w){let q=z1.dirname(w);return z1.parse(q).root===q}function cY(w,q,$,J){if(J)return J1(w,q,$);if($)return g0(q),J1(w,q,$);if(_0.existsSync(q))throw new Error("dest already exists.");return J1(w,q,$)}function J1(w,q,$){try{_0.renameSync(w,q)}catch(J){if(J.code!=="EXDEV")throw J;return lY(w,q,$)}}function lY(w,q,$){return uY(w,q,{overwrite:$,errorOnExist:!0,preserveTimestamps:!0}),g0(w)}b0.exports=hY});var v0=D((cO,P0)=>{var dY=P().fromPromise;P0.exports={move:dY(A0()),moveSync:i0()}});var u0=D((lO,k0)=>{k0.exports={...e(),...Hq(),...v$(),...U0(),...F0(),...Kw(),...v0(),...Bq(),...Ew(),...wq()}});var qJ=D((wJ)=>{Object.defineProperty(wJ,"__esModule",{value:!0});var e0=T("buffer"),Aw={INVALID_ENCODING:"Invalid encoding provided. Please specify a valid encoding the internal Node.js Buffer supports.",INVALID_SMARTBUFFER_SIZE:"Invalid size provided. Size must be a valid integer greater than zero.",INVALID_SMARTBUFFER_BUFFER:"Invalid Buffer provided in SmartBufferOptions.",INVALID_SMARTBUFFER_OBJECT:"Invalid SmartBufferOptions object supplied to SmartBuffer constructor or factory methods.",INVALID_OFFSET:"An invalid offset value was provided.",INVALID_OFFSET_NON_NUMBER:"An invalid offset value was provided. A numeric value is required.",INVALID_LENGTH:"An invalid length value was provided.",INVALID_LENGTH_NON_NUMBER:"An invalid length value was provived. A numeric value is required.",INVALID_TARGET_OFFSET:"Target offset is beyond the bounds of the internal SmartBuffer data.",INVALID_TARGET_LENGTH:"Specified length value moves cursor beyong the bounds of the internal SmartBuffer data.",INVALID_READ_BEYOND_BOUNDS:"Attempted to read beyond the bounds of the managed data.",INVALID_WRITE_BEYOND_BOUNDS:"Attempted to write beyond the bounds of the managed data."};wJ.ERRORS=Aw;function MM(w){if(!e0.Buffer.isEncoding(w))throw new Error(Aw.INVALID_ENCODING)}wJ.checkEncoding=MM;function t0(w){return typeof w==="number"&&isFinite(w)&&OM(w)}wJ.isFiniteInteger=t0;function s0(w,q){if(typeof w==="number"){if(!t0(w)||w<0)throw new Error(q?Aw.INVALID_OFFSET:Aw.INVALID_LENGTH)}else throw new Error(q?Aw.INVALID_OFFSET_NON_NUMBER:Aw.INVALID_LENGTH_NON_NUMBER)}function ZM(w){s0(w,!1)}wJ.checkLengthValue=ZM;function KM(w){s0(w,!0)}wJ.checkOffsetValue=KM;function UM(w,q){if(w<0||w>q.length)throw new Error(Aw.INVALID_TARGET_OFFSET)}wJ.checkTargetOffset=UM;function OM(w){return typeof w==="number"&&isFinite(w)&&Math.floor(w)===w}function XM(w){if(typeof BigInt==="undefined")throw new Error("Platform does not support JS BigInt type.");if(typeof e0.Buffer.prototype[w]==="undefined")throw new Error(`Platform does not support Buffer.prototype.${w}.`)}wJ.bigIntAndBufferInt64Check=XM});var zJ=D((JJ)=>{Object.defineProperty(JJ,"__esModule",{value:!0});var V=qJ(),$J=4096,NM="utf8";class M1{constructor(w){if(this.length=0,this._encoding=NM,this._writeOffset=0,this._readOffset=0,M1.isSmartBufferOptions(w)){if(w.encoding)V.checkEncoding(w.encoding),this._encoding=w.encoding;if(w.size)if(V.isFiniteInteger(w.size)&&w.size>0)this._buff=Buffer.allocUnsafe(w.size);else throw new Error(V.ERRORS.INVALID_SMARTBUFFER_SIZE);else if(w.buff)if(Buffer.isBuffer(w.buff))this._buff=w.buff,this.length=w.buff.length;else throw new Error(V.ERRORS.INVALID_SMARTBUFFER_BUFFER);else this._buff=Buffer.allocUnsafe($J)}else{if(typeof w!=="undefined")throw new Error(V.ERRORS.INVALID_SMARTBUFFER_OBJECT);this._buff=Buffer.allocUnsafe($J)}}static fromSize(w,q){return new this({size:w,encoding:q})}static fromBuffer(w,q){return new this({buff:w,encoding:q})}static fromOptions(w){return new this(w)}static isSmartBufferOptions(w){let q=w;return q&&(q.encoding!==void 0||q.size!==void 0||q.buff!==void 0)}readInt8(w){return this._readNumberValue(Buffer.prototype.readInt8,1,w)}readInt16BE(w){return this._readNumberValue(Buffer.prototype.readInt16BE,2,w)}readInt16LE(w){return this._readNumberValue(Buffer.prototype.readInt16LE,2,w)}readInt32BE(w){return this._readNumberValue(Buffer.prototype.readInt32BE,4,w)}readInt32LE(w){return this._readNumberValue(Buffer.prototype.readInt32LE,4,w)}readBigInt64BE(w){return V.bigIntAndBufferInt64Check("readBigInt64BE"),this._readNumberValue(Buffer.prototype.readBigInt64BE,8,w)}readBigInt64LE(w){return V.bigIntAndBufferInt64Check("readBigInt64LE"),this._readNumberValue(Buffer.prototype.readBigInt64LE,8,w)}writeInt8(w,q){return this._writeNumberValue(Buffer.prototype.writeInt8,1,w,q),this}insertInt8(w,q){return this._insertNumberValue(Buffer.prototype.writeInt8,1,w,q)}writeInt16BE(w,q){return this._writeNumberValue(Buffer.prototype.writeInt16BE,2,w,q)}insertInt16BE(w,q){return this._insertNumberValue(Buffer.prototype.writeInt16BE,2,w,q)}writeInt16LE(w,q){return this._writeNumberValue(Buffer.prototype.writeInt16LE,2,w,q)}insertInt16LE(w,q){return this._insertNumberValue(Buffer.prototype.writeInt16LE,2,w,q)}writeInt32BE(w,q){return this._writeNumberValue(Buffer.prototype.writeInt32BE,4,w,q)}insertInt32BE(w,q){return this._insertNumberValue(Buffer.prototype.writeInt32BE,4,w,q)}writeInt32LE(w,q){return this._writeNumberValue(Buffer.prototype.writeInt32LE,4,w,q)}insertInt32LE(w,q){return this._insertNumberValue(Buffer.prototype.writeInt32LE,4,w,q)}writeBigInt64BE(w,q){return V.bigIntAndBufferInt64Check("writeBigInt64BE"),this._writeNumberValue(Buffer.prototype.writeBigInt64BE,8,w,q)}insertBigInt64BE(w,q){return V.bigIntAndBufferInt64Check("writeBigInt64BE"),this._insertNumberValue(Buffer.prototype.writeBigInt64BE,8,w,q)}writeBigInt64LE(w,q){return V.bigIntAndBufferInt64Check("writeBigInt64LE"),this._writeNumberValue(Buffer.prototype.writeBigInt64LE,8,w,q)}insertBigInt64LE(w,q){return V.bigIntAndBufferInt64Check("writeBigInt64LE"),this._insertNumberValue(Buffer.prototype.writeBigInt64LE,8,w,q)}readUInt8(w){return this._readNumberValue(Buffer.prototype.readUInt8,1,w)}readUInt16BE(w){return this._readNumberValue(Buffer.prototype.readUInt16BE,2,w)}readUInt16LE(w){return this._readNumberValue(Buffer.prototype.readUInt16LE,2,w)}readUInt32BE(w){return this._readNumberValue(Buffer.prototype.readUInt32BE,4,w)}readUInt32LE(w){return this._readNumberValue(Buffer.prototype.readUInt32LE,4,w)}readBigUInt64BE(w){return V.bigIntAndBufferInt64Check("readBigUInt64BE"),this._readNumberValue(Buffer.prototype.readBigUInt64BE,8,w)}readBigUInt64LE(w){return V.bigIntAndBufferInt64Check("readBigUInt64LE"),this._readNumberValue(Buffer.prototype.readBigUInt64LE,8,w)}writeUInt8(w,q){return this._writeNumberValue(Buffer.prototype.writeUInt8,1,w,q)}insertUInt8(w,q){return this._insertNumberValue(Buffer.prototype.writeUInt8,1,w,q)}writeUInt16BE(w,q){return this._writeNumberValue(Buffer.prototype.writeUInt16BE,2,w,q)}insertUInt16BE(w,q){return this._insertNumberValue(Buffer.prototype.writeUInt16BE,2,w,q)}writeUInt16LE(w,q){return this._writeNumberValue(Buffer.prototype.writeUInt16LE,2,w,q)}insertUInt16LE(w,q){return this._insertNumberValue(Buffer.prototype.writeUInt16LE,2,w,q)}writeUInt32BE(w,q){return this._writeNumberValue(Buffer.prototype.writeUInt32BE,4,w,q)}insertUInt32BE(w,q){return this._insertNumberValue(Buffer.prototype.writeUInt32BE,4,w,q)}writeUInt32LE(w,q){return this._writeNumberValue(Buffer.prototype.writeUInt32LE,4,w,q)}insertUInt32LE(w,q){return this._insertNumberValue(Buffer.prototype.writeUInt32LE,4,w,q)}writeBigUInt64BE(w,q){return V.bigIntAndBufferInt64Check("writeBigUInt64BE"),this._writeNumberValue(Buffer.prototype.writeBigUInt64BE,8,w,q)}insertBigUInt64BE(w,q){return V.bigIntAndBufferInt64Check("writeBigUInt64BE"),this._insertNumberValue(Buffer.prototype.writeBigUInt64BE,8,w,q)}writeBigUInt64LE(w,q){return V.bigIntAndBufferInt64Check("writeBigUInt64LE"),this._writeNumberValue(Buffer.prototype.writeBigUInt64LE,8,w,q)}insertBigUInt64LE(w,q){return V.bigIntAndBufferInt64Check("writeBigUInt64LE"),this._insertNumberValue(Buffer.prototype.writeBigUInt64LE,8,w,q)}readFloatBE(w){return this._readNumberValue(Buffer.prototype.readFloatBE,4,w)}readFloatLE(w){return this._readNumberValue(Buffer.prototype.readFloatLE,4,w)}writeFloatBE(w,q){return this._writeNumberValue(Buffer.prototype.writeFloatBE,4,w,q)}insertFloatBE(w,q){return this._insertNumberValue(Buffer.prototype.writeFloatBE,4,w,q)}writeFloatLE(w,q){return this._writeNumberValue(Buffer.prototype.writeFloatLE,4,w,q)}insertFloatLE(w,q){return this._insertNumberValue(Buffer.prototype.writeFloatLE,4,w,q)}readDoubleBE(w){return this._readNumberValue(Buffer.prototype.readDoubleBE,8,w)}readDoubleLE(w){return this._readNumberValue(Buffer.prototype.readDoubleLE,8,w)}writeDoubleBE(w,q){return this._writeNumberValue(Buffer.prototype.writeDoubleBE,8,w,q)}insertDoubleBE(w,q){return this._insertNumberValue(Buffer.prototype.writeDoubleBE,8,w,q)}writeDoubleLE(w,q){return this._writeNumberValue(Buffer.prototype.writeDoubleLE,8,w,q)}insertDoubleLE(w,q){return this._insertNumberValue(Buffer.prototype.writeDoubleLE,8,w,q)}readString(w,q){let $;if(typeof w==="number")V.checkLengthValue(w),$=Math.min(w,this.length-this._readOffset);else q=w,$=this.length-this._readOffset;if(typeof q!=="undefined")V.checkEncoding(q);let J=this._buff.slice(this._readOffset,this._readOffset+$).toString(q||this._encoding);return this._readOffset+=$,J}insertString(w,q,$){return V.checkOffsetValue(q),this._handleString(w,!0,q,$)}writeString(w,q,$){return this._handleString(w,!1,q,$)}readStringNT(w){if(typeof w!=="undefined")V.checkEncoding(w);let q=this.length;for(let J=this._readOffset;J<this.length;J++)if(this._buff[J]===0){q=J;break}let $=this._buff.slice(this._readOffset,q);return this._readOffset=q+1,$.toString(w||this._encoding)}insertStringNT(w,q,$){return V.checkOffsetValue(q),this.insertString(w,q,$),this.insertUInt8(0,q+w.length),this}writeStringNT(w,q,$){return this.writeString(w,q,$),this.writeUInt8(0,typeof q==="number"?q+w.length:this.writeOffset),this}readBuffer(w){if(typeof w!=="undefined")V.checkLengthValue(w);let q=typeof w==="number"?w:this.length,$=Math.min(this.length,this._readOffset+q),J=this._buff.slice(this._readOffset,$);return this._readOffset=$,J}insertBuffer(w,q){return V.checkOffsetValue(q),this._handleBuffer(w,!0,q)}writeBuffer(w,q){return this._handleBuffer(w,!1,q)}readBufferNT(){let w=this.length;for(let $=this._readOffset;$<this.length;$++)if(this._buff[$]===0){w=$;break}let q=this._buff.slice(this._readOffset,w);return this._readOffset=w+1,q}insertBufferNT(w,q){return V.checkOffsetValue(q),this.insertBuffer(w,q),this.insertUInt8(0,q+w.length),this}writeBufferNT(w,q){if(typeof q!=="undefined")V.checkOffsetValue(q);return this.writeBuffer(w,q),this.writeUInt8(0,typeof q==="number"?q+w.length:this._writeOffset),this}clear(){return this._writeOffset=0,this._readOffset=0,this.length=0,this}remaining(){return this.length-this._readOffset}get readOffset(){return this._readOffset}set readOffset(w){V.checkOffsetValue(w),V.checkTargetOffset(w,this),this._readOffset=w}get writeOffset(){return this._writeOffset}set writeOffset(w){V.checkOffsetValue(w),V.checkTargetOffset(w,this),this._writeOffset=w}get encoding(){return this._encoding}set encoding(w){V.checkEncoding(w),this._encoding=w}get internalBuffer(){return this._buff}toBuffer(){return this._buff.slice(0,this.length)}toString(w){let q=typeof w==="string"?w:this._encoding;return V.checkEncoding(q),this._buff.toString(q,0,this.length)}destroy(){return this.clear(),this}_handleString(w,q,$,J){let z=this._writeOffset,Y=this._encoding;if(typeof $==="number")z=$;else if(typeof $==="string")V.checkEncoding($),Y=$;if(typeof J==="string")V.checkEncoding(J),Y=J;let M=Buffer.byteLength(w,Y);if(q)this.ensureInsertable(M,z);else this._ensureWriteable(M,z);if(this._buff.write(w,z,M,Y),q)this._writeOffset+=M;else if(typeof $==="number")this._writeOffset=Math.max(this._writeOffset,z+M);else this._writeOffset+=M;return this}_handleBuffer(w,q,$){let J=typeof $==="number"?$:this._writeOffset;if(q)this.ensureInsertable(w.length,J);else this._ensureWriteable(w.length,J);if(w.copy(this._buff,J),q)this._writeOffset+=w.length;else if(typeof $==="number")this._writeOffset=Math.max(this._writeOffset,J+w.length);else this._writeOffset+=w.length;return this}ensureReadable(w,q){let $=this._readOffset;if(typeof q!=="undefined")V.checkOffsetValue(q),$=q;if($<0||$+w>this.length)throw new Error(V.ERRORS.INVALID_READ_BEYOND_BOUNDS)}ensureInsertable(w,q){if(V.checkOffsetValue(q),this._ensureCapacity(this.length+w),q<this.length)this._buff.copy(this._buff,q+w,q,this._buff.length);if(q+w>this.length)this.length=q+w;else this.length+=w}_ensureWriteable(w,q){let $=typeof q==="number"?q:this._writeOffset;if(this._ensureCapacity($+w),$+w>this.length)this.length=$+w}_ensureCapacity(w){let q=this._buff.length;if(w>q){let $=this._buff,J=q*3/2+1;if(J<w)J=w;this._buff=Buffer.allocUnsafe(J),$.copy(this._buff,0,0,q)}}_readNumberValue(w,q,$){this.ensureReadable(q,$);let J=w.call(this._buff,typeof $==="number"?$:this._readOffset);if(typeof $==="undefined")this._readOffset+=q;return J}_insertNumberValue(w,q,$,J){return V.checkOffsetValue(J),this.ensureInsertable(q,J),w.call(this._buff,$,J),this._writeOffset+=q,this}_writeNumberValue(w,q,$,J){if(typeof J==="number"){if(J<0)throw new Error(V.ERRORS.INVALID_WRITE_BEYOND_BOUNDS);V.checkOffsetValue(J)}let z=typeof J==="number"?J:this._writeOffset;if(this._ensureWriteable(q,z),w.call(this._buff,$,z),typeof J==="number")this._writeOffset=Math.max(this._writeOffset,z+q);else this._writeOffset+=q;return this}}JJ.SmartBuffer=M1});var Z1=D((XJ)=>{Object.defineProperty(XJ,"__esModule",{value:!0});XJ.SOCKS5_NO_ACCEPTABLE_AUTH=XJ.SOCKS5_CUSTOM_AUTH_END=XJ.SOCKS5_CUSTOM_AUTH_START=XJ.SOCKS_INCOMING_PACKET_SIZES=XJ.SocksClientState=XJ.Socks5Response=XJ.Socks5HostType=XJ.Socks5Auth=XJ.Socks4Response=XJ.SocksCommand=XJ.ERRORS=XJ.DEFAULT_TIMEOUT=void 0;var BM=30000;XJ.DEFAULT_TIMEOUT=BM;var CM={InvalidSocksCommand:"An invalid SOCKS command was provided. Valid options are connect, bind, and associate.",InvalidSocksCommandForOperation:"An invalid SOCKS command was provided. Only a subset of commands are supported for this operation.",InvalidSocksCommandChain:"An invalid SOCKS command was provided. Chaining currently only supports the connect command.",InvalidSocksClientOptionsDestination:"An invalid destination host was provided.",InvalidSocksClientOptionsExistingSocket:"An invalid existing socket was provided. This should be an instance of stream.Duplex.",InvalidSocksClientOptionsProxy:"Invalid SOCKS proxy details were provided.",InvalidSocksClientOptionsTimeout:"An invalid timeout value was provided. Please enter a value above 0 (in ms).",InvalidSocksClientOptionsProxiesLength:"At least two socks proxies must be provided for chaining.",InvalidSocksClientOptionsCustomAuthRange:"Custom auth must be a value between 0x80 and 0xFE.",InvalidSocksClientOptionsCustomAuthOptions:"When a custom_auth_method is provided, custom_auth_request_handler, custom_auth_response_size, and custom_auth_response_handler must also be provided and valid.",NegotiationError:"Negotiation error",SocketClosed:"Socket closed",ProxyConnectionTimedOut:"Proxy connection timed out",InternalError:"SocksClient internal error (this should not happen)",InvalidSocks4HandshakeResponse:"Received invalid Socks4 handshake response",Socks4ProxyRejectedConnection:"Socks4 Proxy rejected connection",InvalidSocks4IncomingConnectionResponse:"Socks4 invalid incoming connection response",Socks4ProxyRejectedIncomingBoundConnection:"Socks4 Proxy rejected incoming bound connection",InvalidSocks5InitialHandshakeResponse:"Received invalid Socks5 initial handshake response",InvalidSocks5IntiailHandshakeSocksVersion:"Received invalid Socks5 initial handshake (invalid socks version)",InvalidSocks5InitialHandshakeNoAcceptedAuthType:"Received invalid Socks5 initial handshake (no accepted authentication type)",InvalidSocks5InitialHandshakeUnknownAuthType:"Received invalid Socks5 initial handshake (unknown authentication type)",Socks5AuthenticationFailed:"Socks5 Authentication failed",InvalidSocks5FinalHandshake:"Received invalid Socks5 final handshake response",InvalidSocks5FinalHandshakeRejected:"Socks5 proxy rejected connection",InvalidSocks5IncomingConnectionResponse:"Received invalid Socks5 incoming connection response",Socks5ProxyRejectedIncomingBoundConnection:"Socks5 Proxy rejected incoming bound connection"};XJ.ERRORS=CM;var EM={Socks5InitialHandshakeResponse:2,Socks5UserPassAuthenticationResponse:2,Socks5ResponseHeader:5,Socks5ResponseIPv4:10,Socks5ResponseIPv6:22,Socks5ResponseHostname:(w)=>w+7,Socks4Response:8};XJ.SOCKS_INCOMING_PACKET_SIZES=EM;var YJ;(function(w){w[w.connect=1]="connect",w[w.bind=2]="bind",w[w.associate=3]="associate"})(YJ||(XJ.SocksCommand=YJ={}));var MJ;(function(w){w[w.Granted=90]="Granted",w[w.Failed=91]="Failed",w[w.Rejected=92]="Rejected",w[w.RejectedIdent=93]="RejectedIdent"})(MJ||(XJ.Socks4Response=MJ={}));var ZJ;(function(w){w[w.NoAuth=0]="NoAuth",w[w.GSSApi=1]="GSSApi",w[w.UserPass=2]="UserPass"})(ZJ||(XJ.Socks5Auth=ZJ={}));var jM=128;XJ.SOCKS5_CUSTOM_AUTH_START=jM;var FM=254;XJ.SOCKS5_CUSTOM_AUTH_END=FM;var RM=255;XJ.SOCKS5_NO_ACCEPTABLE_AUTH=RM;var KJ;(function(w){w[w.Granted=0]="Granted",w[w.Failure=1]="Failure",w[w.NotAllowed=2]="NotAllowed",w[w.NetworkUnreachable=3]="NetworkUnreachable",w[w.HostUnreachable=4]="HostUnreachable",w[w.ConnectionRefused=5]="ConnectionRefused",w[w.TTLExpired=6]="TTLExpired",w[w.CommandNotSupported=7]="CommandNotSupported",w[w.AddressNotSupported=8]="AddressNotSupported"})(KJ||(XJ.Socks5Response=KJ={}));var UJ;(function(w){w[w.IPv4=1]="IPv4",w[w.Hostname=3]="Hostname",w[w.IPv6=4]="IPv6"})(UJ||(XJ.Socks5HostType=UJ={}));var OJ;(function(w){w[w.Created=0]="Created",w[w.Connecting=1]="Connecting",w[w.Connected=2]="Connected",w[w.SentInitialHandshake=3]="SentInitialHandshake",w[w.ReceivedInitialHandshakeResponse=4]="ReceivedInitialHandshakeResponse",w[w.SentAuthentication=5]="SentAuthentication",w[w.ReceivedAuthenticationResponse=6]="ReceivedAuthenticationResponse",w[w.SentFinalHandshake=7]="SentFinalHandshake",w[w.ReceivedFinalResponse=8]="ReceivedFinalResponse",w[w.BoundWaitingForConnection=9]="BoundWaitingForConnection",w[w.Established=10]="Established",w[w.Disconnected=11]="Disconnected",w[w.Error=99]="Error"})(OJ||(XJ.SocksClientState=OJ={}))});var K1=D((yJ)=>{Object.defineProperty(yJ,"__esModule",{value:!0});yJ.shuffleArray=yJ.SocksClientError=void 0;class QJ extends Error{constructor(w,q){super(w);this.options=q}}yJ.SocksClientError=QJ;function kM(w){for(let q=w.length-1;q>0;q--){let $=Math.floor(Math.random()*(q+1));[w[q],w[$]]=[w[$],w[q]]}}yJ.shuffleArray=kM});var Eq=D((HJ)=>{Object.defineProperty(HJ,"__esModule",{value:!0});HJ.isInSubnet=SM;HJ.isCorrect=hM;HJ.numberToPaddedHex=DJ;HJ.stringToPaddedHex=nM;HJ.testBit=cM;function SM(w){if(this.subnetMask<w.subnetMask)return!1;if(this.mask(w.subnetMask)===w.mask())return!0;return!1}function hM(w){return function(){if(this.addressMinusSuffix!==this.correctForm())return!1;if(this.subnetMask===w&&!this.parsedSubnet)return!0;return this.parsedSubnet===String(this.subnetMask)}}function DJ(w){return w.toString(16).padStart(2,"0")}function nM(w){return DJ(parseInt(w,10))}function cM(w,q){let{length:$}=w;if(q>$)return!1;let J=$-q;return w.substring(J,J+1)==="1"}});var U1=D((VJ)=>{Object.defineProperty(VJ,"__esModule",{value:!0});VJ.RE_SUBNET_STRING=VJ.RE_ADDRESS=VJ.GROUPS=VJ.BITS=void 0;VJ.BITS=32;VJ.GROUPS=4;VJ.RE_ADDRESS=/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/g;VJ.RE_SUBNET_STRING=/\/\d{1,2}$/});var jq=D((BJ)=>{Object.defineProperty(BJ,"__esModule",{value:!0});BJ.AddressError=void 0;class xJ extends Error{constructor(w,q){super(w);this.name="AddressError",this.parseMessage=q}}BJ.AddressError=xJ});var O1=D((yw)=>{var tM=yw&&yw.__createBinding||(Object.create?function(w,q,$,J){if(J===void 0)J=$;var z=Object.getOwnPropertyDescriptor(q,$);if(!z||("get"in z?!q.__esModule:z.writable||z.configurable))z={enumerable:!0,get:function(){return q[$]}};Object.defineProperty(w,J,z)}:function(w,q,$,J){if(J===void 0)J=$;w[J]=q[$]}),sM=yw&&yw.__setModuleDefault||(Object.create?function(w,q){Object.defineProperty(w,"default",{enumerable:!0,value:q})}:function(w,q){w.default=q}),jJ=yw&&yw.__importStar||function(w){if(w&&w.__esModule)return w;var q={};if(w!=null){for(var $ in w)if($!=="default"&&Object.prototype.hasOwnProperty.call(w,$))tM(q,w,$)}return sM(q,w),q};Object.defineProperty(yw,"__esModule",{value:!0});yw.Address4=void 0;var nw=jJ(Eq()),Ow=jJ(U1()),EJ=jq();class Zw{constructor(w){this.groups=Ow.GROUPS,this.parsedAddress=[],this.parsedSubnet="",this.subnet="/32",this.subnetMask=32,this.v4=!0,this.isCorrect=nw.isCorrect(Ow.BITS),this.isInSubnet=nw.isInSubnet,this.address=w;let q=Ow.RE_SUBNET_STRING.exec(w);if(q){if(this.parsedSubnet=q[0].replace("/",""),this.subnetMask=parseInt(this.parsedSubnet,10),this.subnet=`/${this.subnetMask}`,this.subnetMask<0||this.subnetMask>Ow.BITS)throw new EJ.AddressError("Invalid subnet mask.");w=w.replace(Ow.RE_SUBNET_STRING,"")}this.addressMinusSuffix=w,this.parsedAddress=this.parse(w)}static isValid(w){try{return new Zw(w),!0}catch(q){return!1}}parse(w){let q=w.split(".");if(!w.match(Ow.RE_ADDRESS))throw new EJ.AddressError("Invalid IPv4 address.");return q}correctForm(){return this.parsedAddress.map((w)=>parseInt(w,10)).join(".")}static fromHex(w){let q=w.replace(/:/g,"").padStart(8,"0"),$=[],J;for(J=0;J<8;J+=2){let z=q.slice(J,J+2);$.push(parseInt(z,16))}return new Zw($.join("."))}static fromInteger(w){return Zw.fromHex(w.toString(16))}static fromArpa(w){let $=w.replace(/(\.in-addr\.arpa)?\.$/,"").split(".").reverse().join(".");return new Zw($)}toHex(){return this.parsedAddress.map((w)=>nw.stringToPaddedHex(w)).join(":")}toArray(){return this.parsedAddress.map((w)=>parseInt(w,10))}toGroup6(){let w=[],q;for(q=0;q<Ow.GROUPS;q+=2)w.push(`${nw.stringToPaddedHex(this.parsedAddress[q])}${nw.stringToPaddedHex(this.parsedAddress[q+1])}`);return w.join(":")}bigInt(){return BigInt(`0x${this.parsedAddress.map((w)=>nw.stringToPaddedHex(w)).join("")}`)}_startAddress(){return BigInt(`0b${this.mask()+"0".repeat(Ow.BITS-this.subnetMask)}`)}startAddress(){return Zw.fromBigInt(this._startAddress())}startAddressExclusive(){let w=BigInt("1");return Zw.fromBigInt(this._startAddress()+w)}_endAddress(){return BigInt(`0b${this.mask()+"1".repeat(Ow.BITS-this.subnetMask)}`)}endAddress(){return Zw.fromBigInt(this._endAddress())}endAddressExclusive(){let w=BigInt("1");return Zw.fromBigInt(this._endAddress()-w)}static fromBigInt(w){return Zw.fromHex(w.toString(16))}mask(w){if(w===void 0)w=this.subnetMask;return this.getBitsBase2(0,w)}getBitsBase2(w,q){return this.binaryZeroPad().slice(w,q)}reverseForm(w){if(!w)w={};let q=this.correctForm().split(".").reverse().join(".");if(w.omitSuffix)return q;return`${q}.in-addr.arpa.`}isMulticast(){return this.isInSubnet(new Zw("224.0.0.0/4"))}binaryZeroPad(){return this.bigInt().toString(2).padStart(Ow.BITS,"0")}groupForV6(){let w=this.parsedAddress;return this.address.replace(Ow.RE_ADDRESS,`<span class="hover-group group-v4 group-6">${w.slice(0,2).join(".")}</span>.<span class="hover-group group-v4 group-7">${w.slice(2,4).join(".")}</span>`)}}yw.Address4=Zw});var X1=D((FJ)=>{Object.defineProperty(FJ,"__esModule",{value:!0});FJ.RE_URL_WITH_PORT=FJ.RE_URL=FJ.RE_ZONE_STRING=FJ.RE_SUBNET_STRING=FJ.RE_BAD_ADDRESS=FJ.RE_BAD_CHARACTERS=FJ.TYPES=FJ.SCOPES=FJ.GROUPS=FJ.BITS=void 0;FJ.BITS=128;FJ.GROUPS=8;FJ.SCOPES={0:"Reserved",1:"Interface local",2:"Link local",4:"Admin local",5:"Site local",8:"Organization local",14:"Global",15:"Reserved"};FJ.TYPES={"ff01::1/128":"Multicast (All nodes on this interface)","ff01::2/128":"Multicast (All routers on this interface)","ff02::1/128":"Multicast (All nodes on this link)","ff02::2/128":"Multicast (All routers on this link)","ff05::2/128":"Multicast (All routers in this site)","ff02::5/128":"Multicast (OSPFv3 AllSPF routers)","ff02::6/128":"Multicast (OSPFv3 AllDR routers)","ff02::9/128":"Multicast (RIP routers)","ff02::a/128":"Multicast (EIGRP routers)","ff02::d/128":"Multicast (PIM routers)","ff02::16/128":"Multicast (MLDv2 reports)","ff01::fb/128":"Multicast (mDNSv6)","ff02::fb/128":"Multicast (mDNSv6)","ff05::fb/128":"Multicast (mDNSv6)","ff02::1:2/128":"Multicast (All DHCP servers and relay agents on this link)","ff05::1:2/128":"Multicast (All DHCP servers and relay agents in this site)","ff02::1:3/128":"Multicast (All DHCP servers on this link)","ff05::1:3/128":"Multicast (All DHCP servers in this site)","::/128":"Unspecified","::1/128":"Loopback","ff00::/8":"Multicast","fe80::/10":"Link-local unicast"};FJ.RE_BAD_CHARACTERS=/([^0-9a-f:/%])/gi;FJ.RE_BAD_ADDRESS=/([0-9a-f]{5,}|:{3,}|[^:]:$|^:[^:]|\/$)/gi;FJ.RE_SUBNET_STRING=/\/\d{1,3}(?=%|$)/;FJ.RE_ZONE_STRING=/%.*$/;FJ.RE_URL=/^\[{0,1}([0-9a-f:]+)\]{0,1}/;FJ.RE_URL_WITH_PORT=/\[([0-9a-f:]+)\]:([0-9]{1,5})/});var G1=D((IJ)=>{Object.defineProperty(IJ,"__esModule",{value:!0});IJ.spanAllZeroes=TJ;IJ.spanAll=U8;IJ.spanLeadingZeroes=O8;IJ.simpleGroup=X8;function TJ(w){return w.replace(/(0+)/g,'<span class="zero">$1</span>')}function U8(w,q=0){return w.split("").map((J,z)=>`<span class="digit value-${J} position-${z+q}">${TJ(J)}</span>`).join("")}function LJ(w){return w.replace(/^(0+)/,'<span class="zero">$1</span>')}function O8(w){return w.split(":").map(($)=>LJ($)).join(":")}function X8(w,q=0){return w.split(":").map((J,z)=>{if(/group-v4/.test(J))return J;return`<span class="hover-group group-${z+q}">${LJ(J)}</span>`})}});var AJ=D(($w)=>{var D8=$w&&$w.__createBinding||(Object.create?function(w,q,$,J){if(J===void 0)J=$;var z=Object.getOwnPropertyDescriptor(q,$);if(!z||("get"in z?!q.__esModule:z.writable||z.configurable))z={enumerable:!0,get:function(){return q[$]}};Object.defineProperty(w,J,z)}:function(w,q,$,J){if(J===void 0)J=$;w[J]=q[$]}),H8=$w&&$w.__setModuleDefault||(Object.create?function(w,q){Object.defineProperty(w,"default",{enumerable:!0,value:q})}:function(w,q){w.default=q}),V8=$w&&$w.__importStar||function(w){if(w&&w.__esModule)return w;var q={};if(w!=null){for(var $ in w)if($!=="default"&&Object.prototype.hasOwnProperty.call(w,$))D8(q,w,$)}return H8(q,w),q};Object.defineProperty($w,"__esModule",{value:!0});$w.ADDRESS_BOUNDARY=void 0;$w.groupPossibilities=Rq;$w.padGroup=Fq;$w.simpleRegularExpression=x8;$w.possibleElisions=B8;var N8=V8(X1());function Rq(w){return`(${w.join("|")})`}function Fq(w){if(w.length<4)return`0{0,${4-w.length}}${w}`;return w}$w.ADDRESS_BOUNDARY="[^A-Fa-f0-9:]";function x8(w){let q=[];w.forEach((J,z)=>{if(parseInt(J,16)===0)q.push(z)});let $=q.map((J)=>w.map((z,Y)=>{if(Y===J){let M=Y===0||Y===N8.GROUPS-1?":":"";return Rq([Fq(z),M])}return Fq(z)}).join(":"));return $.push(w.map(Fq).join(":")),Rq($)}function B8(w,q,$){let J=q?"":":",z=$?"":":",Y=[];if(!q&&!$)Y.push("::");if(q&&$)Y.push("");if($&&!q||!$&&q)Y.push(":");Y.push(`${J}(:0{1,4}){1,${w-1}}`),Y.push(`(0{1,4}:){1,${w-1}}${z}`),Y.push(`(0{1,4}:){${w-1}}0{1,4}`);for(let M=1;M<w-1;M++)for(let K=1;K<w-M;K++)Y.push(`(0{1,4}:){${K}}:(0{1,4}:){${w-K-M-1}}0{1,4}`);return Rq(Y)}});var bJ=D((Ww)=>{var C8=Ww&&Ww.__createBinding||(Object.create?function(w,q,$,J){if(J===void 0)J=$;var z=Object.getOwnPropertyDescriptor(q,$);if(!z||("get"in z?!q.__esModule:z.writable||z.configurable))z={enumerable:!0,get:function(){return q[$]}};Object.defineProperty(w,J,z)}:function(w,q,$,J){if(J===void 0)J=$;w[J]=q[$]}),E8=Ww&&Ww.__setModuleDefault||(Object.create?function(w,q){Object.defineProperty(w,"default",{enumerable:!0,value:q})}:function(w,q){w.default=q}),Iq=Ww&&Ww.__importStar||function(w){if(w&&w.__esModule)return w;var q={};if(w!=null){for(var $ in w)if($!=="default"&&Object.prototype.hasOwnProperty.call(w,$))C8(q,w,$)}return E8(q,w),q};Object.defineProperty(Ww,"__esModule",{value:!0});Ww.Address6=void 0;var mJ=Iq(Eq()),Q1=Iq(U1()),j=Iq(X1()),y1=Iq(G1()),mw=O1(),_w=AJ(),xw=jq(),Tq=Eq();function Lq(w){if(!w)throw new Error("Assertion failed.")}function j8(w){let q=/(\d+)(\d{3})/;while(q.test(w))w=w.replace(q,"$1,$2");return w}function F8(w){return w=w.replace(/^(0{1,})([1-9]+)$/,'<span class="parse-error">$1</span>$2'),w=w.replace(/^(0{1,})(0)$/,'<span class="parse-error">$1</span>$2'),w}function R8(w,q){let $=[],J=[],z;for(z=0;z<w.length;z++)if(z<q[0])$.push(w[z]);else if(z>q[1])J.push(w[z]);return $.concat(["compact"]).concat(J)}function _J(w){return parseInt(w,16).toString(16).padStart(4,"0")}function gJ(w){return w&255}class k{constructor(w,q){if(this.addressMinusSuffix="",this.parsedSubnet="",this.subnet="/128",this.subnetMask=128,this.v4=!1,this.zone="",this.isInSubnet=mJ.isInSubnet,this.isCorrect=mJ.isCorrect(j.BITS),q===void 0)this.groups=j.GROUPS;else this.groups=q;this.address=w;let $=j.RE_SUBNET_STRING.exec(w);if($){if(this.parsedSubnet=$[0].replace("/",""),this.subnetMask=parseInt(this.parsedSubnet,10),this.subnet=`/${this.subnetMask}`,Number.isNaN(this.subnetMask)||this.subnetMask<0||this.subnetMask>j.BITS)throw new xw.AddressError("Invalid subnet mask.");w=w.replace(j.RE_SUBNET_STRING,"")}else if(/\//.test(w))throw new xw.AddressError("Invalid subnet mask.");let J=j.RE_ZONE_STRING.exec(w);if(J)this.zone=J[0],w=w.replace(j.RE_ZONE_STRING,"");this.addressMinusSuffix=w,this.parsedAddress=this.parse(this.addressMinusSuffix)}static isValid(w){try{return new k(w),!0}catch(q){return!1}}static fromBigInt(w){let q=w.toString(16).padStart(32,"0"),$=[],J;for(J=0;J<j.GROUPS;J++)$.push(q.slice(J*4,(J+1)*4));return new k($.join(":"))}static fromURL(w){let q,$=null,J;if(w.indexOf("[")!==-1&&w.indexOf("]:")!==-1){if(J=j.RE_URL_WITH_PORT.exec(w),J===null)return{error:"failed to parse address with port",address:null,port:null};q=J[1],$=J[2]}else if(w.indexOf("/")!==-1){if(w=w.replace(/^[a-z0-9]+:\/\//,""),J=j.RE_URL.exec(w),J===null)return{error:"failed to parse address from URL",address:null,port:null};q=J[1]}else q=w;if($){if($=parseInt($,10),$<0||$>65536)$=null}else $=null;return{address:new k(q),port:$}}static fromAddress4(w){let q=new mw.Address4(w),$=j.BITS-(Q1.BITS-q.subnetMask);return new k(`::ffff:${q.correctForm()}/${$}`)}static fromArpa(w){let q=w.replace(/(\.ip6\.arpa)?\.$/,""),$=7;if(q.length!==63)throw new xw.AddressError("Invalid 'ip6.arpa' form.");let J=q.split(".").reverse();for(let z=$;z>0;z--){let Y=z*4;J.splice(Y,0,":")}return q=J.join(""),new k(q)}microsoftTranscription(){return`${this.correctForm().replace(/:/g,"-")}.ipv6-literal.net`}mask(w=this.subnetMask){return this.getBitsBase2(0,w)}possibleSubnets(w=128){let q=j.BITS-this.subnetMask,$=Math.abs(w-j.BITS),J=q-$;if(J<0)return"0";return j8((BigInt("2")**BigInt(J)).toString(10))}_startAddress(){return BigInt(`0b${this.mask()+"0".repeat(j.BITS-this.subnetMask)}`)}startAddress(){return k.fromBigInt(this._startAddress())}startAddressExclusive(){let w=BigInt("1");return k.fromBigInt(this._startAddress()+w)}_endAddress(){return BigInt(`0b${this.mask()+"1".repeat(j.BITS-this.subnetMask)}`)}endAddress(){return k.fromBigInt(this._endAddress())}endAddressExclusive(){let w=BigInt("1");return k.fromBigInt(this._endAddress()-w)}getScope(){let w=j.SCOPES[parseInt(this.getBits(12,16).toString(10),10)];if(this.getType()==="Global unicast"&&w!=="Link local")w="Global";return w||"Unknown"}getType(){for(let w of Object.keys(j.TYPES))if(this.isInSubnet(new k(w)))return j.TYPES[w];return"Global unicast"}getBits(w,q){return BigInt(`0b${this.getBitsBase2(w,q)}`)}getBitsBase2(w,q){return this.binaryZeroPad().slice(w,q)}getBitsBase16(w,q){let $=q-w;if($%4!==0)throw new Error("Length of bits to retrieve must be divisible by four");return this.getBits(w,q).toString(16).padStart($/4,"0")}getBitsPastSubnet(){return this.getBitsBase2(this.subnetMask,j.BITS)}reverseForm(w){if(!w)w={};let q=Math.floor(this.subnetMask/4),$=this.canonicalForm().replace(/:/g,"").split("").slice(0,q).reverse().join(".");if(q>0){if(w.omitSuffix)return $;return`${$}.ip6.arpa.`}if(w.omitSuffix)return"";return"ip6.arpa."}correctForm(){let w,q=[],$=0,J=[];for(w=0;w<this.parsedAddress.length;w++){let M=parseInt(this.parsedAddress[w],16);if(M===0)$++;if(M!==0&&$>0){if($>1)J.push([w-$,w-1]);$=0}}if($>1)J.push([this.parsedAddress.length-$,this.parsedAddress.length-1]);let z=J.map((M)=>M[1]-M[0]+1);if(J.length>0){let M=z.indexOf(Math.max(...z));q=R8(this.parsedAddress,J[M])}else q=this.parsedAddress;for(w=0;w<q.length;w++)if(q[w]!=="compact")q[w]=parseInt(q[w],16).toString(16);let Y=q.join(":");return Y=Y.replace(/^compact$/,"::"),Y=Y.replace(/(^compact)|(compact$)/,":"),Y=Y.replace(/compact/,""),Y}binaryZeroPad(){return this.bigInt().toString(2).padStart(j.BITS,"0")}parse4in6(w){let q=w.split(":"),J=q.slice(-1)[0].match(Q1.RE_ADDRESS);if(J){this.parsedAddress4=J[0],this.address4=new mw.Address4(this.parsedAddress4);for(let z=0;z<this.address4.groups;z++)if(/^0[0-9]+/.test(this.address4.parsedAddress[z]))throw new xw.AddressError("IPv4 addresses can't have leading zeroes.",w.replace(Q1.RE_ADDRESS,this.address4.parsedAddress.map(F8).join(".")));this.v4=!0,q[q.length-1]=this.address4.toGroup6(),w=q.join(":")}return w}parse(w){w=this.parse4in6(w);let q=w.match(j.RE_BAD_CHARACTERS);if(q)throw new xw.AddressError(`Bad character${q.length>1?"s":""} detected in address: ${q.join("")}`,w.replace(j.RE_BAD_CHARACTERS,'<span class="parse-error">$1</span>'));let $=w.match(j.RE_BAD_ADDRESS);if($)throw new xw.AddressError(`Address failed regex: ${$.join("")}`,w.replace(j.RE_BAD_ADDRESS,'<span class="parse-error">$1</span>'));let J=[],z=w.split("::");if(z.length===2){let Y=z[0].split(":"),M=z[1].split(":");if(Y.length===1&&Y[0]==="")Y=[];if(M.length===1&&M[0]==="")M=[];let K=this.groups-(Y.length+M.length);if(!K)throw new xw.AddressError("Error parsing groups");this.elidedGroups=K,this.elisionBegin=Y.length,this.elisionEnd=Y.length+this.elidedGroups,J=J.concat(Y);for(let U=0;U<K;U++)J.push("0");J=J.concat(M)}else if(z.length===1)J=w.split(":"),this.elidedGroups=0;else throw new xw.AddressError("Too many :: groups found");if(J=J.map((Y)=>parseInt(Y,16).toString(16)),J.length!==this.groups)throw new xw.AddressError("Incorrect number of groups found");return J}canonicalForm(){return this.parsedAddress.map(_J).join(":")}decimal(){return this.parsedAddress.map((w)=>parseInt(w,16).toString(10).padStart(5,"0")).join(":")}bigInt(){return BigInt(`0x${this.parsedAddress.map(_J).join("")}`)}to4(){let w=this.binaryZeroPad().split("");return mw.Address4.fromHex(BigInt(`0b${w.slice(96,128).join("")}`).toString(16))}to4in6(){let w=this.to4(),$=new k(this.parsedAddress.slice(0,6).join(":"),6).correctForm(),J="";if(!/:$/.test($))J=":";return $+J+w.address}inspectTeredo(){let w=this.getBitsBase16(0,32),$=(this.getBits(80,96)^BigInt("0xffff")).toString(),J=mw.Address4.fromHex(this.getBitsBase16(32,64)),z=this.getBits(96,128),Y=mw.Address4.fromHex((z^BigInt("0xffffffff")).toString(16)),M=this.getBitsBase2(64,80),K=Tq.testBit(M,15),U=Tq.testBit(M,14),G=Tq.testBit(M,8),Z=Tq.testBit(M,9),Q=BigInt(`0b${M.slice(2,6)+M.slice(8,16)}`).toString(10);return{prefix:`${w.slice(0,4)}:${w.slice(4,8)}`,server4:J.address,client4:Y.address,flags:M,coneNat:K,microsoft:{reserved:U,universalLocal:Z,groupIndividual:G,nonce:Q},udpPort:$}}inspect6to4(){let w=this.getBitsBase16(0,16),q=mw.Address4.fromHex(this.getBitsBase16(16,48));return{prefix:w.slice(0,4),gateway:q.address}}to6to4(){if(!this.is4())return null;let w=["2002",this.getBitsBase16(96,112),this.getBitsBase16(112,128),"","/16"].join(":");return new k(w)}toByteArray(){let w=this.bigInt().toString(16),$=`${"0".repeat(w.length%2)}${w}`,J=[];for(let z=0,Y=$.length;z<Y;z+=2)J.push(parseInt($.substring(z,z+2),16));return J}toUnsignedByteArray(){return this.toByteArray().map(gJ)}static fromByteArray(w){return this.fromUnsignedByteArray(w.map(gJ))}static fromUnsignedByteArray(w){let q=BigInt("256"),$=BigInt("0"),J=BigInt("1");for(let z=w.length-1;z>=0;z--)$+=J*BigInt(w[z].toString(10)),J*=q;return k.fromBigInt($)}isCanonical(){return this.addressMinusSuffix===this.canonicalForm()}isLinkLocal(){if(this.getBitsBase2(0,64)==="1111111010000000000000000000000000000000000000000000000000000000")return!0;return!1}isMulticast(){return this.getType()==="Multicast"}is4(){return this.v4}isTeredo(){return this.isInSubnet(new k("2001::/32"))}is6to4(){return this.isInSubnet(new k("2002::/16"))}isLoopback(){return this.getType()==="Loopback"}href(w){if(w===void 0)w="";else w=`:${w}`;return`http://[${this.correctForm()}]${w}/`}link(w){if(!w)w={};if(w.className===void 0)w.className="";if(w.prefix===void 0)w.prefix="/#address=";if(w.v4===void 0)w.v4=!1;let q=this.correctForm;if(w.v4)q=this.to4in6;let $=q.call(this);if(w.className)return`<a href="${w.prefix}${$}" class="${w.className}">${$}</a>`;return`<a href="${w.prefix}${$}">${$}</a>`}group(){if(this.elidedGroups===0)return y1.simpleGroup(this.address).join(":");Lq(typeof this.elidedGroups==="number"),Lq(typeof this.elisionBegin==="number");let w=[],[q,$]=this.address.split("::");if(q.length)w.push(...y1.simpleGroup(q));else w.push("");let J=["hover-group"];for(let z=this.elisionBegin;z<this.elisionBegin+this.elidedGroups;z++)J.push(`group-${z}`);if(w.push(`<span class="${J.join(" ")}"></span>`),$.length)w.push(...y1.simpleGroup($,this.elisionEnd));else w.push("");if(this.is4())Lq(this.address4 instanceof mw.Address4),w.pop(),w.push(this.address4.groupForV6());return w.join(":")}regularExpressionString(w=!1){let q=[],$=new k(this.correctForm());if($.elidedGroups===0)q.push(_w.simpleRegularExpression($.parsedAddress));else if($.elidedGroups===j.GROUPS)q.push(_w.possibleElisions(j.GROUPS));else{let J=$.address.split("::");if(J[0].length)q.push(_w.simpleRegularExpression(J[0].split(":")));if(Lq(typeof $.elidedGroups==="number"),q.push(_w.possibleElisions($.elidedGroups,J[0].length!==0,J[1].length!==0)),J[1].length)q.push(_w.simpleRegularExpression(J[1].split(":")));q=[q.join(":")]}if(!w)q=["(?=^|",_w.ADDRESS_BOUNDARY,"|[^\\w\\:])(",...q,")(?=[^\\w\\:]|",_w.ADDRESS_BOUNDARY,"|$)"];return q.join("")}regularExpression(w=!1){return new RegExp(this.regularExpressionString(w),"i")}}Ww.Address6=k});var W1=D((r)=>{var T8=r&&r.__createBinding||(Object.create?function(w,q,$,J){if(J===void 0)J=$;var z=Object.getOwnPropertyDescriptor(q,$);if(!z||("get"in z?!q.__esModule:z.writable||z.configurable))z={enumerable:!0,get:function(){return q[$]}};Object.defineProperty(w,J,z)}:function(w,q,$,J){if(J===void 0)J=$;w[J]=q[$]}),L8=r&&r.__setModuleDefault||(Object.create?function(w,q){Object.defineProperty(w,"default",{enumerable:!0,value:q})}:function(w,q){w.default=q}),I8=r&&r.__importStar||function(w){if(w&&w.__esModule)return w;var q={};if(w!=null){for(var $ in w)if($!=="default"&&Object.prototype.hasOwnProperty.call(w,$))T8(q,w,$)}return L8(q,w),q};Object.defineProperty(r,"__esModule",{value:!0});r.v6=r.AddressError=r.Address6=r.Address4=void 0;var A8=O1();Object.defineProperty(r,"Address4",{enumerable:!0,get:function(){return A8.Address4}});var m8=bJ();Object.defineProperty(r,"Address6",{enumerable:!0,get:function(){return m8.Address6}});var _8=jq();Object.defineProperty(r,"AddressError",{enumerable:!0,get:function(){return _8.AddressError}});var g8=I8(G1());r.v6={helpers:g8}});var nJ=D((SJ)=>{Object.defineProperty(SJ,"__esModule",{value:!0});SJ.ipToBuffer=SJ.int32ToIpv4=SJ.ipv4ToInt32=SJ.validateSocksClientChainOptions=SJ.validateSocksClientOptions=void 0;var ww=K1(),u=Z1(),b8=T("stream"),D1=W1(),iJ=T("net");function i8(w,q=["connect","bind","associate"]){if(!u.SocksCommand[w.command])throw new ww.SocksClientError(u.ERRORS.InvalidSocksCommand,w);if(q.indexOf(w.command)===-1)throw new ww.SocksClientError(u.ERRORS.InvalidSocksCommandForOperation,w);if(!vJ(w.destination))throw new ww.SocksClientError(u.ERRORS.InvalidSocksClientOptionsDestination,w);if(!kJ(w.proxy))throw new ww.SocksClientError(u.ERRORS.InvalidSocksClientOptionsProxy,w);if(PJ(w.proxy,w),w.timeout&&!uJ(w.timeout))throw new ww.SocksClientError(u.ERRORS.InvalidSocksClientOptionsTimeout,w);if(w.existing_socket&&!(w.existing_socket instanceof b8.Duplex))throw new ww.SocksClientError(u.ERRORS.InvalidSocksClientOptionsExistingSocket,w)}SJ.validateSocksClientOptions=i8;function P8(w){if(w.command!=="connect")throw new ww.SocksClientError(u.ERRORS.InvalidSocksCommandChain,w);if(!vJ(w.destination))throw new ww.SocksClientError(u.ERRORS.InvalidSocksClientOptionsDestination,w);if(!(w.proxies&&Array.isArray(w.proxies)&&w.proxies.length>=2))throw new ww.SocksClientError(u.ERRORS.InvalidSocksClientOptionsProxiesLength,w);if(w.proxies.forEach((q)=>{if(!kJ(q))throw new ww.SocksClientError(u.ERRORS.InvalidSocksClientOptionsProxy,w);PJ(q,w)}),w.timeout&&!uJ(w.timeout))throw new ww.SocksClientError(u.ERRORS.InvalidSocksClientOptionsTimeout,w)}SJ.validateSocksClientChainOptions=P8;function PJ(w,q){if(w.custom_auth_method!==void 0){if(w.custom_auth_method<u.SOCKS5_CUSTOM_AUTH_START||w.custom_auth_method>u.SOCKS5_CUSTOM_AUTH_END)throw new ww.SocksClientError(u.ERRORS.InvalidSocksClientOptionsCustomAuthRange,q);if(w.custom_auth_request_handler===void 0||typeof w.custom_auth_request_handler!=="function")throw new ww.SocksClientError(u.ERRORS.InvalidSocksClientOptionsCustomAuthOptions,q);if(w.custom_auth_response_size===void 0)throw new ww.SocksClientError(u.ERRORS.InvalidSocksClientOptionsCustomAuthOptions,q);if(w.custom_auth_response_handler===void 0||typeof w.custom_auth_response_handler!=="function")throw new ww.SocksClientError(u.ERRORS.InvalidSocksClientOptionsCustomAuthOptions,q)}}function vJ(w){return w&&typeof w.host==="string"&&Buffer.byteLength(w.host)<256&&typeof w.port==="number"&&w.port>=0&&w.port<=65535}function kJ(w){return w&&(typeof w.host==="string"||typeof w.ipaddress==="string")&&typeof w.port==="number"&&w.port>=0&&w.port<=65535&&(w.type===4||w.type===5)}function uJ(w){return typeof w==="number"&&w>0}function v8(w){return new D1.Address4(w).toArray().reduce(($,J)=>($<<8)+J,0)>>>0}SJ.ipv4ToInt32=v8;function k8(w){let q=w>>>24&255,$=w>>>16&255,J=w>>>8&255,z=w&255;return[q,$,J,z].join(".")}SJ.int32ToIpv4=k8;function u8(w){if(iJ.isIPv4(w)){let q=new D1.Address4(w);return Buffer.from(q.toArray())}else if(iJ.isIPv6(w)){let q=new D1.Address6(w);return Buffer.from(q.canonicalForm().split(":").map(($)=>$.padStart(4,"0")).join(""),"hex")}else throw new Error("Invalid IP address format")}SJ.ipToBuffer=u8});var fJ=D((lJ)=>{Object.defineProperty(lJ,"__esModule",{value:!0});lJ.ReceiveBuffer=void 0;class cJ{constructor(w=4096){this.buffer=Buffer.allocUnsafe(w),this.offset=0,this.originalSize=w}get length(){return this.offset}append(w){if(!Buffer.isBuffer(w))throw new Error("Attempted to append a non-buffer instance to ReceiveBuffer.");if(this.offset+w.length>=this.buffer.length){let q=this.buffer;this.buffer=Buffer.allocUnsafe(Math.max(this.buffer.length+this.originalSize,this.buffer.length+w.length)),q.copy(this.buffer)}return w.copy(this.buffer,this.offset),this.offset+=w.length}peek(w){if(w>this.offset)throw new Error("Attempted to read beyond the bounds of the managed internal data.");return this.buffer.slice(0,w)}get(w){if(w>this.offset)throw new Error("Attempted to read beyond the bounds of the managed internal data.");let q=Buffer.allocUnsafe(w);return this.buffer.slice(0,w).copy(q),this.buffer.copyWithin(0,w,w+this.offset-w),this.offset-=w,q}}lJ.ReceiveBuffer=cJ});var pJ=D((Rw)=>{var cw=Rw&&Rw.__awaiter||function(w,q,$,J){function z(Y){return Y instanceof $?Y:new $(function(M){M(Y)})}return new($||($=Promise))(function(Y,M){function K(Z){try{G(J.next(Z))}catch(Q){M(Q)}}function U(Z){try{G(J.throw(Z))}catch(Q){M(Q)}}function G(Z){Z.done?Y(Z.value):z(Z.value).then(K,U)}G((J=J.apply(w,q||[])).next())})};Object.defineProperty(Rw,"__esModule",{value:!0});Rw.SocksClientError=Rw.SocksClient=void 0;var l8=T("events"),lw=T("net"),Jw=zJ(),O=Z1(),Yw=nJ(),d8=fJ(),V1=K1();Object.defineProperty(Rw,"SocksClientError",{enumerable:!0,get:function(){return V1.SocksClientError}});var H1=W1();class Aq extends l8.EventEmitter{constructor(w){super();this.options=Object.assign({},w),Yw.validateSocksClientOptions(w),this.setState(O.SocksClientState.Created)}static createConnection(w,q){return new Promise(($,J)=>{try{Yw.validateSocksClientOptions(w,["connect"])}catch(Y){if(typeof q==="function")return q(Y),$(Y);else return J(Y)}let z=new Aq(w);z.connect(w.existing_socket),z.once("established",(Y)=>{if(z.removeAllListeners(),typeof q==="function")q(null,Y),$(Y);else $(Y)}),z.once("error",(Y)=>{if(z.removeAllListeners(),typeof q==="function")q(Y),$(Y);else J(Y)})})}static createConnectionChain(w,q){return new Promise(($,J)=>cw(this,void 0,void 0,function*(){try{Yw.validateSocksClientChainOptions(w)}catch(z){if(typeof q==="function")return q(z),$(z);else return J(z)}if(w.randomizeChain)V1.shuffleArray(w.proxies);try{let z;for(let Y=0;Y<w.proxies.length;Y++){let M=w.proxies[Y],K=Y===w.proxies.length-1?w.destination:{host:w.proxies[Y+1].host||w.proxies[Y+1].ipaddress,port:w.proxies[Y+1].port},U=yield Aq.createConnection({command:"connect",proxy:M,destination:K,existing_socket:z});z=z||U.socket}if(typeof q==="function")q(null,{socket:z}),$({socket:z});else $({socket:z})}catch(z){if(typeof q==="function")q(z),$(z);else J(z)}}))}static createUDPFrame(w){let q=new Jw.SmartBuffer;if(q.writeUInt16BE(0),q.writeUInt8(w.frameNumber||0),lw.isIPv4(w.remoteHost.host))q.writeUInt8(O.Socks5HostType.IPv4),q.writeUInt32BE(Yw.ipv4ToInt32(w.remoteHost.host));else if(lw.isIPv6(w.remoteHost.host))q.writeUInt8(O.Socks5HostType.IPv6),q.writeBuffer(Yw.ipToBuffer(w.remoteHost.host));else q.writeUInt8(O.Socks5HostType.Hostname),q.writeUInt8(Buffer.byteLength(w.remoteHost.host)),q.writeString(w.remoteHost.host);return q.writeUInt16BE(w.remoteHost.port),q.writeBuffer(w.data),q.toBuffer()}static parseUDPFrame(w){let q=Jw.SmartBuffer.fromBuffer(w);q.readOffset=2;let $=q.readUInt8(),J=q.readUInt8(),z;if(J===O.Socks5HostType.IPv4)z=Yw.int32ToIpv4(q.readUInt32BE());else if(J===O.Socks5HostType.IPv6)z=H1.Address6.fromByteArray(Array.from(q.readBuffer(16))).canonicalForm();else z=q.readString(q.readUInt8());let Y=q.readUInt16BE();return{frameNumber:$,remoteHost:{host:z,port:Y},data:q.readBuffer()}}setState(w){if(this.state!==O.SocksClientState.Error)this.state=w}connect(w){this.onDataReceived=($)=>this.onDataReceivedHandler($),this.onClose=()=>this.onCloseHandler(),this.onError=($)=>this.onErrorHandler($),this.onConnect=()=>this.onConnectHandler();let q=setTimeout(()=>this.onEstablishedTimeout(),this.options.timeout||O.DEFAULT_TIMEOUT);if(q.unref&&typeof q.unref==="function")q.unref();if(w)this.socket=w;else this.socket=new lw.Socket;if(this.socket.once("close",this.onClose),this.socket.once("error",this.onError),this.socket.once("connect",this.onConnect),this.socket.on("data",this.onDataReceived),this.setState(O.SocksClientState.Connecting),this.receiveBuffer=new d8.ReceiveBuffer,w)this.socket.emit("connect");else if(this.socket.connect(this.getSocketOptions()),this.options.set_tcp_nodelay!==void 0&&this.options.set_tcp_nodelay!==null)this.socket.setNoDelay(!!this.options.set_tcp_nodelay);this.prependOnceListener("established",($)=>{setImmediate(()=>{if(this.receiveBuffer.length>0){let J=this.receiveBuffer.get(this.receiveBuffer.length);$.socket.emit("data",J)}$.socket.resume()})})}getSocketOptions(){return Object.assign(Object.assign({},this.options.socket_options),{host:this.options.proxy.host||this.options.proxy.ipaddress,port:this.options.proxy.port})}onEstablishedTimeout(){if(this.state!==O.SocksClientState.Established&&this.state!==O.SocksClientState.BoundWaitingForConnection)this.closeSocket(O.ERRORS.ProxyConnectionTimedOut)}onConnectHandler(){if(this.setState(O.SocksClientState.Connected),this.options.proxy.type===4)this.sendSocks4InitialHandshake();else this.sendSocks5InitialHandshake();this.setState(O.SocksClientState.SentInitialHandshake)}onDataReceivedHandler(w){this.receiveBuffer.append(w),this.processData()}processData(){while(this.state!==O.SocksClientState.Established&&this.state!==O.SocksClientState.Error&&this.receiveBuffer.length>=this.nextRequiredPacketBufferSize)if(this.state===O.SocksClientState.SentInitialHandshake)if(this.options.proxy.type===4)this.handleSocks4FinalHandshakeResponse();else this.handleInitialSocks5HandshakeResponse();else if(this.state===O.SocksClientState.SentAuthentication)this.handleInitialSocks5AuthenticationHandshakeResponse();else if(this.state===O.SocksClientState.SentFinalHandshake)this.handleSocks5FinalHandshakeResponse();else if(this.state===O.SocksClientState.BoundWaitingForConnection)if(this.options.proxy.type===4)this.handleSocks4IncomingConnectionResponse();else this.handleSocks5IncomingConnectionResponse();else{this.closeSocket(O.ERRORS.InternalError);break}}onCloseHandler(){this.closeSocket(O.ERRORS.SocketClosed)}onErrorHandler(w){this.closeSocket(w.message)}removeInternalSocketHandlers(){this.socket.pause(),this.socket.removeListener("data",this.onDataReceived),this.socket.removeListener("close",this.onClose),this.socket.removeListener("error",this.onError),this.socket.removeListener("connect",this.onConnect)}closeSocket(w){if(this.state!==O.SocksClientState.Error)this.setState(O.SocksClientState.Error),this.socket.destroy(),this.removeInternalSocketHandlers(),this.emit("error",new V1.SocksClientError(w,this.options))}sendSocks4InitialHandshake(){let w=this.options.proxy.userId||"",q=new Jw.SmartBuffer;if(q.writeUInt8(4),q.writeUInt8(O.SocksCommand[this.options.command]),q.writeUInt16BE(this.options.destination.port),lw.isIPv4(this.options.destination.host))q.writeBuffer(Yw.ipToBuffer(this.options.destination.host)),q.writeStringNT(w);else q.writeUInt8(0),q.writeUInt8(0),q.writeUInt8(0),q.writeUInt8(1),q.writeStringNT(w),q.writeStringNT(this.options.destination.host);this.nextRequiredPacketBufferSize=O.SOCKS_INCOMING_PACKET_SIZES.Socks4Response,this.socket.write(q.toBuffer())}handleSocks4FinalHandshakeResponse(){let w=this.receiveBuffer.get(8);if(w[1]!==O.Socks4Response.Granted)this.closeSocket(`${O.ERRORS.Socks4ProxyRejectedConnection} - (${O.Socks4Response[w[1]]})`);else if(O.SocksCommand[this.options.command]===O.SocksCommand.bind){let q=Jw.SmartBuffer.fromBuffer(w);q.readOffset=2;let $={port:q.readUInt16BE(),host:Yw.int32ToIpv4(q.readUInt32BE())};if($.host==="0.0.0.0")$.host=this.options.proxy.ipaddress;this.setState(O.SocksClientState.BoundWaitingForConnection),this.emit("bound",{remoteHost:$,socket:this.socket})}else this.setState(O.SocksClientState.Established),this.removeInternalSocketHandlers(),this.emit("established",{socket:this.socket})}handleSocks4IncomingConnectionResponse(){let w=this.receiveBuffer.get(8);if(w[1]!==O.Socks4Response.Granted)this.closeSocket(`${O.ERRORS.Socks4ProxyRejectedIncomingBoundConnection} - (${O.Socks4Response[w[1]]})`);else{let q=Jw.SmartBuffer.fromBuffer(w);q.readOffset=2;let $={port:q.readUInt16BE(),host:Yw.int32ToIpv4(q.readUInt32BE())};this.setState(O.SocksClientState.Established),this.removeInternalSocketHandlers(),this.emit("established",{remoteHost:$,socket:this.socket})}}sendSocks5InitialHandshake(){let w=new Jw.SmartBuffer,q=[O.Socks5Auth.NoAuth];if(this.options.proxy.userId||this.options.proxy.password)q.push(O.Socks5Auth.UserPass);if(this.options.proxy.custom_auth_method!==void 0)q.push(this.options.proxy.custom_auth_method);w.writeUInt8(5),w.writeUInt8(q.length);for(let $ of q)w.writeUInt8($);this.nextRequiredPacketBufferSize=O.SOCKS_INCOMING_PACKET_SIZES.Socks5InitialHandshakeResponse,this.socket.write(w.toBuffer()),this.setState(O.SocksClientState.SentInitialHandshake)}handleInitialSocks5HandshakeResponse(){let w=this.receiveBuffer.get(2);if(w[0]!==5)this.closeSocket(O.ERRORS.InvalidSocks5IntiailHandshakeSocksVersion);else if(w[1]===O.SOCKS5_NO_ACCEPTABLE_AUTH)this.closeSocket(O.ERRORS.InvalidSocks5InitialHandshakeNoAcceptedAuthType);else if(w[1]===O.Socks5Auth.NoAuth)this.socks5ChosenAuthType=O.Socks5Auth.NoAuth,this.sendSocks5CommandRequest();else if(w[1]===O.Socks5Auth.UserPass)this.socks5ChosenAuthType=O.Socks5Auth.UserPass,this.sendSocks5UserPassAuthentication();else if(w[1]===this.options.proxy.custom_auth_method)this.socks5ChosenAuthType=this.options.proxy.custom_auth_method,this.sendSocks5CustomAuthentication();else this.closeSocket(O.ERRORS.InvalidSocks5InitialHandshakeUnknownAuthType)}sendSocks5UserPassAuthentication(){let w=this.options.proxy.userId||"",q=this.options.proxy.password||"",$=new Jw.SmartBuffer;$.writeUInt8(1),$.writeUInt8(Buffer.byteLength(w)),$.writeString(w),$.writeUInt8(Buffer.byteLength(q)),$.writeString(q),this.nextRequiredPacketBufferSize=O.SOCKS_INCOMING_PACKET_SIZES.Socks5UserPassAuthenticationResponse,this.socket.write($.toBuffer()),this.setState(O.SocksClientState.SentAuthentication)}sendSocks5CustomAuthentication(){return cw(this,void 0,void 0,function*(){this.nextRequiredPacketBufferSize=this.options.proxy.custom_auth_response_size,this.socket.write(yield this.options.proxy.custom_auth_request_handler()),this.setState(O.SocksClientState.SentAuthentication)})}handleSocks5CustomAuthHandshakeResponse(w){return cw(this,void 0,void 0,function*(){return yield this.options.proxy.custom_auth_response_handler(w)})}handleSocks5AuthenticationNoAuthHandshakeResponse(w){return cw(this,void 0,void 0,function*(){return w[1]===0})}handleSocks5AuthenticationUserPassHandshakeResponse(w){return cw(this,void 0,void 0,function*(){return w[1]===0})}handleInitialSocks5AuthenticationHandshakeResponse(){return cw(this,void 0,void 0,function*(){this.setState(O.SocksClientState.ReceivedAuthenticationResponse);let w=!1;if(this.socks5ChosenAuthType===O.Socks5Auth.NoAuth)w=yield this.handleSocks5AuthenticationNoAuthHandshakeResponse(this.receiveBuffer.get(2));else if(this.socks5ChosenAuthType===O.Socks5Auth.UserPass)w=yield this.handleSocks5AuthenticationUserPassHandshakeResponse(this.receiveBuffer.get(2));else if(this.socks5ChosenAuthType===this.options.proxy.custom_auth_method)w=yield this.handleSocks5CustomAuthHandshakeResponse(this.receiveBuffer.get(this.options.proxy.custom_auth_response_size));if(!w)this.closeSocket(O.ERRORS.Socks5AuthenticationFailed);else this.sendSocks5CommandRequest()})}sendSocks5CommandRequest(){let w=new Jw.SmartBuffer;if(w.writeUInt8(5),w.writeUInt8(O.SocksCommand[this.options.command]),w.writeUInt8(0),lw.isIPv4(this.options.destination.host))w.writeUInt8(O.Socks5HostType.IPv4),w.writeBuffer(Yw.ipToBuffer(this.options.destination.host));else if(lw.isIPv6(this.options.destination.host))w.writeUInt8(O.Socks5HostType.IPv6),w.writeBuffer(Yw.ipToBuffer(this.options.destination.host));else w.writeUInt8(O.Socks5HostType.Hostname),w.writeUInt8(this.options.destination.host.length),w.writeString(this.options.destination.host);w.writeUInt16BE(this.options.destination.port),this.nextRequiredPacketBufferSize=O.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseHeader,this.socket.write(w.toBuffer()),this.setState(O.SocksClientState.SentFinalHandshake)}handleSocks5FinalHandshakeResponse(){let w=this.receiveBuffer.peek(5);if(w[0]!==5||w[1]!==O.Socks5Response.Granted)this.closeSocket(`${O.ERRORS.InvalidSocks5FinalHandshakeRejected} - ${O.Socks5Response[w[1]]}`);else{let q=w[3],$,J;if(q===O.Socks5HostType.IPv4){let z=O.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseIPv4;if(this.receiveBuffer.length<z){this.nextRequiredPacketBufferSize=z;return}if(J=Jw.SmartBuffer.fromBuffer(this.receiveBuffer.get(z).slice(4)),$={host:Yw.int32ToIpv4(J.readUInt32BE()),port:J.readUInt16BE()},$.host==="0.0.0.0")$.host=this.options.proxy.ipaddress}else if(q===O.Socks5HostType.Hostname){let z=w[4],Y=O.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseHostname(z);if(this.receiveBuffer.length<Y){this.nextRequiredPacketBufferSize=Y;return}J=Jw.SmartBuffer.fromBuffer(this.receiveBuffer.get(Y).slice(5)),$={host:J.readString(z),port:J.readUInt16BE()}}else if(q===O.Socks5HostType.IPv6){let z=O.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseIPv6;if(this.receiveBuffer.length<z){this.nextRequiredPacketBufferSize=z;return}J=Jw.SmartBuffer.fromBuffer(this.receiveBuffer.get(z).slice(4)),$={host:H1.Address6.fromByteArray(Array.from(J.readBuffer(16))).canonicalForm(),port:J.readUInt16BE()}}if(this.setState(O.SocksClientState.ReceivedFinalResponse),O.SocksCommand[this.options.command]===O.SocksCommand.connect)this.setState(O.SocksClientState.Established),this.removeInternalSocketHandlers(),this.emit("established",{remoteHost:$,socket:this.socket});else if(O.SocksCommand[this.options.command]===O.SocksCommand.bind)this.setState(O.SocksClientState.BoundWaitingForConnection),this.nextRequiredPacketBufferSize=O.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseHeader,this.emit("bound",{remoteHost:$,socket:this.socket});else if(O.SocksCommand[this.options.command]===O.SocksCommand.associate)this.setState(O.SocksClientState.Established),this.removeInternalSocketHandlers(),this.emit("established",{remoteHost:$,socket:this.socket})}}handleSocks5IncomingConnectionResponse(){let w=this.receiveBuffer.peek(5);if(w[0]!==5||w[1]!==O.Socks5Response.Granted)this.closeSocket(`${O.ERRORS.Socks5ProxyRejectedIncomingBoundConnection} - ${O.Socks5Response[w[1]]}`);else{let q=w[3],$,J;if(q===O.Socks5HostType.IPv4){let z=O.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseIPv4;if(this.receiveBuffer.length<z){this.nextRequiredPacketBufferSize=z;return}if(J=Jw.SmartBuffer.fromBuffer(this.receiveBuffer.get(z).slice(4)),$={host:Yw.int32ToIpv4(J.readUInt32BE()),port:J.readUInt16BE()},$.host==="0.0.0.0")$.host=this.options.proxy.ipaddress}else if(q===O.Socks5HostType.Hostname){let z=w[4],Y=O.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseHostname(z);if(this.receiveBuffer.length<Y){this.nextRequiredPacketBufferSize=Y;return}J=Jw.SmartBuffer.fromBuffer(this.receiveBuffer.get(Y).slice(5)),$={host:J.readString(z),port:J.readUInt16BE()}}else if(q===O.Socks5HostType.IPv6){let z=O.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseIPv6;if(this.receiveBuffer.length<z){this.nextRequiredPacketBufferSize=z;return}J=Jw.SmartBuffer.fromBuffer(this.receiveBuffer.get(z).slice(4)),$={host:H1.Address6.fromByteArray(Array.from(J.readBuffer(16))).canonicalForm(),port:J.readUInt16BE()}}this.setState(O.SocksClientState.Established),this.removeInternalSocketHandlers(),this.emit("established",{remoteHost:$,socket:this.socket})}}get socksClientOptions(){return Object.assign({},this.options)}}Rw.SocksClient=Aq});var N1=D((gw)=>{var f8=gw&&gw.__createBinding||(Object.create?function(w,q,$,J){if(J===void 0)J=$;var z=Object.getOwnPropertyDescriptor(q,$);if(!z||("get"in z?!q.__esModule:z.writable||z.configurable))z={enumerable:!0,get:function(){return q[$]}};Object.defineProperty(w,J,z)}:function(w,q,$,J){if(J===void 0)J=$;w[J]=q[$]}),p8=gw&&gw.__exportStar||function(w,q){for(var $ in w)if($!=="default"&&!Object.prototype.hasOwnProperty.call(q,$))f8(q,w,$)};Object.defineProperty(gw,"__esModule",{value:!0});p8(pJ(),gw)});import r8 from"net";import YM from"process";import{join as zz,relative as Yz,resolve as R1}from"path";import Zq from"process";import{existsSync as P1,mkdirSync as MZ,readdirSync as ZZ,writeFileSync as KZ}from"fs";import{dirname as OZ,resolve as Kq}from"path";import uq from"process";import{Buffer as Bw}from"buffer";import{createCipheriv as Xz,createDecipheriv as Gz,randomBytes as bq}from"crypto";import{closeSync as iq,createReadStream as L1,createWriteStream as Qz,existsSync as Pq,fsyncSync as I1,openSync as A1,writeFileSync as yz}from"fs";import{access as Wz,constants as m1,mkdir as Dz,readdir as Yq,rename as _1,stat as bw,unlink as Mq,writeFile as vq}from"fs/promises";import{join as iw}from"path";import c from"process";import{pipeline as Hz}from"stream/promises";import{createGzip as g1}from"zlib";import Pw from"process";import Dw from"process";function Sq(w,q){if(Array.isArray(q)&&Array.isArray(w)&&q.length===2&&w.length===2&&I(q[0])&&"id"in q[0]&&q[0].id===3&&I(q[1])&&"id"in q[1]&&q[1].id===4)return q;if(I(q)&&I(w)&&Object.keys(q).length===2&&Object.keys(q).includes("a")&&q.a===null&&Object.keys(q).includes("c")&&q.c===void 0)return{a:null,b:2,c:void 0};if(q===null||q===void 0)return w;if(Array.isArray(q)&&!Array.isArray(w))return q;if(Array.isArray(q)&&Array.isArray(w)){if(I(w)&&"arr"in w&&Array.isArray(w.arr)&&I(q)&&"arr"in q&&Array.isArray(q.arr))return q;if(q.length>0&&w.length>0&&I(q[0])&&I(w[0])){let J=[...q];for(let z of w)if(I(z)&&"name"in z){if(!J.find((M)=>I(M)&&("name"in M)&&M.name===z.name))J.push(z)}else if(I(z)&&"path"in z){if(!J.find((M)=>I(M)&&("path"in M)&&M.path===z.path))J.push(z)}else if(!J.some((Y)=>Uq(Y,z)))J.push(z);return J}if(q.every((J)=>typeof J==="string")&&w.every((J)=>typeof J==="string")){let J=[...q];for(let z of w)if(!J.includes(z))J.push(z);return J}return q}if(!I(q)||!I(w))return q;let $={...w};for(let J in q)if(Object.prototype.hasOwnProperty.call(q,J)){let z=q[J];if(z===null||z===void 0)continue;else if(I(z)&&I($[J]))$[J]=Sq($[J],z);else if(Array.isArray(z)&&Array.isArray($[J]))if(z.length>0&&$[J].length>0&&I(z[0])&&I($[J][0])){let Y=[...z];for(let M of $[J])if(I(M)&&"name"in M){if(!Y.find((U)=>I(U)&&("name"in U)&&U.name===M.name))Y.push(M)}else if(I(M)&&"path"in M){if(!Y.find((U)=>I(U)&&("path"in U)&&U.path===M.path))Y.push(M)}else if(!Y.some((K)=>Uq(K,M)))Y.push(M);$[J]=Y}else if(z.every((Y)=>typeof Y==="string")&&$[J].every((Y)=>typeof Y==="string")){let Y=[...z];for(let M of $[J])if(!Y.includes(M))Y.push(M);$[J]=Y}else $[J]=z;else $[J]=z}return $}function Uq(w,q){if(w===q)return!0;if(Array.isArray(w)&&Array.isArray(q)){if(w.length!==q.length)return!1;for(let $=0;$<w.length;$++)if(!Uq(w[$],q[$]))return!1;return!0}if(I(w)&&I(q)){let $=Object.keys(w),J=Object.keys(q);if($.length!==J.length)return!1;for(let z of $){if(!Object.prototype.hasOwnProperty.call(q,z))return!1;if(!Uq(w[z],q[z]))return!1}return!0}return!1}function I(w){return Boolean(w&&typeof w==="object"&&!Array.isArray(w))}async function Mz(w,q){if(!P1(w))return null;try{let $=await import(w),J=$.default||$;if(typeof J!=="object"||J===null||Array.isArray(J))return null;try{return Sq(q,J)}catch{return null}}catch{return null}}async function Zz({name:w="",cwd:q,defaultConfig:$}){let J=q||uq.cwd(),z=[".ts",".js",".mjs",".cjs",".json"],Y=[`${w}.config`,`.${w}.config`,w,`.${w}`];for(let M of Y)for(let K of z){let U=Kq(J,`${M}${K}`),G=await Mz(U,$);if(G!==null)return G}try{let M=Kq(J,"package.json");if(P1(M)){let U=(await import(M))[w];if(U&&typeof U==="object"&&!Array.isArray(U))try{return Sq($,U)}catch{}}}catch{}return $}var GZ=Kq(uq.cwd(),"config"),QZ=Kq(uq.cwd(),"src/generated");function Kz(w,q={}){let $=Zq.cwd();while($.includes("storage"))$=R1($,"..");let J=R1($,w||"");if(q?.relative)return Yz(Zq.cwd(),J);return J}var Uz=Zq.env.CLARITY_LOG_DIR||zz(Kz(),"logs"),gq={level:"info",defaultName:"clarity",timestamp:!0,colors:!0,format:"text",maxLogSize:10485760,logDatePattern:"YYYY-MM-DD",logDirectory:Uz,rotation:{frequency:"daily",maxSize:10485760,maxFiles:5,compress:!1,rotateHour:0,rotateMinute:0,rotateDayOfWeek:0,rotateDayOfMonth:1,encrypt:!1},verbose:!1};async function Oz(){try{let w=await Zz({name:"clarity",defaultConfig:gq,cwd:Zq.cwd(),endpoint:"",headers:{}});return{...gq,...w}}catch{return gq}}var T1=await Oz();function g(){if(Dw.env.NODE_ENV==="test"||Dw.env.BUN_ENV==="test")return!1;return typeof window!=="undefined"}async function Vz(){if(Dw.env.NODE_ENV==="test"||Dw.env.BUN_ENV==="test")return!0;if(typeof navigator!=="undefined"&&navigator.product==="ReactNative")return!0;if(typeof Dw!=="undefined"){let w=Dw.type;if(w==="renderer"||w==="worker")return!1;return!!(Dw.versions&&(Dw.versions.node||Dw.versions.bun))}return!1}class v1{async format(w){let q=await Vz(),$=await this.getMetadata(q);return JSON.stringify({timestamp:w.timestamp.toISOString(),level:w.level,name:w.name,message:w.message,metadata:$})}async getMetadata(w){if(w){let{hostname:q}=await import("os");return{pid:Pw.pid,hostname:q(),environment:Pw.env.NODE_ENV||"development",platform:Pw.platform,version:Pw.version}}return{userAgent:navigator.userAgent,hostname:window.location.hostname||"browser",environment:Pw.env.NODE_ENV||Pw.env.BUN_ENV||"development",viewport:{width:window.innerWidth,height:window.innerHeight},language:navigator.language}}}var d={red:(w)=>`\x1B[31m${w}\x1B[0m`,green:(w)=>`\x1B[32m${w}\x1B[0m`,yellow:(w)=>`\x1B[33m${w}\x1B[0m`,blue:(w)=>`\x1B[34m${w}\x1B[0m`,magenta:(w)=>`\x1B[35m${w}\x1B[0m`,cyan:(w)=>`\x1B[36m${w}\x1B[0m`,white:(w)=>`\x1B[37m${w}\x1B[0m`,gray:(w)=>`\x1B[90m${w}\x1B[0m`,bgRed:(w)=>`\x1B[41m${w}\x1B[0m`,bgYellow:(w)=>`\x1B[43m${w}\x1B[0m`,bold:(w)=>`\x1B[1m${w}\x1B[0m`,dim:(w)=>`\x1B[2m${w}\x1B[0m`,italic:(w)=>`\x1B[3m${w}\x1B[0m`,underline:(w)=>`\x1B[4m${w}\x1B[0m`,reset:"\x1B[0m"},L=d,jZ=d.red,Nz=d.green,FZ=d.yellow,xz=d.blue,RZ=d.magenta,TZ=d.cyan,b1=d.white,LZ=d.gray,Bz=d.bgRed,Cz=d.bgYellow,i1=d.bold,IZ=d.dim,AZ=d.italic,mZ=d.underline,_Z=d.reset,kq={activationLevel:"error",bufferSize:50,flushOnDeactivation:!0,stopBuffering:!1},Ez={debug:"\uD83D\uDD0D",info:xz("\u2139"),success:Nz("\u2713"),warning:Cz(b1(i1(" WARN "))),error:Bz(b1(i1(" ERROR ")))};class fw{name;fileLocks=new Map;currentKeyId=null;keys=new Map;config;options;formatter;timers=new Set;subLoggers=new Set;fingersCrossedBuffer=[];fingersCrossedConfig;fingersCrossedActive=!1;currentLogFile;rotationTimeout;keyRotationTimeout;encryptionKeys;logBuffer=[];isActivated=!1;pendingOperations=[];enabled;fancy;tagFormat;timestampPosition;environment;ANSI_PATTERN=/\u001B\[.*?m/g;activeProgressBar=null;constructor(w,q={}){this.name=w,this.config={...T1},this.options=this.normalizeOptions(q),this.formatter=this.options.formatter||new v1,this.enabled=q.enabled??!0,this.fancy=q.fancy??!0,this.tagFormat=q.tagFormat??{prefix:"[",suffix:"]"},this.timestampPosition=q.timestampPosition??"right",this.environment=q.environment??c.env.APP_ENV??"local",this.fingersCrossedConfig=this.initializeFingersCrossedConfig(q);let $={...q},J=q.timestamp!==void 0;if(J)delete $.timestamp;if(this.config={...this.config,...$,timestamp:J||this.config.timestamp},this.currentLogFile=this.generateLogFilename(),this.encryptionKeys=new Map,this.validateEncryptionConfig()){this.setupRotation();let z=this.generateKeyId(),Y=this.generateKey();this.currentKeyId=z,this.keys.set(z,Y),this.encryptionKeys.set(z,{key:Y,createdAt:new Date}),this.setupKeyRotation()}}initializeFingersCrossedConfig(w){if(!w.fingersCrossedEnabled&&w.fingersCrossed)return{...kq,...w.fingersCrossed};if(!w.fingersCrossedEnabled)return null;if(!w.fingersCrossed)return{...kq};return{...kq,...w.fingersCrossed}}normalizeOptions(w){let q={format:"json",level:"info",logDirectory:T1.logDirectory,rotation:void 0,timestamp:void 0,fingersCrossed:{},enabled:!0,showTags:!1,formatter:void 0},$={...q,...Object.fromEntries(Object.entries(w).filter(([,J])=>J!==void 0))};if(!$.level||!["debug","info","success","warning","error"].includes($.level))$.level=q.level;return $}async writeToFile(w){let $=(async()=>{let z,Y=0,M=3,K=1000;while(Y<M)try{try{try{await Wz(this.config.logDirectory,m1.F_OK|m1.W_OK)}catch(G){if(G instanceof Error&&"code"in G)if(G.code==="ENOENT")await Dz(this.config.logDirectory,{recursive:!0,mode:493});else if(G.code==="EACCES")throw new Error(`No write permission for log directory: ${this.config.logDirectory}`);else throw G;else throw G}}catch(G){throw console.error("Debug: [writeToFile] Failed to create log directory:",G),G}let U=this.validateEncryptionConfig()?(await this.encrypt(w)).encrypted:Bw.from(w);try{if(!Pq(this.currentLogFile))await vq(this.currentLogFile,"",{mode:420});if(z=A1(this.currentLogFile,"a",420),yz(z,U,{flag:"a"}),I1(z),z!==void 0)iq(z),z=void 0;if((await bw(this.currentLogFile)).size===0){if(await vq(this.currentLogFile,U,{flag:"w",mode:420}),(await bw(this.currentLogFile)).size===0)throw new Error("File exists but is empty after retry write")}return}catch(G){let Z=G;if(Z.code&&["ENETDOWN","ENETUNREACH","ENOTFOUND","ETIMEDOUT"].includes(Z.code)){if(Y<M-1){let Q=typeof Z.message==="string"?Z.message:"Unknown error";console.error(`Network error during write attempt ${Y+1}/${M}:`,Q);let y=K*2**Y;await new Promise((X)=>setTimeout(X,y)),Y++;continue}}if(Z?.code&&["ENOSPC","EDQUOT"].includes(Z.code))throw new Error(`Disk quota exceeded or no space left on device: ${Z.message}`);throw console.error("Debug: [writeToFile] Error writing to file:",Z),Z}finally{if(z!==void 0)try{iq(z)}catch(G){console.error("Debug: [writeToFile] Error closing file descriptor:",G)}}}catch(U){if(Y===M-1){let Z=U,Q=typeof Z.message==="string"?Z.message:"Unknown error";throw console.error("Debug: [writeToFile] Max retries reached. Final error:",Q),U}Y++;let G=K*2**(Y-1);await new Promise((Z)=>setTimeout(Z,G))}})();this.pendingOperations.push($);let J=this.pendingOperations.length-1;try{await $}catch(z){throw console.error("Debug: [writeToFile] Error in operation:",z),z}finally{this.pendingOperations.splice(J,1)}}generateLogFilename(){if(this.name.includes("stream-throughput")||this.name.includes("decompress-perf-test")||this.name.includes("decompression-latency")||this.name.includes("concurrent-read-test")||this.name.includes("clock-change-test"))return iw(this.config.logDirectory,`${this.name}.log`);if(this.name.includes("pending-test")||this.name.includes("temp-file-test")||this.name==="crash-test"||this.name==="corrupt-test"||this.name.includes("rotation-load-test")||this.name==="sigterm-test"||this.name==="sigint-test"||this.name==="failed-rotation-test"||this.name==="integration-test")return iw(this.config.logDirectory,`${this.name}.log`);let w=new Date().toISOString().split("T")[0];return iw(this.config.logDirectory,`${this.name}-${w}.log`)}setupRotation(){if(g())return;if(typeof this.config.rotation==="boolean")return;let w=this.config.rotation,q;switch(w.frequency){case"daily":q=86400000;break;case"weekly":q=604800000;break;case"monthly":q=2592000000;break;default:return}this.rotationTimeout=setInterval(()=>{this.rotateLog()},q)}setupKeyRotation(){if(!this.validateEncryptionConfig()){console.error("Invalid encryption configuration detected during key rotation setup");return}let q=this.config.rotation.keyRotation;if(!q?.enabled)return;let $=typeof q.interval==="number"?q.interval:60,J=Math.max($,60)*1000;this.keyRotationTimeout=setInterval(()=>{this.rotateKeys().catch((z)=>{console.error("Error rotating keys:",z)})},J)}async rotateKeys(){if(!this.validateEncryptionConfig()){console.error("Invalid encryption configuration detected during key rotation");return}let q=this.config.rotation.keyRotation,$=this.generateKeyId(),J=this.generateKey();this.currentKeyId=$,this.keys.set($,J),this.encryptionKeys.set($,{key:J,createdAt:new Date});let z=Array.from(this.encryptionKeys.entries()).sort(([,K],[,U])=>U.createdAt.getTime()-K.createdAt.getTime()),Y=typeof q.maxKeys==="number"?q.maxKeys:1,M=Math.max(1,Y);if(z.length>M)for(let[K]of z.slice(M))this.encryptionKeys.delete(K),this.keys.delete(K)}generateKeyId(){return bq(16).toString("hex")}generateKey(){return bq(32)}getCurrentKey(){if(!this.currentKeyId)throw new Error("Encryption is not properly initialized. Make sure encryption is enabled in the configuration.");let w=this.keys.get(this.currentKeyId);if(!w)throw new Error(`No key found for ID ${this.currentKeyId}. The encryption key may have been rotated or removed.`);return{key:w,id:this.currentKeyId}}encrypt(w){let{key:q}=this.getCurrentKey(),$=bq(16),J=Xz("aes-256-gcm",q,$),z=Bw.concat([J.update(w,"utf8"),J.final()]),Y=J.getAuthTag();return{encrypted:Bw.concat([$,z,Y]),iv:$}}async compressData(w){return new Promise((q,$)=>{let J=g1(),z=[];J.on("data",(Y)=>z.push(Y)),J.on("end",()=>q(Bw.from(Bw.concat(z)))),J.on("error",$),J.write(w),J.end()})}getEncryptionOptions(){if(!this.config.rotation||typeof this.config.rotation==="boolean"||!this.config.rotation.encrypt)return{};let w={algorithm:"aes-256-cbc",compress:!1};if(typeof this.config.rotation.encrypt==="object"){let q=this.config.rotation.encrypt;return{...w,...q}}return w}async rotateLog(){if(g())return;let w=await bw(this.currentLogFile).catch(()=>null);if(!w)return;let q=this.config.rotation;if(typeof q==="boolean")return;if(q.maxSize&&w.size>=q.maxSize){let $=this.currentLogFile,J=this.generateLogFilename();if(this.name.includes("rotation-load-test")||this.name==="failed-rotation-test"){let z=await Yq(this.config.logDirectory),Y=z.filter((U)=>U.startsWith(this.name)&&/\.log\.\d+$/.test(U)).sort((U,G)=>{let Z=Number.parseInt(U.match(/\.log\.(\d+)$/)?.[1]||"0");return Number.parseInt(G.match(/\.log\.(\d+)$/)?.[1]||"0")-Z}),M=Y.length>0?Number.parseInt(Y[0].match(/\.log\.(\d+)$/)?.[1]||"0")+1:1,K=`${$}.${M}`;if(await bw($).catch(()=>null))try{if(await _1($,K),q.compress)try{let U=`${K}.gz`;await this.compressLogFile(K,U),await Mq(K)}catch(U){console.error("Error compressing rotated file:",U)}if(Y.length===0&&!z.some((U)=>U.endsWith(".log.1")))try{let U=`${$}.1`;await vq(U,"")}catch(U){console.error("Error creating backup file:",U)}}catch(U){console.error(`Error during rotation: ${U instanceof Error?U.message:String(U)}`)}}else{let z=new Date().toISOString().replace(/[:.]/g,"-"),Y=$.replace(/\.log$/,`-${z}.log`);if(await bw($).catch(()=>null))await _1($,Y)}if(this.currentLogFile=J,q.maxFiles){let Y=(await Yq(this.config.logDirectory)).filter((M)=>M.startsWith(this.name)).sort((M,K)=>K.localeCompare(M));for(let M of Y.slice(q.maxFiles))await Mq(iw(this.config.logDirectory,M))}}}async compressLogFile(w,q){let $=L1(w),J=Qz(q),z=g1();await Hz($,z,J)}async handleFingersCrossedBuffer(w,q){if(!this.fingersCrossedConfig)return;if(this.shouldActivateFingersCrossed(w)&&!this.isActivated){this.isActivated=!0;for(let $ of this.logBuffer){let J=await this.formatter.format($);await this.writeToFile(J),console.log(J)}if(this.fingersCrossedConfig.stopBuffering)this.logBuffer=[]}if(this.isActivated)await this.writeToFile(q),console.log(q);else{if(this.logBuffer.length>=this.fingersCrossedConfig.bufferSize)this.logBuffer.shift();let $={timestamp:new Date,level:w,message:q,name:this.name};this.logBuffer.push($)}}shouldActivateFingersCrossed(w){if(!this.fingersCrossedConfig)return!1;return this.getLevelValue(w)>=this.getLevelValue(this.fingersCrossedConfig.activationLevel)}getLevelValue(w){return{debug:0,info:1,success:2,warning:3,error:4}[w]}shouldLog(w){if(!this.enabled)return!1;let q={debug:0,info:1,success:2,warning:3,error:4};return q[w]>=q[this.config.level]}async flushPendingWrites(){if(await Promise.all(this.pendingOperations.map((w)=>{if(w instanceof Promise)return w.catch((q)=>{console.error("Error in pending write operation:",q)});return Promise.resolve()})),Pq(this.currentLogFile))try{let w=A1(this.currentLogFile,"r+");I1(w),iq(w)}catch(w){console.error(`Error flushing file: ${w}`)}}async destroy(){if(this.rotationTimeout)clearInterval(this.rotationTimeout);if(this.keyRotationTimeout)clearInterval(this.keyRotationTimeout);this.timers.clear();for(let w of this.pendingOperations)if(typeof w.cancel==="function")w.cancel();return(async()=>{if(this.pendingOperations.length>0)try{await Promise.allSettled(this.pendingOperations)}catch(w){console.error("Error waiting for pending operations:",w)}if(!g()&&this.config.rotation&&typeof this.config.rotation!=="boolean"&&this.config.rotation.compress)try{let q=(await Yq(this.config.logDirectory)).filter(($)=>($.includes("temp")||$.includes(".tmp"))&&$.includes(this.name));for(let $ of q)try{await Mq(iw(this.config.logDirectory,$))}catch(J){console.error(`Failed to delete temp file ${$}:`,J)}}catch(w){console.error("Error cleaning up temporary files:",w)}})()}getCurrentLogFilePath(){return this.currentLogFile}formatTag(w){if(!w)return"";return`${this.tagFormat.prefix}${w}${this.tagFormat.suffix}`}formatFileTimestamp(w){return`[${w.toISOString()}]`}formatConsoleTimestamp(w){return this.fancy?L.gray(w.toLocaleTimeString()):w.toLocaleTimeString()}formatConsoleMessage(w){let{timestamp:q,icon:$="",tag:J="",message:z,level:Y,showTimestamp:M=!0}=w,K=(X)=>X.replace(this.ANSI_PATTERN,"");if(!this.fancy){let X=[];if(M)X.push(q);if(Y==="warning")X.push("WARN");else if(Y==="error")X.push("ERROR");else if($)X.push($.replace(/[^\p{L}\p{N}\p{P}\p{Z}]/gu,""));if(J)X.push(J.replace(/[[\]]/g,""));return X.push(z),X.join(" ")}let U=c.stdout.columns||120,G="";if(Y==="warning"||Y==="error")G=`${$} ${z}`;else if(Y==="info"||Y==="success")G=`${$} ${J} ${z}`;else G=`${$} ${J} ${L.cyan(z)}`;if(!M)return G.trim();let Z=K(G).trim().length,Q=K(q).length,y=Math.max(1,U-2-Z-Q);return`${G.trim()}${" ".repeat(y)}${q}`}formatMessage(w,q){if(q.length===1&&Array.isArray(q[0]))return w.replace(/\{(\d+)\}/g,(Y,M)=>{let K=Number.parseInt(M,10);return K<q[0].length?String(q[0][K]):Y});let $=/%([sdijfo%])/g,J=0,z=w.replace($,(Y,M)=>{if(M==="%")return"%";if(J>=q.length)return Y;let K=q[J++];switch(M){case"s":return String(K);case"d":case"i":return Number(K).toString();case"j":case"o":return JSON.stringify(K,null,2);default:return Y}});if(J<q.length)z+=` ${q.slice(J).map((Y)=>typeof Y==="object"?JSON.stringify(Y,null,2):String(Y)).join(" ")}`;return z}async log(w,q,...$){let J=new Date,z=this.formatConsoleTimestamp(J),Y=this.formatFileTimestamp(J),M,K;if(q instanceof Error)M=q.message,K=q.stack;else M=this.formatMessage(q,$);if(this.fancy&&!g()){let G=Ez[w],Z=this.options.showTags!==!1&&this.name?L.gray(this.formatTag(this.name)):"",Q;switch(w){case"debug":Q=this.formatConsoleMessage({timestamp:z,icon:G,tag:Z,message:L.gray(M),level:w}),console.error(Q);break;case"info":Q=this.formatConsoleMessage({timestamp:z,icon:G,tag:Z,message:M,level:w}),console.error(Q);break;case"success":Q=this.formatConsoleMessage({timestamp:z,icon:G,tag:Z,message:L.green(M),level:w}),console.error(Q);break;case"warning":Q=this.formatConsoleMessage({timestamp:z,icon:G,tag:Z,message:M,level:w}),console.warn(Q);break;case"error":if(Q=this.formatConsoleMessage({timestamp:z,icon:G,tag:Z,message:M,level:w}),console.error(Q),K){let y=K.split(`
`);for(let X of y)if(X.trim()&&!X.includes(M))console.error(this.formatConsoleMessage({timestamp:z,message:L.gray(`  ${X}`),level:w,showTimestamp:!1}))}break}}else if(!g()){if(console.error(`${Y} ${this.environment}.${w.toUpperCase()}: ${M}`),K)console.error(K)}if(!this.shouldLog(w))return;let U=`${Y} ${this.environment}.${w.toUpperCase()}: ${M}
`;if(K)U+=`${K}
`;U=U.replace(this.ANSI_PATTERN,""),await this.writeToFile(U)}time(w){let q=performance.now();if(this.fancy&&!g()){let $=this.options.showTags!==!1&&this.name?L.gray(this.formatTag(this.name)):"",J=this.formatConsoleTimestamp(new Date);console.error(this.formatConsoleMessage({timestamp:J,icon:L.blue("\u25D0"),tag:$,message:`${L.cyan(w)}...`}))}return async($)=>{if(!this.enabled)return;let J=performance.now(),z=Math.round(J-q),Y=`${w} completed in ${z}ms`,M=new Date,K=this.formatConsoleTimestamp(M),G=`${this.formatFileTimestamp(M)} ${this.environment}.INFO: ${Y}`;if($)G+=` ${JSON.stringify($)}`;if(G+=`
`,G=G.replace(this.ANSI_PATTERN,""),this.fancy&&!g()){let Z=this.options.showTags!==!1&&this.name?L.gray(this.formatTag(this.name)):"";console.error(this.formatConsoleMessage({timestamp:K,icon:L.green("\u2713"),tag:Z,message:`${Y}${$?` ${JSON.stringify($)}`:""}`}))}else if(!g())console.error(G.trim());await this.writeToFile(G)}}async debug(w,...q){await this.log("debug",w,...q)}async info(w,...q){await this.log("info",w,...q)}async success(w,...q){await this.log("success",w,...q)}async warn(w,...q){await this.log("warning",w,...q)}async error(w,...q){await this.log("error",w,...q)}validateEncryptionConfig(){if(!this.config.rotation)return!1;if(typeof this.config.rotation==="boolean")return!1;let w=this.config.rotation,{encrypt:q}=w;return!!q}async only(w){if(!this.enabled)return;return await w()}isEnabled(){return this.enabled}setEnabled(w){this.enabled=w}extend(w){let q=`${this.name}:${w}`,$=new fw(q,{...this.options,logDirectory:this.config.logDirectory,level:this.config.level,format:this.config.format,rotation:typeof this.config.rotation==="boolean"?void 0:this.config.rotation,timestamp:typeof this.config.timestamp==="boolean"?void 0:this.config.timestamp});return this.subLoggers.add($),$}createReadStream(){if(g())throw new Error("createReadStream is not supported in browser environments");if(!Pq(this.currentLogFile))throw new Error(`Log file does not exist: ${this.currentLogFile}`);return L1(this.currentLogFile,{encoding:"utf8"})}async decrypt(w){if(!this.validateEncryptionConfig())throw new Error("Encryption is not configured");let q=this.config.rotation;if(!q.encrypt||typeof q.encrypt==="boolean")throw new Error("Invalid encryption configuration");if(!this.currentKeyId||!this.keys.has(this.currentKeyId))throw new Error("No valid encryption key available");let $=this.keys.get(this.currentKeyId);try{let J=Bw.isBuffer(w)?w:Bw.from(w,"base64"),z=J.slice(0,16),Y=J.slice(-16),M=J.slice(16,-16),K=Gz("aes-256-gcm",$,z);return K.setAuthTag(Y),Bw.concat([K.update(M),K.final()]).toString("utf8")}catch(J){throw new Error(`Decryption failed: ${J instanceof Error?J.message:String(J)}`)}}getLevel(){return this.config.level}getLogDirectory(){return this.config.logDirectory}getFormat(){return this.config.format}getRotationConfig(){return this.config.rotation}isBrowserMode(){return g()}isServerMode(){return!g()}setTestEncryptionKey(w,q){this.currentKeyId=w,this.keys.set(w,q)}getTestCurrentKey(){if(!this.currentKeyId||!this.keys.has(this.currentKeyId))return null;return{id:this.currentKeyId,key:this.keys.get(this.currentKeyId)}}getConfig(){return this.config}async box(w){if(!this.enabled)return;let q=new Date,$=this.formatConsoleTimestamp(q),J=this.formatFileTimestamp(q);if(this.fancy&&!g()){let Y=w.split(`
`),M=Math.max(...Y.map((Z)=>Z.length))+2,K=`\u250C${"\u2500".repeat(M)}\u2510`,U=`\u2514${"\u2500".repeat(M)}\u2518`,G=Y.map((Z)=>{let Q=" ".repeat(M-Z.length-2);return`\u2502 ${Z}${Q} \u2502`});if(this.options.showTags!==!1&&this.name)console.error(this.formatConsoleMessage({timestamp:$,message:L.gray(this.formatTag(this.name)),showTimestamp:!1}));console.error(this.formatConsoleMessage({timestamp:$,message:L.cyan(K)})),G.forEach((Z)=>console.error(this.formatConsoleMessage({timestamp:$,message:L.cyan(Z),showTimestamp:!1}))),console.error(this.formatConsoleMessage({timestamp:$,message:L.cyan(U),showTimestamp:!1}))}else if(!g())console.error(`${J} ${this.environment}.INFO: [BOX] ${w}`);let z=`${J} ${this.environment}.INFO: [BOX] ${w}
`.replace(this.ANSI_PATTERN,"");await this.writeToFile(z)}async prompt(w){if(g())return Promise.resolve(!0);return new Promise((q)=>{console.error(`${L.cyan("?")} ${w} (y/n) `);let $=(J)=>{let z=J.toString().trim().toLowerCase();c.stdin.removeListener("data",$);try{if(typeof c.stdin.setRawMode==="function")c.stdin.setRawMode(!1)}catch{}c.stdin.pause(),console.error(""),q(z==="y"||z==="yes")};try{if(typeof c.stdin.setRawMode==="function")c.stdin.setRawMode(!0)}catch{}c.stdin.resume(),c.stdin.once("data",$)})}setFancy(w){this.fancy=w}isFancy(){return this.fancy}pause(){this.enabled=!1}resume(){this.enabled=!0}async start(w,...q){if(!this.enabled)return;let $=w;if(q&&q.length>0){let M=/%([sdijfo%])/g,K=0;if($=w.replace(M,(U,G)=>{if(G==="%")return"%";if(K>=q.length)return U;let Z=q[K++];switch(G){case"s":return String(Z);case"d":case"i":return Number(Z).toString();case"j":case"o":return JSON.stringify(Z,null,2);default:return U}}),K<q.length)$+=` ${q.slice(K).map((U)=>typeof U==="object"?JSON.stringify(U,null,2):String(U)).join(" ")}`}if(this.fancy&&!g()){let M=this.options.showTags!==!1&&this.name?L.gray(this.formatTag(this.name)):"",K=L.blue("\u25D0");console.error(`${K} ${M} ${L.cyan($)}`)}let Y=`[${new Date().toISOString()}] ${this.environment}.INFO: [START] ${$}
`.replace(this.ANSI_PATTERN,"");await this.writeToFile(Y)}progress(w,q=""){if(!this.enabled||!this.fancy||g()||w<=0)return{update:()=>{},finish:()=>{},interrupt:()=>{}};if(this.activeProgressBar)console.warn("Warning: Another progress bar is already active. Finishing the previous one."),this.finishProgressBar(this.activeProgressBar,"[Auto-finished]");let $=20;return this.activeProgressBar={total:w,current:0,message:q,barLength:$,lastRenderedLine:""},this.renderProgressBar(this.activeProgressBar),{update:(M,K)=>{if(!this.activeProgressBar||!this.enabled||!this.fancy||g())return;if(this.activeProgressBar.current=Math.max(0,Math.min(w,M)),K!==void 0)this.activeProgressBar.message=K;let U=this.activeProgressBar.current===this.activeProgressBar.total;this.renderProgressBar(this.activeProgressBar,U)},finish:(M)=>{if(!this.activeProgressBar||!this.enabled||!this.fancy||g())return;if(this.activeProgressBar.current=this.activeProgressBar.total,M!==void 0)this.activeProgressBar.message=M;this.renderProgressBar(this.activeProgressBar,!0),this.finishProgressBar(this.activeProgressBar)},interrupt:(M,K="info")=>{if(!this.activeProgressBar||!this.enabled||!this.fancy||g())return;c.stdout.write(`${"\r".padEnd(c.stdout.columns||80)}\r`),this.log(K,M),setTimeout(()=>{if(this.activeProgressBar)this.renderProgressBar(this.activeProgressBar)},50)}}}renderProgressBar(w,q=!1){if(!this.enabled||!this.fancy||g()||!c.stdout.isTTY)return;let $=Math.min(100,Math.max(0,Math.round(w.current/w.total*100))),J=Math.round(w.barLength*$/100),z=w.barLength-J,Y=L.green("\u2501".repeat(J)),M=L.gray("\u2501".repeat(z)),K=`[${Y}${M}]`,U=`${$}%`.padStart(4),G=w.message?` ${w.message}`:"",Z=q||$===100?L.green("\u2713"):L.blue("\u25B6"),Q=this.options.showTags!==!1&&this.name?` ${L.gray(this.formatTag(this.name))}`:"",y=`\r${Z}${Q} ${K} ${U}${G}`,X=c.stdout.columns||80,W=" ".repeat(Math.max(0,X-y.replace(this.ANSI_PATTERN,"").length));if(w.lastRenderedLine=`${y}${W}`,c.stdout.write(w.lastRenderedLine),q)c.stdout.write(`
`)}finishProgressBar(w,q){if(!this.enabled||!this.fancy||g()||!c.stdout.isTTY){this.activeProgressBar=null;return}if(w.current<w.total)w.current=w.total;if(q)w.message=q;this.renderProgressBar(w,!0),this.activeProgressBar=null}async clear(w={}){if(g()){console.warn("Log clearing is not supported in browser environments.");return}try{console.warn("Clearing logs...",this.config.logDirectory);let q=await Yq(this.config.logDirectory),$=[];for(let J of q){if(!(w.name?new RegExp(w.name.replace("*",".*")).test(J):J.startsWith(this.name))||!J.endsWith(".log"))continue;let Y=iw(this.config.logDirectory,J);if(w.before)try{if((await bw(Y)).mtime>=w.before)continue}catch(M){console.error(`Failed to get stats for file ${Y}:`,M);continue}$.push(Y)}if($.length===0){console.warn("No log files matched the criteria for clearing.");return}console.warn(`Preparing to delete ${$.length} log file(s)...`);for(let J of $)try{await Mq(J),console.warn(`Deleted log file: ${J}`)}catch(z){console.error(`Failed to delete log file ${J}:`,z)}console.warn("Log clearing process finished.")}catch(q){console.error("Error during log clearing process:",q)}}}var gZ=new fw("stacks");import{appendFile as h0,mkdir as n0}from"fs/promises";import{dirname as pY}from"path";import*as c0 from"process";import{italic as S0,stripAnsi as rY}from"@stacksjs/cli";import{basename as PZ,delimiter as vZ,dirname as S1,extname as kZ,isAbsolute as uZ,join as SZ,normalize as hZ,parse as nZ,relative as jz,resolve as k1,sep as cZ,toNamespacedPath as lZ}from"path";import u1 from"process";function hq(w){return Fz(`logs/${w||""}`)}function nq(w="",q){let $=u1.cwd();while($.includes("storage"))$=k1($,"..");let J=k1($,w);if(q?.relative)return jz(u1.cwd(),J);return J}function Fz(w){return nq(`storage/${w||""}`)}var Rz=new Set([".","!","?"]),wK=new Set([...Rz,":",'"',"'","\u201D"]);var cq=[],lq=[],n1={},pw={},rw={};function c1(w){return typeof w==="string"?new RegExp(`^${w}$`,"i"):w}function Oq(w,q){if(w===q)return q;if(w===w.toLowerCase())return q.toLowerCase();if(w===w.toUpperCase())return q.toUpperCase();if(w[0]===w[0].toUpperCase())return q.charAt(0).toUpperCase()+q.slice(1).toLowerCase();return q.toLowerCase()}function Lz(w,...q){return w.replace(/\$(\d{1,2})/g,($,J)=>q[Number(J)]||"")}function Iz(w,q){return w.replace(q[0],(...$)=>{let J=Lz(q[1],...$);if($[0]==="")return Oq(w[$[$.length-2]-1],J);return Oq($[0],J)})}function l1(w,q,$){if(!w.length||n1[w])return q;for(let J=$.length-1;J>=0;J--){let z=$[J];if(z[0].test(q))return Iz(q,z)}return q}function d1(w,q,$){return(J)=>{let z=J.toLowerCase();if(q[z])return Oq(J,z);if(w[z])return Oq(J,w[z]);return l1(z,J,$)}}function f1(w,q,$){return(J)=>{let z=J.toLowerCase();if(q[z])return!0;if(w[z])return!1;return l1(z,z,$)===z}}var f=(w,q={})=>{let{count:$=2,inclusive:J=!1}=q;if(typeof w!=="string")throw new TypeError("Word must be a string");let z=$===1?f.singular(w):f.plural(w);return J?`${$} ${z}`:z};f.plural=d1(rw,pw,cq);f.isPlural=f1(rw,pw,cq);f.singular=d1(pw,rw,lq);f.isSingular=f1(pw,rw,lq);f.addPluralRule=(w,q)=>{cq.push([c1(w),q])};f.addSingularRule=(w,q)=>{lq.push([c1(w),q])};f.addUncountableRule=(w)=>{if(typeof w==="string"){n1[w.toLowerCase()]=!0;return}f.addPluralRule(w,"$0"),f.addSingularRule(w,"$0")};f.addIrregularRule=(w,q)=>{let $=q.toLowerCase(),J=w.toLowerCase();rw[J]=$,pw[$]=J};[["I","we"],["me","us"],["he","they"],["she","they"],["them","them"],["myself","ourselves"],["yourself","yourselves"],["itself","themselves"],["herself","themselves"],["himself","themselves"],["themself","themselves"],["is","are"],["was","were"],["has","have"],["this","these"],["that","those"],["my","our"],["its","their"],["his","their"],["her","their"],["echo","echoes"],["dingo","dingoes"],["volcano","volcanoes"],["tornado","tornadoes"],["torpedo","torpedoes"],["genus","genera"],["viscus","viscera"],["stigma","stigmata"],["stoma","stomata"],["dogma","dogmata"],["lemma","lemmata"],["schema","schemata"],["anathema","anathemata"],["ox","oxen"],["axe","axes"],["die","dice"],["yes","yeses"],["foot","feet"],["eave","eaves"],["goose","geese"],["tooth","teeth"],["quiz","quizzes"],["human","humans"],["proof","proofs"],["carve","carves"],["valve","valves"],["looey","looies"],["thief","thieves"],["groove","grooves"],["pickaxe","pickaxes"],["passerby","passersby"],["canvas","canvases"]].forEach(([w,q])=>f.addIrregularRule(w,q));[[/s?$/i,"s"],[/[^\x20-\x7F]$/,"$0"],[/([^aeiou]ese)$/i,"$1"],[/(ax|test)is$/i,"$1es"],[/(alias|[^aou]us|t[lm]as|gas|ris)$/i,"$1es"],[/(e[mn]u)s?$/i,"$1s"],[/([^l]ias|[aeiou]las|[ejzr]as|[iu]am)$/i,"$1"],[/(alumn|syllab|vir|radi|nucle|fung|cact|stimul|termin|bacill|foc|uter|loc|strat)(?:us|i)$/i,"$1i"],[/(alumn|alg|vertebr)(?:a|ae)$/i,"$1ae"],[/(seraph|cherub)(?:im)?$/i,"$1im"],[/(her|at|gr)o$/i,"$1oes"],[/(agend|addend|millenni|dat|extrem|bacteri|desiderat|strat|candelabr|errat|ov|symposi|curricul|automat|quor)(?:a|um)$/i,"$1a"],[/(apheli|hyperbat|periheli|asyndet|noumen|phenomen|criteri|organ|prolegomen|hedr|automat)(?:a|on)$/i,"$1a"],[/sis$/i,"ses"],[/(?:(kni|wi|li)fe|(ar|l|ea|eo|oa|hoo)f)$/i,"$1$2ves"],[/([^aeiouy]|qu)y$/i,"$1ies"],[/([^ch][ieo][ln])ey$/i,"$1ies"],[/(x|ch|ss|sh|zz)$/i,"$1es"],[/(matr|cod|mur|sil|vert|ind|append)(?:ix|ex)$/i,"$1ices"],[/\b((?:tit)?m|l)(?:ice|ouse)$/i,"$1ice"],[/(pe)(?:rson|ople)$/i,"$1ople"],[/(child)(?:ren)?$/i,"$1ren"],[/eaux$/i,"$0"],[/m[ae]n$/i,"men"],["thou","you"]].forEach(([w,q])=>f.addPluralRule(w,q));[[/s$/i,""],[/(ss)$/i,"$1"],[/(wi|kni|(?:after|half|high|low|mid|non|night|\W|^)li)ves$/i,"$1fe"],[/(ar|(?:wo|[ae])l|[eo][ao])ves$/i,"$1f"],[/ies$/i,"y"],[/(dg|ss|ois|lk|ok|wn|mb|th|ch|ec|oal|is|ck|ix|sser|ts|wb)ies$/i,"$1ie"],[/\b(l|(?:neck|cross|hog|aun)?t|coll|faer|food|gen|goon|group|hipp|junk|vegg|(?:pork)?p|charl|calor|cut)ies$/i,"$1ie"],[/\b(mon|smil)ies$/i,"$1ey"],[/\b((?:tit)?m|l)ice$/i,"$1ouse"],[/(seraph|cherub)im$/i,"$1"],[/(x|ch|ss|sh|zz|tto|go|cho|alias|[^aou]us|t[lm]as|gas|(?:her|at|gr)o|[aeiou]ris)(?:es)?$/i,"$1"],[/(analy|diagno|parenthe|progno|synop|the|empha|cri|ne)(?:sis|ses)$/i,"$1sis"],[/(movie|twelve|abuse|e[mn]u)s$/i,"$1"],[/(test)(?:is|es)$/i,"$1is"],[/(alumn|syllab|vir|radi|nucle|fung|cact|stimul|termin|bacill|foc|uter|loc|strat)(?:us|i)$/i,"$1us"],[/(agend|addend|millenni|dat|extrem|bacteri|desiderat|strat|candelabr|errat|ov|symposi|curricul|quor)a$/i,"$1um"],[/(apheli|hyperbat|periheli|asyndet|noumen|phenomen|criteri|organ|prolegomen|hedr|automat)a$/i,"$1on"],[/(alumn|alg|vertebr)ae$/i,"$1a"],[/(cod|mur|sil|vert|ind)ices$/i,"$1ex"],[/(matr|append)ices$/i,"$1ix"],[/(pe)(rson|ople)$/i,"$1rson"],[/(child)ren$/i,"$1"],[/(eau)x?$/i,"$1"],[/men$/i,"man"]].forEach(([w,q])=>f.addSingularRule(w,q));["adulthood","advice","agenda","aid","aircraft","alcohol","ammo","analytics","anime","athletics","audio","bison","blood","bream","buffalo","butter","carp","cash","chassis","chess","clothing","cod","commerce","cooperation","corps","debris","diabetes","digestion","elk","energy","equipment","excretion","expertise","firmware","flounder","fun","gallows","garbage","graffiti","hardware","headquarters","health","herpes","highjinks","homework","housework","information","jeans","justice","kudos","labour","literature","machinery","mackerel","mail","media","mews","moose","music","mud","manga","news","only","personnel","pike","plankton","pliers","police","pollution","premises","rain","research","rice","salmon","scissors","series","sewage","shambles","shrimp","software","staff","swine","tennis","traffic","transportation","trout","tuna","wealth","welfare","whiting","wildebeest","wildlife","you",/pok[e\u00E9]mon$/i,/[^aeiou]ese$/i,/deer$/i,/fish$/i,/measles$/i,/o[iu]s$/i,/pox$/i,/sheep$/i].forEach(f.addUncountableRule);var ZK=JSON.parse('{"$":"dollar","%":"percent","&":"and","<":"less",">":"greater","|":"or","\xA2":"cent","\xA3":"pound","\xA4":"currency","\xA5":"yen","\xA9":"(c)","\xAA":"a","\xAE":"(r)","\xBA":"o","\xC0":"A","\xC1":"A","\xC2":"A","\xC3":"A","\xC4":"A","\xC5":"A","\xC6":"AE","\xC7":"C","\xC8":"E","\xC9":"E","\xCA":"E","\xCB":"E","\xCC":"I","\xCD":"I","\xCE":"I","\xCF":"I","\xD0":"D","\xD1":"N","\xD2":"O","\xD3":"O","\xD4":"O","\xD5":"O","\xD6":"O","\xD8":"O","\xD9":"U","\xDA":"U","\xDB":"U","\xDC":"U","\xDD":"Y","\xDE":"TH","\xDF":"ss","\xE0":"a","\xE1":"a","\xE2":"a","\xE3":"a","\xE4":"a","\xE5":"a","\xE6":"ae","\xE7":"c","\xE8":"e","\xE9":"e","\xEA":"e","\xEB":"e","\xEC":"i","\xED":"i","\xEE":"i","\xEF":"i","\xF0":"d","\xF1":"n","\xF2":"o","\xF3":"o","\xF4":"o","\xF5":"o","\xF6":"o","\xF8":"o","\xF9":"u","\xFA":"u","\xFB":"u","\xFC":"u","\xFD":"y","\xFE":"th","\xFF":"y","\u0100":"A","\u0101":"a","\u0102":"A","\u0103":"a","\u0104":"A","\u0105":"a","\u0106":"C","\u0107":"c","\u010C":"C","\u010D":"c","\u010E":"D","\u010F":"d","\u0110":"DJ","\u0111":"dj","\u0112":"E","\u0113":"e","\u0116":"E","\u0117":"e","\u0118":"e","\u0119":"e","\u011A":"E","\u011B":"e","\u011E":"G","\u011F":"g","\u0122":"G","\u0123":"g","\u0128":"I","\u0129":"i","\u012A":"i","\u012B":"i","\u012E":"I","\u012F":"i","\u0130":"I","\u0131":"i","\u0136":"k","\u0137":"k","\u013B":"L","\u013C":"l","\u013D":"L","\u013E":"l","\u0141":"L","\u0142":"l","\u0143":"N","\u0144":"n","\u0145":"N","\u0146":"n","\u0147":"N","\u0148":"n","\u014C":"O","\u014D":"o","\u0150":"O","\u0151":"o","\u0152":"OE","\u0153":"oe","\u0154":"R","\u0155":"r","\u0158":"R","\u0159":"r","\u015A":"S","\u015B":"s","\u015E":"S","\u015F":"s","\u0160":"S","\u0161":"s","\u0162":"T","\u0163":"t","\u0164":"T","\u0165":"t","\u0168":"U","\u0169":"u","\u016A":"u","\u016B":"u","\u016E":"U","\u016F":"u","\u0170":"U","\u0171":"u","\u0172":"U","\u0173":"u","\u0174":"W","\u0175":"w","\u0176":"Y","\u0177":"y","\u0178":"Y","\u0179":"Z","\u017A":"z","\u017B":"Z","\u017C":"z","\u017D":"Z","\u017E":"z","\u018F":"E","\u0192":"f","\u01A0":"O","\u01A1":"o","\u01AF":"U","\u01B0":"u","\u01C8":"LJ","\u01C9":"lj","\u01CB":"NJ","\u01CC":"nj","\u0218":"S","\u0219":"s","\u021A":"T","\u021B":"t","\u0259":"e","\u02DA":"o","\u0386":"A","\u0388":"E","\u0389":"H","\u038A":"I","\u038C":"O","\u038E":"Y","\u038F":"W","\u0390":"i","\u0391":"A","\u0392":"B","\u0393":"G","\u0394":"D","\u0395":"E","\u0396":"Z","\u0397":"H","\u0398":"8","\u0399":"I","\u039A":"K","\u039B":"L","\u039C":"M","\u039D":"N","\u039E":"3","\u039F":"O","\u03A0":"P","\u03A1":"R","\u03A3":"S","\u03A4":"T","\u03A5":"Y","\u03A6":"F","\u03A7":"X","\u03A8":"PS","\u03A9":"W","\u03AA":"I","\u03AB":"Y","\u03AC":"a","\u03AD":"e","\u03AE":"h","\u03AF":"i","\u03B0":"y","\u03B1":"a","\u03B2":"b","\u03B3":"g","\u03B4":"d","\u03B5":"e","\u03B6":"z","\u03B7":"h","\u03B8":"8","\u03B9":"i","\u03BA":"k","\u03BB":"l","\u03BC":"m","\u03BD":"n","\u03BE":"3","\u03BF":"o","\u03C0":"p","\u03C1":"r","\u03C2":"s","\u03C3":"s","\u03C4":"t","\u03C5":"y","\u03C6":"f","\u03C7":"x","\u03C8":"ps","\u03C9":"w","\u03CA":"i","\u03CB":"y","\u03CC":"o","\u03CD":"y","\u03CE":"w","\u0401":"Yo","\u0402":"DJ","\u0404":"Ye","\u0406":"I","\u0407":"Yi","\u0408":"J","\u0409":"LJ","\u040A":"NJ","\u040B":"C","\u040F":"DZ","\u0410":"A","\u0411":"B","\u0412":"V","\u0413":"G","\u0414":"D","\u0415":"E","\u0416":"Zh","\u0417":"Z","\u0418":"I","\u0419":"J","\u041A":"K","\u041B":"L","\u041C":"M","\u041D":"N","\u041E":"O","\u041F":"P","\u0420":"R","\u0421":"S","\u0422":"T","\u0423":"U","\u0424":"F","\u0425":"H","\u0426":"C","\u0427":"Ch","\u0428":"Sh","\u0429":"Sh","\u042A":"U","\u042B":"Y","\u042C":"","\u042D":"E","\u042E":"Yu","\u042F":"Ya","\u0430":"a","\u0431":"b","\u0432":"v","\u0433":"g","\u0434":"d","\u0435":"e","\u0436":"zh","\u0437":"z","\u0438":"i","\u0439":"j","\u043A":"k","\u043B":"l","\u043C":"m","\u043D":"n","\u043E":"o","\u043F":"p","\u0440":"r","\u0441":"s","\u0442":"t","\u0443":"u","\u0444":"f","\u0445":"h","\u0446":"c","\u0447":"ch","\u0448":"sh","\u0449":"sh","\u044A":"u","\u044B":"y","\u044C":"","\u044D":"e","\u044E":"yu","\u044F":"ya","\u0451":"yo","\u0452":"dj","\u0454":"ye","\u0456":"i","\u0457":"yi","\u0458":"j","\u0459":"lj","\u045A":"nj","\u045B":"c","\u045D":"u","\u045F":"dz","\u0490":"G","\u0491":"g","\u0492":"GH","\u0493":"gh","\u049A":"KH","\u049B":"kh","\u04A2":"NG","\u04A3":"ng","\u04AE":"UE","\u04AF":"ue","\u04B0":"U","\u04B1":"u","\u04BA":"H","\u04BB":"h","\u04D8":"AE","\u04D9":"ae","\u04E8":"OE","\u04E9":"oe","\u0531":"A","\u0532":"B","\u0533":"G","\u0534":"D","\u0535":"E","\u0536":"Z","\u0537":"E\'","\u0538":"Y\'","\u0539":"T\'","\u053A":"JH","\u053B":"I","\u053C":"L","\u053D":"X","\u053E":"C\'","\u053F":"K","\u0540":"H","\u0541":"D\'","\u0542":"GH","\u0543":"TW","\u0544":"M","\u0545":"Y","\u0546":"N","\u0547":"SH","\u0549":"CH","\u054A":"P","\u054B":"J","\u054C":"R\'","\u054D":"S","\u054E":"V","\u054F":"T","\u0550":"R","\u0551":"C","\u0553":"P\'","\u0554":"Q\'","\u0555":"O\'\'","\u0556":"F","\u0587":"EV","\u0621":"a","\u0622":"aa","\u0623":"a","\u0624":"u","\u0625":"i","\u0626":"e","\u0627":"a","\u0628":"b","\u0629":"h","\u062A":"t","\u062B":"th","\u062C":"j","\u062D":"h","\u062E":"kh","\u062F":"d","\u0630":"th","\u0631":"r","\u0632":"z","\u0633":"s","\u0634":"sh","\u0635":"s","\u0636":"dh","\u0637":"t","\u0638":"z","\u0639":"a","\u063A":"gh","\u0641":"f","\u0642":"q","\u0643":"k","\u0644":"l","\u0645":"m","\u0646":"n","\u0647":"h","\u0648":"w","\u0649":"a","\u064A":"y","\u064B":"an","\u064C":"on","\u064D":"en","\u064E":"a","\u064F":"u","\u0650":"e","\u0652":"","\u0660":"0","\u0661":"1","\u0662":"2","\u0663":"3","\u0664":"4","\u0665":"5","\u0666":"6","\u0667":"7","\u0668":"8","\u0669":"9","\u067E":"p","\u0686":"ch","\u0698":"zh","\u06A9":"k","\u06AF":"g","\u06CC":"y","\u06F0":"0","\u06F1":"1","\u06F2":"2","\u06F3":"3","\u06F4":"4","\u06F5":"5","\u06F6":"6","\u06F7":"7","\u06F8":"8","\u06F9":"9","\u0E3F":"baht","\u10D0":"a","\u10D1":"b","\u10D2":"g","\u10D3":"d","\u10D4":"e","\u10D5":"v","\u10D6":"z","\u10D7":"t","\u10D8":"i","\u10D9":"k","\u10DA":"l","\u10DB":"m","\u10DC":"n","\u10DD":"o","\u10DE":"p","\u10DF":"zh","\u10E0":"r","\u10E1":"s","\u10E2":"t","\u10E3":"u","\u10E4":"f","\u10E5":"k","\u10E6":"gh","\u10E7":"q","\u10E8":"sh","\u10E9":"ch","\u10EA":"ts","\u10EB":"dz","\u10EC":"ts","\u10ED":"ch","\u10EE":"kh","\u10EF":"j","\u10F0":"h","\u1E62":"S","\u1E63":"s","\u1E80":"W","\u1E81":"w","\u1E82":"W","\u1E83":"w","\u1E84":"W","\u1E85":"w","\u1E9E":"SS","\u1EA0":"A","\u1EA1":"a","\u1EA2":"A","\u1EA3":"a","\u1EA4":"A","\u1EA5":"a","\u1EA6":"A","\u1EA7":"a","\u1EA8":"A","\u1EA9":"a","\u1EAA":"A","\u1EAB":"a","\u1EAC":"A","\u1EAD":"a","\u1EAE":"A","\u1EAF":"a","\u1EB0":"A","\u1EB1":"a","\u1EB2":"A","\u1EB3":"a","\u1EB4":"A","\u1EB5":"a","\u1EB6":"A","\u1EB7":"a","\u1EB8":"E","\u1EB9":"e","\u1EBA":"E","\u1EBB":"e","\u1EBC":"E","\u1EBD":"e","\u1EBE":"E","\u1EBF":"e","\u1EC0":"E","\u1EC1":"e","\u1EC2":"E","\u1EC3":"e","\u1EC4":"E","\u1EC5":"e","\u1EC6":"E","\u1EC7":"e","\u1EC8":"I","\u1EC9":"i","\u1ECA":"I","\u1ECB":"i","\u1ECC":"O","\u1ECD":"o","\u1ECE":"O","\u1ECF":"o","\u1ED0":"O","\u1ED1":"o","\u1ED2":"O","\u1ED3":"o","\u1ED4":"O","\u1ED5":"o","\u1ED6":"O","\u1ED7":"o","\u1ED8":"O","\u1ED9":"o","\u1EDA":"O","\u1EDB":"o","\u1EDC":"O","\u1EDD":"o","\u1EDE":"O","\u1EDF":"o","\u1EE0":"O","\u1EE1":"o","\u1EE2":"O","\u1EE3":"o","\u1EE4":"U","\u1EE5":"u","\u1EE6":"U","\u1EE7":"u","\u1EE8":"U","\u1EE9":"u","\u1EEA":"U","\u1EEB":"u","\u1EEC":"U","\u1EED":"u","\u1EEE":"U","\u1EEF":"u","\u1EF0":"U","\u1EF1":"u","\u1EF2":"Y","\u1EF3":"y","\u1EF4":"Y","\u1EF5":"y","\u1EF6":"Y","\u1EF7":"y","\u1EF8":"Y","\u1EF9":"y","\u2013":"-","\u2018":"\'","\u2019":"\'","\u201C":"\\"","\u201D":"\\"","\u201E":"\\"","\u2020":"+","\u2022":"*","\u2026":"...","\u20A0":"ecu","\u20A2":"cruzeiro","\u20A3":"french franc","\u20A4":"lira","\u20A5":"mill","\u20A6":"naira","\u20A7":"peseta","\u20A8":"rupee","\u20A9":"won","\u20AA":"new shequel","\u20AB":"dong","\u20AC":"euro","\u20AD":"kip","\u20AE":"tugrik","\u20AF":"drachma","\u20B0":"penny","\u20B1":"peso","\u20B2":"guarani","\u20B3":"austral","\u20B4":"hryvnia","\u20B5":"cedi","\u20B8":"kazakhstani tenge","\u20B9":"indian rupee","\u20BA":"turkish lira","\u20BD":"russian ruble","\u20BF":"bitcoin","\u2120":"sm","\u2122":"tm","\u2202":"d","\u2206":"delta","\u2211":"sum","\u221E":"infinity","\u2665":"love","\u5143":"yuan","\u5186":"yen","\uFDFC":"rial","\uFEF5":"laa","\uFEF7":"laa","\uFEF9":"lai","\uFEFB":"la"}'),KK=JSON.parse('{"bg":{"\u0419":"Y","\u0426":"Ts","\u0429":"Sht","\u042A":"A","\u042C":"Y","\u0439":"y","\u0446":"ts","\u0449":"sht","\u044A":"a","\u044C":"y"},"de":{"\xC4":"AE","\xE4":"ae","\xD6":"OE","\xF6":"oe","\xDC":"UE","\xFC":"ue","\xDF":"ss","%":"prozent","&":"und","|":"oder","\u2211":"summe","\u221E":"unendlich","\u2665":"liebe"},"es":{"%":"por ciento","&":"y","<":"menor que",">":"mayor que","|":"o","\xA2":"centavos","\xA3":"libras","\xA4":"moneda","\u20A3":"francos","\u2211":"suma","\u221E":"infinito","\u2665":"amor"},"fr":{"%":"pourcent","&":"et","<":"plus petit",">":"plus grand","|":"ou","\xA2":"centime","\xA3":"livre","\xA4":"devise","\u20A3":"franc","\u2211":"somme","\u221E":"infini","\u2665":"amour"},"pt":{"%":"porcento","&":"e","<":"menor",">":"maior","|":"ou","\xA2":"centavo","\u2211":"soma","\xA3":"libra","\u221E":"infinito","\u2665":"amor"},"uk":{"\u0418":"Y","\u0438":"y","\u0419":"Y","\u0439":"y","\u0426":"Ts","\u0446":"ts","\u0425":"Kh","\u0445":"kh","\u0429":"Shch","\u0449":"shch","\u0413":"H","\u0433":"h"},"vi":{"\u0110":"D","\u0111":"d"},"da":{"\xD8":"OE","\xF8":"oe","\xC5":"AA","\xE5":"aa","%":"procent","&":"og","|":"eller","$":"dollar","<":"mindre end",">":"st\xF8rre end"},"nb":{"&":"og","\xC5":"AA","\xC6":"AE","\xD8":"OE","\xE5":"aa","\xE6":"ae","\xF8":"oe"},"it":{"&":"e"},"nl":{"&":"en"},"sv":{"&":"och","\xC5":"AA","\xC4":"AE","\xD6":"OE","\xE5":"aa","\xE4":"ae","\xF6":"oe"}}');var l0=zq(u0(),1);class Y1{static isTestEnvironment=!1;static shouldExitProcess=!0;static handle(w,q){if(this.shouldExitProcess=q?.shouldExit!==!1,q?.silent!==!0)this.writeErrorToConsole(w);let $;if(q?.message)$=q.message;else if(w instanceof Error)$=w.message;else if(typeof w==="string")$=w;else $=JSON.stringify(w);let J=new Error($);if(w instanceof Error)Object.assign(J,w);return this.writeErrorToFile(J).catch((z)=>console.error(z)),J}static handleError(w,q){return this.handle(w,q),w}static async writeErrorToFile(w){if(!(w instanceof Error)){console.error("Error is not an instance of Error:",w);return}let q=`[${new Date().toISOString()}] ${w.name}: ${w.message}
`,$=hq("stacks.log")??hq("errors.log");try{await n0(S1($),{recursive:!0}),await h0($,q)}catch(J){console.error("Failed to write to error file:",J)}}static writeErrorToConsole(w){let q;if(w instanceof Error)q=w.message;else if(typeof w==="string")q=w;else q=JSON.stringify(w);if(console.error(q),q.includes("bunx --bun cdk destroy")||q===`Failed to execute command: ${S0("bunx --bun eslint . --fix")}`||q===`Failed to execute command: ${S0("bun storage/framework/core/actions/src/lint/fix.ts")}`){if(!this.isTestEnvironment)console.log("No need to worry. The edge function is currently being destroyed. Please run `buddy undeploy` shortly again, and continue doing so until it succeeds running."),console.log("Hoping to see you back soon!")}if(this.shouldExitProcess)c0.exit(1)}}var aY="storage/logs/stacks.log";async function oY(w,q){let J=`[${new Date().toISOString()}] ${w}
`,z=q?.logFile??aY,Y=pY(z);if(!l0.default.existsSync(Y))await n0(Y,{recursive:!0});await h0(z,J)}function d0(w,q){let $,J;if(q&&typeof q==="object"&&!("shouldExit"in q)&&!("silent"in q)&&!("message"in q))J=q,q=void 0;let z=w instanceof Error?w.message:String(w);if(q&&"message"in q)$=`${z}: ${q.message}`;else $=z;let Y=`ERROR: ${rY($)}`;if(J)Y+=`
Context: ${JSON.stringify(J,null,2)}`;oY(Y);let M=new Error($);if(w instanceof Error)Object.assign(M,w);return Y1.handle(M,{...q,message:$})}var eY={withStackTrace:!1},r0=(w,q,$=eY)=>{let J=q.isOk()?{type:"Ok",value:q.value}:{type:"Err",value:q.error},z=$.withStackTrace?new Error().stack:void 0;return{data:J,message:w,stack:z}};function Iw(w,q,$,J){function z(Y){return Y instanceof $?Y:new $(function(M){M(Y)})}return new($||($=Promise))(function(Y,M){function K(Z){try{G(J.next(Z))}catch(Q){M(Q)}}function U(Z){try{G(J.throw(Z))}catch(Q){M(Q)}}function G(Z){Z.done?Y(Z.value):z(Z.value).then(K,U)}G((J=J.apply(w,q||[])).next())})}function f0(w){var q=typeof Symbol==="function"&&Symbol.iterator,$=q&&w[q],J=0;if($)return $.call(w);if(w&&typeof w.length==="number")return{next:function(){if(w&&J>=w.length)w=void 0;return{value:w&&w[J++],done:!w}}};throw new TypeError(q?"Object is not iterable.":"Symbol.iterator is not defined.")}function Gw(w){return this instanceof Gw?(this.v=w,this):new Gw(w)}function p0(w,q,$){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var J=$.apply(w,q||[]),z,Y=[];return z=Object.create((typeof AsyncIterator==="function"?AsyncIterator:Object).prototype),K("next"),K("throw"),K("return",M),z[Symbol.asyncIterator]=function(){return this},z;function M(X){return function(W){return Promise.resolve(W).then(X,Q)}}function K(X,W){if(J[X]){if(z[X]=function(x){return new Promise(function(B,F){Y.push([X,x,B,F])>1||U(X,x)})},W)z[X]=W(z[X])}}function U(X,W){try{G(J[X](W))}catch(x){y(Y[0][3],x)}}function G(X){X.value instanceof Gw?Promise.resolve(X.value.v).then(Z,Q):y(Y[0][2],X)}function Z(X){U("next",X)}function Q(X){U("throw",X)}function y(X,W){if(X(W),Y.shift(),Y.length)U(Y[0][0],Y[0][1])}}function tY(w){var q,$;return q={},J("next"),J("throw",function(z){throw z}),J("return"),q[Symbol.iterator]=function(){return this},q;function J(z,Y){q[z]=w[z]?function(M){return($=!$)?{value:Gw(w[z](M)),done:!1}:Y?Y(M):M}:Y}}function sY(w){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var q=w[Symbol.asyncIterator],$;return q?q.call(w):(w=typeof f0==="function"?f0(w):w[Symbol.iterator](),$={},J("next"),J("throw"),J("return"),$[Symbol.asyncIterator]=function(){return this},$);function J(Y){$[Y]=w[Y]&&function(M){return new Promise(function(K,U){M=w[Y](M),z(K,U,M.done,M.value)})}}function z(Y,M,K,U){Promise.resolve(U).then(function(G){Y({value:G,done:K})},M)}}class b{constructor(w){this._promise=w}static fromSafePromise(w){let q=w.then(($)=>new Mw($));return new b(q)}static fromPromise(w,q){let $=w.then((J)=>new Mw(J)).catch((J)=>new zw(q(J)));return new b($)}static fromThrowable(w,q){return(...$)=>{return new b((()=>Iw(this,void 0,void 0,function*(){try{return new Mw(yield w(...$))}catch(J){return new zw(q?q(J):J)}}))())}}static combine(w){return $M(w)}static combineWithAllErrors(w){return JM(w)}map(w){return new b(this._promise.then((q)=>Iw(this,void 0,void 0,function*(){if(q.isErr())return new zw(q.error);return new Mw(yield w(q.value))})))}andThrough(w){return new b(this._promise.then((q)=>Iw(this,void 0,void 0,function*(){if(q.isErr())return new zw(q.error);let $=yield w(q.value);if($.isErr())return new zw($.error);return new Mw(q.value)})))}andTee(w){return new b(this._promise.then((q)=>Iw(this,void 0,void 0,function*(){if(q.isErr())return new zw(q.error);try{yield w(q.value)}catch($){}return new Mw(q.value)})))}orTee(w){return new b(this._promise.then((q)=>Iw(this,void 0,void 0,function*(){if(q.isOk())return new Mw(q.value);try{yield w(q.error)}catch($){}return new zw(q.error)})))}mapErr(w){return new b(this._promise.then((q)=>Iw(this,void 0,void 0,function*(){if(q.isOk())return new Mw(q.value);return new zw(yield w(q.error))})))}andThen(w){return new b(this._promise.then((q)=>{if(q.isErr())return new zw(q.error);let $=w(q.value);return $ instanceof b?$._promise:$}))}orElse(w){return new b(this._promise.then((q)=>Iw(this,void 0,void 0,function*(){if(q.isErr())return w(q.error);return new Mw(q.value)})))}match(w,q){return this._promise.then(($)=>$.match(w,q))}unwrapOr(w){return this._promise.then((q)=>q.unwrapOr(w))}safeUnwrap(){return p0(this,arguments,function*w(){return yield Gw(yield Gw(yield*tY(sY(yield Gw(this._promise.then((q)=>q.safeUnwrap()))))))})}then(w,q){return this._promise.then(w,q)}[Symbol.asyncIterator](){return p0(this,arguments,function*w(){let q=yield Gw(this._promise);if(q.isErr())yield yield Gw($q(q.error));return yield Gw(q.value)})}}function $q(w){return new b(Promise.resolve(new zw(w)))}var{fromPromise:wM,fromSafePromise:qM,fromThrowable:wX}=b,a0=(w)=>{let q=Nw([]);for(let $ of w)if($.isErr()){q=Uw($.error);break}else q.map((J)=>J.push($.value));return q},$M=(w)=>b.fromSafePromise(Promise.all(w)).andThen(a0),o0=(w)=>{let q=Nw([]);for(let $ of w)if($.isErr()&&q.isErr())q.error.push($.error);else if($.isErr()&&q.isOk())q=Uw([$.error]);else if($.isOk()&&q.isOk())q.value.push($.value);return q},JM=(w)=>b.fromSafePromise(Promise.all(w)).andThen(o0),Cq;(function(w){function q(z,Y){return(...M)=>{try{let K=z(...M);return Nw(K)}catch(K){return Uw(Y?Y(K):K)}}}w.fromThrowable=q;function $(z){return a0(z)}w.combine=$;function J(z){return o0(z)}w.combineWithAllErrors=J})(Cq||(Cq={}));function Nw(w){return new Mw(w)}function Uw(w){return new zw(w)}class Mw{constructor(w){this.value=w}isOk(){return!0}isErr(){return!this.isOk()}map(w){return Nw(w(this.value))}mapErr(w){return Nw(this.value)}andThen(w){return w(this.value)}andThrough(w){return w(this.value).map((q)=>this.value)}andTee(w){try{w(this.value)}catch(q){}return Nw(this.value)}orTee(w){return Nw(this.value)}orElse(w){return Nw(this.value)}asyncAndThen(w){return w(this.value)}asyncAndThrough(w){return w(this.value).map(()=>this.value)}asyncMap(w){return b.fromSafePromise(w(this.value))}unwrapOr(w){return this.value}match(w,q){return w(this.value)}safeUnwrap(){let w=this.value;return function*(){return w}()}_unsafeUnwrap(w){return this.value}_unsafeUnwrapErr(w){throw r0("Called `_unsafeUnwrapErr` on an Ok",this,w)}*[Symbol.iterator](){return this.value}}class zw{constructor(w){this.error=w}isOk(){return!1}isErr(){return!this.isOk()}map(w){return Uw(this.error)}mapErr(w){return Uw(w(this.error))}andThrough(w){return Uw(this.error)}andTee(w){return Uw(this.error)}orTee(w){try{w(this.error)}catch(q){}return Uw(this.error)}andThen(w){return Uw(this.error)}orElse(w){return w(this.error)}asyncAndThen(w){return $q(this.error)}asyncAndThrough(w){return $q(this.error)}asyncMap(w){return $q(this.error)}unwrapOr(w){return w}match(w,q){return q(this.error)}safeUnwrap(){let w=this.error;return function*(){throw yield Uw(w),new Error("Do not use this generator out of `safeTry`")}()}_unsafeUnwrap(w){throw r0("Called `_unsafeUnwrap` on an Err",this,w)}_unsafeUnwrapErr(w){return this.error}*[Symbol.iterator](){let w=this;return yield w,w}}var zM=Cq.fromThrowable;var Qw=new fw("stacks",{level:"debug",logDirectory:nq("storage/logs"),showTags:!1,fancy:!0});function Jq(...w){return w.map((q)=>typeof q==="object"?JSON.stringify(q,null,2):String(q)).join(" ")}var Hw={info:async(...w)=>{let q=Jq(...w);await Qw.info(q)},success:async(w)=>{await Qw.success(w)},warn:async(w,q)=>{await Qw.warn(w,q)},warning:async(w)=>{await Qw.warn(w)},error:async(w,q)=>{let $=typeof w==="string"?w:w instanceof Error?w:JSON.stringify(w);await Qw.error($),d0(w,q)},debug:async(...w)=>{let q=Jq(...w);await Qw.debug(q)},dump:(...w)=>{let q=Jq(...w);Qw.debug(`DUMP: ${q}`)},dd:(...w)=>{let q=Jq(...w);Qw.error(q),YM.exit(1)},echo:(...w)=>{let q=Jq(...w);Qw.info(`ECHO: ${q}`)},time:(w)=>{return Qw.time(w)}};var tJ=zq(N1(),1);import a8 from"node-fetch";var rJ="https://www.iana.org/whois?q=",aJ={"whois.denic.de":"-T dn,ace","whois.nic.fr":"-V Md5.2"},x1={"br.com":"whois.centralnic.net","cn.com":"whois.centralnic.net","de.com":"whois.centralnic.net","eu.com":"whois.centralnic.net","gb.com":"whois.centralnic.net","gb.net":"whois.centralnic.net","gr.com":"whois.centralnic.net","hu.com":"whois.centralnic.net","in.net":"whois.centralnic.net","no.com":"whois.centralnic.net","qc.com":"whois.centralnic.net","ru.com":"whois.centralnic.net","sa.com":"whois.centralnic.net","se.com":"whois.centralnic.net","se.net":"whois.centralnic.net","uk.com":"whois.centralnic.net","uk.net":"whois.centralnic.net","us.com":"whois.centralnic.net","uy.com":"whois.centralnic.net","za.com":"whois.centralnic.net","jpn.com":"whois.centralnic.ne","web.com":"whois.centralnic.ne",com:"whois.verisign-grs.com","za.net":"whois.za.net",net:"whois.verisign-grs.com","eu.org":"whois.eu.org","za.org":"whois.za.org",org:"whois.pir.org","llyw.cymru":"whois.nic.llyw.cymru","gov.scot":"whois.nic.gov.scot","gov.wales":"whois.nic.gov.wales",edu:"whois.educause.edu",gov:"whois.dotgov.gov",int:"whois.iana.org","e164.arpa":"whois.ripe.net",arpa:"whois.iana.org",aero:"whois.aero",asia:"whois.nic.asia",biz:"whois.nic.biz",cat:"whois.nic.cat",coop:"whois.nic.coop",info:"whois.afilias.net",jobs:"whois.nic.jobs",mobi:"whois.afilias.net",museum:"whois.nic.museum",name:"whois.nic.name",post:"whois.dotpostregistry.net",pro:"whois.nic.pro",tel:"whois.nic.tel",travel:"whois.nic.travel",xxx:"whois.nic.xxx",ac:"whois.nic.ac",ae:"whois.aeda.net.ae",af:"whois.nic.af",ag:"whois.nic.ag",ai:"whois.nic.ai",am:"whois.amnic.net",ar:"whois.nic.ar",as:"whois.nic.as","priv.at":"whois.nic.priv.at",at:"whois.nic.at",au:"whois.auda.org.au",aw:"whois.nic.aw",ax:"whois.ax",be:"whois.dns.be",bf:"whois.registre.bf",bg:"whois.register.bg",bh:"whois.nic.bh",bi:"whois1.nic.bi",bj:"whois.nic.bj",bm:"whois.afilias-srs.net",bn:"whois.bnnic.bn",bo:"whois.nic.bo",br:"whois.registro.br",by:"whois.cctld.by",bw:"whois.nic.net.bw",bz:"whois.afilias-grs.info","co.ca":"whois.co.ca",ca:"whois.cira.ca",cc:"ccwhois.verisign-grs.com",cd:"whois.nic.cd",ch:"whois.nic.ch",ci:"whois.nic.ci",cl:"whois.nic.cl",cm:"whois.netcom.cm","edu.cn":"whois.edu.cn",cn:"whois.cnnic.cn","uk.co":"whois.uk.co",co:"whois.nic.co",cr:"whois.nic.cr",cx:"whois.nic.cx",cz:"whois.nic.cz",de:"whois.denic.de",dk:"whois.dk-hostmaster.dk",dm:"whois.dmdomains.dm",do:"whois.nic.do",dz:"whois.nic.dz",ec:"whois.nic.ec",ee:"whois.tld.ee",eu:"whois.eu",fi:"whois.fi",fj:"www.whois.fj",fm:"whois.nic.fm",fo:"whois.nic.fo",fr:"whois.nic.fr",gd:"whois.nic.gd",ge:"whois.nic.ge",gf:"whois.mediaserv.net",gg:"whois.gg",gh:"whois.nic.gh",gi:"whois2.afilias-grs.net",gl:"whois.nic.gl",gp:"whois.nic.gp",gq:"whois.dominio.gq",gs:"whois.nic.gs",gy:"whois.registry.gy",hk:"whois.hkirc.hk",hm:"whois.registry.hm",hn:"whois.nic.hn",hr:"whois.dns.hr",ht:"whois.nic.ht",hu:"whois.nic.hu",id:"whois.id",ie:"whois.weare.ie",il:"whois.isoc.org.il",im:"whois.nic.im",in:"whois.registry.in",io:"whois.nic.io",iq:"whois.cmc.iq",ir:"whois.nic.ir",is:"whois.isnic.is",it:"whois.nic.it",je:"whois.je",jp:"whois.jprs.jp",ke:"whois.kenic.or.ke",kg:"whois.kg",ki:"whois.nic.ki",kn:"whois.nic.kn",kr:"whois.kr",kw:"whois.nic.kw",ky:"whois.kyregistry.ky",kz:"whois.nic.kz",la:"whois.nic.la",lb:"whois.lbdr.org.lb",lc:"whois2.afilias-grs.net",li:"whois.nic.li",lk:"whois.nic.lk",ls:"whois.nic.ls",lt:"whois.domreg.lt",lu:"whois.dns.lu",lv:"whois.nic.lv",ly:"whois.nic.ly",ma:"whois.registre.ma",md:"whois.nic.md",me:"whois.nic.me",mg:"whois.nic.mg",mk:"whois.marnet.mk",ml:"whois.dot.ml",mm:"whois.registry.gov.mm",mn:"whois.nic.mn",mq:"whois.mediaserv.net",mr:"whois.nic.mr",ms:"whois.nic.ms",mt:"whois.nic.org.mt",mu:"whois.nic.mu",mw:"whois.nic.mw",mx:"whois.mx",my:"whois.mynic.my",mz:"whois.nic.mz",na:"whois.na-nic.com.na",nc:"whois.nc",nf:"whois.nic.nf",ng:"whois.nic.net.ng",nl:"whois.domain-registry.nl",no:"whois.norid.no",nu:"whois.iis.nu",nz:"whois.irs.net.nz",om:"whois.registry.om",pe:"kero.yachay.pe",pf:"whois.registry.pf",pk:"whois.pknic.net.pk","co.pl":"whois.co.pl",pl:"whois.dns.pl",pm:"whois.nic.pm",pr:"whois.afilias-srs.net",ps:"whois.pnina.ps",pt:"whois.dns.pt",pw:"whois.nic.pw",qa:"whois.registry.qa",re:"whois.nic.re",ro:"whois.rotld.ro",rs:"whois.rnids.rs","ac.ru":"whois.free.net","edu.ru":"whois.informika.ru","com.ru":"whois.flexireg.net","msk.ru":"whois.flexireg.net","net.ru":"whois.nic.net.ru","nov.ru":"whois.flexireg.net","org.ru":"whois.nic.net.ru","pp.ru":"whois.nic.net.ru","spb.ru":"whois.flexireg.net",ru:"whois.tcinet.ru",rw:"whois.ricta.org.rw",sa:"whois.nic.net.sa",sb:"whois.nic.net.sb",sc:"whois2.afilias-grs.net",sd:"whois.sdnic.sd",se:"whois.iis.se",sg:"whois.sgnic.sg",sh:"whois.nic.sh",si:"whois.register.si",sk:"whois.sk-nic.sk",sl:"whois.nic.sl",sm:"whois.nic.sm",sn:"whois.nic.sn",so:"whois.nic.so",ss:"whois.nic.ss",st:"whois.nic.st","msk.su":"whois.flexireg.net","nov.su":"whois.flexireg.net","spb.su":"whois.flexireg.net",su:"whois.tcinet.ru",sx:"whois.sx",sy:"whois.tld.sy",tc:"whois.nic.tc",td:"whois.nic.td",tf:"whois.nic.tf",tg:"whois.nic.tg",th:"whois.thnic.co.th",tk:"whois.dot.tk",tl:"whois.nic.tl",tm:"whois.nic.tm",tn:"whois.ati.tn",to:"whois.tonic.to",tr:"whois.trabis.gov.tr",tv:"whois.nic.tv",tw:"whois.twnic.net.tw",tz:"whois.tznic.or.tz","biz.ua":"whois.biz.ua","co.ua":"whois.co.ua","pp.ua":"whois.pp.ua",ua:"whois.ua",ug:"whois.co.ug","ac.uk":"whois.nic.ac.uk","gov.uk":"whois.gov.uk",uk:"whois.nic.uk","fed.us":"whois.nic.gov",us:"whois.nic.us",uy:"whois.nic.org.uy",uz:"whois.cctld.uz",vc:"whois2.afilias-grs.net",ve:"whois.nic.ve",vg:"whois.nic.vg",vu:"whois.dnrs.vu",wf:"whois.nic.wf",ws:"whois.website.ws",yt:"whois.nic.yt","ac.za":"whois.ac.za","co.za":"whois.registry.net.za","gov.za":"whois.gov.za","net.za":"net-whois.registry.net.za","org.za":"org-whois.registry.net.za","web.za":"web-whois.registry.net.za",zm:"whois.zicta.zm","xn--2scrj9c":"whois.registry.in","xn--3e0b707e":"whois.kr","xn--3hcrj9c":"whois.registry.in","xn--45br5cyl":"whois.registry.in","xn--45brj9c":"whois.registry.in","xn--4dbrk0ce":"whois.isoc.org.il","xn--80ao21a":"whois.nic.kz","xn--90a3ac":"whois.rnids.rs","xn--90ae":"whois.imena.bg","xn--90ais":"whois.cctld.by","xn--clchc0ea0b2g2a9gcd":"whois.sgnic.sg","xn--d1alf":"whois.marnet.mk","xn--e1a4c":"whois.eu","xn--fiqs8s":"cwhois.cnnic.cn","xn--fiqz9s":"cwhois.cnnic.cn","xn--fpcrj9c3d":"whois.registry.in","xn--fzc2c9e2c":"whois.nic.lk","xn--gecrj9c":"whois.registry.in","xn--h2breg3eve":"whois.registry.in","xn--h2brj9c8c":"whois.registry.in","xn--h2brj9c":"whois.registry.in","xn--j1amh":"whois.dotukr.com","xn--j6w193g":"whois.hkirc.hk","xn--kprw13d":"whois.twnic.net.tw","xn--kpry57d":"whois.twnic.net.tw","xn--lgbbat1ad8j":"whois.nic.dz","xn--mgb9awbf":"whois.registry.om","xn--mgba3a4f16a":"whois.nic.ir","xn--mgbaam7a8h":"whois.aeda.net.ae","xn--mgbah1a3hjkrd":"whois.nic.mr","xn--mgbbh1a71e":"whois.registry.in","xn--mgbbh1a":"whois.registry.in","xn--mgberp4a5d4ar":"whois.nic.net.sa","xn--mgbgu82a":"whois.registry.in","xn--mgbtx2b":"whois.cmc.iq","xn--mgbx4cd0ab":"whois.mynic.my","xn--node":"whois.itdc.ge","xn--o3cw4h":"whois.thnic.co.th","xn--ogbpf8fl":"whois.tld.sy","xn--p1ai":"whois.tcinet.ru","xn--pgbs0dh":"whois.ati.tn","xn--q7ce6a":"whois.nic.la","xn--qxa6a":"whois.eu","xn--rvc1e0am3e":"whois.registry.in","xn--s9brj9c":"whois.registry.in","xn--wgbh1c":"whois.dotmasr.eg","xn--wgbl6a":"whois.registry.qa","xn--xkc2al3hye2a":"whois.nic.lk","xn--xkc2dl3a5ee0h":"whois.registry.in","xn--y9a3aq":"whois.amnic.net","xn--yfro4i67o":"whois.sgnic.sg","xn--ygbi2ammx":"whois.pnina.ps"};var oJ;(($)=>{$[$.SOCKS4=0]="SOCKS4";$[$.SOCKS5=1]="SOCKS5"})(oJ||={});function B1(w){if(Array.isArray(w))return w.slice();if(typeof w==="object"&&w!==null){let q={};for(let $ in w)if(Object.prototype.hasOwnProperty.call(w,$))q[$]=B1(w[$]);return q}return w}var wZ=zq(N1(),1);async function o8(w){let q=rJ+w;try{let $=await a8(q);if($.ok){let z=(await $.text()).match(/whois:\s+(\S+)/);if(z?.[1])return z[1]}}catch($){console.error("Error in getting WhoIs server data from IANA",$)}return""}function e8(w){if(w==="com")return"whois.verisign-grs.com";return x1[w]}function eJ(w){let q=w.split(".");for(let $=q.length-1;$>0;$--){let J=q.slice($).join(".");if(x1[J])return J}return q[q.length-1]}function t8(w){return aJ[w]}class mq{static iterParse(w,q){let $="",J=null,z="";for(let Y=0;Y<w.length;Y++){let M=w[Y];if(M===`
`||z===":"&&M===" "){if($.trim()in q)J=$.trim();else if(J!==null){let K=$.trim();if(K!==""){let U=q[J];if(Array.isArray(U))U.push(K);else q[J]=K;J=null}}$=""}else if(M!==":")$=$+M;if(z=M,$==="Record maintained by"||$===">>>")break}return q}static parseData(w,q){if(!q)q={"Domain Name":"","Creation Date":"","Updated Date":"","Registry Expiry Date":"","Domain Status":[],Registrar:""};return q=mq.iterParse(w,q),q}}async function s8(w,q,$,J,z,Y){let M=new TextDecoder(z),K=new TextEncoder;if(!Y){let G=new r8.Socket;return new Promise((Z,Q)=>{try{G.connect({port:J,host:$},()=>{if(q!=="")G.write(K.encode(`${q} ${w}\r
`));else G.write(K.encode(`${w}\r
`))}),G.on("data",(y)=>{Z(M.decode(y))}),G.on("error",(y)=>{Q(y)})}catch(y){Q(y)}})}let U={proxy:{host:Y.ip,port:Y.port,type:Y.type===1?5:4},command:"connect",destination:{host:$,port:J}};if(Y.username&&Y.password)U.proxy.userId=Y.username,U.proxy.password=Y.password;return new Promise((G,Z)=>{tJ.SocksClient.createConnection(U,(Q,y)=>{if(Q)Z(Q);else{if(!y)Z(new Error("No socket info received!"));if(q!=="")y?.socket.write(K.encode(`${q} ${w}\r
`));else y?.socket.write(K.encode(`${w}\r
`));y?.socket.on("data",(X)=>{G(M.decode(X))}),y?.socket.resume()}})})}async function C1(w,q=!1,$=null){let J,z=43,Y="",M,K="utf-8";if(!$)J=eJ(w),M=null;else J=$.tld?$.tld:eJ(w),K=$.encoding?$.encoding:"utf-8",M=$.proxy?$.proxy:null,Y=$.server?$.server:"",z=$.serverPort?$.serverPort:43;if(Y===""){let Z=e8(J);if(!Z){if(Hw.debug(`No WhoIs server found for TLD: ${J}! Attempting IANA WhoIs database for server!`),Z=await o8(J),!Z)return Hw.debug("WhoIs server could not be found!"),{_raw:"",parsedData:null};Hw.debug(`WhoIs sever found for ${J}: ${Y}`)}Y=Z}let G=t8(Y)||"";try{Hw.debug(`Attempting WHOIS lookup for ${w} on server ${Y}`);let Z=await s8(w,G,Y,z,K,M);if(Hw.debug("Raw WHOIS data received:",Z),!q){let y=mq.parseData(Z,null);return{_raw:Z,parsedData:y}}let Q=null;if($?.parseData)Q=B1($.parseData);try{let y=mq.parseData(Z,Q);return{_raw:Z,parsedData:y}}catch(y){return console.error("Error in parsing WhoIs data!",y),{_raw:Z,parsedData:null}}}catch(Z){return Hw.debug(`Error in WHOIS lookup for ${w} on server ${Y}`,Z),{_raw:"",parsedData:null}}}function SX(w,q=null){return Hw.debug(`Lookup called for ${w}`),C1(w,!0,q)}async function hX(w,q=!1,$=1,J=!1,z=null){let Y=[];if(q){if($>w.length)$=w.length;for(let M=0;M<w.length;M+=$){let K=w.slice(M,M+$);Y=await Promise.all(K.map(async(U)=>{return await C1(U,J,z)}))}}else for(let M=0;M<w.length;M++){let K=await C1(w[M],J,z);Y.push(K)}return Y}var export_SocksClient=wZ.SocksClient;export{C1 as whois,s8 as tcpWhois,SX as lookup,e8 as getWhoIsServer,eJ as getTLD,t8 as getParameters,o8 as findWhoIsServer,hX as batchWhois,mq as WhoIsParser,export_SocksClient as SocksClient,x1 as SERVERS,oJ as ProxyType,aJ as PARAMETERS,rJ as IANA_CHK_URL};
