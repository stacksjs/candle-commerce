// @bun
var E8=Object.create;var{getPrototypeOf:F8,defineProperty:Vq,getOwnPropertyNames:C8}=Object;var L8=Object.prototype.hasOwnProperty;var g$=(w,$,q)=>{q=w!=null?E8(F8(w)):{};let J=$||!w||!w.__esModule?Vq(q,"default",{value:w,enumerable:!0}):q;for(let Y of C8(w))if(!L8.call(J,Y))Vq(J,Y,{get:()=>w[Y],enumerable:!0});return J};var R=(w,$)=>()=>($||w(($={exports:{}}).exports,$),$.exports);var h=import.meta.require;var t=R((e8)=>{e8.fromCallback=function(w){return Object.defineProperty(function(...$){if(typeof $[$.length-1]==="function")w.apply(this,$);else return new Promise((q,J)=>{$.push((Y,U)=>Y!=null?J(Y):q(U)),w.apply(this,$)})},"name",{value:w.name})};e8.fromPromise=function(w){return Object.defineProperty(function(...$){let q=$[$.length-1];if(typeof q!=="function")return w.apply(this,$);else $.pop(),w.apply(this,$).then((J)=>q(null,J),q)},"name",{value:w.name})}});var gq=R((RM,Sq)=>{var dw=h("constants"),wZ=process.cwd,f$=null,$Z=process.env.GRACEFUL_FS_PLATFORM||process.platform;process.cwd=function(){if(!f$)f$=wZ.call(process);return f$};try{process.cwd()}catch(w){}if(typeof process.chdir==="function"){if(p$=process.chdir,process.chdir=function(w){f$=null,p$.call(process,w)},Object.setPrototypeOf)Object.setPrototypeOf(process.chdir,p$)}var p$;Sq.exports=qZ;function qZ(w){if(dw.hasOwnProperty("O_SYMLINK")&&process.version.match(/^v0\.6\.[0-2]|^v0\.5\./))$(w);if(!w.lutimes)q(w);if(w.chown=U(w.chown),w.fchown=U(w.fchown),w.lchown=U(w.lchown),w.chmod=J(w.chmod),w.fchmod=J(w.fchmod),w.lchmod=J(w.lchmod),w.chownSync=X(w.chownSync),w.fchownSync=X(w.fchownSync),w.lchownSync=X(w.lchownSync),w.chmodSync=Y(w.chmodSync),w.fchmodSync=Y(w.fchmodSync),w.lchmodSync=Y(w.lchmodSync),w.stat=M(w.stat),w.fstat=M(w.fstat),w.lstat=M(w.lstat),w.statSync=Q(w.statSync),w.fstatSync=Q(w.fstatSync),w.lstatSync=Q(w.lstatSync),w.chmod&&!w.lchmod)w.lchmod=function(z,N,F){if(F)process.nextTick(F)},w.lchmodSync=function(){};if(w.chown&&!w.lchown)w.lchown=function(z,N,F,W){if(W)process.nextTick(W)},w.lchownSync=function(){};if($Z==="win32")w.rename=typeof w.rename!=="function"?w.rename:function(z){function N(F,W,E){var B=Date.now(),j=0;z(F,W,function P(_){if(_&&(_.code==="EACCES"||_.code==="EPERM"||_.code==="EBUSY")&&Date.now()-B<60000){if(setTimeout(function(){w.stat(W,function(S,aw){if(S&&S.code==="ENOENT")z(F,W,P);else E(_)})},j),j<100)j+=10;return}if(E)E(_)})}if(Object.setPrototypeOf)Object.setPrototypeOf(N,z);return N}(w.rename);w.read=typeof w.read!=="function"?w.read:function(z){function N(F,W,E,B,j,P){var _;if(P&&typeof P==="function"){var S=0;_=function(aw,v$,k$){if(aw&&aw.code==="EAGAIN"&&S<10)return S++,z.call(w,F,W,E,B,j,_);P.apply(this,arguments)}}return z.call(w,F,W,E,B,j,_)}if(Object.setPrototypeOf)Object.setPrototypeOf(N,z);return N}(w.read),w.readSync=typeof w.readSync!=="function"?w.readSync:function(z){return function(N,F,W,E,B){var j=0;while(!0)try{return z.call(w,N,F,W,E,B)}catch(P){if(P.code==="EAGAIN"&&j<10){j++;continue}throw P}}}(w.readSync);function $(z){z.lchmod=function(N,F,W){z.open(N,dw.O_WRONLY|dw.O_SYMLINK,F,function(E,B){if(E){if(W)W(E);return}z.fchmod(B,F,function(j){z.close(B,function(P){if(W)W(j||P)})})})},z.lchmodSync=function(N,F){var W=z.openSync(N,dw.O_WRONLY|dw.O_SYMLINK,F),E=!0,B;try{B=z.fchmodSync(W,F),E=!1}finally{if(E)try{z.closeSync(W)}catch(j){}else z.closeSync(W)}return B}}function q(z){if(dw.hasOwnProperty("O_SYMLINK")&&z.futimes)z.lutimes=function(N,F,W,E){z.open(N,dw.O_SYMLINK,function(B,j){if(B){if(E)E(B);return}z.futimes(j,F,W,function(P){z.close(j,function(_){if(E)E(P||_)})})})},z.lutimesSync=function(N,F,W){var E=z.openSync(N,dw.O_SYMLINK),B,j=!0;try{B=z.futimesSync(E,F,W),j=!1}finally{if(j)try{z.closeSync(E)}catch(P){}else z.closeSync(E)}return B};else if(z.futimes)z.lutimes=function(N,F,W,E){if(E)process.nextTick(E)},z.lutimesSync=function(){}}function J(z){if(!z)return z;return function(N,F,W){return z.call(w,N,F,function(E){if(V(E))E=null;if(W)W.apply(this,arguments)})}}function Y(z){if(!z)return z;return function(N,F){try{return z.call(w,N,F)}catch(W){if(!V(W))throw W}}}function U(z){if(!z)return z;return function(N,F,W,E){return z.call(w,N,F,W,function(B){if(V(B))B=null;if(E)E.apply(this,arguments)})}}function X(z){if(!z)return z;return function(N,F,W){try{return z.call(w,N,F,W)}catch(E){if(!V(E))throw E}}}function M(z){if(!z)return z;return function(N,F,W){if(typeof F==="function")W=F,F=null;function E(B,j){if(j){if(j.uid<0)j.uid+=4294967296;if(j.gid<0)j.gid+=4294967296}if(W)W.apply(this,arguments)}return F?z.call(w,N,F,E):z.call(w,N,E)}}function Q(z){if(!z)return z;return function(N,F){var W=F?z.call(w,N,F):z.call(w,N);if(W){if(W.uid<0)W.uid+=4294967296;if(W.gid<0)W.gid+=4294967296}return W}}function V(z){if(!z)return!0;if(z.code==="ENOSYS")return!0;var N=!process.getuid||process.getuid()!==0;if(N){if(z.code==="EINVAL"||z.code==="EPERM")return!0}return!1}}});var cq=R((TM,iq)=>{var hq=h("stream").Stream;iq.exports=JZ;function JZ(w){return{ReadStream:$,WriteStream:q};function $(J,Y){if(!(this instanceof $))return new $(J,Y);hq.call(this);var U=this;this.path=J,this.fd=null,this.readable=!0,this.paused=!1,this.flags="r",this.mode=438,this.bufferSize=65536,Y=Y||{};var X=Object.keys(Y);for(var M=0,Q=X.length;M<Q;M++){var V=X[M];this[V]=Y[V]}if(this.encoding)this.setEncoding(this.encoding);if(this.start!==void 0){if(typeof this.start!=="number")throw TypeError("start must be a Number");if(this.end===void 0)this.end=1/0;else if(typeof this.end!=="number")throw TypeError("end must be a Number");if(this.start>this.end)throw new Error("start must be <= end");this.pos=this.start}if(this.fd!==null){process.nextTick(function(){U._read()});return}w.open(this.path,this.flags,this.mode,function(z,N){if(z){U.emit("error",z),U.readable=!1;return}U.fd=N,U.emit("open",N),U._read()})}function q(J,Y){if(!(this instanceof q))return new q(J,Y);hq.call(this),this.path=J,this.fd=null,this.writable=!0,this.flags="w",this.encoding="binary",this.mode=438,this.bytesWritten=0,Y=Y||{};var U=Object.keys(Y);for(var X=0,M=U.length;X<M;X++){var Q=U[X];this[Q]=Y[Q]}if(this.start!==void 0){if(typeof this.start!=="number")throw TypeError("start must be a Number");if(this.start<0)throw new Error("start must be >= zero");this.pos=this.start}if(this.busy=!1,this._queue=[],this.fd===null)this._open=w.open,this._queue.push([this._open,this.path,this.flags,this.mode,void 0]),this.flush()}}});var lq=R((AM,nq)=>{nq.exports=ZZ;var YZ=Object.getPrototypeOf||function(w){return w.__proto__};function ZZ(w){if(w===null||typeof w!=="object")return w;if(w instanceof Object)var $={__proto__:YZ(w)};else var $=Object.create(null);return Object.getOwnPropertyNames(w).forEach(function(q){Object.defineProperty($,q,Object.getOwnPropertyDescriptor(w,q))}),$}});var z$=R((BM,_1)=>{var n=h("fs"),KZ=gq(),UZ=cq(),OZ=lq(),r$=h("util"),Yw,a$;if(typeof Symbol==="function"&&typeof Symbol.for==="function")Yw=Symbol.for("graceful-fs.queue"),a$=Symbol.for("graceful-fs.previous");else Yw="___graceful-fs.queue",a$="___graceful-fs.previous";function XZ(){}function fq(w,$){Object.defineProperty(w,Yw,{get:function(){return $}})}var sw=XZ;if(r$.debuglog)sw=r$.debuglog("gfs4");else if(/\bgfs4\b/i.test(process.env.NODE_DEBUG||""))sw=function(){var w=r$.format.apply(r$,arguments);w="GFS4: "+w.split(/\n/).join(`
GFS4: `),console.error(w)};if(!n[Yw]){if(P1=global[Yw]||[],fq(n,P1),n.close=function(w){function $(q,J){return w.call(n,q,function(Y){if(!Y)dq();if(typeof J==="function")J.apply(this,arguments)})}return Object.defineProperty($,a$,{value:w}),$}(n.close),n.closeSync=function(w){function $(q){w.apply(n,arguments),dq()}return Object.defineProperty($,a$,{value:w}),$}(n.closeSync),/\bgfs4\b/i.test(process.env.NODE_DEBUG||""))process.on("exit",function(){sw(n[Yw]),h("assert").equal(n[Yw].length,0)})}var P1;if(!global[Yw])fq(global,n[Yw]);_1.exports=x1(OZ(n));if(process.env.TEST_GRACEFUL_FS_GLOBAL_PATCH&&!n.__patched)_1.exports=x1(n),n.__patched=!0;function x1(w){KZ(w),w.gracefulify=x1,w.createReadStream=v$,w.createWriteStream=k$;var $=w.readFile;w.readFile=q;function q(T,x,I){if(typeof x==="function")I=x,x=null;return p(T,x,I);function p(r,d,u,g){return $(r,d,function(m){if(m&&(m.code==="EMFILE"||m.code==="ENFILE"))X$([p,[r,d,u],m,g||Date.now(),Date.now()]);else if(typeof u==="function")u.apply(this,arguments)})}}var J=w.writeFile;w.writeFile=Y;function Y(T,x,I,p){if(typeof I==="function")p=I,I=null;return r(T,x,I,p);function r(d,u,g,m,o){return J(d,u,g,function(v){if(v&&(v.code==="EMFILE"||v.code==="ENFILE"))X$([r,[d,u,g,m],v,o||Date.now(),Date.now()]);else if(typeof m==="function")m.apply(this,arguments)})}}var U=w.appendFile;if(U)w.appendFile=X;function X(T,x,I,p){if(typeof I==="function")p=I,I=null;return r(T,x,I,p);function r(d,u,g,m,o){return U(d,u,g,function(v){if(v&&(v.code==="EMFILE"||v.code==="ENFILE"))X$([r,[d,u,g,m],v,o||Date.now(),Date.now()]);else if(typeof m==="function")m.apply(this,arguments)})}}var M=w.copyFile;if(M)w.copyFile=Q;function Q(T,x,I,p){if(typeof I==="function")p=I,I=0;return r(T,x,I,p);function r(d,u,g,m,o){return M(d,u,g,function(v){if(v&&(v.code==="EMFILE"||v.code==="ENFILE"))X$([r,[d,u,g,m],v,o||Date.now(),Date.now()]);else if(typeof m==="function")m.apply(this,arguments)})}}var V=w.readdir;w.readdir=N;var z=/^v[0-5]\./;function N(T,x,I){if(typeof x==="function")I=x,x=null;var p=z.test(process.version)?function d(u,g,m,o){return V(u,r(u,g,m,o))}:function d(u,g,m,o){return V(u,g,r(u,g,m,o))};return p(T,x,I);function r(d,u,g,m){return function(o,v){if(o&&(o.code==="EMFILE"||o.code==="ENFILE"))X$([p,[d,u,g],o,m||Date.now(),Date.now()]);else{if(v&&v.sort)v.sort();if(typeof g==="function")g.call(this,o,v)}}}}if(process.version.substr(0,4)==="v0.8"){var F=UZ(w);P=F.ReadStream,S=F.WriteStream}var W=w.ReadStream;if(W)P.prototype=Object.create(W.prototype),P.prototype.open=_;var E=w.WriteStream;if(E)S.prototype=Object.create(E.prototype),S.prototype.open=aw;Object.defineProperty(w,"ReadStream",{get:function(){return P},set:function(T){P=T},enumerable:!0,configurable:!0}),Object.defineProperty(w,"WriteStream",{get:function(){return S},set:function(T){S=T},enumerable:!0,configurable:!0});var B=P;Object.defineProperty(w,"FileReadStream",{get:function(){return B},set:function(T){B=T},enumerable:!0,configurable:!0});var j=S;Object.defineProperty(w,"FileWriteStream",{get:function(){return j},set:function(T){j=T},enumerable:!0,configurable:!0});function P(T,x){if(this instanceof P)return W.apply(this,arguments),this;else return P.apply(Object.create(P.prototype),arguments)}function _(){var T=this;N$(T.path,T.flags,T.mode,function(x,I){if(x){if(T.autoClose)T.destroy();T.emit("error",x)}else T.fd=I,T.emit("open",I),T.read()})}function S(T,x){if(this instanceof S)return E.apply(this,arguments),this;else return S.apply(Object.create(S.prototype),arguments)}function aw(){var T=this;N$(T.path,T.flags,T.mode,function(x,I){if(x)T.destroy(),T.emit("error",x);else T.fd=I,T.emit("open",I)})}function v$(T,x){return new w.ReadStream(T,x)}function k$(T,x){return new w.WriteStream(T,x)}var M1=w.open;w.open=N$;function N$(T,x,I,p){if(typeof I==="function")p=I,I=null;return r(T,x,I,p);function r(d,u,g,m,o){return M1(d,u,g,function(v,cw){if(v&&(v.code==="EMFILE"||v.code==="ENFILE"))X$([r,[d,u,g,m],v,o||Date.now(),Date.now()]);else if(typeof m==="function")m.apply(this,arguments)})}}return w}function X$(w){sw("ENQUEUE",w[0].name,w[1]),n[Yw].push(w),m1()}var o$;function dq(){var w=Date.now();for(var $=0;$<n[Yw].length;++$)if(n[Yw][$].length>2)n[Yw][$][3]=w,n[Yw][$][4]=w;m1()}function m1(){if(clearTimeout(o$),o$=void 0,n[Yw].length===0)return;var w=n[Yw].shift(),$=w[0],q=w[1],J=w[2],Y=w[3],U=w[4];if(Y===void 0)sw("RETRY",$.name,q),$.apply(null,q);else if(Date.now()-Y>=60000){sw("TIMEOUT",$.name,q);var X=q.pop();if(typeof X==="function")X.call(null,J)}else{var M=Date.now()-U,Q=Math.max(U-Y,1),V=Math.min(Q*1.2,100);if(M>=V)sw("RETRY",$.name,q),$.apply(null,q.concat([Y]));else n[Yw].push(w)}if(o$===void 0)o$=setTimeout(m1,0)}});var Gw=R((v1)=>{var pq=t().fromCallback,zw=z$(),zZ=["access","appendFile","chmod","chown","close","copyFile","cp","fchmod","fchown","fdatasync","fstat","fsync","ftruncate","futimes","glob","lchmod","lchown","lutimes","link","lstat","mkdir","mkdtemp","open","opendir","readdir","readFile","readlink","realpath","rename","rm","rmdir","stat","statfs","symlink","truncate","unlink","utimes","writeFile"].filter((w)=>{return typeof zw[w]==="function"});Object.assign(v1,zw);zZ.forEach((w)=>{v1[w]=pq(zw[w])});v1.exists=function(w,$){if(typeof $==="function")return zw.exists(w,$);return new Promise((q)=>{return zw.exists(w,q)})};v1.read=function(w,$,q,J,Y,U){if(typeof U==="function")return zw.read(w,$,q,J,Y,U);return new Promise((X,M)=>{zw.read(w,$,q,J,Y,(Q,V,z)=>{if(Q)return M(Q);X({bytesRead:V,buffer:z})})})};v1.write=function(w,$,...q){if(typeof q[q.length-1]==="function")return zw.write(w,$,...q);return new Promise((J,Y)=>{zw.write(w,$,...q,(U,X,M)=>{if(U)return Y(U);J({bytesWritten:X,buffer:M})})})};v1.readv=function(w,$,...q){if(typeof q[q.length-1]==="function")return zw.readv(w,$,...q);return new Promise((J,Y)=>{zw.readv(w,$,...q,(U,X,M)=>{if(U)return Y(U);J({bytesRead:X,buffers:M})})})};v1.writev=function(w,$,...q){if(typeof q[q.length-1]==="function")return zw.writev(w,$,...q);return new Promise((J,Y)=>{zw.writev(w,$,...q,(U,X,M)=>{if(U)return Y(U);J({bytesWritten:X,buffers:M})})})};if(typeof zw.realpath.native==="function")v1.realpath.native=pq(zw.realpath.native);else process.emitWarning("fs.realpath.native is not a function. Is fs being monkey-patched?","Warning","fs-extra-WARN0003")});var oq=R((DZ,rq)=>{var VZ=h("path");DZ.checkPath=function w($){if(process.platform==="win32"){if(/[<>:"|?*]/.test($.replace(VZ.parse($).root,""))){let J=new Error(`Path contains invalid characters: ${$}`);throw J.code="EINVAL",J}}}});var sq=R((EZ,k1)=>{var aq=Gw(),{checkPath:eq}=oq(),tq=(w)=>{let $={mode:511};if(typeof w==="number")return w;return{...$,...w}.mode};EZ.makeDir=async(w,$)=>{return eq(w),aq.mkdir(w,{mode:tq($),recursive:!0})};EZ.makeDirSync=(w,$)=>{return eq(w),aq.mkdirSync(w,{mode:tq($),recursive:!0})}});var jw=R((PM,w0)=>{var LZ=t().fromPromise,{makeDir:yZ,makeDirSync:u1}=sq(),b1=LZ(yZ);w0.exports={mkdirs:b1,mkdirsSync:u1,mkdirp:b1,mkdirpSync:u1,ensureDir:b1,ensureDirSync:u1}});var fw=R((xM,q0)=>{var RZ=t().fromPromise,$0=Gw();function TZ(w){return $0.access(w).then(()=>!0).catch(()=>!1)}q0.exports={pathExists:RZ(TZ),pathExistsSync:$0.existsSync}});var S1=R((mM,J0)=>{var G$=Gw(),AZ=t().fromPromise;async function BZ(w,$,q){let J=await G$.open(w,"r+"),Y=null;try{await G$.futimes(J,$,q)}finally{try{await G$.close(J)}catch(U){Y=U}}if(Y)throw Y}function jZ(w,$,q){let J=G$.openSync(w,"r+");return G$.futimesSync(J,$,q),G$.closeSync(J)}J0.exports={utimesMillis:AZ(BZ),utimesMillisSync:jZ}});var w$=R((_M,U0)=>{var M$=Gw(),s=h("path"),Y0=t().fromPromise;function IZ(w,$,q){let J=q.dereference?(Y)=>M$.stat(Y,{bigint:!0}):(Y)=>M$.lstat(Y,{bigint:!0});return Promise.all([J(w),J($).catch((Y)=>{if(Y.code==="ENOENT")return null;throw Y})]).then(([Y,U])=>({srcStat:Y,destStat:U}))}function PZ(w,$,q){let J,Y=q.dereference?(X)=>M$.statSync(X,{bigint:!0}):(X)=>M$.lstatSync(X,{bigint:!0}),U=Y(w);try{J=Y($)}catch(X){if(X.code==="ENOENT")return{srcStat:U,destStat:null};throw X}return{srcStat:U,destStat:J}}async function xZ(w,$,q,J){let{srcStat:Y,destStat:U}=await IZ(w,$,J);if(U){if(y$(Y,U)){let X=s.basename(w),M=s.basename($);if(q==="move"&&X!==M&&X.toLowerCase()===M.toLowerCase())return{srcStat:Y,destStat:U,isChangingCase:!0};throw new Error("Source and destination must not be the same.")}if(Y.isDirectory()&&!U.isDirectory())throw new Error(`Cannot overwrite non-directory '${$}' with directory '${w}'.`);if(!Y.isDirectory()&&U.isDirectory())throw new Error(`Cannot overwrite directory '${$}' with non-directory '${w}'.`)}if(Y.isDirectory()&&g1(w,$))throw new Error(e$(w,$,q));return{srcStat:Y,destStat:U}}function mZ(w,$,q,J){let{srcStat:Y,destStat:U}=PZ(w,$,J);if(U){if(y$(Y,U)){let X=s.basename(w),M=s.basename($);if(q==="move"&&X!==M&&X.toLowerCase()===M.toLowerCase())return{srcStat:Y,destStat:U,isChangingCase:!0};throw new Error("Source and destination must not be the same.")}if(Y.isDirectory()&&!U.isDirectory())throw new Error(`Cannot overwrite non-directory '${$}' with directory '${w}'.`);if(!Y.isDirectory()&&U.isDirectory())throw new Error(`Cannot overwrite directory '${$}' with non-directory '${w}'.`)}if(Y.isDirectory()&&g1(w,$))throw new Error(e$(w,$,q));return{srcStat:Y,destStat:U}}async function Z0(w,$,q,J){let Y=s.resolve(s.dirname(w)),U=s.resolve(s.dirname(q));if(U===Y||U===s.parse(U).root)return;let X;try{X=await M$.stat(U,{bigint:!0})}catch(M){if(M.code==="ENOENT")return;throw M}if(y$($,X))throw new Error(e$(w,q,J));return Z0(w,$,U,J)}function K0(w,$,q,J){let Y=s.resolve(s.dirname(w)),U=s.resolve(s.dirname(q));if(U===Y||U===s.parse(U).root)return;let X;try{X=M$.statSync(U,{bigint:!0})}catch(M){if(M.code==="ENOENT")return;throw M}if(y$($,X))throw new Error(e$(w,q,J));return K0(w,$,U,J)}function y$(w,$){return $.ino&&$.dev&&$.ino===w.ino&&$.dev===w.dev}function g1(w,$){let q=s.resolve(w).split(s.sep).filter((Y)=>Y),J=s.resolve($).split(s.sep).filter((Y)=>Y);return q.every((Y,U)=>J[U]===Y)}function e$(w,$,q){return`Cannot ${q} '${w}' to a subdirectory of itself, '${$}'.`}U0.exports={checkPaths:Y0(xZ),checkPathsSync:mZ,checkParentPaths:Y0(Z0),checkParentPathsSync:K0,isSrcSubdir:g1,areIdentical:y$}});var M0=R((vM,G0)=>{var Uw=Gw(),R$=h("path"),{mkdirs:_Z}=jw(),{pathExists:vZ}=fw(),{utimesMillis:kZ}=S1(),T$=w$();async function uZ(w,$,q={}){if(typeof q==="function")q={filter:q};if(q.clobber="clobber"in q?!!q.clobber:!0,q.overwrite="overwrite"in q?!!q.overwrite:q.clobber,q.preserveTimestamps&&process.arch==="ia32")process.emitWarning(`Using the preserveTimestamps option in 32-bit node is not recommended;

	see https://github.com/jprichardson/node-fs-extra/issues/269`,"Warning","fs-extra-WARN0001");let{srcStat:J,destStat:Y}=await T$.checkPaths(w,$,"copy",q);if(await T$.checkParentPaths(w,J,$,"copy"),!await X0(w,$,q))return;let X=R$.dirname($);if(!await vZ(X))await _Z(X);await z0(Y,w,$,q)}async function X0(w,$,q){if(!q.filter)return!0;return q.filter(w,$)}async function z0(w,$,q,J){let U=await(J.dereference?Uw.stat:Uw.lstat)($);if(U.isDirectory())return hZ(U,w,$,q,J);if(U.isFile()||U.isCharacterDevice()||U.isBlockDevice())return bZ(U,w,$,q,J);if(U.isSymbolicLink())return iZ(w,$,q,J);if(U.isSocket())throw new Error(`Cannot copy a socket file: ${$}`);if(U.isFIFO())throw new Error(`Cannot copy a FIFO pipe: ${$}`);throw new Error(`Unknown file: ${$}`)}async function bZ(w,$,q,J,Y){if(!$)return O0(w,q,J,Y);if(Y.overwrite)return await Uw.unlink(J),O0(w,q,J,Y);if(Y.errorOnExist)throw new Error(`'${J}' already exists`)}async function O0(w,$,q,J){if(await Uw.copyFile($,q),J.preserveTimestamps){if(SZ(w.mode))await gZ(q,w.mode);let Y=await Uw.stat($);await kZ(q,Y.atime,Y.mtime)}return Uw.chmod(q,w.mode)}function SZ(w){return(w&128)===0}function gZ(w,$){return Uw.chmod(w,$|128)}async function hZ(w,$,q,J,Y){if(!$)await Uw.mkdir(J);let U=[];for await(let X of await Uw.opendir(q)){let M=R$.join(q,X.name),Q=R$.join(J,X.name);U.push(X0(M,Q,Y).then((V)=>{if(V)return T$.checkPaths(M,Q,"copy",Y).then(({destStat:z})=>{return z0(z,M,Q,Y)})}))}if(await Promise.all(U),!$)await Uw.chmod(J,w.mode)}async function iZ(w,$,q,J){let Y=await Uw.readlink($);if(J.dereference)Y=R$.resolve(process.cwd(),Y);if(!w)return Uw.symlink(Y,q);let U=null;try{U=await Uw.readlink(q)}catch(X){if(X.code==="EINVAL"||X.code==="UNKNOWN")return Uw.symlink(Y,q);throw X}if(J.dereference)U=R$.resolve(process.cwd(),U);if(T$.isSrcSubdir(Y,U))throw new Error(`Cannot copy '${Y}' to a subdirectory of itself, '${U}'.`);if(T$.isSrcSubdir(U,Y))throw new Error(`Cannot overwrite '${U}' with '${Y}'.`);return await Uw.unlink(q),Uw.symlink(Y,q)}G0.exports=uZ});var D0=R((kM,V0)=>{var Mw=z$(),A$=h("path"),cZ=jw().mkdirsSync,nZ=S1().utimesMillisSync,B$=w$();function lZ(w,$,q){if(typeof q==="function")q={filter:q};if(q=q||{},q.clobber="clobber"in q?!!q.clobber:!0,q.overwrite="overwrite"in q?!!q.overwrite:q.clobber,q.preserveTimestamps&&process.arch==="ia32")process.emitWarning(`Using the preserveTimestamps option in 32-bit node is not recommended;

	see https://github.com/jprichardson/node-fs-extra/issues/269`,"Warning","fs-extra-WARN0002");let{srcStat:J,destStat:Y}=B$.checkPathsSync(w,$,"copy",q);if(B$.checkParentPathsSync(w,J,$,"copy"),q.filter&&!q.filter(w,$))return;let U=A$.dirname($);if(!Mw.existsSync(U))cZ(U);return Q0(Y,w,$,q)}function Q0(w,$,q,J){let U=(J.dereference?Mw.statSync:Mw.lstatSync)($);if(U.isDirectory())return eZ(U,w,$,q,J);else if(U.isFile()||U.isCharacterDevice()||U.isBlockDevice())return dZ(U,w,$,q,J);else if(U.isSymbolicLink())return wK(w,$,q,J);else if(U.isSocket())throw new Error(`Cannot copy a socket file: ${$}`);else if(U.isFIFO())throw new Error(`Cannot copy a FIFO pipe: ${$}`);throw new Error(`Unknown file: ${$}`)}function dZ(w,$,q,J,Y){if(!$)return W0(w,q,J,Y);return fZ(w,q,J,Y)}function fZ(w,$,q,J){if(J.overwrite)return Mw.unlinkSync(q),W0(w,$,q,J);else if(J.errorOnExist)throw new Error(`'${q}' already exists`)}function W0(w,$,q,J){if(Mw.copyFileSync($,q),J.preserveTimestamps)pZ(w.mode,$,q);return h1(q,w.mode)}function pZ(w,$,q){if(rZ(w))oZ(q,w);return aZ($,q)}function rZ(w){return(w&128)===0}function oZ(w,$){return h1(w,$|128)}function h1(w,$){return Mw.chmodSync(w,$)}function aZ(w,$){let q=Mw.statSync(w);return nZ($,q.atime,q.mtime)}function eZ(w,$,q,J,Y){if(!$)return tZ(w.mode,q,J,Y);return H0(q,J,Y)}function tZ(w,$,q,J){return Mw.mkdirSync(q),H0($,q,J),h1(q,w)}function H0(w,$,q){let J=Mw.opendirSync(w);try{let Y;while((Y=J.readSync())!==null)sZ(Y.name,w,$,q)}finally{J.closeSync()}}function sZ(w,$,q,J){let Y=A$.join($,w),U=A$.join(q,w);if(J.filter&&!J.filter(Y,U))return;let{destStat:X}=B$.checkPathsSync(Y,U,"copy",J);return Q0(X,Y,U,J)}function wK(w,$,q,J){let Y=Mw.readlinkSync($);if(J.dereference)Y=A$.resolve(process.cwd(),Y);if(!w)return Mw.symlinkSync(Y,q);else{let U;try{U=Mw.readlinkSync(q)}catch(X){if(X.code==="EINVAL"||X.code==="UNKNOWN")return Mw.symlinkSync(Y,q);throw X}if(J.dereference)U=A$.resolve(process.cwd(),U);if(B$.isSrcSubdir(Y,U))throw new Error(`Cannot copy '${Y}' to a subdirectory of itself, '${U}'.`);if(B$.isSrcSubdir(U,Y))throw new Error(`Cannot overwrite '${U}' with '${Y}'.`);return $K(Y,q)}}function $K(w,$){return Mw.unlinkSync($),Mw.symlinkSync(w,$)}V0.exports=lZ});var t$=R((uM,N0)=>{var qK=t().fromPromise;N0.exports={copy:qK(M0()),copySync:D0()}});var j$=R((bM,F0)=>{var E0=z$(),JK=t().fromCallback;function YK(w,$){E0.rm(w,{recursive:!0,force:!0},$)}function ZK(w){E0.rmSync(w,{recursive:!0,force:!0})}F0.exports={remove:JK(YK),removeSync:ZK}});var j0=R((SM,B0)=>{var KK=t().fromPromise,y0=Gw(),R0=h("path"),T0=jw(),A0=j$(),C0=KK(async function w($){let q;try{q=await y0.readdir($)}catch{return T0.mkdirs($)}return Promise.all(q.map((J)=>A0.remove(R0.join($,J))))});function L0(w){let $;try{$=y0.readdirSync(w)}catch{return T0.mkdirsSync(w)}$.forEach((q)=>{q=R0.join(w,q),A0.removeSync(q)})}B0.exports={emptyDirSync:L0,emptydirSync:L0,emptyDir:C0,emptydir:C0}});var m0=R((gM,x0)=>{var UK=t().fromPromise,I0=h("path"),gw=Gw(),P0=jw();async function OK(w){let $;try{$=await gw.stat(w)}catch{}if($&&$.isFile())return;let q=I0.dirname(w),J=null;try{J=await gw.stat(q)}catch(Y){if(Y.code==="ENOENT"){await P0.mkdirs(q),await gw.writeFile(w,"");return}else throw Y}if(J.isDirectory())await gw.writeFile(w,"");else await gw.readdir(q)}function XK(w){let $;try{$=gw.statSync(w)}catch{}if($&&$.isFile())return;let q=I0.dirname(w);try{if(!gw.statSync(q).isDirectory())gw.readdirSync(q)}catch(J){if(J&&J.code==="ENOENT")P0.mkdirsSync(q);else throw J}gw.writeFileSync(w,"")}x0.exports={createFile:UK(OK),createFileSync:XK}});var b0=R((hM,u0)=>{var zK=t().fromPromise,_0=h("path"),pw=Gw(),v0=jw(),{pathExists:GK}=fw(),{areIdentical:k0}=w$();async function MK(w,$){let q;try{q=await pw.lstat($)}catch{}let J;try{J=await pw.lstat(w)}catch(X){throw X.message=X.message.replace("lstat","ensureLink"),X}if(q&&k0(J,q))return;let Y=_0.dirname($);if(!await GK(Y))await v0.mkdirs(Y);await pw.link(w,$)}function QK(w,$){let q;try{q=pw.lstatSync($)}catch{}try{let U=pw.lstatSync(w);if(q&&k0(U,q))return}catch(U){throw U.message=U.message.replace("lstat","ensureLink"),U}let J=_0.dirname($);if(pw.existsSync(J))return pw.linkSync(w,$);return v0.mkdirsSync(J),pw.linkSync(w,$)}u0.exports={createLink:zK(MK),createLinkSync:QK}});var g0=R((iM,S0)=>{var rw=h("path"),I$=Gw(),{pathExists:WK}=fw(),HK=t().fromPromise;async function VK(w,$){if(rw.isAbsolute(w)){try{await I$.lstat(w)}catch(U){throw U.message=U.message.replace("lstat","ensureSymlink"),U}return{toCwd:w,toDst:w}}let q=rw.dirname($),J=rw.join(q,w);if(await WK(J))return{toCwd:J,toDst:w};try{await I$.lstat(w)}catch(U){throw U.message=U.message.replace("lstat","ensureSymlink"),U}return{toCwd:w,toDst:rw.relative(q,w)}}function DK(w,$){if(rw.isAbsolute(w)){if(!I$.existsSync(w))throw new Error("absolute srcpath does not exist");return{toCwd:w,toDst:w}}let q=rw.dirname($),J=rw.join(q,w);if(I$.existsSync(J))return{toCwd:J,toDst:w};if(!I$.existsSync(w))throw new Error("relative srcpath does not exist");return{toCwd:w,toDst:rw.relative(q,w)}}S0.exports={symlinkPaths:HK(VK),symlinkPathsSync:DK}});var c0=R((cM,i0)=>{var h0=Gw(),NK=t().fromPromise;async function EK(w,$){if($)return $;let q;try{q=await h0.lstat(w)}catch{return"file"}return q&&q.isDirectory()?"dir":"file"}function FK(w,$){if($)return $;let q;try{q=h0.lstatSync(w)}catch{return"file"}return q&&q.isDirectory()?"dir":"file"}i0.exports={symlinkType:NK(EK),symlinkTypeSync:FK}});var f0=R((nM,d0)=>{var CK=t().fromPromise,n0=h("path"),xw=Gw(),{mkdirs:LK,mkdirsSync:yK}=jw(),{symlinkPaths:RK,symlinkPathsSync:TK}=g0(),{symlinkType:AK,symlinkTypeSync:BK}=c0(),{pathExists:jK}=fw(),{areIdentical:l0}=w$();async function IK(w,$,q){let J;try{J=await xw.lstat($)}catch{}if(J&&J.isSymbolicLink()){let[M,Q]=await Promise.all([xw.stat(w),xw.stat($)]);if(l0(M,Q))return}let Y=await RK(w,$);w=Y.toDst;let U=await AK(Y.toCwd,q),X=n0.dirname($);if(!await jK(X))await LK(X);return xw.symlink(w,$,U)}function PK(w,$,q){let J;try{J=xw.lstatSync($)}catch{}if(J&&J.isSymbolicLink()){let M=xw.statSync(w),Q=xw.statSync($);if(l0(M,Q))return}let Y=TK(w,$);w=Y.toDst,q=BK(Y.toCwd,q);let U=n0.dirname($);if(xw.existsSync(U))return xw.symlinkSync(w,$,q);return yK(U),xw.symlinkSync(w,$,q)}d0.exports={createSymlink:CK(IK),createSymlinkSync:PK}});var wJ=R((lM,s0)=>{var{createFile:p0,createFileSync:r0}=m0(),{createLink:o0,createLinkSync:a0}=b0(),{createSymlink:e0,createSymlinkSync:t0}=f0();s0.exports={createFile:p0,createFileSync:r0,ensureFile:p0,ensureFileSync:r0,createLink:o0,createLinkSync:a0,ensureLink:o0,ensureLinkSync:a0,createSymlink:e0,createSymlinkSync:t0,ensureSymlink:e0,ensureSymlinkSync:t0}});var s$=R((dM,$J)=>{function xK(w,{EOL:$=`
`,finalEOL:q=!0,replacer:J=null,spaces:Y}={}){let U=q?$:"";return JSON.stringify(w,J,Y).replace(/\n/g,$)+U}function mK(w){if(Buffer.isBuffer(w))w=w.toString("utf8");return w.replace(/^\uFEFF/,"")}$J.exports={stringify:xK,stripBom:mK}});var ZJ=R((fM,YJ)=>{var Q$;try{Q$=z$()}catch(w){Q$=h("fs")}var w1=t(),{stringify:qJ,stripBom:JJ}=s$();async function _K(w,$={}){if(typeof $==="string")$={encoding:$};let q=$.fs||Q$,J="throws"in $?$.throws:!0,Y=await w1.fromCallback(q.readFile)(w,$);Y=JJ(Y);let U;try{U=JSON.parse(Y,$?$.reviver:null)}catch(X){if(J)throw X.message=`${w}: ${X.message}`,X;else return null}return U}var vK=w1.fromPromise(_K);function kK(w,$={}){if(typeof $==="string")$={encoding:$};let q=$.fs||Q$,J="throws"in $?$.throws:!0;try{let Y=q.readFileSync(w,$);return Y=JJ(Y),JSON.parse(Y,$.reviver)}catch(Y){if(J)throw Y.message=`${w}: ${Y.message}`,Y;else return null}}async function uK(w,$,q={}){let J=q.fs||Q$,Y=qJ($,q);await w1.fromCallback(J.writeFile)(w,Y,q)}var bK=w1.fromPromise(uK);function SK(w,$,q={}){let J=q.fs||Q$,Y=qJ($,q);return J.writeFileSync(w,Y,q)}var gK={readFile:vK,readFileSync:kK,writeFile:bK,writeFileSync:SK};YJ.exports=gK});var UJ=R((pM,KJ)=>{var $1=ZJ();KJ.exports={readJson:$1.readFile,readJsonSync:$1.readFileSync,writeJson:$1.writeFile,writeJsonSync:$1.writeFileSync}});var q1=R((rM,zJ)=>{var hK=t().fromPromise,i1=Gw(),OJ=h("path"),XJ=jw(),iK=fw().pathExists;async function cK(w,$,q="utf-8"){let J=OJ.dirname(w);if(!await iK(J))await XJ.mkdirs(J);return i1.writeFile(w,$,q)}function nK(w,...$){let q=OJ.dirname(w);if(!i1.existsSync(q))XJ.mkdirsSync(q);i1.writeFileSync(w,...$)}zJ.exports={outputFile:hK(cK),outputFileSync:nK}});var MJ=R((oM,GJ)=>{var{stringify:lK}=s$(),{outputFile:dK}=q1();async function fK(w,$,q={}){let J=lK($,q);await dK(w,J,q)}GJ.exports=fK});var WJ=R((aM,QJ)=>{var{stringify:pK}=s$(),{outputFileSync:rK}=q1();function oK(w,$,q){let J=pK($,q);rK(w,J,q)}QJ.exports=oK});var VJ=R((eM,HJ)=>{var aK=t().fromPromise,Qw=UJ();Qw.outputJson=aK(MJ());Qw.outputJsonSync=WJ();Qw.outputJSON=Qw.outputJson;Qw.outputJSONSync=Qw.outputJsonSync;Qw.writeJSON=Qw.writeJson;Qw.writeJSONSync=Qw.writeJsonSync;Qw.readJSON=Qw.readJson;Qw.readJSONSync=Qw.readJsonSync;HJ.exports=Qw});var CJ=R((tM,FJ)=>{var eK=Gw(),DJ=h("path"),{copy:tK}=t$(),{remove:EJ}=j$(),{mkdirp:sK}=jw(),{pathExists:wU}=fw(),NJ=w$();async function $U(w,$,q={}){let J=q.overwrite||q.clobber||!1,{srcStat:Y,isChangingCase:U=!1}=await NJ.checkPaths(w,$,"move",q);await NJ.checkParentPaths(w,Y,$,"move");let X=DJ.dirname($);if(DJ.parse(X).root!==X)await sK(X);return qU(w,$,J,U)}async function qU(w,$,q,J){if(!J){if(q)await EJ($);else if(await wU($))throw new Error("dest already exists.")}try{await eK.rename(w,$)}catch(Y){if(Y.code!=="EXDEV")throw Y;await JU(w,$,q)}}async function JU(w,$,q){return await tK(w,$,{overwrite:q,errorOnExist:!0,preserveTimestamps:!0}),EJ(w)}FJ.exports=$U});var AJ=R((sM,TJ)=>{var yJ=z$(),n1=h("path"),YU=t$().copySync,RJ=j$().removeSync,ZU=jw().mkdirpSync,LJ=w$();function KU(w,$,q){q=q||{};let J=q.overwrite||q.clobber||!1,{srcStat:Y,isChangingCase:U=!1}=LJ.checkPathsSync(w,$,"move",q);if(LJ.checkParentPathsSync(w,Y,$,"move"),!UU($))ZU(n1.dirname($));return OU(w,$,J,U)}function UU(w){let $=n1.dirname(w);return n1.parse($).root===$}function OU(w,$,q,J){if(J)return c1(w,$,q);if(q)return RJ($),c1(w,$,q);if(yJ.existsSync($))throw new Error("dest already exists.");return c1(w,$,q)}function c1(w,$,q){try{yJ.renameSync(w,$)}catch(J){if(J.code!=="EXDEV")throw J;return XU(w,$,q)}}function XU(w,$,q){return YU(w,$,{overwrite:q,errorOnExist:!0,preserveTimestamps:!0}),RJ(w)}TJ.exports=KU});var jJ=R((wQ,BJ)=>{var zU=t().fromPromise;BJ.exports={move:zU(CJ()),moveSync:AJ()}});var PJ=R(($Q,IJ)=>{IJ.exports={...Gw(),...t$(),...j0(),...wJ(),...VJ(),...jw(),...jJ(),...q1(),...fw(),...j$()}});var fJ=R((dJ)=>{Object.defineProperty(dJ,"__esModule",{value:!0});var cJ=h("buffer"),q$={INVALID_ENCODING:"Invalid encoding provided. Please specify a valid encoding the internal Node.js Buffer supports.",INVALID_SMARTBUFFER_SIZE:"Invalid size provided. Size must be a valid integer greater than zero.",INVALID_SMARTBUFFER_BUFFER:"Invalid Buffer provided in SmartBufferOptions.",INVALID_SMARTBUFFER_OBJECT:"Invalid SmartBufferOptions object supplied to SmartBuffer constructor or factory methods.",INVALID_OFFSET:"An invalid offset value was provided.",INVALID_OFFSET_NON_NUMBER:"An invalid offset value was provided. A numeric value is required.",INVALID_LENGTH:"An invalid length value was provided.",INVALID_LENGTH_NON_NUMBER:"An invalid length value was provived. A numeric value is required.",INVALID_TARGET_OFFSET:"Target offset is beyond the bounds of the internal SmartBuffer data.",INVALID_TARGET_LENGTH:"Specified length value moves cursor beyong the bounds of the internal SmartBuffer data.",INVALID_READ_BEYOND_BOUNDS:"Attempted to read beyond the bounds of the managed data.",INVALID_WRITE_BEYOND_BOUNDS:"Attempted to write beyond the bounds of the managed data."};dJ.ERRORS=q$;function TU(w){if(!cJ.Buffer.isEncoding(w))throw new Error(q$.INVALID_ENCODING)}dJ.checkEncoding=TU;function nJ(w){return typeof w==="number"&&isFinite(w)&&IU(w)}dJ.isFiniteInteger=nJ;function lJ(w,$){if(typeof w==="number"){if(!nJ(w)||w<0)throw new Error($?q$.INVALID_OFFSET:q$.INVALID_LENGTH)}else throw new Error($?q$.INVALID_OFFSET_NON_NUMBER:q$.INVALID_LENGTH_NON_NUMBER)}function AU(w){lJ(w,!1)}dJ.checkLengthValue=AU;function BU(w){lJ(w,!0)}dJ.checkOffsetValue=BU;function jU(w,$){if(w<0||w>$.length)throw new Error(q$.INVALID_TARGET_OFFSET)}dJ.checkTargetOffset=jU;function IU(w){return typeof w==="number"&&isFinite(w)&&Math.floor(w)===w}function PU(w){if(typeof BigInt==="undefined")throw new Error("Platform does not support JS BigInt type.");if(typeof cJ.Buffer.prototype[w]==="undefined")throw new Error(`Platform does not support Buffer.prototype.${w}.`)}dJ.bigIntAndBufferInt64Check=PU});var oJ=R((rJ)=>{Object.defineProperty(rJ,"__esModule",{value:!0});var A=fJ(),pJ=4096,SU="utf8";class d1{constructor(w){if(this.length=0,this._encoding=SU,this._writeOffset=0,this._readOffset=0,d1.isSmartBufferOptions(w)){if(w.encoding)A.checkEncoding(w.encoding),this._encoding=w.encoding;if(w.size)if(A.isFiniteInteger(w.size)&&w.size>0)this._buff=Buffer.allocUnsafe(w.size);else throw new Error(A.ERRORS.INVALID_SMARTBUFFER_SIZE);else if(w.buff)if(Buffer.isBuffer(w.buff))this._buff=w.buff,this.length=w.buff.length;else throw new Error(A.ERRORS.INVALID_SMARTBUFFER_BUFFER);else this._buff=Buffer.allocUnsafe(pJ)}else{if(typeof w!=="undefined")throw new Error(A.ERRORS.INVALID_SMARTBUFFER_OBJECT);this._buff=Buffer.allocUnsafe(pJ)}}static fromSize(w,$){return new this({size:w,encoding:$})}static fromBuffer(w,$){return new this({buff:w,encoding:$})}static fromOptions(w){return new this(w)}static isSmartBufferOptions(w){let $=w;return $&&($.encoding!==void 0||$.size!==void 0||$.buff!==void 0)}readInt8(w){return this._readNumberValue(Buffer.prototype.readInt8,1,w)}readInt16BE(w){return this._readNumberValue(Buffer.prototype.readInt16BE,2,w)}readInt16LE(w){return this._readNumberValue(Buffer.prototype.readInt16LE,2,w)}readInt32BE(w){return this._readNumberValue(Buffer.prototype.readInt32BE,4,w)}readInt32LE(w){return this._readNumberValue(Buffer.prototype.readInt32LE,4,w)}readBigInt64BE(w){return A.bigIntAndBufferInt64Check("readBigInt64BE"),this._readNumberValue(Buffer.prototype.readBigInt64BE,8,w)}readBigInt64LE(w){return A.bigIntAndBufferInt64Check("readBigInt64LE"),this._readNumberValue(Buffer.prototype.readBigInt64LE,8,w)}writeInt8(w,$){return this._writeNumberValue(Buffer.prototype.writeInt8,1,w,$),this}insertInt8(w,$){return this._insertNumberValue(Buffer.prototype.writeInt8,1,w,$)}writeInt16BE(w,$){return this._writeNumberValue(Buffer.prototype.writeInt16BE,2,w,$)}insertInt16BE(w,$){return this._insertNumberValue(Buffer.prototype.writeInt16BE,2,w,$)}writeInt16LE(w,$){return this._writeNumberValue(Buffer.prototype.writeInt16LE,2,w,$)}insertInt16LE(w,$){return this._insertNumberValue(Buffer.prototype.writeInt16LE,2,w,$)}writeInt32BE(w,$){return this._writeNumberValue(Buffer.prototype.writeInt32BE,4,w,$)}insertInt32BE(w,$){return this._insertNumberValue(Buffer.prototype.writeInt32BE,4,w,$)}writeInt32LE(w,$){return this._writeNumberValue(Buffer.prototype.writeInt32LE,4,w,$)}insertInt32LE(w,$){return this._insertNumberValue(Buffer.prototype.writeInt32LE,4,w,$)}writeBigInt64BE(w,$){return A.bigIntAndBufferInt64Check("writeBigInt64BE"),this._writeNumberValue(Buffer.prototype.writeBigInt64BE,8,w,$)}insertBigInt64BE(w,$){return A.bigIntAndBufferInt64Check("writeBigInt64BE"),this._insertNumberValue(Buffer.prototype.writeBigInt64BE,8,w,$)}writeBigInt64LE(w,$){return A.bigIntAndBufferInt64Check("writeBigInt64LE"),this._writeNumberValue(Buffer.prototype.writeBigInt64LE,8,w,$)}insertBigInt64LE(w,$){return A.bigIntAndBufferInt64Check("writeBigInt64LE"),this._insertNumberValue(Buffer.prototype.writeBigInt64LE,8,w,$)}readUInt8(w){return this._readNumberValue(Buffer.prototype.readUInt8,1,w)}readUInt16BE(w){return this._readNumberValue(Buffer.prototype.readUInt16BE,2,w)}readUInt16LE(w){return this._readNumberValue(Buffer.prototype.readUInt16LE,2,w)}readUInt32BE(w){return this._readNumberValue(Buffer.prototype.readUInt32BE,4,w)}readUInt32LE(w){return this._readNumberValue(Buffer.prototype.readUInt32LE,4,w)}readBigUInt64BE(w){return A.bigIntAndBufferInt64Check("readBigUInt64BE"),this._readNumberValue(Buffer.prototype.readBigUInt64BE,8,w)}readBigUInt64LE(w){return A.bigIntAndBufferInt64Check("readBigUInt64LE"),this._readNumberValue(Buffer.prototype.readBigUInt64LE,8,w)}writeUInt8(w,$){return this._writeNumberValue(Buffer.prototype.writeUInt8,1,w,$)}insertUInt8(w,$){return this._insertNumberValue(Buffer.prototype.writeUInt8,1,w,$)}writeUInt16BE(w,$){return this._writeNumberValue(Buffer.prototype.writeUInt16BE,2,w,$)}insertUInt16BE(w,$){return this._insertNumberValue(Buffer.prototype.writeUInt16BE,2,w,$)}writeUInt16LE(w,$){return this._writeNumberValue(Buffer.prototype.writeUInt16LE,2,w,$)}insertUInt16LE(w,$){return this._insertNumberValue(Buffer.prototype.writeUInt16LE,2,w,$)}writeUInt32BE(w,$){return this._writeNumberValue(Buffer.prototype.writeUInt32BE,4,w,$)}insertUInt32BE(w,$){return this._insertNumberValue(Buffer.prototype.writeUInt32BE,4,w,$)}writeUInt32LE(w,$){return this._writeNumberValue(Buffer.prototype.writeUInt32LE,4,w,$)}insertUInt32LE(w,$){return this._insertNumberValue(Buffer.prototype.writeUInt32LE,4,w,$)}writeBigUInt64BE(w,$){return A.bigIntAndBufferInt64Check("writeBigUInt64BE"),this._writeNumberValue(Buffer.prototype.writeBigUInt64BE,8,w,$)}insertBigUInt64BE(w,$){return A.bigIntAndBufferInt64Check("writeBigUInt64BE"),this._insertNumberValue(Buffer.prototype.writeBigUInt64BE,8,w,$)}writeBigUInt64LE(w,$){return A.bigIntAndBufferInt64Check("writeBigUInt64LE"),this._writeNumberValue(Buffer.prototype.writeBigUInt64LE,8,w,$)}insertBigUInt64LE(w,$){return A.bigIntAndBufferInt64Check("writeBigUInt64LE"),this._insertNumberValue(Buffer.prototype.writeBigUInt64LE,8,w,$)}readFloatBE(w){return this._readNumberValue(Buffer.prototype.readFloatBE,4,w)}readFloatLE(w){return this._readNumberValue(Buffer.prototype.readFloatLE,4,w)}writeFloatBE(w,$){return this._writeNumberValue(Buffer.prototype.writeFloatBE,4,w,$)}insertFloatBE(w,$){return this._insertNumberValue(Buffer.prototype.writeFloatBE,4,w,$)}writeFloatLE(w,$){return this._writeNumberValue(Buffer.prototype.writeFloatLE,4,w,$)}insertFloatLE(w,$){return this._insertNumberValue(Buffer.prototype.writeFloatLE,4,w,$)}readDoubleBE(w){return this._readNumberValue(Buffer.prototype.readDoubleBE,8,w)}readDoubleLE(w){return this._readNumberValue(Buffer.prototype.readDoubleLE,8,w)}writeDoubleBE(w,$){return this._writeNumberValue(Buffer.prototype.writeDoubleBE,8,w,$)}insertDoubleBE(w,$){return this._insertNumberValue(Buffer.prototype.writeDoubleBE,8,w,$)}writeDoubleLE(w,$){return this._writeNumberValue(Buffer.prototype.writeDoubleLE,8,w,$)}insertDoubleLE(w,$){return this._insertNumberValue(Buffer.prototype.writeDoubleLE,8,w,$)}readString(w,$){let q;if(typeof w==="number")A.checkLengthValue(w),q=Math.min(w,this.length-this._readOffset);else $=w,q=this.length-this._readOffset;if(typeof $!=="undefined")A.checkEncoding($);let J=this._buff.slice(this._readOffset,this._readOffset+q).toString($||this._encoding);return this._readOffset+=q,J}insertString(w,$,q){return A.checkOffsetValue($),this._handleString(w,!0,$,q)}writeString(w,$,q){return this._handleString(w,!1,$,q)}readStringNT(w){if(typeof w!=="undefined")A.checkEncoding(w);let $=this.length;for(let J=this._readOffset;J<this.length;J++)if(this._buff[J]===0){$=J;break}let q=this._buff.slice(this._readOffset,$);return this._readOffset=$+1,q.toString(w||this._encoding)}insertStringNT(w,$,q){return A.checkOffsetValue($),this.insertString(w,$,q),this.insertUInt8(0,$+w.length),this}writeStringNT(w,$,q){return this.writeString(w,$,q),this.writeUInt8(0,typeof $==="number"?$+w.length:this.writeOffset),this}readBuffer(w){if(typeof w!=="undefined")A.checkLengthValue(w);let $=typeof w==="number"?w:this.length,q=Math.min(this.length,this._readOffset+$),J=this._buff.slice(this._readOffset,q);return this._readOffset=q,J}insertBuffer(w,$){return A.checkOffsetValue($),this._handleBuffer(w,!0,$)}writeBuffer(w,$){return this._handleBuffer(w,!1,$)}readBufferNT(){let w=this.length;for(let q=this._readOffset;q<this.length;q++)if(this._buff[q]===0){w=q;break}let $=this._buff.slice(this._readOffset,w);return this._readOffset=w+1,$}insertBufferNT(w,$){return A.checkOffsetValue($),this.insertBuffer(w,$),this.insertUInt8(0,$+w.length),this}writeBufferNT(w,$){if(typeof $!=="undefined")A.checkOffsetValue($);return this.writeBuffer(w,$),this.writeUInt8(0,typeof $==="number"?$+w.length:this._writeOffset),this}clear(){return this._writeOffset=0,this._readOffset=0,this.length=0,this}remaining(){return this.length-this._readOffset}get readOffset(){return this._readOffset}set readOffset(w){A.checkOffsetValue(w),A.checkTargetOffset(w,this),this._readOffset=w}get writeOffset(){return this._writeOffset}set writeOffset(w){A.checkOffsetValue(w),A.checkTargetOffset(w,this),this._writeOffset=w}get encoding(){return this._encoding}set encoding(w){A.checkEncoding(w),this._encoding=w}get internalBuffer(){return this._buff}toBuffer(){return this._buff.slice(0,this.length)}toString(w){let $=typeof w==="string"?w:this._encoding;return A.checkEncoding($),this._buff.toString($,0,this.length)}destroy(){return this.clear(),this}_handleString(w,$,q,J){let Y=this._writeOffset,U=this._encoding;if(typeof q==="number")Y=q;else if(typeof q==="string")A.checkEncoding(q),U=q;if(typeof J==="string")A.checkEncoding(J),U=J;let X=Buffer.byteLength(w,U);if($)this.ensureInsertable(X,Y);else this._ensureWriteable(X,Y);if(this._buff.write(w,Y,X,U),$)this._writeOffset+=X;else if(typeof q==="number")this._writeOffset=Math.max(this._writeOffset,Y+X);else this._writeOffset+=X;return this}_handleBuffer(w,$,q){let J=typeof q==="number"?q:this._writeOffset;if($)this.ensureInsertable(w.length,J);else this._ensureWriteable(w.length,J);if(w.copy(this._buff,J),$)this._writeOffset+=w.length;else if(typeof q==="number")this._writeOffset=Math.max(this._writeOffset,J+w.length);else this._writeOffset+=w.length;return this}ensureReadable(w,$){let q=this._readOffset;if(typeof $!=="undefined")A.checkOffsetValue($),q=$;if(q<0||q+w>this.length)throw new Error(A.ERRORS.INVALID_READ_BEYOND_BOUNDS)}ensureInsertable(w,$){if(A.checkOffsetValue($),this._ensureCapacity(this.length+w),$<this.length)this._buff.copy(this._buff,$+w,$,this._buff.length);if($+w>this.length)this.length=$+w;else this.length+=w}_ensureWriteable(w,$){let q=typeof $==="number"?$:this._writeOffset;if(this._ensureCapacity(q+w),q+w>this.length)this.length=q+w}_ensureCapacity(w){let $=this._buff.length;if(w>$){let q=this._buff,J=$*3/2+1;if(J<w)J=w;this._buff=Buffer.allocUnsafe(J),q.copy(this._buff,0,0,$)}}_readNumberValue(w,$,q){this.ensureReadable($,q);let J=w.call(this._buff,typeof q==="number"?q:this._readOffset);if(typeof q==="undefined")this._readOffset+=$;return J}_insertNumberValue(w,$,q,J){return A.checkOffsetValue(J),this.ensureInsertable($,J),w.call(this._buff,q,J),this._writeOffset+=$,this}_writeNumberValue(w,$,q,J){if(typeof J==="number"){if(J<0)throw new Error(A.ERRORS.INVALID_WRITE_BEYOND_BOUNDS);A.checkOffsetValue(J)}let Y=typeof J==="number"?J:this._writeOffset;if(this._ensureWriteable($,Y),w.call(this._buff,q,Y),typeof J==="number")this._writeOffset=Math.max(this._writeOffset,Y+$);else this._writeOffset+=$;return this}}rJ.SmartBuffer=d1});var f1=R((q9)=>{Object.defineProperty(q9,"__esModule",{value:!0});q9.SOCKS5_NO_ACCEPTABLE_AUTH=q9.SOCKS5_CUSTOM_AUTH_END=q9.SOCKS5_CUSTOM_AUTH_START=q9.SOCKS_INCOMING_PACKET_SIZES=q9.SocksClientState=q9.Socks5Response=q9.Socks5HostType=q9.Socks5Auth=q9.Socks4Response=q9.SocksCommand=q9.ERRORS=q9.DEFAULT_TIMEOUT=void 0;var hU=30000;q9.DEFAULT_TIMEOUT=hU;var iU={InvalidSocksCommand:"An invalid SOCKS command was provided. Valid options are connect, bind, and associate.",InvalidSocksCommandForOperation:"An invalid SOCKS command was provided. Only a subset of commands are supported for this operation.",InvalidSocksCommandChain:"An invalid SOCKS command was provided. Chaining currently only supports the connect command.",InvalidSocksClientOptionsDestination:"An invalid destination host was provided.",InvalidSocksClientOptionsExistingSocket:"An invalid existing socket was provided. This should be an instance of stream.Duplex.",InvalidSocksClientOptionsProxy:"Invalid SOCKS proxy details were provided.",InvalidSocksClientOptionsTimeout:"An invalid timeout value was provided. Please enter a value above 0 (in ms).",InvalidSocksClientOptionsProxiesLength:"At least two socks proxies must be provided for chaining.",InvalidSocksClientOptionsCustomAuthRange:"Custom auth must be a value between 0x80 and 0xFE.",InvalidSocksClientOptionsCustomAuthOptions:"When a custom_auth_method is provided, custom_auth_request_handler, custom_auth_response_size, and custom_auth_response_handler must also be provided and valid.",NegotiationError:"Negotiation error",SocketClosed:"Socket closed",ProxyConnectionTimedOut:"Proxy connection timed out",InternalError:"SocksClient internal error (this should not happen)",InvalidSocks4HandshakeResponse:"Received invalid Socks4 handshake response",Socks4ProxyRejectedConnection:"Socks4 Proxy rejected connection",InvalidSocks4IncomingConnectionResponse:"Socks4 invalid incoming connection response",Socks4ProxyRejectedIncomingBoundConnection:"Socks4 Proxy rejected incoming bound connection",InvalidSocks5InitialHandshakeResponse:"Received invalid Socks5 initial handshake response",InvalidSocks5IntiailHandshakeSocksVersion:"Received invalid Socks5 initial handshake (invalid socks version)",InvalidSocks5InitialHandshakeNoAcceptedAuthType:"Received invalid Socks5 initial handshake (no accepted authentication type)",InvalidSocks5InitialHandshakeUnknownAuthType:"Received invalid Socks5 initial handshake (unknown authentication type)",Socks5AuthenticationFailed:"Socks5 Authentication failed",InvalidSocks5FinalHandshake:"Received invalid Socks5 final handshake response",InvalidSocks5FinalHandshakeRejected:"Socks5 proxy rejected connection",InvalidSocks5IncomingConnectionResponse:"Received invalid Socks5 incoming connection response",Socks5ProxyRejectedIncomingBoundConnection:"Socks5 Proxy rejected incoming bound connection"};q9.ERRORS=iU;var cU={Socks5InitialHandshakeResponse:2,Socks5UserPassAuthenticationResponse:2,Socks5ResponseHeader:5,Socks5ResponseIPv4:10,Socks5ResponseIPv6:22,Socks5ResponseHostname:(w)=>w+7,Socks4Response:8};q9.SOCKS_INCOMING_PACKET_SIZES=cU;var aJ;(function(w){w[w.connect=1]="connect",w[w.bind=2]="bind",w[w.associate=3]="associate"})(aJ||(q9.SocksCommand=aJ={}));var eJ;(function(w){w[w.Granted=90]="Granted",w[w.Failed=91]="Failed",w[w.Rejected=92]="Rejected",w[w.RejectedIdent=93]="RejectedIdent"})(eJ||(q9.Socks4Response=eJ={}));var tJ;(function(w){w[w.NoAuth=0]="NoAuth",w[w.GSSApi=1]="GSSApi",w[w.UserPass=2]="UserPass"})(tJ||(q9.Socks5Auth=tJ={}));var nU=128;q9.SOCKS5_CUSTOM_AUTH_START=nU;var lU=254;q9.SOCKS5_CUSTOM_AUTH_END=lU;var dU=255;q9.SOCKS5_NO_ACCEPTABLE_AUTH=dU;var sJ;(function(w){w[w.Granted=0]="Granted",w[w.Failure=1]="Failure",w[w.NotAllowed=2]="NotAllowed",w[w.NetworkUnreachable=3]="NetworkUnreachable",w[w.HostUnreachable=4]="HostUnreachable",w[w.ConnectionRefused=5]="ConnectionRefused",w[w.TTLExpired=6]="TTLExpired",w[w.CommandNotSupported=7]="CommandNotSupported",w[w.AddressNotSupported=8]="AddressNotSupported"})(sJ||(q9.Socks5Response=sJ={}));var w9;(function(w){w[w.IPv4=1]="IPv4",w[w.Hostname=3]="Hostname",w[w.IPv6=4]="IPv6"})(w9||(q9.Socks5HostType=w9={}));var $9;(function(w){w[w.Created=0]="Created",w[w.Connecting=1]="Connecting",w[w.Connected=2]="Connected",w[w.SentInitialHandshake=3]="SentInitialHandshake",w[w.ReceivedInitialHandshakeResponse=4]="ReceivedInitialHandshakeResponse",w[w.SentAuthentication=5]="SentAuthentication",w[w.ReceivedAuthenticationResponse=6]="ReceivedAuthenticationResponse",w[w.SentFinalHandshake=7]="SentFinalHandshake",w[w.ReceivedFinalResponse=8]="ReceivedFinalResponse",w[w.BoundWaitingForConnection=9]="BoundWaitingForConnection",w[w.Established=10]="Established",w[w.Disconnected=11]="Disconnected",w[w.Error=99]="Error"})($9||(q9.SocksClientState=$9={}))});var p1=R((Z9)=>{Object.defineProperty(Z9,"__esModule",{value:!0});Z9.shuffleArray=Z9.SocksClientError=void 0;class Y9 extends Error{constructor(w,$){super(w);this.options=$}}Z9.SocksClientError=Y9;function JO(w){for(let $=w.length-1;$>0;$--){let q=Math.floor(Math.random()*($+1));[w[$],w[q]]=[w[q],w[$]]}}Z9.shuffleArray=JO});var r1=R((U9)=>{Object.defineProperty(U9,"__esModule",{value:!0});U9.isCorrect=U9.isInSubnet=void 0;function ZO(w){if(this.subnetMask<w.subnetMask)return!1;if(this.mask(w.subnetMask)===w.mask())return!0;return!1}U9.isInSubnet=ZO;function KO(w){return function(){if(this.addressMinusSuffix!==this.correctForm())return!1;if(this.subnetMask===w&&!this.parsedSubnet)return!0;return this.parsedSubnet===String(this.subnetMask)}}U9.isCorrect=KO});var o1=R((X9)=>{Object.defineProperty(X9,"__esModule",{value:!0});X9.RE_SUBNET_STRING=X9.RE_ADDRESS=X9.GROUPS=X9.BITS=void 0;X9.BITS=32;X9.GROUPS=4;X9.RE_ADDRESS=/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/g;X9.RE_SUBNET_STRING=/\/\d{1,2}$/});var Y1=R((M9)=>{Object.defineProperty(M9,"__esModule",{value:!0});M9.AddressError=void 0;class G9 extends Error{constructor(w,$){super(w);if(this.name="AddressError",$!==null)this.parseMessage=$}}M9.AddressError=G9});var a1=R((Z1,W9)=>{(function(){var w,$=244837814094590,q=($&16777215)==15715070;function J(Z,K,O){if(Z!=null)if(typeof Z=="number")this.fromNumber(Z,K,O);else if(K==null&&typeof Z!="string")this.fromString(Z,256);else this.fromString(Z,K)}function Y(){return new J(null)}function U(Z,K,O,G,H,D){while(--D>=0){var L=K*this[Z++]+O[G]+H;H=Math.floor(L/67108864),O[G++]=L&67108863}return H}function X(Z,K,O,G,H,D){var L=K&32767,y=K>>15;while(--D>=0){var b=this[Z]&32767,e=this[Z++]>>15,Lw=y*b+e*L;b=L*b+((Lw&32767)<<15)+O[G]+(H&1073741823),H=(b>>>30)+(Lw>>>15)+y*e+(H>>>30),O[G++]=b&1073741823}return H}function M(Z,K,O,G,H,D){var L=K&16383,y=K>>14;while(--D>=0){var b=this[Z]&16383,e=this[Z++]>>14,Lw=y*b+e*L;b=L*b+((Lw&16383)<<14)+O[G]+H,H=(b>>28)+(Lw>>14)+y*e,O[G++]=b&268435455}return H}var Q=typeof navigator!=="undefined";if(Q&&q&&navigator.appName=="Microsoft Internet Explorer")J.prototype.am=X,w=30;else if(Q&&q&&navigator.appName!="Netscape")J.prototype.am=U,w=26;else J.prototype.am=M,w=28;J.prototype.DB=w,J.prototype.DM=(1<<w)-1,J.prototype.DV=1<<w;var V=52;J.prototype.FV=Math.pow(2,V),J.prototype.F1=V-w,J.prototype.F2=2*w-V;var z="0123456789abcdefghijklmnopqrstuvwxyz",N=new Array,F,W;F=48;for(W=0;W<=9;++W)N[F++]=W;F=97;for(W=10;W<36;++W)N[F++]=W;F=65;for(W=10;W<36;++W)N[F++]=W;function E(Z){return z.charAt(Z)}function B(Z,K){var O=N[Z.charCodeAt(K)];return O==null?-1:O}function j(Z){for(var K=this.t-1;K>=0;--K)Z[K]=this[K];Z.t=this.t,Z.s=this.s}function P(Z){if(this.t=1,this.s=Z<0?-1:0,Z>0)this[0]=Z;else if(Z<-1)this[0]=Z+this.DV;else this.t=0}function _(Z){var K=Y();return K.fromInt(Z),K}function S(Z,K){var O;if(K==16)O=4;else if(K==8)O=3;else if(K==256)O=8;else if(K==2)O=1;else if(K==32)O=5;else if(K==4)O=2;else{this.fromRadix(Z,K);return}this.t=0,this.s=0;var G=Z.length,H=!1,D=0;while(--G>=0){var L=O==8?Z[G]&255:B(Z,G);if(L<0){if(Z.charAt(G)=="-")H=!0;continue}if(H=!1,D==0)this[this.t++]=L;else if(D+O>this.DB)this[this.t-1]|=(L&(1<<this.DB-D)-1)<<D,this[this.t++]=L>>this.DB-D;else this[this.t-1]|=L<<D;if(D+=O,D>=this.DB)D-=this.DB}if(O==8&&(Z[0]&128)!=0){if(this.s=-1,D>0)this[this.t-1]|=(1<<this.DB-D)-1<<D}if(this.clamp(),H)J.ZERO.subTo(this,this)}function aw(){var Z=this.s&this.DM;while(this.t>0&&this[this.t-1]==Z)--this.t}function v$(Z){if(this.s<0)return"-"+this.negate().toString(Z);var K;if(Z==16)K=4;else if(Z==8)K=3;else if(Z==2)K=1;else if(Z==32)K=5;else if(Z==4)K=2;else return this.toRadix(Z);var O=(1<<K)-1,G,H=!1,D="",L=this.t,y=this.DB-L*this.DB%K;if(L-- >0){if(y<this.DB&&(G=this[L]>>y)>0)H=!0,D=E(G);while(L>=0){if(y<K)G=(this[L]&(1<<y)-1)<<K-y,G|=this[--L]>>(y+=this.DB-K);else if(G=this[L]>>(y-=K)&O,y<=0)y+=this.DB,--L;if(G>0)H=!0;if(H)D+=E(G)}}return H?D:"0"}function k$(){var Z=Y();return J.ZERO.subTo(this,Z),Z}function M1(){return this.s<0?this.negate():this}function N$(Z){var K=this.s-Z.s;if(K!=0)return K;var O=this.t;if(K=O-Z.t,K!=0)return this.s<0?-K:K;while(--O>=0)if((K=this[O]-Z[O])!=0)return K;return 0}function T(Z){var K=1,O;if((O=Z>>>16)!=0)Z=O,K+=16;if((O=Z>>8)!=0)Z=O,K+=8;if((O=Z>>4)!=0)Z=O,K+=4;if((O=Z>>2)!=0)Z=O,K+=2;if((O=Z>>1)!=0)Z=O,K+=1;return K}function x(){if(this.t<=0)return 0;return this.DB*(this.t-1)+T(this[this.t-1]^this.s&this.DM)}function I(Z,K){var O;for(O=this.t-1;O>=0;--O)K[O+Z]=this[O];for(O=Z-1;O>=0;--O)K[O]=0;K.t=this.t+Z,K.s=this.s}function p(Z,K){for(var O=Z;O<this.t;++O)K[O-Z]=this[O];K.t=Math.max(this.t-Z,0),K.s=this.s}function r(Z,K){var O=Z%this.DB,G=this.DB-O,H=(1<<G)-1,D=Math.floor(Z/this.DB),L=this.s<<O&this.DM,y;for(y=this.t-1;y>=0;--y)K[y+D+1]=this[y]>>G|L,L=(this[y]&H)<<O;for(y=D-1;y>=0;--y)K[y]=0;K[D]=L,K.t=this.t+D+1,K.s=this.s,K.clamp()}function d(Z,K){K.s=this.s;var O=Math.floor(Z/this.DB);if(O>=this.t){K.t=0;return}var G=Z%this.DB,H=this.DB-G,D=(1<<G)-1;K[0]=this[O]>>G;for(var L=O+1;L<this.t;++L)K[L-O-1]|=(this[L]&D)<<H,K[L-O]=this[L]>>G;if(G>0)K[this.t-O-1]|=(this.s&D)<<H;K.t=this.t-O,K.clamp()}function u(Z,K){var O=0,G=0,H=Math.min(Z.t,this.t);while(O<H)G+=this[O]-Z[O],K[O++]=G&this.DM,G>>=this.DB;if(Z.t<this.t){G-=Z.s;while(O<this.t)G+=this[O],K[O++]=G&this.DM,G>>=this.DB;G+=this.s}else{G+=this.s;while(O<Z.t)G-=Z[O],K[O++]=G&this.DM,G>>=this.DB;G-=Z.s}if(K.s=G<0?-1:0,G<-1)K[O++]=this.DV+G;else if(G>0)K[O++]=G;K.t=O,K.clamp()}function g(Z,K){var O=this.abs(),G=Z.abs(),H=O.t;K.t=H+G.t;while(--H>=0)K[H]=0;for(H=0;H<G.t;++H)K[H+O.t]=O.am(0,G[H],K,H,0,O.t);if(K.s=0,K.clamp(),this.s!=Z.s)J.ZERO.subTo(K,K)}function m(Z){var K=this.abs(),O=Z.t=2*K.t;while(--O>=0)Z[O]=0;for(O=0;O<K.t-1;++O){var G=K.am(O,K[O],Z,2*O,0,1);if((Z[O+K.t]+=K.am(O+1,2*K[O],Z,2*O+1,G,K.t-O-1))>=K.DV)Z[O+K.t]-=K.DV,Z[O+K.t+1]=1}if(Z.t>0)Z[Z.t-1]+=K.am(O,K[O],Z,2*O,0,1);Z.s=0,Z.clamp()}function o(Z,K,O){var G=Z.abs();if(G.t<=0)return;var H=this.abs();if(H.t<G.t){if(K!=null)K.fromInt(0);if(O!=null)this.copyTo(O);return}if(O==null)O=Y();var D=Y(),L=this.s,y=Z.s,b=this.DB-T(G[G.t-1]);if(b>0)G.lShiftTo(b,D),H.lShiftTo(b,O);else G.copyTo(D),H.copyTo(O);var e=D.t,Lw=D[e-1];if(Lw==0)return;var Ew=Lw*(1<<this.F1)+(e>1?D[e-2]>>this.F2:0),uw=this.FV/Ew,b$=(1<<this.F1)/Ew,Aw=1<<this.F2,Bw=O.t,S$=Bw-e,nw=K==null?Y():K;if(D.dlShiftTo(S$,nw),O.compareTo(nw)>=0)O[O.t++]=1,O.subTo(nw,O);J.ONE.dlShiftTo(e,nw),nw.subTo(D,D);while(D.t<e)D[D.t++]=0;while(--S$>=0){var D1=O[--Bw]==Lw?this.DM:Math.floor(O[Bw]*uw+(O[Bw-1]+Aw)*b$);if((O[Bw]+=D.am(0,D1,O,S$,0,e))<D1){D.dlShiftTo(S$,nw),O.subTo(nw,O);while(O[Bw]<--D1)O.subTo(nw,O)}}if(K!=null){if(O.drShiftTo(e,K),L!=y)J.ZERO.subTo(K,K)}if(O.t=e,O.clamp(),b>0)O.rShiftTo(b,O);if(L<0)J.ZERO.subTo(O,O)}function v(Z){var K=Y();if(this.abs().divRemTo(Z,null,K),this.s<0&&K.compareTo(J.ZERO)>0)Z.subTo(K,K);return K}function cw(Z){this.m=Z}function o9(Z){if(Z.s<0||Z.compareTo(this.m)>=0)return Z.mod(this.m);else return Z}function a9(Z){return Z}function e9(Z){Z.divRemTo(this.m,null,Z)}function t9(Z,K,O){Z.multiplyTo(K,O),this.reduce(O)}function s9(Z,K){Z.squareTo(K),this.reduce(K)}cw.prototype.convert=o9,cw.prototype.revert=a9,cw.prototype.reduce=e9,cw.prototype.mulTo=t9,cw.prototype.sqrTo=s9;function wY(){if(this.t<1)return 0;var Z=this[0];if((Z&1)==0)return 0;var K=Z&3;return K=K*(2-(Z&15)*K)&15,K=K*(2-(Z&255)*K)&255,K=K*(2-((Z&65535)*K&65535))&65535,K=K*(2-Z*K%this.DV)%this.DV,K>0?this.DV-K:-K}function ew(Z){this.m=Z,this.mp=Z.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<Z.DB-15)-1,this.mt2=2*Z.t}function $Y(Z){var K=Y();if(Z.abs().dlShiftTo(this.m.t,K),K.divRemTo(this.m,null,K),Z.s<0&&K.compareTo(J.ZERO)>0)this.m.subTo(K,K);return K}function qY(Z){var K=Y();return Z.copyTo(K),this.reduce(K),K}function JY(Z){while(Z.t<=this.mt2)Z[Z.t++]=0;for(var K=0;K<this.m.t;++K){var O=Z[K]&32767,G=O*this.mpl+((O*this.mph+(Z[K]>>15)*this.mpl&this.um)<<15)&Z.DM;O=K+this.m.t,Z[O]+=this.m.am(0,G,Z,K,0,this.m.t);while(Z[O]>=Z.DV)Z[O]-=Z.DV,Z[++O]++}if(Z.clamp(),Z.drShiftTo(this.m.t,Z),Z.compareTo(this.m)>=0)Z.subTo(this.m,Z)}function YY(Z,K){Z.squareTo(K),this.reduce(K)}function ZY(Z,K,O){Z.multiplyTo(K,O),this.reduce(O)}ew.prototype.convert=$Y,ew.prototype.revert=qY,ew.prototype.reduce=JY,ew.prototype.mulTo=ZY,ew.prototype.sqrTo=YY;function KY(){return(this.t>0?this[0]&1:this.s)==0}function UY(Z,K){if(Z>4294967295||Z<1)return J.ONE;var O=Y(),G=Y(),H=K.convert(this),D=T(Z)-1;H.copyTo(O);while(--D>=0)if(K.sqrTo(O,G),(Z&1<<D)>0)K.mulTo(G,H,O);else{var L=O;O=G,G=L}return K.revert(O)}function OY(Z,K){var O;if(Z<256||K.isEven())O=new cw(K);else O=new ew(K);return this.exp(Z,O)}J.prototype.copyTo=j,J.prototype.fromInt=P,J.prototype.fromString=S,J.prototype.clamp=aw,J.prototype.dlShiftTo=I,J.prototype.drShiftTo=p,J.prototype.lShiftTo=r,J.prototype.rShiftTo=d,J.prototype.subTo=u,J.prototype.multiplyTo=g,J.prototype.squareTo=m,J.prototype.divRemTo=o,J.prototype.invDigit=wY,J.prototype.isEven=KY,J.prototype.exp=UY,J.prototype.toString=v$,J.prototype.negate=k$,J.prototype.abs=M1,J.prototype.compareTo=N$,J.prototype.bitLength=x,J.prototype.mod=v,J.prototype.modPowInt=OY,J.ZERO=_(0),J.ONE=_(1);function XY(){var Z=Y();return this.copyTo(Z),Z}function zY(){if(this.s<0){if(this.t==1)return this[0]-this.DV;else if(this.t==0)return-1}else if(this.t==1)return this[0];else if(this.t==0)return 0;return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]}function GY(){return this.t==0?this.s:this[0]<<24>>24}function MY(){return this.t==0?this.s:this[0]<<16>>16}function QY(Z){return Math.floor(Math.LN2*this.DB/Math.log(Z))}function WY(){if(this.s<0)return-1;else if(this.t<=0||this.t==1&&this[0]<=0)return 0;else return 1}function HY(Z){if(Z==null)Z=10;if(this.signum()==0||Z<2||Z>36)return"0";var K=this.chunkSize(Z),O=Math.pow(Z,K),G=_(O),H=Y(),D=Y(),L="";this.divRemTo(G,H,D);while(H.signum()>0)L=(O+D.intValue()).toString(Z).substr(1)+L,H.divRemTo(G,H,D);return D.intValue().toString(Z)+L}function VY(Z,K){if(this.fromInt(0),K==null)K=10;var O=this.chunkSize(K),G=Math.pow(K,O),H=!1,D=0,L=0;for(var y=0;y<Z.length;++y){var b=B(Z,y);if(b<0){if(Z.charAt(y)=="-"&&this.signum()==0)H=!0;continue}if(L=K*L+b,++D>=O)this.dMultiply(G),this.dAddOffset(L,0),D=0,L=0}if(D>0)this.dMultiply(Math.pow(K,D)),this.dAddOffset(L,0);if(H)J.ZERO.subTo(this,this)}function DY(Z,K,O){if(typeof K=="number")if(Z<2)this.fromInt(1);else{if(this.fromNumber(Z,O),!this.testBit(Z-1))this.bitwiseTo(J.ONE.shiftLeft(Z-1),Q1,this);if(this.isEven())this.dAddOffset(1,0);while(!this.isProbablePrime(K))if(this.dAddOffset(2,0),this.bitLength()>Z)this.subTo(J.ONE.shiftLeft(Z-1),this)}else{var G=new Array,H=Z&7;if(G.length=(Z>>3)+1,K.nextBytes(G),H>0)G[0]&=(1<<H)-1;else G[0]=0;this.fromString(G,256)}}function NY(){var Z=this.t,K=new Array;K[0]=this.s;var O=this.DB-Z*this.DB%8,G,H=0;if(Z-- >0){if(O<this.DB&&(G=this[Z]>>O)!=(this.s&this.DM)>>O)K[H++]=G|this.s<<this.DB-O;while(Z>=0){if(O<8)G=(this[Z]&(1<<O)-1)<<8-O,G|=this[--Z]>>(O+=this.DB-8);else if(G=this[Z]>>(O-=8)&255,O<=0)O+=this.DB,--Z;if((G&128)!=0)G|=-256;if(H==0&&(this.s&128)!=(G&128))++H;if(H>0||G!=this.s)K[H++]=G}}return K}function EY(Z){return this.compareTo(Z)==0}function FY(Z){return this.compareTo(Z)<0?this:Z}function CY(Z){return this.compareTo(Z)>0?this:Z}function LY(Z,K,O){var G,H,D=Math.min(Z.t,this.t);for(G=0;G<D;++G)O[G]=K(this[G],Z[G]);if(Z.t<this.t){H=Z.s&this.DM;for(G=D;G<this.t;++G)O[G]=K(this[G],H);O.t=this.t}else{H=this.s&this.DM;for(G=D;G<Z.t;++G)O[G]=K(H,Z[G]);O.t=Z.t}O.s=K(this.s,Z.s),O.clamp()}function yY(Z,K){return Z&K}function RY(Z){var K=Y();return this.bitwiseTo(Z,yY,K),K}function Q1(Z,K){return Z|K}function TY(Z){var K=Y();return this.bitwiseTo(Z,Q1,K),K}function zq(Z,K){return Z^K}function AY(Z){var K=Y();return this.bitwiseTo(Z,zq,K),K}function Gq(Z,K){return Z&~K}function BY(Z){var K=Y();return this.bitwiseTo(Z,Gq,K),K}function jY(){var Z=Y();for(var K=0;K<this.t;++K)Z[K]=this.DM&~this[K];return Z.t=this.t,Z.s=~this.s,Z}function IY(Z){var K=Y();if(Z<0)this.rShiftTo(-Z,K);else this.lShiftTo(Z,K);return K}function PY(Z){var K=Y();if(Z<0)this.lShiftTo(-Z,K);else this.rShiftTo(Z,K);return K}function xY(Z){if(Z==0)return-1;var K=0;if((Z&65535)==0)Z>>=16,K+=16;if((Z&255)==0)Z>>=8,K+=8;if((Z&15)==0)Z>>=4,K+=4;if((Z&3)==0)Z>>=2,K+=2;if((Z&1)==0)++K;return K}function mY(){for(var Z=0;Z<this.t;++Z)if(this[Z]!=0)return Z*this.DB+xY(this[Z]);if(this.s<0)return this.t*this.DB;return-1}function _Y(Z){var K=0;while(Z!=0)Z&=Z-1,++K;return K}function vY(){var Z=0,K=this.s&this.DM;for(var O=0;O<this.t;++O)Z+=_Y(this[O]^K);return Z}function kY(Z){var K=Math.floor(Z/this.DB);if(K>=this.t)return this.s!=0;return(this[K]&1<<Z%this.DB)!=0}function uY(Z,K){var O=J.ONE.shiftLeft(Z);return this.bitwiseTo(O,K,O),O}function bY(Z){return this.changeBit(Z,Q1)}function SY(Z){return this.changeBit(Z,Gq)}function gY(Z){return this.changeBit(Z,zq)}function hY(Z,K){var O=0,G=0,H=Math.min(Z.t,this.t);while(O<H)G+=this[O]+Z[O],K[O++]=G&this.DM,G>>=this.DB;if(Z.t<this.t){G+=Z.s;while(O<this.t)G+=this[O],K[O++]=G&this.DM,G>>=this.DB;G+=this.s}else{G+=this.s;while(O<Z.t)G+=Z[O],K[O++]=G&this.DM,G>>=this.DB;G+=Z.s}if(K.s=G<0?-1:0,G>0)K[O++]=G;else if(G<-1)K[O++]=this.DV+G;K.t=O,K.clamp()}function iY(Z){var K=Y();return this.addTo(Z,K),K}function cY(Z){var K=Y();return this.subTo(Z,K),K}function nY(Z){var K=Y();return this.multiplyTo(Z,K),K}function lY(){var Z=Y();return this.squareTo(Z),Z}function dY(Z){var K=Y();return this.divRemTo(Z,K,null),K}function fY(Z){var K=Y();return this.divRemTo(Z,null,K),K}function pY(Z){var K=Y(),O=Y();return this.divRemTo(Z,K,O),new Array(K,O)}function rY(Z){this[this.t]=this.am(0,Z-1,this,0,0,this.t),++this.t,this.clamp()}function oY(Z,K){if(Z==0)return;while(this.t<=K)this[this.t++]=0;this[K]+=Z;while(this[K]>=this.DV){if(this[K]-=this.DV,++K>=this.t)this[this.t++]=0;++this[K]}}function E$(){}function Mq(Z){return Z}function aY(Z,K,O){Z.multiplyTo(K,O)}function eY(Z,K){Z.squareTo(K)}E$.prototype.convert=Mq,E$.prototype.revert=Mq,E$.prototype.mulTo=aY,E$.prototype.sqrTo=eY;function tY(Z){return this.exp(Z,new E$)}function sY(Z,K,O){var G=Math.min(this.t+Z.t,K);O.s=0,O.t=G;while(G>0)O[--G]=0;var H;for(H=O.t-this.t;G<H;++G)O[G+this.t]=this.am(0,Z[G],O,G,0,this.t);for(H=Math.min(Z.t,K);G<H;++G)this.am(0,Z[G],O,G,0,K-G);O.clamp()}function w8(Z,K,O){--K;var G=O.t=this.t+Z.t-K;O.s=0;while(--G>=0)O[G]=0;for(G=Math.max(K-this.t,0);G<Z.t;++G)O[this.t+G-K]=this.am(K-G,Z[G],O,0,0,this.t+G-K);O.clamp(),O.drShiftTo(1,O)}function tw(Z){this.r2=Y(),this.q3=Y(),J.ONE.dlShiftTo(2*Z.t,this.r2),this.mu=this.r2.divide(Z),this.m=Z}function $8(Z){if(Z.s<0||Z.t>2*this.m.t)return Z.mod(this.m);else if(Z.compareTo(this.m)<0)return Z;else{var K=Y();return Z.copyTo(K),this.reduce(K),K}}function q8(Z){return Z}function J8(Z){if(Z.drShiftTo(this.m.t-1,this.r2),Z.t>this.m.t+1)Z.t=this.m.t+1,Z.clamp();this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);while(Z.compareTo(this.r2)<0)Z.dAddOffset(1,this.m.t+1);Z.subTo(this.r2,Z);while(Z.compareTo(this.m)>=0)Z.subTo(this.m,Z)}function Y8(Z,K){Z.squareTo(K),this.reduce(K)}function Z8(Z,K,O){Z.multiplyTo(K,O),this.reduce(O)}tw.prototype.convert=$8,tw.prototype.revert=q8,tw.prototype.reduce=J8,tw.prototype.mulTo=Z8,tw.prototype.sqrTo=Y8;function K8(Z,K){var O=Z.bitLength(),G,H=_(1),D;if(O<=0)return H;else if(O<18)G=1;else if(O<48)G=3;else if(O<144)G=4;else if(O<768)G=5;else G=6;if(O<8)D=new cw(K);else if(K.isEven())D=new tw(K);else D=new ew(K);var L=new Array,y=3,b=G-1,e=(1<<G)-1;if(L[1]=D.convert(this),G>1){var Lw=Y();D.sqrTo(L[1],Lw);while(y<=e)L[y]=Y(),D.mulTo(Lw,L[y-2],L[y]),y+=2}var Ew=Z.t-1,uw,b$=!0,Aw=Y(),Bw;O=T(Z[Ew])-1;while(Ew>=0){if(O>=b)uw=Z[Ew]>>O-b&e;else if(uw=(Z[Ew]&(1<<O+1)-1)<<b-O,Ew>0)uw|=Z[Ew-1]>>this.DB+O-b;y=G;while((uw&1)==0)uw>>=1,--y;if((O-=y)<0)O+=this.DB,--Ew;if(b$)L[uw].copyTo(H),b$=!1;else{while(y>1)D.sqrTo(H,Aw),D.sqrTo(Aw,H),y-=2;if(y>0)D.sqrTo(H,Aw);else Bw=H,H=Aw,Aw=Bw;D.mulTo(Aw,L[uw],H)}while(Ew>=0&&(Z[Ew]&1<<O)==0)if(D.sqrTo(H,Aw),Bw=H,H=Aw,Aw=Bw,--O<0)O=this.DB-1,--Ew}return D.revert(H)}function U8(Z){var K=this.s<0?this.negate():this.clone(),O=Z.s<0?Z.negate():Z.clone();if(K.compareTo(O)<0){var G=K;K=O,O=G}var H=K.getLowestSetBit(),D=O.getLowestSetBit();if(D<0)return K;if(H<D)D=H;if(D>0)K.rShiftTo(D,K),O.rShiftTo(D,O);while(K.signum()>0){if((H=K.getLowestSetBit())>0)K.rShiftTo(H,K);if((H=O.getLowestSetBit())>0)O.rShiftTo(H,O);if(K.compareTo(O)>=0)K.subTo(O,K),K.rShiftTo(1,K);else O.subTo(K,O),O.rShiftTo(1,O)}if(D>0)O.lShiftTo(D,O);return O}function O8(Z){if(Z<=0)return 0;var K=this.DV%Z,O=this.s<0?Z-1:0;if(this.t>0)if(K==0)O=this[0]%Z;else for(var G=this.t-1;G>=0;--G)O=(K*O+this[G])%Z;return O}function X8(Z){var K=Z.isEven();if(this.isEven()&&K||Z.signum()==0)return J.ZERO;var O=Z.clone(),G=this.clone(),H=_(1),D=_(0),L=_(0),y=_(1);while(O.signum()!=0){while(O.isEven()){if(O.rShiftTo(1,O),K){if(!H.isEven()||!D.isEven())H.addTo(this,H),D.subTo(Z,D);H.rShiftTo(1,H)}else if(!D.isEven())D.subTo(Z,D);D.rShiftTo(1,D)}while(G.isEven()){if(G.rShiftTo(1,G),K){if(!L.isEven()||!y.isEven())L.addTo(this,L),y.subTo(Z,y);L.rShiftTo(1,L)}else if(!y.isEven())y.subTo(Z,y);y.rShiftTo(1,y)}if(O.compareTo(G)>=0){if(O.subTo(G,O),K)H.subTo(L,H);D.subTo(y,D)}else{if(G.subTo(O,G),K)L.subTo(H,L);y.subTo(D,y)}}if(G.compareTo(J.ONE)!=0)return J.ZERO;if(y.compareTo(Z)>=0)return y.subtract(Z);if(y.signum()<0)y.addTo(Z,y);else return y;if(y.signum()<0)return y.add(Z);else return y}var Xw=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],z8=67108864/Xw[Xw.length-1];function G8(Z){var K,O=this.abs();if(O.t==1&&O[0]<=Xw[Xw.length-1]){for(K=0;K<Xw.length;++K)if(O[0]==Xw[K])return!0;return!1}if(O.isEven())return!1;K=1;while(K<Xw.length){var G=Xw[K],H=K+1;while(H<Xw.length&&G<z8)G*=Xw[H++];G=O.modInt(G);while(K<H)if(G%Xw[K++]==0)return!1}return O.millerRabin(Z)}function M8(Z){var K=this.subtract(J.ONE),O=K.getLowestSetBit();if(O<=0)return!1;var G=K.shiftRight(O);if(Z=Z+1>>1,Z>Xw.length)Z=Xw.length;var H=Y();for(var D=0;D<Z;++D){H.fromInt(Xw[Math.floor(Math.random()*Xw.length)]);var L=H.modPow(G,this);if(L.compareTo(J.ONE)!=0&&L.compareTo(K)!=0){var y=1;while(y++<O&&L.compareTo(K)!=0)if(L=L.modPowInt(2,this),L.compareTo(J.ONE)==0)return!1;if(L.compareTo(K)!=0)return!1}}return!0}J.prototype.chunkSize=QY,J.prototype.toRadix=HY,J.prototype.fromRadix=VY,J.prototype.fromNumber=DY,J.prototype.bitwiseTo=LY,J.prototype.changeBit=uY,J.prototype.addTo=hY,J.prototype.dMultiply=rY,J.prototype.dAddOffset=oY,J.prototype.multiplyLowerTo=sY,J.prototype.multiplyUpperTo=w8,J.prototype.modInt=O8,J.prototype.millerRabin=M8,J.prototype.clone=XY,J.prototype.intValue=zY,J.prototype.byteValue=GY,J.prototype.shortValue=MY,J.prototype.signum=WY,J.prototype.toByteArray=NY,J.prototype.equals=EY,J.prototype.min=FY,J.prototype.max=CY,J.prototype.and=RY,J.prototype.or=TY,J.prototype.xor=AY,J.prototype.andNot=BY,J.prototype.not=jY,J.prototype.shiftLeft=IY,J.prototype.shiftRight=PY,J.prototype.getLowestSetBit=mY,J.prototype.bitCount=vY,J.prototype.testBit=kY,J.prototype.setBit=bY,J.prototype.clearBit=SY,J.prototype.flipBit=gY,J.prototype.add=iY,J.prototype.subtract=cY,J.prototype.multiply=nY,J.prototype.divide=dY,J.prototype.remainder=fY,J.prototype.divideAndRemainder=pY,J.prototype.modPow=K8,J.prototype.modInverse=X8,J.prototype.pow=tY,J.prototype.gcd=U8,J.prototype.isProbablePrime=G8,J.prototype.square=lY,J.prototype.Barrett=tw;var u$,Nw,a;function Q8(Z){if(Nw[a++]^=Z&255,Nw[a++]^=Z>>8&255,Nw[a++]^=Z>>16&255,Nw[a++]^=Z>>24&255,a>=V1)a-=V1}function Qq(){Q8(new Date().getTime())}if(Nw==null){Nw=new Array,a=0;var Tw;if(typeof window!=="undefined"&&window.crypto){if(window.crypto.getRandomValues){var Wq=new Uint8Array(32);window.crypto.getRandomValues(Wq);for(Tw=0;Tw<32;++Tw)Nw[a++]=Wq[Tw]}else if(navigator.appName=="Netscape"&&navigator.appVersion<"5"){var Hq=window.crypto.random(32);for(Tw=0;Tw<Hq.length;++Tw)Nw[a++]=Hq.charCodeAt(Tw)&255}}while(a<V1)Tw=Math.floor(65536*Math.random()),Nw[a++]=Tw>>>8,Nw[a++]=Tw&255;a=0,Qq()}function W8(){if(u$==null){Qq(),u$=N8(),u$.init(Nw);for(a=0;a<Nw.length;++a)Nw[a]=0;a=0}return u$.next()}function H8(Z){var K;for(K=0;K<Z.length;++K)Z[K]=W8()}function W1(){}W1.prototype.nextBytes=H8;function H1(){this.i=0,this.j=0,this.S=new Array}function V8(Z){var K,O,G;for(K=0;K<256;++K)this.S[K]=K;O=0;for(K=0;K<256;++K)O=O+this.S[K]+Z[K%Z.length]&255,G=this.S[K],this.S[K]=this.S[O],this.S[O]=G;this.i=0,this.j=0}function D8(){var Z;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,Z=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=Z,this.S[Z+this.S[this.i]&255]}H1.prototype.init=V8,H1.prototype.next=D8;function N8(){return new H1}var V1=256;if(typeof Z1!=="undefined")Z1=W9.exports={default:J,BigInteger:J,SecureRandom:W1};else this.jsbn={BigInteger:J,SecureRandom:W1}}).call(Z1)});var m$=R((H9)=>{(function(){var w={not_string:/[^s]/,not_bool:/[^t]/,not_type:/[^T]/,not_primitive:/[^v]/,number:/[diefg]/,numeric_arg:/[bcdiefguxX]/,json:/[j]/,not_json:/[^j]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-gijostTuvxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[+-]/};function $(X){return J(U(X),arguments)}function q(X,M){return $.apply(null,[X].concat(M||[]))}function J(X,M){var Q=1,V=X.length,z,N="",F,W,E,B,j,P,_,S;for(F=0;F<V;F++)if(typeof X[F]==="string")N+=X[F];else if(typeof X[F]==="object"){if(E=X[F],E.keys){z=M[Q];for(W=0;W<E.keys.length;W++){if(z==null)throw new Error($('[sprintf] Cannot access property "%s" of undefined value "%s"',E.keys[W],E.keys[W-1]));z=z[E.keys[W]]}}else if(E.param_no)z=M[E.param_no];else z=M[Q++];if(w.not_type.test(E.type)&&w.not_primitive.test(E.type)&&z instanceof Function)z=z();if(w.numeric_arg.test(E.type)&&(typeof z!=="number"&&isNaN(z)))throw new TypeError($("[sprintf] expecting number but found %T",z));if(w.number.test(E.type))_=z>=0;switch(E.type){case"b":z=parseInt(z,10).toString(2);break;case"c":z=String.fromCharCode(parseInt(z,10));break;case"d":case"i":z=parseInt(z,10);break;case"j":z=JSON.stringify(z,null,E.width?parseInt(E.width):0);break;case"e":z=E.precision?parseFloat(z).toExponential(E.precision):parseFloat(z).toExponential();break;case"f":z=E.precision?parseFloat(z).toFixed(E.precision):parseFloat(z);break;case"g":z=E.precision?String(Number(z.toPrecision(E.precision))):parseFloat(z);break;case"o":z=(parseInt(z,10)>>>0).toString(8);break;case"s":z=String(z),z=E.precision?z.substring(0,E.precision):z;break;case"t":z=String(!!z),z=E.precision?z.substring(0,E.precision):z;break;case"T":z=Object.prototype.toString.call(z).slice(8,-1).toLowerCase(),z=E.precision?z.substring(0,E.precision):z;break;case"u":z=parseInt(z,10)>>>0;break;case"v":z=z.valueOf(),z=E.precision?z.substring(0,E.precision):z;break;case"x":z=(parseInt(z,10)>>>0).toString(16);break;case"X":z=(parseInt(z,10)>>>0).toString(16).toUpperCase();break}if(w.json.test(E.type))N+=z;else{if(w.number.test(E.type)&&(!_||E.sign))S=_?"+":"-",z=z.toString().replace(w.sign,"");else S="";j=E.pad_char?E.pad_char==="0"?"0":E.pad_char.charAt(1):" ",P=E.width-(S+z).length,B=E.width?P>0?j.repeat(P):"":"",N+=E.align?S+z+B:j==="0"?S+B+z:B+S+z}}return N}var Y=Object.create(null);function U(X){if(Y[X])return Y[X];var M=X,Q,V=[],z=0;while(M){if((Q=w.text.exec(M))!==null)V.push(Q[0]);else if((Q=w.modulo.exec(M))!==null)V.push("%");else if((Q=w.placeholder.exec(M))!==null){if(Q[2]){z|=1;var N=[],F=Q[2],W=[];if((W=w.key.exec(F))!==null){N.push(W[1]);while((F=F.substring(W[0].length))!=="")if((W=w.key_access.exec(F))!==null)N.push(W[1]);else if((W=w.index_access.exec(F))!==null)N.push(W[1]);else throw new SyntaxError("[sprintf] failed to parse named argument key")}else throw new SyntaxError("[sprintf] failed to parse named argument key");Q[2]=N}else z|=2;if(z===3)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");V.push({placeholder:Q[0],param_no:Q[1],keys:Q[2],sign:Q[3],pad_char:Q[4],align:Q[5],width:Q[6],precision:Q[7],type:Q[8]})}else throw new SyntaxError("[sprintf] unexpected placeholder");M=M.substring(Q[0].length)}return Y[X]=V}if(typeof H9!=="undefined")H9.sprintf=$,H9.vsprintf=q;if(typeof window!=="undefined"){if(window.sprintf=$,window.vsprintf=q,typeof define==="function"&&define.amd)define(function(){return{sprintf:$,vsprintf:q}})}})()});var e1=R((vw)=>{var GO=vw&&vw.__createBinding||(Object.create?function(w,$,q,J){if(J===void 0)J=q;var Y=Object.getOwnPropertyDescriptor($,q);if(!Y||("get"in Y?!$.__esModule:Y.writable||Y.configurable))Y={enumerable:!0,get:function(){return $[q]}};Object.defineProperty(w,J,Y)}:function(w,$,q,J){if(J===void 0)J=q;w[J]=$[q]}),MO=vw&&vw.__setModuleDefault||(Object.create?function(w,$){Object.defineProperty(w,"default",{enumerable:!0,value:$})}:function(w,$){w.default=$}),N9=vw&&vw.__importStar||function(w){if(w&&w.__esModule)return w;var $={};if(w!=null){for(var q in w)if(q!=="default"&&Object.prototype.hasOwnProperty.call(w,q))GO($,w,q)}return MO($,w),$};Object.defineProperty(vw,"__esModule",{value:!0});vw.Address4=void 0;var V9=N9(r1()),Pw=N9(o1()),D9=Y1(),_$=a1(),W$=m$();class Rw{constructor(w){this.groups=Pw.GROUPS,this.parsedAddress=[],this.parsedSubnet="",this.subnet="/32",this.subnetMask=32,this.v4=!0,this.isCorrect=V9.isCorrect(Pw.BITS),this.isInSubnet=V9.isInSubnet,this.address=w;let $=Pw.RE_SUBNET_STRING.exec(w);if($){if(this.parsedSubnet=$[0].replace("/",""),this.subnetMask=parseInt(this.parsedSubnet,10),this.subnet=`/${this.subnetMask}`,this.subnetMask<0||this.subnetMask>Pw.BITS)throw new D9.AddressError("Invalid subnet mask.");w=w.replace(Pw.RE_SUBNET_STRING,"")}this.addressMinusSuffix=w,this.parsedAddress=this.parse(w)}static isValid(w){try{return new Rw(w),!0}catch($){return!1}}parse(w){let $=w.split(".");if(!w.match(Pw.RE_ADDRESS))throw new D9.AddressError("Invalid IPv4 address.");return $}correctForm(){return this.parsedAddress.map((w)=>parseInt(w,10)).join(".")}static fromHex(w){let $=w.replace(/:/g,"").padStart(8,"0"),q=[],J;for(J=0;J<8;J+=2){let Y=$.slice(J,J+2);q.push(parseInt(Y,16))}return new Rw(q.join("."))}static fromInteger(w){return Rw.fromHex(w.toString(16))}static fromArpa(w){let q=w.replace(/(\.in-addr\.arpa)?\.$/,"").split(".").reverse().join(".");return new Rw(q)}toHex(){return this.parsedAddress.map((w)=>W$.sprintf("%02x",parseInt(w,10))).join(":")}toArray(){return this.parsedAddress.map((w)=>parseInt(w,10))}toGroup6(){let w=[],$;for($=0;$<Pw.GROUPS;$+=2){let q=W$.sprintf("%02x%02x",parseInt(this.parsedAddress[$],10),parseInt(this.parsedAddress[$+1],10));w.push(W$.sprintf("%x",parseInt(q,16)))}return w.join(":")}bigInteger(){return new _$.BigInteger(this.parsedAddress.map((w)=>W$.sprintf("%02x",parseInt(w,10))).join(""),16)}_startAddress(){return new _$.BigInteger(this.mask()+"0".repeat(Pw.BITS-this.subnetMask),2)}startAddress(){return Rw.fromBigInteger(this._startAddress())}startAddressExclusive(){let w=new _$.BigInteger("1");return Rw.fromBigInteger(this._startAddress().add(w))}_endAddress(){return new _$.BigInteger(this.mask()+"1".repeat(Pw.BITS-this.subnetMask),2)}endAddress(){return Rw.fromBigInteger(this._endAddress())}endAddressExclusive(){let w=new _$.BigInteger("1");return Rw.fromBigInteger(this._endAddress().subtract(w))}static fromBigInteger(w){return Rw.fromInteger(parseInt(w.toString(),10))}mask(w){if(w===void 0)w=this.subnetMask;return this.getBitsBase2(0,w)}getBitsBase2(w,$){return this.binaryZeroPad().slice(w,$)}reverseForm(w){if(!w)w={};let $=this.correctForm().split(".").reverse().join(".");if(w.omitSuffix)return $;return W$.sprintf("%s.in-addr.arpa.",$)}isMulticast(){return this.isInSubnet(new Rw("224.0.0.0/4"))}binaryZeroPad(){return this.bigInteger().toString(2).padStart(Pw.BITS,"0")}groupForV6(){let w=this.parsedAddress;return this.address.replace(Pw.RE_ADDRESS,W$.sprintf('<span class="hover-group group-v4 group-6">%s</span>.<span class="hover-group group-v4 group-7">%s</span>',w.slice(0,2).join("."),w.slice(2,4).join(".")))}}vw.Address4=Rw});var t1=R((E9)=>{Object.defineProperty(E9,"__esModule",{value:!0});E9.RE_URL_WITH_PORT=E9.RE_URL=E9.RE_ZONE_STRING=E9.RE_SUBNET_STRING=E9.RE_BAD_ADDRESS=E9.RE_BAD_CHARACTERS=E9.TYPES=E9.SCOPES=E9.GROUPS=E9.BITS=void 0;E9.BITS=128;E9.GROUPS=8;E9.SCOPES={0:"Reserved",1:"Interface local",2:"Link local",4:"Admin local",5:"Site local",8:"Organization local",14:"Global",15:"Reserved"};E9.TYPES={"ff01::1/128":"Multicast (All nodes on this interface)","ff01::2/128":"Multicast (All routers on this interface)","ff02::1/128":"Multicast (All nodes on this link)","ff02::2/128":"Multicast (All routers on this link)","ff05::2/128":"Multicast (All routers in this site)","ff02::5/128":"Multicast (OSPFv3 AllSPF routers)","ff02::6/128":"Multicast (OSPFv3 AllDR routers)","ff02::9/128":"Multicast (RIP routers)","ff02::a/128":"Multicast (EIGRP routers)","ff02::d/128":"Multicast (PIM routers)","ff02::16/128":"Multicast (MLDv2 reports)","ff01::fb/128":"Multicast (mDNSv6)","ff02::fb/128":"Multicast (mDNSv6)","ff05::fb/128":"Multicast (mDNSv6)","ff02::1:2/128":"Multicast (All DHCP servers and relay agents on this link)","ff05::1:2/128":"Multicast (All DHCP servers and relay agents in this site)","ff02::1:3/128":"Multicast (All DHCP servers on this link)","ff05::1:3/128":"Multicast (All DHCP servers in this site)","::/128":"Unspecified","::1/128":"Loopback","ff00::/8":"Multicast","fe80::/10":"Link-local unicast"};E9.RE_BAD_CHARACTERS=/([^0-9a-f:/%])/gi;E9.RE_BAD_ADDRESS=/([0-9a-f]{5,}|:{3,}|[^:]:$|^:[^:]|\/$)/gi;E9.RE_SUBNET_STRING=/\/\d{1,3}(?=%|$)/;E9.RE_ZONE_STRING=/%.*$/;E9.RE_URL=new RegExp(/^\[{0,1}([0-9a-f:]+)\]{0,1}/);E9.RE_URL_WITH_PORT=new RegExp(/\[([0-9a-f:]+)\]:([0-9]{1,5})/)});var s1=R((R9)=>{Object.defineProperty(R9,"__esModule",{value:!0});R9.simpleGroup=R9.spanLeadingZeroes=R9.spanAll=R9.spanAllZeroes=void 0;var C9=m$();function L9(w){return w.replace(/(0+)/g,'<span class="zero">$1</span>')}R9.spanAllZeroes=L9;function LO(w,$=0){return w.split("").map((J,Y)=>C9.sprintf('<span class="digit value-%s position-%d">%s</span>',J,Y+$,L9(J))).join("")}R9.spanAll=LO;function y9(w){return w.replace(/^(0+)/,'<span class="zero">$1</span>')}function yO(w){return w.split(":").map((q)=>y9(q)).join(":")}R9.spanLeadingZeroes=yO;function RO(w,$=0){return w.split(":").map((J,Y)=>{if(/group-v4/.test(J))return J;return C9.sprintf('<span class="hover-group group-%d">%s</span>',Y+$,y9(J))})}R9.simpleGroup=RO});var A9=R((ww)=>{var jO=ww&&ww.__createBinding||(Object.create?function(w,$,q,J){if(J===void 0)J=q;var Y=Object.getOwnPropertyDescriptor($,q);if(!Y||("get"in Y?!$.__esModule:Y.writable||Y.configurable))Y={enumerable:!0,get:function(){return $[q]}};Object.defineProperty(w,J,Y)}:function(w,$,q,J){if(J===void 0)J=q;w[J]=$[q]}),IO=ww&&ww.__setModuleDefault||(Object.create?function(w,$){Object.defineProperty(w,"default",{enumerable:!0,value:$})}:function(w,$){w.default=$}),PO=ww&&ww.__importStar||function(w){if(w&&w.__esModule)return w;var $={};if(w!=null){for(var q in w)if(q!=="default"&&Object.prototype.hasOwnProperty.call(w,q))jO($,w,q)}return IO($,w),$};Object.defineProperty(ww,"__esModule",{value:!0});ww.possibleElisions=ww.simpleRegularExpression=ww.ADDRESS_BOUNDARY=ww.padGroup=ww.groupPossibilities=void 0;var xO=PO(t1()),H$=m$();function U1(w){return H$.sprintf("(%s)",w.join("|"))}ww.groupPossibilities=U1;function K1(w){if(w.length<4)return H$.sprintf("0{0,%d}%s",4-w.length,w);return w}ww.padGroup=K1;ww.ADDRESS_BOUNDARY="[^A-Fa-f0-9:]";function mO(w){let $=[];w.forEach((J,Y)=>{if(parseInt(J,16)===0)$.push(Y)});let q=$.map((J)=>w.map((Y,U)=>{if(U===J){let X=U===0||U===xO.GROUPS-1?":":"";return U1([K1(Y),X])}return K1(Y)}).join(":"));return q.push(w.map(K1).join(":")),U1(q)}ww.simpleRegularExpression=mO;function _O(w,$,q){let J=$?"":":",Y=q?"":":",U=[];if(!$&&!q)U.push("::");if($&&q)U.push("");if(q&&!$||!q&&$)U.push(":");U.push(H$.sprintf("%s(:0{1,4}){1,%d}",J,w-1)),U.push(H$.sprintf("(0{1,4}:){1,%d}%s",w-1,Y)),U.push(H$.sprintf("(0{1,4}:){%d}0{1,4}",w-1));for(let X=1;X<w-1;X++)for(let M=1;M<w-X;M++)U.push(H$.sprintf("(0{1,4}:){%d}:(0{1,4}:){%d}0{1,4}",M,w-M-X-1));return U1(U)}ww.possibleElisions=_O});var P9=R((kw)=>{var vO=kw&&kw.__createBinding||(Object.create?function(w,$,q,J){if(J===void 0)J=q;var Y=Object.getOwnPropertyDescriptor($,q);if(!Y||("get"in Y?!$.__esModule:Y.writable||Y.configurable))Y={enumerable:!0,get:function(){return $[q]}};Object.defineProperty(w,J,Y)}:function(w,$,q,J){if(J===void 0)J=q;w[J]=$[q]}),kO=kw&&kw.__setModuleDefault||(Object.create?function(w,$){Object.defineProperty(w,"default",{enumerable:!0,value:$})}:function(w,$){w.default=$}),X1=kw&&kw.__importStar||function(w){if(w&&w.__esModule)return w;var $={};if(w!=null){for(var q in w)if(q!=="default"&&Object.prototype.hasOwnProperty.call(w,q))vO($,w,q)}return kO($,w),$};Object.defineProperty(kw,"__esModule",{value:!0});kw.Address6=void 0;var B9=X1(r1()),wq=X1(o1()),k=X1(t1()),$q=X1(s1()),J$=e1(),Y$=A9(),iw=Y1(),Ww=a1(),Hw=m$();function O1(w){if(!w)throw new Error("Assertion failed.")}function uO(w){let $=/(\d+)(\d{3})/;while($.test(w))w=w.replace($,"$1,$2");return w}function bO(w){return w=w.replace(/^(0{1,})([1-9]+)$/,'<span class="parse-error">$1</span>$2'),w=w.replace(/^(0{1,})(0)$/,'<span class="parse-error">$1</span>$2'),w}function SO(w,$){let q=[],J=[],Y;for(Y=0;Y<w.length;Y++)if(Y<$[0])q.push(w[Y]);else if(Y>$[1])J.push(w[Y]);return q.concat(["compact"]).concat(J)}function j9(w){return Hw.sprintf("%04x",parseInt(w,16))}function I9(w){return w&255}class $w{constructor(w,$){if(this.addressMinusSuffix="",this.parsedSubnet="",this.subnet="/128",this.subnetMask=128,this.v4=!1,this.zone="",this.isInSubnet=B9.isInSubnet,this.isCorrect=B9.isCorrect(k.BITS),$===void 0)this.groups=k.GROUPS;else this.groups=$;this.address=w;let q=k.RE_SUBNET_STRING.exec(w);if(q){if(this.parsedSubnet=q[0].replace("/",""),this.subnetMask=parseInt(this.parsedSubnet,10),this.subnet=`/${this.subnetMask}`,Number.isNaN(this.subnetMask)||this.subnetMask<0||this.subnetMask>k.BITS)throw new iw.AddressError("Invalid subnet mask.");w=w.replace(k.RE_SUBNET_STRING,"")}else if(/\//.test(w))throw new iw.AddressError("Invalid subnet mask.");let J=k.RE_ZONE_STRING.exec(w);if(J)this.zone=J[0],w=w.replace(k.RE_ZONE_STRING,"");this.addressMinusSuffix=w,this.parsedAddress=this.parse(this.addressMinusSuffix)}static isValid(w){try{return new $w(w),!0}catch($){return!1}}static fromBigInteger(w){let $=w.toString(16).padStart(32,"0"),q=[],J;for(J=0;J<k.GROUPS;J++)q.push($.slice(J*4,(J+1)*4));return new $w(q.join(":"))}static fromURL(w){let $,q=null,J;if(w.indexOf("[")!==-1&&w.indexOf("]:")!==-1){if(J=k.RE_URL_WITH_PORT.exec(w),J===null)return{error:"failed to parse address with port",address:null,port:null};$=J[1],q=J[2]}else if(w.indexOf("/")!==-1){if(w=w.replace(/^[a-z0-9]+:\/\//,""),J=k.RE_URL.exec(w),J===null)return{error:"failed to parse address from URL",address:null,port:null};$=J[1]}else $=w;if(q){if(q=parseInt(q,10),q<0||q>65536)q=null}else q=null;return{address:new $w($),port:q}}static fromAddress4(w){let $=new J$.Address4(w),q=k.BITS-(wq.BITS-$.subnetMask);return new $w(`::ffff:${$.correctForm()}/${q}`)}static fromArpa(w){let $=w.replace(/(\.ip6\.arpa)?\.$/,""),q=7;if($.length!==63)throw new iw.AddressError("Invalid 'ip6.arpa' form.");let J=$.split(".").reverse();for(let Y=q;Y>0;Y--){let U=Y*4;J.splice(U,0,":")}return $=J.join(""),new $w($)}microsoftTranscription(){return Hw.sprintf("%s.ipv6-literal.net",this.correctForm().replace(/:/g,"-"))}mask(w=this.subnetMask){return this.getBitsBase2(0,w)}possibleSubnets(w=128){let $=k.BITS-this.subnetMask,q=Math.abs(w-k.BITS),J=$-q;if(J<0)return"0";return uO(new Ww.BigInteger("2",10).pow(J).toString(10))}_startAddress(){return new Ww.BigInteger(this.mask()+"0".repeat(k.BITS-this.subnetMask),2)}startAddress(){return $w.fromBigInteger(this._startAddress())}startAddressExclusive(){let w=new Ww.BigInteger("1");return $w.fromBigInteger(this._startAddress().add(w))}_endAddress(){return new Ww.BigInteger(this.mask()+"1".repeat(k.BITS-this.subnetMask),2)}endAddress(){return $w.fromBigInteger(this._endAddress())}endAddressExclusive(){let w=new Ww.BigInteger("1");return $w.fromBigInteger(this._endAddress().subtract(w))}getScope(){let w=k.SCOPES[this.getBits(12,16).intValue()];if(this.getType()==="Global unicast"&&w!=="Link local")w="Global";return w||"Unknown"}getType(){for(let w of Object.keys(k.TYPES))if(this.isInSubnet(new $w(w)))return k.TYPES[w];return"Global unicast"}getBits(w,$){return new Ww.BigInteger(this.getBitsBase2(w,$),2)}getBitsBase2(w,$){return this.binaryZeroPad().slice(w,$)}getBitsBase16(w,$){let q=$-w;if(q%4!==0)throw new Error("Length of bits to retrieve must be divisible by four");return this.getBits(w,$).toString(16).padStart(q/4,"0")}getBitsPastSubnet(){return this.getBitsBase2(this.subnetMask,k.BITS)}reverseForm(w){if(!w)w={};let $=Math.floor(this.subnetMask/4),q=this.canonicalForm().replace(/:/g,"").split("").slice(0,$).reverse().join(".");if($>0){if(w.omitSuffix)return q;return Hw.sprintf("%s.ip6.arpa.",q)}if(w.omitSuffix)return"";return"ip6.arpa."}correctForm(){let w,$=[],q=0,J=[];for(w=0;w<this.parsedAddress.length;w++){let X=parseInt(this.parsedAddress[w],16);if(X===0)q++;if(X!==0&&q>0){if(q>1)J.push([w-q,w-1]);q=0}}if(q>1)J.push([this.parsedAddress.length-q,this.parsedAddress.length-1]);let Y=J.map((X)=>X[1]-X[0]+1);if(J.length>0){let X=Y.indexOf(Math.max(...Y));$=SO(this.parsedAddress,J[X])}else $=this.parsedAddress;for(w=0;w<$.length;w++)if($[w]!=="compact")$[w]=parseInt($[w],16).toString(16);let U=$.join(":");return U=U.replace(/^compact$/,"::"),U=U.replace(/^compact|compact$/,":"),U=U.replace(/compact/,""),U}binaryZeroPad(){return this.bigInteger().toString(2).padStart(k.BITS,"0")}parse4in6(w){let $=w.split(":"),J=$.slice(-1)[0].match(wq.RE_ADDRESS);if(J){this.parsedAddress4=J[0],this.address4=new J$.Address4(this.parsedAddress4);for(let Y=0;Y<this.address4.groups;Y++)if(/^0[0-9]+/.test(this.address4.parsedAddress[Y]))throw new iw.AddressError("IPv4 addresses can't have leading zeroes.",w.replace(wq.RE_ADDRESS,this.address4.parsedAddress.map(bO).join(".")));this.v4=!0,$[$.length-1]=this.address4.toGroup6(),w=$.join(":")}return w}parse(w){w=this.parse4in6(w);let $=w.match(k.RE_BAD_CHARACTERS);if($)throw new iw.AddressError(Hw.sprintf("Bad character%s detected in address: %s",$.length>1?"s":"",$.join("")),w.replace(k.RE_BAD_CHARACTERS,'<span class="parse-error">$1</span>'));let q=w.match(k.RE_BAD_ADDRESS);if(q)throw new iw.AddressError(Hw.sprintf("Address failed regex: %s",q.join("")),w.replace(k.RE_BAD_ADDRESS,'<span class="parse-error">$1</span>'));let J=[],Y=w.split("::");if(Y.length===2){let U=Y[0].split(":"),X=Y[1].split(":");if(U.length===1&&U[0]==="")U=[];if(X.length===1&&X[0]==="")X=[];let M=this.groups-(U.length+X.length);if(!M)throw new iw.AddressError("Error parsing groups");this.elidedGroups=M,this.elisionBegin=U.length,this.elisionEnd=U.length+this.elidedGroups,J=J.concat(U);for(let Q=0;Q<M;Q++)J.push("0");J=J.concat(X)}else if(Y.length===1)J=w.split(":"),this.elidedGroups=0;else throw new iw.AddressError("Too many :: groups found");if(J=J.map((U)=>Hw.sprintf("%x",parseInt(U,16))),J.length!==this.groups)throw new iw.AddressError("Incorrect number of groups found");return J}canonicalForm(){return this.parsedAddress.map(j9).join(":")}decimal(){return this.parsedAddress.map((w)=>Hw.sprintf("%05d",parseInt(w,16))).join(":")}bigInteger(){return new Ww.BigInteger(this.parsedAddress.map(j9).join(""),16)}to4(){let w=this.binaryZeroPad().split("");return J$.Address4.fromHex(new Ww.BigInteger(w.slice(96,128).join(""),2).toString(16))}to4in6(){let w=this.to4(),q=new $w(this.parsedAddress.slice(0,6).join(":"),6).correctForm(),J="";if(!/:$/.test(q))J=":";return q+J+w.address}inspectTeredo(){let w=this.getBitsBase16(0,32),$=this.getBits(80,96).xor(new Ww.BigInteger("ffff",16)).toString(),q=J$.Address4.fromHex(this.getBitsBase16(32,64)),J=J$.Address4.fromHex(this.getBits(96,128).xor(new Ww.BigInteger("ffffffff",16)).toString(16)),Y=this.getBits(64,80),U=this.getBitsBase2(64,80),X=Y.testBit(15),M=Y.testBit(14),Q=Y.testBit(8),V=Y.testBit(9),z=new Ww.BigInteger(U.slice(2,6)+U.slice(8,16),2).toString(10);return{prefix:Hw.sprintf("%s:%s",w.slice(0,4),w.slice(4,8)),server4:q.address,client4:J.address,flags:U,coneNat:X,microsoft:{reserved:M,universalLocal:V,groupIndividual:Q,nonce:z},udpPort:$}}inspect6to4(){let w=this.getBitsBase16(0,16),$=J$.Address4.fromHex(this.getBitsBase16(16,48));return{prefix:Hw.sprintf("%s",w.slice(0,4)),gateway:$.address}}to6to4(){if(!this.is4())return null;let w=["2002",this.getBitsBase16(96,112),this.getBitsBase16(112,128),"","/16"].join(":");return new $w(w)}toByteArray(){let w=this.bigInteger().toByteArray();if(w.length===17&&w[0]===0)return w.slice(1);return w}toUnsignedByteArray(){return this.toByteArray().map(I9)}static fromByteArray(w){return this.fromUnsignedByteArray(w.map(I9))}static fromUnsignedByteArray(w){let $=new Ww.BigInteger("256",10),q=new Ww.BigInteger("0",10),J=new Ww.BigInteger("1",10);for(let Y=w.length-1;Y>=0;Y--)q=q.add(J.multiply(new Ww.BigInteger(w[Y].toString(10),10))),J=J.multiply($);return $w.fromBigInteger(q)}isCanonical(){return this.addressMinusSuffix===this.canonicalForm()}isLinkLocal(){if(this.getBitsBase2(0,64)==="1111111010000000000000000000000000000000000000000000000000000000")return!0;return!1}isMulticast(){return this.getType()==="Multicast"}is4(){return this.v4}isTeredo(){return this.isInSubnet(new $w("2001::/32"))}is6to4(){return this.isInSubnet(new $w("2002::/16"))}isLoopback(){return this.getType()==="Loopback"}href(w){if(w===void 0)w="";else w=Hw.sprintf(":%s",w);return Hw.sprintf("http://[%s]%s/",this.correctForm(),w)}link(w){if(!w)w={};if(w.className===void 0)w.className="";if(w.prefix===void 0)w.prefix="/#address=";if(w.v4===void 0)w.v4=!1;let $=this.correctForm;if(w.v4)$=this.to4in6;if(w.className)return Hw.sprintf('<a href="%1$s%2$s" class="%3$s">%2$s</a>',w.prefix,$.call(this),w.className);return Hw.sprintf('<a href="%1$s%2$s">%2$s</a>',w.prefix,$.call(this))}group(){if(this.elidedGroups===0)return $q.simpleGroup(this.address).join(":");O1(typeof this.elidedGroups==="number"),O1(typeof this.elisionBegin==="number");let w=[],[$,q]=this.address.split("::");if($.length)w.push(...$q.simpleGroup($));else w.push("");let J=["hover-group"];for(let Y=this.elisionBegin;Y<this.elisionBegin+this.elidedGroups;Y++)J.push(Hw.sprintf("group-%d",Y));if(w.push(Hw.sprintf('<span class="%s"></span>',J.join(" "))),q.length)w.push(...$q.simpleGroup(q,this.elisionEnd));else w.push("");if(this.is4())O1(this.address4 instanceof J$.Address4),w.pop(),w.push(this.address4.groupForV6());return w.join(":")}regularExpressionString(w=!1){let $=[],q=new $w(this.correctForm());if(q.elidedGroups===0)$.push(Y$.simpleRegularExpression(q.parsedAddress));else if(q.elidedGroups===k.GROUPS)$.push(Y$.possibleElisions(k.GROUPS));else{let J=q.address.split("::");if(J[0].length)$.push(Y$.simpleRegularExpression(J[0].split(":")));if(O1(typeof q.elidedGroups==="number"),$.push(Y$.possibleElisions(q.elidedGroups,J[0].length!==0,J[1].length!==0)),J[1].length)$.push(Y$.simpleRegularExpression(J[1].split(":")));$=[$.join(":")]}if(!w)$=["(?=^|",Y$.ADDRESS_BOUNDARY,"|[^\\w\\:])(",...$,")(?=[^\\w\\:]|",Y$.ADDRESS_BOUNDARY,"|$)"];return $.join("")}regularExpression(w=!1){return new RegExp(this.regularExpressionString(w),"i")}}kw.Address6=$w});var qq=R((Ow)=>{var gO=Ow&&Ow.__createBinding||(Object.create?function(w,$,q,J){if(J===void 0)J=q;var Y=Object.getOwnPropertyDescriptor($,q);if(!Y||("get"in Y?!$.__esModule:Y.writable||Y.configurable))Y={enumerable:!0,get:function(){return $[q]}};Object.defineProperty(w,J,Y)}:function(w,$,q,J){if(J===void 0)J=q;w[J]=$[q]}),hO=Ow&&Ow.__setModuleDefault||(Object.create?function(w,$){Object.defineProperty(w,"default",{enumerable:!0,value:$})}:function(w,$){w.default=$}),iO=Ow&&Ow.__importStar||function(w){if(w&&w.__esModule)return w;var $={};if(w!=null){for(var q in w)if(q!=="default"&&Object.prototype.hasOwnProperty.call(w,q))gO($,w,q)}return hO($,w),$};Object.defineProperty(Ow,"__esModule",{value:!0});Ow.v6=Ow.AddressError=Ow.Address6=Ow.Address4=void 0;var cO=e1();Object.defineProperty(Ow,"Address4",{enumerable:!0,get:function(){return cO.Address4}});var nO=P9();Object.defineProperty(Ow,"Address6",{enumerable:!0,get:function(){return nO.Address6}});var lO=Y1();Object.defineProperty(Ow,"AddressError",{enumerable:!0,get:function(){return lO.AddressError}});var dO=iO(s1());Ow.v6={helpers:dO}});var S9=R((u9)=>{Object.defineProperty(u9,"__esModule",{value:!0});u9.ipToBuffer=u9.int32ToIpv4=u9.ipv4ToInt32=u9.validateSocksClientChainOptions=u9.validateSocksClientOptions=void 0;var Vw=p1(),qw=f1(),fO=h("stream"),Jq=qq(),x9=h("net");function pO(w,$=["connect","bind","associate"]){if(!qw.SocksCommand[w.command])throw new Vw.SocksClientError(qw.ERRORS.InvalidSocksCommand,w);if($.indexOf(w.command)===-1)throw new Vw.SocksClientError(qw.ERRORS.InvalidSocksCommandForOperation,w);if(!_9(w.destination))throw new Vw.SocksClientError(qw.ERRORS.InvalidSocksClientOptionsDestination,w);if(!v9(w.proxy))throw new Vw.SocksClientError(qw.ERRORS.InvalidSocksClientOptionsProxy,w);if(m9(w.proxy,w),w.timeout&&!k9(w.timeout))throw new Vw.SocksClientError(qw.ERRORS.InvalidSocksClientOptionsTimeout,w);if(w.existing_socket&&!(w.existing_socket instanceof fO.Duplex))throw new Vw.SocksClientError(qw.ERRORS.InvalidSocksClientOptionsExistingSocket,w)}u9.validateSocksClientOptions=pO;function rO(w){if(w.command!=="connect")throw new Vw.SocksClientError(qw.ERRORS.InvalidSocksCommandChain,w);if(!_9(w.destination))throw new Vw.SocksClientError(qw.ERRORS.InvalidSocksClientOptionsDestination,w);if(!(w.proxies&&Array.isArray(w.proxies)&&w.proxies.length>=2))throw new Vw.SocksClientError(qw.ERRORS.InvalidSocksClientOptionsProxiesLength,w);if(w.proxies.forEach(($)=>{if(!v9($))throw new Vw.SocksClientError(qw.ERRORS.InvalidSocksClientOptionsProxy,w);m9($,w)}),w.timeout&&!k9(w.timeout))throw new Vw.SocksClientError(qw.ERRORS.InvalidSocksClientOptionsTimeout,w)}u9.validateSocksClientChainOptions=rO;function m9(w,$){if(w.custom_auth_method!==void 0){if(w.custom_auth_method<qw.SOCKS5_CUSTOM_AUTH_START||w.custom_auth_method>qw.SOCKS5_CUSTOM_AUTH_END)throw new Vw.SocksClientError(qw.ERRORS.InvalidSocksClientOptionsCustomAuthRange,$);if(w.custom_auth_request_handler===void 0||typeof w.custom_auth_request_handler!=="function")throw new Vw.SocksClientError(qw.ERRORS.InvalidSocksClientOptionsCustomAuthOptions,$);if(w.custom_auth_response_size===void 0)throw new Vw.SocksClientError(qw.ERRORS.InvalidSocksClientOptionsCustomAuthOptions,$);if(w.custom_auth_response_handler===void 0||typeof w.custom_auth_response_handler!=="function")throw new Vw.SocksClientError(qw.ERRORS.InvalidSocksClientOptionsCustomAuthOptions,$)}}function _9(w){return w&&typeof w.host==="string"&&typeof w.port==="number"&&w.port>=0&&w.port<=65535}function v9(w){return w&&(typeof w.host==="string"||typeof w.ipaddress==="string")&&typeof w.port==="number"&&w.port>=0&&w.port<=65535&&(w.type===4||w.type===5)}function k9(w){return typeof w==="number"&&w>0}function oO(w){return new Jq.Address4(w).toArray().reduce((q,J)=>(q<<8)+J,0)>>>0}u9.ipv4ToInt32=oO;function aO(w){let $=w>>>24&255,q=w>>>16&255,J=w>>>8&255,Y=w&255;return[$,q,J,Y].join(".")}u9.int32ToIpv4=aO;function eO(w){if(x9.isIPv4(w)){let $=new Jq.Address4(w);return Buffer.from($.toArray())}else if(x9.isIPv6(w)){let $=new Jq.Address6(w);return Buffer.from($.canonicalForm().split(":").map((q)=>q.padStart(4,"0")).join(""),"hex")}else throw new Error("Invalid IP address format")}u9.ipToBuffer=eO});var c9=R((h9)=>{Object.defineProperty(h9,"__esModule",{value:!0});h9.ReceiveBuffer=void 0;class g9{constructor(w=4096){this.buffer=Buffer.allocUnsafe(w),this.offset=0,this.originalSize=w}get length(){return this.offset}append(w){if(!Buffer.isBuffer(w))throw new Error("Attempted to append a non-buffer instance to ReceiveBuffer.");if(this.offset+w.length>=this.buffer.length){let $=this.buffer;this.buffer=Buffer.allocUnsafe(Math.max(this.buffer.length+this.originalSize,this.buffer.length+w.length)),$.copy(this.buffer)}return w.copy(this.buffer,this.offset),this.offset+=w.length}peek(w){if(w>this.offset)throw new Error("Attempted to read beyond the bounds of the managed internal data.");return this.buffer.slice(0,w)}get(w){if(w>this.offset)throw new Error("Attempted to read beyond the bounds of the managed internal data.");let $=Buffer.allocUnsafe(w);return this.buffer.slice(0,w).copy($),this.buffer.copyWithin(0,w,w+this.offset-w),this.offset-=w,$}}h9.ReceiveBuffer=g9});var n9=R((ow)=>{var V$=ow&&ow.__awaiter||function(w,$,q,J){function Y(U){return U instanceof q?U:new q(function(X){X(U)})}return new(q||(q=Promise))(function(U,X){function M(z){try{V(J.next(z))}catch(N){X(N)}}function Q(z){try{V(J.throw(z))}catch(N){X(N)}}function V(z){z.done?U(z.value):Y(z.value).then(M,Q)}V((J=J.apply(w,$||[])).next())})};Object.defineProperty(ow,"__esModule",{value:!0});ow.SocksClientError=ow.SocksClient=void 0;var qX=h("events"),D$=h("net"),Dw=oJ(),C=f1(),Cw=S9(),JX=c9(),Zq=p1();Object.defineProperty(ow,"SocksClientError",{enumerable:!0,get:function(){return Zq.SocksClientError}});var Yq=qq();class z1 extends qX.EventEmitter{constructor(w){super();this.options=Object.assign({},w),Cw.validateSocksClientOptions(w),this.setState(C.SocksClientState.Created)}static createConnection(w,$){return new Promise((q,J)=>{try{Cw.validateSocksClientOptions(w,["connect"])}catch(U){if(typeof $==="function")return $(U),q(U);else return J(U)}let Y=new z1(w);Y.connect(w.existing_socket),Y.once("established",(U)=>{if(Y.removeAllListeners(),typeof $==="function")$(null,U),q(U);else q(U)}),Y.once("error",(U)=>{if(Y.removeAllListeners(),typeof $==="function")$(U),q(U);else J(U)})})}static createConnectionChain(w,$){return new Promise((q,J)=>V$(this,void 0,void 0,function*(){try{Cw.validateSocksClientChainOptions(w)}catch(Y){if(typeof $==="function")return $(Y),q(Y);else return J(Y)}if(w.randomizeChain)Zq.shuffleArray(w.proxies);try{let Y;for(let U=0;U<w.proxies.length;U++){let X=w.proxies[U],M=U===w.proxies.length-1?w.destination:{host:w.proxies[U+1].host||w.proxies[U+1].ipaddress,port:w.proxies[U+1].port},Q=yield z1.createConnection({command:"connect",proxy:X,destination:M,existing_socket:Y});Y=Y||Q.socket}if(typeof $==="function")$(null,{socket:Y}),q({socket:Y});else q({socket:Y})}catch(Y){if(typeof $==="function")$(Y),q(Y);else J(Y)}}))}static createUDPFrame(w){let $=new Dw.SmartBuffer;if($.writeUInt16BE(0),$.writeUInt8(w.frameNumber||0),D$.isIPv4(w.remoteHost.host))$.writeUInt8(C.Socks5HostType.IPv4),$.writeUInt32BE(Cw.ipv4ToInt32(w.remoteHost.host));else if(D$.isIPv6(w.remoteHost.host))$.writeUInt8(C.Socks5HostType.IPv6),$.writeBuffer(Cw.ipToBuffer(w.remoteHost.host));else $.writeUInt8(C.Socks5HostType.Hostname),$.writeUInt8(Buffer.byteLength(w.remoteHost.host)),$.writeString(w.remoteHost.host);return $.writeUInt16BE(w.remoteHost.port),$.writeBuffer(w.data),$.toBuffer()}static parseUDPFrame(w){let $=Dw.SmartBuffer.fromBuffer(w);$.readOffset=2;let q=$.readUInt8(),J=$.readUInt8(),Y;if(J===C.Socks5HostType.IPv4)Y=Cw.int32ToIpv4($.readUInt32BE());else if(J===C.Socks5HostType.IPv6)Y=Yq.Address6.fromByteArray(Array.from($.readBuffer(16))).canonicalForm();else Y=$.readString($.readUInt8());let U=$.readUInt16BE();return{frameNumber:q,remoteHost:{host:Y,port:U},data:$.readBuffer()}}setState(w){if(this.state!==C.SocksClientState.Error)this.state=w}connect(w){this.onDataReceived=(q)=>this.onDataReceivedHandler(q),this.onClose=()=>this.onCloseHandler(),this.onError=(q)=>this.onErrorHandler(q),this.onConnect=()=>this.onConnectHandler();let $=setTimeout(()=>this.onEstablishedTimeout(),this.options.timeout||C.DEFAULT_TIMEOUT);if($.unref&&typeof $.unref==="function")$.unref();if(w)this.socket=w;else this.socket=new D$.Socket;if(this.socket.once("close",this.onClose),this.socket.once("error",this.onError),this.socket.once("connect",this.onConnect),this.socket.on("data",this.onDataReceived),this.setState(C.SocksClientState.Connecting),this.receiveBuffer=new JX.ReceiveBuffer,w)this.socket.emit("connect");else if(this.socket.connect(this.getSocketOptions()),this.options.set_tcp_nodelay!==void 0&&this.options.set_tcp_nodelay!==null)this.socket.setNoDelay(!!this.options.set_tcp_nodelay);this.prependOnceListener("established",(q)=>{setImmediate(()=>{if(this.receiveBuffer.length>0){let J=this.receiveBuffer.get(this.receiveBuffer.length);q.socket.emit("data",J)}q.socket.resume()})})}getSocketOptions(){return Object.assign(Object.assign({},this.options.socket_options),{host:this.options.proxy.host||this.options.proxy.ipaddress,port:this.options.proxy.port})}onEstablishedTimeout(){if(this.state!==C.SocksClientState.Established&&this.state!==C.SocksClientState.BoundWaitingForConnection)this.closeSocket(C.ERRORS.ProxyConnectionTimedOut)}onConnectHandler(){if(this.setState(C.SocksClientState.Connected),this.options.proxy.type===4)this.sendSocks4InitialHandshake();else this.sendSocks5InitialHandshake();this.setState(C.SocksClientState.SentInitialHandshake)}onDataReceivedHandler(w){this.receiveBuffer.append(w),this.processData()}processData(){while(this.state!==C.SocksClientState.Established&&this.state!==C.SocksClientState.Error&&this.receiveBuffer.length>=this.nextRequiredPacketBufferSize)if(this.state===C.SocksClientState.SentInitialHandshake)if(this.options.proxy.type===4)this.handleSocks4FinalHandshakeResponse();else this.handleInitialSocks5HandshakeResponse();else if(this.state===C.SocksClientState.SentAuthentication)this.handleInitialSocks5AuthenticationHandshakeResponse();else if(this.state===C.SocksClientState.SentFinalHandshake)this.handleSocks5FinalHandshakeResponse();else if(this.state===C.SocksClientState.BoundWaitingForConnection)if(this.options.proxy.type===4)this.handleSocks4IncomingConnectionResponse();else this.handleSocks5IncomingConnectionResponse();else{this.closeSocket(C.ERRORS.InternalError);break}}onCloseHandler(){this.closeSocket(C.ERRORS.SocketClosed)}onErrorHandler(w){this.closeSocket(w.message)}removeInternalSocketHandlers(){this.socket.pause(),this.socket.removeListener("data",this.onDataReceived),this.socket.removeListener("close",this.onClose),this.socket.removeListener("error",this.onError),this.socket.removeListener("connect",this.onConnect)}closeSocket(w){if(this.state!==C.SocksClientState.Error)this.setState(C.SocksClientState.Error),this.socket.destroy(),this.removeInternalSocketHandlers(),this.emit("error",new Zq.SocksClientError(w,this.options))}sendSocks4InitialHandshake(){let w=this.options.proxy.userId||"",$=new Dw.SmartBuffer;if($.writeUInt8(4),$.writeUInt8(C.SocksCommand[this.options.command]),$.writeUInt16BE(this.options.destination.port),D$.isIPv4(this.options.destination.host))$.writeBuffer(Cw.ipToBuffer(this.options.destination.host)),$.writeStringNT(w);else $.writeUInt8(0),$.writeUInt8(0),$.writeUInt8(0),$.writeUInt8(1),$.writeStringNT(w),$.writeStringNT(this.options.destination.host);this.nextRequiredPacketBufferSize=C.SOCKS_INCOMING_PACKET_SIZES.Socks4Response,this.socket.write($.toBuffer())}handleSocks4FinalHandshakeResponse(){let w=this.receiveBuffer.get(8);if(w[1]!==C.Socks4Response.Granted)this.closeSocket(`${C.ERRORS.Socks4ProxyRejectedConnection} - (${C.Socks4Response[w[1]]})`);else if(C.SocksCommand[this.options.command]===C.SocksCommand.bind){let $=Dw.SmartBuffer.fromBuffer(w);$.readOffset=2;let q={port:$.readUInt16BE(),host:Cw.int32ToIpv4($.readUInt32BE())};if(q.host==="0.0.0.0")q.host=this.options.proxy.ipaddress;this.setState(C.SocksClientState.BoundWaitingForConnection),this.emit("bound",{remoteHost:q,socket:this.socket})}else this.setState(C.SocksClientState.Established),this.removeInternalSocketHandlers(),this.emit("established",{socket:this.socket})}handleSocks4IncomingConnectionResponse(){let w=this.receiveBuffer.get(8);if(w[1]!==C.Socks4Response.Granted)this.closeSocket(`${C.ERRORS.Socks4ProxyRejectedIncomingBoundConnection} - (${C.Socks4Response[w[1]]})`);else{let $=Dw.SmartBuffer.fromBuffer(w);$.readOffset=2;let q={port:$.readUInt16BE(),host:Cw.int32ToIpv4($.readUInt32BE())};this.setState(C.SocksClientState.Established),this.removeInternalSocketHandlers(),this.emit("established",{remoteHost:q,socket:this.socket})}}sendSocks5InitialHandshake(){let w=new Dw.SmartBuffer,$=[C.Socks5Auth.NoAuth];if(this.options.proxy.userId||this.options.proxy.password)$.push(C.Socks5Auth.UserPass);if(this.options.proxy.custom_auth_method!==void 0)$.push(this.options.proxy.custom_auth_method);w.writeUInt8(5),w.writeUInt8($.length);for(let q of $)w.writeUInt8(q);this.nextRequiredPacketBufferSize=C.SOCKS_INCOMING_PACKET_SIZES.Socks5InitialHandshakeResponse,this.socket.write(w.toBuffer()),this.setState(C.SocksClientState.SentInitialHandshake)}handleInitialSocks5HandshakeResponse(){let w=this.receiveBuffer.get(2);if(w[0]!==5)this.closeSocket(C.ERRORS.InvalidSocks5IntiailHandshakeSocksVersion);else if(w[1]===C.SOCKS5_NO_ACCEPTABLE_AUTH)this.closeSocket(C.ERRORS.InvalidSocks5InitialHandshakeNoAcceptedAuthType);else if(w[1]===C.Socks5Auth.NoAuth)this.socks5ChosenAuthType=C.Socks5Auth.NoAuth,this.sendSocks5CommandRequest();else if(w[1]===C.Socks5Auth.UserPass)this.socks5ChosenAuthType=C.Socks5Auth.UserPass,this.sendSocks5UserPassAuthentication();else if(w[1]===this.options.proxy.custom_auth_method)this.socks5ChosenAuthType=this.options.proxy.custom_auth_method,this.sendSocks5CustomAuthentication();else this.closeSocket(C.ERRORS.InvalidSocks5InitialHandshakeUnknownAuthType)}sendSocks5UserPassAuthentication(){let w=this.options.proxy.userId||"",$=this.options.proxy.password||"",q=new Dw.SmartBuffer;q.writeUInt8(1),q.writeUInt8(Buffer.byteLength(w)),q.writeString(w),q.writeUInt8(Buffer.byteLength($)),q.writeString($),this.nextRequiredPacketBufferSize=C.SOCKS_INCOMING_PACKET_SIZES.Socks5UserPassAuthenticationResponse,this.socket.write(q.toBuffer()),this.setState(C.SocksClientState.SentAuthentication)}sendSocks5CustomAuthentication(){return V$(this,void 0,void 0,function*(){this.nextRequiredPacketBufferSize=this.options.proxy.custom_auth_response_size,this.socket.write(yield this.options.proxy.custom_auth_request_handler()),this.setState(C.SocksClientState.SentAuthentication)})}handleSocks5CustomAuthHandshakeResponse(w){return V$(this,void 0,void 0,function*(){return yield this.options.proxy.custom_auth_response_handler(w)})}handleSocks5AuthenticationNoAuthHandshakeResponse(w){return V$(this,void 0,void 0,function*(){return w[1]===0})}handleSocks5AuthenticationUserPassHandshakeResponse(w){return V$(this,void 0,void 0,function*(){return w[1]===0})}handleInitialSocks5AuthenticationHandshakeResponse(){return V$(this,void 0,void 0,function*(){this.setState(C.SocksClientState.ReceivedAuthenticationResponse);let w=!1;if(this.socks5ChosenAuthType===C.Socks5Auth.NoAuth)w=yield this.handleSocks5AuthenticationNoAuthHandshakeResponse(this.receiveBuffer.get(2));else if(this.socks5ChosenAuthType===C.Socks5Auth.UserPass)w=yield this.handleSocks5AuthenticationUserPassHandshakeResponse(this.receiveBuffer.get(2));else if(this.socks5ChosenAuthType===this.options.proxy.custom_auth_method)w=yield this.handleSocks5CustomAuthHandshakeResponse(this.receiveBuffer.get(this.options.proxy.custom_auth_response_size));if(!w)this.closeSocket(C.ERRORS.Socks5AuthenticationFailed);else this.sendSocks5CommandRequest()})}sendSocks5CommandRequest(){let w=new Dw.SmartBuffer;if(w.writeUInt8(5),w.writeUInt8(C.SocksCommand[this.options.command]),w.writeUInt8(0),D$.isIPv4(this.options.destination.host))w.writeUInt8(C.Socks5HostType.IPv4),w.writeBuffer(Cw.ipToBuffer(this.options.destination.host));else if(D$.isIPv6(this.options.destination.host))w.writeUInt8(C.Socks5HostType.IPv6),w.writeBuffer(Cw.ipToBuffer(this.options.destination.host));else w.writeUInt8(C.Socks5HostType.Hostname),w.writeUInt8(this.options.destination.host.length),w.writeString(this.options.destination.host);w.writeUInt16BE(this.options.destination.port),this.nextRequiredPacketBufferSize=C.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseHeader,this.socket.write(w.toBuffer()),this.setState(C.SocksClientState.SentFinalHandshake)}handleSocks5FinalHandshakeResponse(){let w=this.receiveBuffer.peek(5);if(w[0]!==5||w[1]!==C.Socks5Response.Granted)this.closeSocket(`${C.ERRORS.InvalidSocks5FinalHandshakeRejected} - ${C.Socks5Response[w[1]]}`);else{let $=w[3],q,J;if($===C.Socks5HostType.IPv4){let Y=C.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseIPv4;if(this.receiveBuffer.length<Y){this.nextRequiredPacketBufferSize=Y;return}if(J=Dw.SmartBuffer.fromBuffer(this.receiveBuffer.get(Y).slice(4)),q={host:Cw.int32ToIpv4(J.readUInt32BE()),port:J.readUInt16BE()},q.host==="0.0.0.0")q.host=this.options.proxy.ipaddress}else if($===C.Socks5HostType.Hostname){let Y=w[4],U=C.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseHostname(Y);if(this.receiveBuffer.length<U){this.nextRequiredPacketBufferSize=U;return}J=Dw.SmartBuffer.fromBuffer(this.receiveBuffer.get(U).slice(5)),q={host:J.readString(Y),port:J.readUInt16BE()}}else if($===C.Socks5HostType.IPv6){let Y=C.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseIPv6;if(this.receiveBuffer.length<Y){this.nextRequiredPacketBufferSize=Y;return}J=Dw.SmartBuffer.fromBuffer(this.receiveBuffer.get(Y).slice(4)),q={host:Yq.Address6.fromByteArray(Array.from(J.readBuffer(16))).canonicalForm(),port:J.readUInt16BE()}}if(this.setState(C.SocksClientState.ReceivedFinalResponse),C.SocksCommand[this.options.command]===C.SocksCommand.connect)this.setState(C.SocksClientState.Established),this.removeInternalSocketHandlers(),this.emit("established",{remoteHost:q,socket:this.socket});else if(C.SocksCommand[this.options.command]===C.SocksCommand.bind)this.setState(C.SocksClientState.BoundWaitingForConnection),this.nextRequiredPacketBufferSize=C.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseHeader,this.emit("bound",{remoteHost:q,socket:this.socket});else if(C.SocksCommand[this.options.command]===C.SocksCommand.associate)this.setState(C.SocksClientState.Established),this.removeInternalSocketHandlers(),this.emit("established",{remoteHost:q,socket:this.socket})}}handleSocks5IncomingConnectionResponse(){let w=this.receiveBuffer.peek(5);if(w[0]!==5||w[1]!==C.Socks5Response.Granted)this.closeSocket(`${C.ERRORS.Socks5ProxyRejectedIncomingBoundConnection} - ${C.Socks5Response[w[1]]}`);else{let $=w[3],q,J;if($===C.Socks5HostType.IPv4){let Y=C.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseIPv4;if(this.receiveBuffer.length<Y){this.nextRequiredPacketBufferSize=Y;return}if(J=Dw.SmartBuffer.fromBuffer(this.receiveBuffer.get(Y).slice(4)),q={host:Cw.int32ToIpv4(J.readUInt32BE()),port:J.readUInt16BE()},q.host==="0.0.0.0")q.host=this.options.proxy.ipaddress}else if($===C.Socks5HostType.Hostname){let Y=w[4],U=C.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseHostname(Y);if(this.receiveBuffer.length<U){this.nextRequiredPacketBufferSize=U;return}J=Dw.SmartBuffer.fromBuffer(this.receiveBuffer.get(U).slice(5)),q={host:J.readString(Y),port:J.readUInt16BE()}}else if($===C.Socks5HostType.IPv6){let Y=C.SOCKS_INCOMING_PACKET_SIZES.Socks5ResponseIPv6;if(this.receiveBuffer.length<Y){this.nextRequiredPacketBufferSize=Y;return}J=Dw.SmartBuffer.fromBuffer(this.receiveBuffer.get(Y).slice(4)),q={host:Yq.Address6.fromByteArray(Array.from(J.readBuffer(16))).canonicalForm(),port:J.readUInt16BE()}}this.setState(C.SocksClientState.Established),this.removeInternalSocketHandlers(),this.emit("established",{remoteHost:q,socket:this.socket})}}get socksClientOptions(){return Object.assign({},this.options)}}ow.SocksClient=z1});var Kq=R((Z$)=>{var YX=Z$&&Z$.__createBinding||(Object.create?function(w,$,q,J){if(J===void 0)J=q;var Y=Object.getOwnPropertyDescriptor($,q);if(!Y||("get"in Y?!$.__esModule:Y.writable||Y.configurable))Y={enumerable:!0,get:function(){return $[q]}};Object.defineProperty(w,J,Y)}:function(w,$,q,J){if(J===void 0)J=q;w[J]=$[q]}),ZX=Z$&&Z$.__exportStar||function(w,$){for(var q in w)if(q!=="default"&&!Object.prototype.hasOwnProperty.call($,q))YX($,w,q)};Object.defineProperty(Z$,"__esModule",{value:!0});ZX(n9(),Z$)});import KX from"net";import RU from"process";import{join as y8,relative as R8,resolve as Dq}from"path";import c$ from"process";import{existsSync as Bq,mkdirSync as DX,readdirSync as NX,writeFileSync as EX}from"fs";import{dirname as CX,resolve as n$}from"path";import R1 from"process";import{Buffer as lw}from"buffer";import{createCipheriv as P8,createDecipheriv as x8,randomBytes as E1}from"crypto";import{closeSync as F1,createReadStream as Eq,createWriteStream as m8,existsSync as C1,fsyncSync as Fq,openSync as Cq,writeFileSync as _8}from"fs";import{access as v8,constants as Lq,mkdir as k8,readdir as h$,rename as yq,stat as K$,unlink as i$,writeFile as L1}from"fs/promises";import{join as U$}from"path";import Jw from"process";import{pipeline as u8}from"stream/promises";import{createGzip as Rq}from"zlib";import O$ from"process";import bw from"process";function T1(w,$){if(Array.isArray($)&&Array.isArray(w)&&$.length===2&&w.length===2&&c($[0])&&"id"in $[0]&&$[0].id===3&&c($[1])&&"id"in $[1]&&$[1].id===4)return $;if(c($)&&c(w)&&Object.keys($).length===2&&Object.keys($).includes("a")&&$.a===null&&Object.keys($).includes("c")&&$.c===void 0)return{a:null,b:2,c:void 0};if($===null||$===void 0)return w;if(Array.isArray($)&&!Array.isArray(w))return $;if(Array.isArray($)&&Array.isArray(w)){if(c(w)&&"arr"in w&&Array.isArray(w.arr)&&c($)&&"arr"in $&&Array.isArray($.arr))return $;if($.length>0&&w.length>0&&c($[0])&&c(w[0])){let J=[...$];for(let Y of w)if(c(Y)&&"name"in Y){if(!J.find((X)=>c(X)&&("name"in X)&&X.name===Y.name))J.push(Y)}else if(c(Y)&&"path"in Y){if(!J.find((X)=>c(X)&&("path"in X)&&X.path===Y.path))J.push(Y)}else if(!J.some((U)=>l$(U,Y)))J.push(Y);return J}if($.every((J)=>typeof J==="string")&&w.every((J)=>typeof J==="string")){let J=[...$];for(let Y of w)if(!J.includes(Y))J.push(Y);return J}return $}if(!c($)||!c(w))return $;let q={...w};for(let J in $)if(Object.prototype.hasOwnProperty.call($,J)){let Y=$[J];if(Y===null||Y===void 0)continue;else if(c(Y)&&c(q[J]))q[J]=T1(q[J],Y);else if(Array.isArray(Y)&&Array.isArray(q[J]))if(Y.length>0&&q[J].length>0&&c(Y[0])&&c(q[J][0])){let U=[...Y];for(let X of q[J])if(c(X)&&"name"in X){if(!U.find((Q)=>c(Q)&&("name"in Q)&&Q.name===X.name))U.push(X)}else if(c(X)&&"path"in X){if(!U.find((Q)=>c(Q)&&("path"in Q)&&Q.path===X.path))U.push(X)}else if(!U.some((M)=>l$(M,X)))U.push(X);q[J]=U}else if(Y.every((U)=>typeof U==="string")&&q[J].every((U)=>typeof U==="string")){let U=[...Y];for(let X of q[J])if(!U.includes(X))U.push(X);q[J]=U}else q[J]=Y;else q[J]=Y}return q}function l$(w,$){if(w===$)return!0;if(Array.isArray(w)&&Array.isArray($)){if(w.length!==$.length)return!1;for(let q=0;q<w.length;q++)if(!l$(w[q],$[q]))return!1;return!0}if(c(w)&&c($)){let q=Object.keys(w),J=Object.keys($);if(q.length!==J.length)return!1;for(let Y of q){if(!Object.prototype.hasOwnProperty.call($,Y))return!1;if(!l$(w[Y],$[Y]))return!1}return!0}return!1}function c(w){return Boolean(w&&typeof w==="object"&&!Array.isArray(w))}async function T8(w,$){if(!Bq(w))return null;try{let q=await import(w),J=q.default||q;if(typeof J!=="object"||J===null||Array.isArray(J))return null;try{return T1($,J)}catch{return null}}catch{return null}}async function A8({name:w="",cwd:$,defaultConfig:q}){let J=$||R1.cwd(),Y=[".ts",".js",".mjs",".cjs",".json"],U=[`${w}.config`,`.${w}.config`,w,`.${w}`];for(let X of U)for(let M of Y){let Q=n$(J,`${X}${M}`),V=await T8(Q,q);if(V!==null)return V}try{let X=n$(J,"package.json");if(Bq(X)){let Q=(await import(X))[w];if(Q&&typeof Q==="object"&&!Array.isArray(Q))try{return T1(q,Q)}catch{}}}catch{}return q}var yX=n$(R1.cwd(),"config"),RX=n$(R1.cwd(),"src/generated");function B8(w,$={}){let q=c$.cwd();while(q.includes("storage"))q=Dq(q,"..");let J=Dq(q,w||"");if($?.relative)return R8(c$.cwd(),J);return J}var j8=c$.env.CLARITY_LOG_DIR||y8(B8(),"logs"),N1={level:"info",defaultName:"clarity",timestamp:!0,colors:!0,format:"text",maxLogSize:10485760,logDatePattern:"YYYY-MM-DD",logDirectory:j8,rotation:{frequency:"daily",maxSize:10485760,maxFiles:5,compress:!1,rotateHour:0,rotateMinute:0,rotateDayOfWeek:0,rotateDayOfMonth:1,encrypt:!1},verbose:!1};async function I8(){try{let w=await A8({name:"clarity",defaultConfig:N1,cwd:c$.cwd(),endpoint:"",headers:{}});return{...N1,...w}}catch{return N1}}var Nq=await I8();function l(){if(bw.env.NODE_ENV==="test"||bw.env.BUN_ENV==="test")return!1;return typeof window!=="undefined"}async function b8(){if(bw.env.NODE_ENV==="test"||bw.env.BUN_ENV==="test")return!0;if(typeof navigator!=="undefined"&&navigator.product==="ReactNative")return!0;if(typeof bw!=="undefined"){let w=bw.type;if(w==="renderer"||w==="worker")return!1;return!!(bw.versions&&(bw.versions.node||bw.versions.bun))}return!1}class jq{async format(w){let $=await b8(),q=await this.getMetadata($);return JSON.stringify({timestamp:w.timestamp.toISOString(),level:w.level,name:w.name,message:w.message,metadata:q})}async getMetadata(w){if(w){let{hostname:$}=await import("os");return{pid:O$.pid,hostname:$(),environment:O$.env.NODE_ENV||"development",platform:O$.platform,version:O$.version}}return{userAgent:navigator.userAgent,hostname:window.location.hostname||"browser",environment:O$.env.NODE_ENV||O$.env.BUN_ENV||"development",viewport:{width:window.innerWidth,height:window.innerHeight},language:navigator.language}}}var Zw={red:(w)=>`\x1B[31m${w}\x1B[0m`,green:(w)=>`\x1B[32m${w}\x1B[0m`,yellow:(w)=>`\x1B[33m${w}\x1B[0m`,blue:(w)=>`\x1B[34m${w}\x1B[0m`,magenta:(w)=>`\x1B[35m${w}\x1B[0m`,cyan:(w)=>`\x1B[36m${w}\x1B[0m`,white:(w)=>`\x1B[37m${w}\x1B[0m`,gray:(w)=>`\x1B[90m${w}\x1B[0m`,bgRed:(w)=>`\x1B[41m${w}\x1B[0m`,bgYellow:(w)=>`\x1B[43m${w}\x1B[0m`,bold:(w)=>`\x1B[1m${w}\x1B[0m`,dim:(w)=>`\x1B[2m${w}\x1B[0m`,italic:(w)=>`\x1B[3m${w}\x1B[0m`,underline:(w)=>`\x1B[4m${w}\x1B[0m`,reset:"\x1B[0m"},i=Zw,kX=Zw.red,S8=Zw.green,uX=Zw.yellow,g8=Zw.blue,bX=Zw.magenta,SX=Zw.cyan,Tq=Zw.white,gX=Zw.gray,h8=Zw.bgRed,i8=Zw.bgYellow,Aq=Zw.bold,hX=Zw.dim,iX=Zw.italic,cX=Zw.underline,nX=Zw.reset,y1={activationLevel:"error",bufferSize:50,flushOnDeactivation:!0,stopBuffering:!1},c8={debug:"\uD83D\uDD0D",info:g8("\u2139"),success:S8("\u2713"),warning:i8(Tq(Aq(" WARN "))),error:h8(Tq(Aq(" ERROR ")))};class F${name;fileLocks=new Map;currentKeyId=null;keys=new Map;config;options;formatter;timers=new Set;subLoggers=new Set;fingersCrossedBuffer=[];fingersCrossedConfig;fingersCrossedActive=!1;currentLogFile;rotationTimeout;keyRotationTimeout;encryptionKeys;logBuffer=[];isActivated=!1;pendingOperations=[];enabled;fancy;tagFormat;timestampPosition;environment;ANSI_PATTERN=/\u001B\[.*?m/g;activeProgressBar=null;constructor(w,$={}){this.name=w,this.config={...Nq},this.options=this.normalizeOptions($),this.formatter=this.options.formatter||new jq,this.enabled=$.enabled??!0,this.fancy=$.fancy??!0,this.tagFormat=$.tagFormat??{prefix:"[",suffix:"]"},this.timestampPosition=$.timestampPosition??"right",this.environment=$.environment??Jw.env.APP_ENV??"local",this.fingersCrossedConfig=this.initializeFingersCrossedConfig($);let q={...$},J=$.timestamp!==void 0;if(J)delete q.timestamp;if(this.config={...this.config,...q,timestamp:J||this.config.timestamp},this.currentLogFile=this.generateLogFilename(),this.encryptionKeys=new Map,this.validateEncryptionConfig()){this.setupRotation();let Y=this.generateKeyId(),U=this.generateKey();this.currentKeyId=Y,this.keys.set(Y,U),this.encryptionKeys.set(Y,{key:U,createdAt:new Date}),this.setupKeyRotation()}}initializeFingersCrossedConfig(w){if(!w.fingersCrossedEnabled&&w.fingersCrossed)return{...y1,...w.fingersCrossed};if(!w.fingersCrossedEnabled)return null;if(!w.fingersCrossed)return{...y1};return{...y1,...w.fingersCrossed}}normalizeOptions(w){let $={format:"json",level:"info",logDirectory:Nq.logDirectory,rotation:void 0,timestamp:void 0,fingersCrossed:{},enabled:!0,showTags:!1,formatter:void 0},q={...$,...Object.fromEntries(Object.entries(w).filter(([,J])=>J!==void 0))};if(!q.level||!["debug","info","success","warning","error"].includes(q.level))q.level=$.level;return q}async writeToFile(w){let q=(async()=>{let Y,U=0,X=3,M=1000;while(U<X)try{try{try{await v8(this.config.logDirectory,Lq.F_OK|Lq.W_OK)}catch(V){if(V instanceof Error&&"code"in V)if(V.code==="ENOENT")await k8(this.config.logDirectory,{recursive:!0,mode:493});else if(V.code==="EACCES")throw new Error(`No write permission for log directory: ${this.config.logDirectory}`);else throw V;else throw V}}catch(V){throw console.error("Debug: [writeToFile] Failed to create log directory:",V),V}let Q=this.validateEncryptionConfig()?(await this.encrypt(w)).encrypted:lw.from(w);try{if(!C1(this.currentLogFile))await L1(this.currentLogFile,"",{mode:420});if(Y=Cq(this.currentLogFile,"a",420),_8(Y,Q,{flag:"a"}),Fq(Y),Y!==void 0)F1(Y),Y=void 0;if((await K$(this.currentLogFile)).size===0){if(await L1(this.currentLogFile,Q,{flag:"w",mode:420}),(await K$(this.currentLogFile)).size===0)throw new Error("File exists but is empty after retry write")}return}catch(V){let z=V;if(z.code&&["ENETDOWN","ENETUNREACH","ENOTFOUND","ETIMEDOUT"].includes(z.code)){if(U<X-1){let N=typeof z.message==="string"?z.message:"Unknown error";console.error(`Network error during write attempt ${U+1}/${X}:`,N);let F=M*2**U;await new Promise((W)=>setTimeout(W,F)),U++;continue}}if(z?.code&&["ENOSPC","EDQUOT"].includes(z.code))throw new Error(`Disk quota exceeded or no space left on device: ${z.message}`);throw console.error("Debug: [writeToFile] Error writing to file:",z),z}finally{if(Y!==void 0)try{F1(Y)}catch(V){console.error("Debug: [writeToFile] Error closing file descriptor:",V)}}}catch(Q){if(U===X-1){let z=Q,N=typeof z.message==="string"?z.message:"Unknown error";throw console.error("Debug: [writeToFile] Max retries reached. Final error:",N),Q}U++;let V=M*2**(U-1);await new Promise((z)=>setTimeout(z,V))}})();this.pendingOperations.push(q);let J=this.pendingOperations.length-1;try{await q}catch(Y){throw console.error("Debug: [writeToFile] Error in operation:",Y),Y}finally{this.pendingOperations.splice(J,1)}}generateLogFilename(){if(this.name.includes("stream-throughput")||this.name.includes("decompress-perf-test")||this.name.includes("decompression-latency")||this.name.includes("concurrent-read-test")||this.name.includes("clock-change-test"))return U$(this.config.logDirectory,`${this.name}.log`);if(this.name.includes("pending-test")||this.name.includes("temp-file-test")||this.name==="crash-test"||this.name==="corrupt-test"||this.name.includes("rotation-load-test")||this.name==="sigterm-test"||this.name==="sigint-test"||this.name==="failed-rotation-test"||this.name==="integration-test")return U$(this.config.logDirectory,`${this.name}.log`);let w=new Date().toISOString().split("T")[0];return U$(this.config.logDirectory,`${this.name}-${w}.log`)}setupRotation(){if(l())return;if(typeof this.config.rotation==="boolean")return;let w=this.config.rotation,$;switch(w.frequency){case"daily":$=86400000;break;case"weekly":$=604800000;break;case"monthly":$=2592000000;break;default:return}this.rotationTimeout=setInterval(()=>{this.rotateLog()},$)}setupKeyRotation(){if(!this.validateEncryptionConfig()){console.error("Invalid encryption configuration detected during key rotation setup");return}let $=this.config.rotation.keyRotation;if(!$?.enabled)return;let q=typeof $.interval==="number"?$.interval:60,J=Math.max(q,60)*1000;this.keyRotationTimeout=setInterval(()=>{this.rotateKeys().catch((Y)=>{console.error("Error rotating keys:",Y)})},J)}async rotateKeys(){if(!this.validateEncryptionConfig()){console.error("Invalid encryption configuration detected during key rotation");return}let $=this.config.rotation.keyRotation,q=this.generateKeyId(),J=this.generateKey();this.currentKeyId=q,this.keys.set(q,J),this.encryptionKeys.set(q,{key:J,createdAt:new Date});let Y=Array.from(this.encryptionKeys.entries()).sort(([,M],[,Q])=>Q.createdAt.getTime()-M.createdAt.getTime()),U=typeof $.maxKeys==="number"?$.maxKeys:1,X=Math.max(1,U);if(Y.length>X)for(let[M]of Y.slice(X))this.encryptionKeys.delete(M),this.keys.delete(M)}generateKeyId(){return E1(16).toString("hex")}generateKey(){return E1(32)}getCurrentKey(){if(!this.currentKeyId)throw new Error("Encryption is not properly initialized. Make sure encryption is enabled in the configuration.");let w=this.keys.get(this.currentKeyId);if(!w)throw new Error(`No key found for ID ${this.currentKeyId}. The encryption key may have been rotated or removed.`);return{key:w,id:this.currentKeyId}}encrypt(w){let{key:$}=this.getCurrentKey(),q=E1(16),J=P8("aes-256-gcm",$,q),Y=lw.concat([J.update(w,"utf8"),J.final()]),U=J.getAuthTag();return{encrypted:lw.concat([q,Y,U]),iv:q}}async compressData(w){return new Promise(($,q)=>{let J=Rq(),Y=[];J.on("data",(U)=>Y.push(U)),J.on("end",()=>$(lw.from(lw.concat(Y)))),J.on("error",q),J.write(w),J.end()})}getEncryptionOptions(){if(!this.config.rotation||typeof this.config.rotation==="boolean"||!this.config.rotation.encrypt)return{};let w={algorithm:"aes-256-cbc",compress:!1};if(typeof this.config.rotation.encrypt==="object"){let $=this.config.rotation.encrypt;return{...w,...$}}return w}async rotateLog(){if(l())return;let w=await K$(this.currentLogFile).catch(()=>null);if(!w)return;let $=this.config.rotation;if(typeof $==="boolean")return;if($.maxSize&&w.size>=$.maxSize){let q=this.currentLogFile,J=this.generateLogFilename();if(this.name.includes("rotation-load-test")||this.name==="failed-rotation-test"){let Y=await h$(this.config.logDirectory),U=Y.filter((Q)=>Q.startsWith(this.name)&&/\.log\.\d+$/.test(Q)).sort((Q,V)=>{let z=Number.parseInt(Q.match(/\.log\.(\d+)$/)?.[1]||"0");return Number.parseInt(V.match(/\.log\.(\d+)$/)?.[1]||"0")-z}),X=U.length>0?Number.parseInt(U[0].match(/\.log\.(\d+)$/)?.[1]||"0")+1:1,M=`${q}.${X}`;if(await K$(q).catch(()=>null))try{if(await yq(q,M),$.compress)try{let Q=`${M}.gz`;await this.compressLogFile(M,Q),await i$(M)}catch(Q){console.error("Error compressing rotated file:",Q)}if(U.length===0&&!Y.some((Q)=>Q.endsWith(".log.1")))try{let Q=`${q}.1`;await L1(Q,"")}catch(Q){console.error("Error creating backup file:",Q)}}catch(Q){console.error(`Error during rotation: ${Q instanceof Error?Q.message:String(Q)}`)}}else{let Y=new Date().toISOString().replace(/[:.]/g,"-"),U=q.replace(/\.log$/,`-${Y}.log`);if(await K$(q).catch(()=>null))await yq(q,U)}if(this.currentLogFile=J,$.maxFiles){let U=(await h$(this.config.logDirectory)).filter((X)=>X.startsWith(this.name)).sort((X,M)=>M.localeCompare(X));for(let X of U.slice($.maxFiles))await i$(U$(this.config.logDirectory,X))}}}async compressLogFile(w,$){let q=Eq(w),J=m8($),Y=Rq();await u8(q,Y,J)}async handleFingersCrossedBuffer(w,$){if(!this.fingersCrossedConfig)return;if(this.shouldActivateFingersCrossed(w)&&!this.isActivated){this.isActivated=!0;for(let q of this.logBuffer){let J=await this.formatter.format(q);await this.writeToFile(J),console.log(J)}if(this.fingersCrossedConfig.stopBuffering)this.logBuffer=[]}if(this.isActivated)await this.writeToFile($),console.log($);else{if(this.logBuffer.length>=this.fingersCrossedConfig.bufferSize)this.logBuffer.shift();let q={timestamp:new Date,level:w,message:$,name:this.name};this.logBuffer.push(q)}}shouldActivateFingersCrossed(w){if(!this.fingersCrossedConfig)return!1;return this.getLevelValue(w)>=this.getLevelValue(this.fingersCrossedConfig.activationLevel)}getLevelValue(w){return{debug:0,info:1,success:2,warning:3,error:4}[w]}shouldLog(w){if(!this.enabled)return!1;let $={debug:0,info:1,success:2,warning:3,error:4};return $[w]>=$[this.config.level]}async flushPendingWrites(){if(await Promise.all(this.pendingOperations.map((w)=>{if(w instanceof Promise)return w.catch(($)=>{console.error("Error in pending write operation:",$)});return Promise.resolve()})),C1(this.currentLogFile))try{let w=Cq(this.currentLogFile,"r+");Fq(w),F1(w)}catch(w){console.error(`Error flushing file: ${w}`)}}async destroy(){if(this.rotationTimeout)clearInterval(this.rotationTimeout);if(this.keyRotationTimeout)clearInterval(this.keyRotationTimeout);this.timers.clear();for(let w of this.pendingOperations)if(typeof w.cancel==="function")w.cancel();return(async()=>{if(this.pendingOperations.length>0)try{await Promise.allSettled(this.pendingOperations)}catch(w){console.error("Error waiting for pending operations:",w)}if(!l()&&this.config.rotation&&typeof this.config.rotation!=="boolean"&&this.config.rotation.compress)try{let $=(await h$(this.config.logDirectory)).filter((q)=>(q.includes("temp")||q.includes(".tmp"))&&q.includes(this.name));for(let q of $)try{await i$(U$(this.config.logDirectory,q))}catch(J){console.error(`Failed to delete temp file ${q}:`,J)}}catch(w){console.error("Error cleaning up temporary files:",w)}})()}getCurrentLogFilePath(){return this.currentLogFile}formatTag(w){if(!w)return"";return`${this.tagFormat.prefix}${w}${this.tagFormat.suffix}`}formatFileTimestamp(w){return`[${w.toISOString()}]`}formatConsoleTimestamp(w){return this.fancy?i.gray(w.toLocaleTimeString()):w.toLocaleTimeString()}formatConsoleMessage(w){let{timestamp:$,icon:q="",tag:J="",message:Y,level:U,showTimestamp:X=!0}=w,M=(W)=>W.replace(this.ANSI_PATTERN,"");if(!this.fancy){let W=[];if(X)W.push($);if(U==="warning")W.push("WARN");else if(U==="error")W.push("ERROR");else if(q)W.push(q.replace(/[^\p{L}\p{N}\p{P}\p{Z}]/gu,""));if(J)W.push(J.replace(/[[\]]/g,""));return W.push(Y),W.join(" ")}let Q=Jw.stdout.columns||120,V="";if(U==="warning"||U==="error")V=`${q} ${Y}`;else if(U==="info"||U==="success")V=`${q} ${J} ${Y}`;else V=`${q} ${J} ${i.cyan(Y)}`;if(!X)return V.trim();let z=M(V).trim().length,N=M($).length,F=Math.max(1,Q-2-z-N);return`${V.trim()}${" ".repeat(F)}${$}`}formatMessage(w,$){if($.length===1&&Array.isArray($[0]))return w.replace(/\{(\d+)\}/g,(U,X)=>{let M=Number.parseInt(X,10);return M<$[0].length?String($[0][M]):U});let q=/%([sdijfo%])/g,J=0,Y=w.replace(q,(U,X)=>{if(X==="%")return"%";if(J>=$.length)return U;let M=$[J++];switch(X){case"s":return String(M);case"d":case"i":return Number(M).toString();case"j":case"o":return JSON.stringify(M,null,2);default:return U}});if(J<$.length)Y+=` ${$.slice(J).map((U)=>typeof U==="object"?JSON.stringify(U,null,2):String(U)).join(" ")}`;return Y}async log(w,$,...q){let J=new Date,Y=this.formatConsoleTimestamp(J),U=this.formatFileTimestamp(J),X,M;if($ instanceof Error)X=$.message,M=$.stack;else X=this.formatMessage($,q);if(this.fancy&&!l()){let V=c8[w],z=this.options.showTags!==!1&&this.name?i.gray(this.formatTag(this.name)):"",N;switch(w){case"debug":N=this.formatConsoleMessage({timestamp:Y,icon:V,tag:z,message:i.gray(X),level:w}),console.error(N);break;case"info":N=this.formatConsoleMessage({timestamp:Y,icon:V,tag:z,message:X,level:w}),console.error(N);break;case"success":N=this.formatConsoleMessage({timestamp:Y,icon:V,tag:z,message:i.green(X),level:w}),console.error(N);break;case"warning":N=this.formatConsoleMessage({timestamp:Y,icon:V,tag:z,message:X,level:w}),console.warn(N);break;case"error":if(N=this.formatConsoleMessage({timestamp:Y,icon:V,tag:z,message:X,level:w}),console.error(N),M){let F=M.split(`
`);for(let W of F)if(W.trim()&&!W.includes(X))console.error(this.formatConsoleMessage({timestamp:Y,message:i.gray(`  ${W}`),level:w,showTimestamp:!1}))}break}}else if(!l()){if(console.error(`${U} ${this.environment}.${w.toUpperCase()}: ${X}`),M)console.error(M)}if(!this.shouldLog(w))return;let Q=`${U} ${this.environment}.${w.toUpperCase()}: ${X}
`;if(M)Q+=`${M}
`;Q=Q.replace(this.ANSI_PATTERN,""),await this.writeToFile(Q)}time(w){let $=performance.now();if(this.fancy&&!l()){let q=this.options.showTags!==!1&&this.name?i.gray(this.formatTag(this.name)):"",J=this.formatConsoleTimestamp(new Date);console.error(this.formatConsoleMessage({timestamp:J,icon:i.blue("\u25D0"),tag:q,message:`${i.cyan(w)}...`}))}return async(q)=>{if(!this.enabled)return;let J=performance.now(),Y=Math.round(J-$),U=`${w} completed in ${Y}ms`,X=new Date,M=this.formatConsoleTimestamp(X),V=`${this.formatFileTimestamp(X)} ${this.environment}.INFO: ${U}`;if(q)V+=` ${JSON.stringify(q)}`;if(V+=`
`,V=V.replace(this.ANSI_PATTERN,""),this.fancy&&!l()){let z=this.options.showTags!==!1&&this.name?i.gray(this.formatTag(this.name)):"";console.error(this.formatConsoleMessage({timestamp:M,icon:i.green("\u2713"),tag:z,message:`${U}${q?` ${JSON.stringify(q)}`:""}`}))}else if(!l())console.error(V.trim());await this.writeToFile(V)}}async debug(w,...$){await this.log("debug",w,...$)}async info(w,...$){await this.log("info",w,...$)}async success(w,...$){await this.log("success",w,...$)}async warn(w,...$){await this.log("warning",w,...$)}async error(w,...$){await this.log("error",w,...$)}validateEncryptionConfig(){if(!this.config.rotation)return!1;if(typeof this.config.rotation==="boolean")return!1;let w=this.config.rotation,{encrypt:$}=w;return!!$}async only(w){if(!this.enabled)return;return await w()}isEnabled(){return this.enabled}setEnabled(w){this.enabled=w}extend(w){let $=`${this.name}:${w}`,q=new F$($,{...this.options,logDirectory:this.config.logDirectory,level:this.config.level,format:this.config.format,rotation:typeof this.config.rotation==="boolean"?void 0:this.config.rotation,timestamp:typeof this.config.timestamp==="boolean"?void 0:this.config.timestamp});return this.subLoggers.add(q),q}createReadStream(){if(l())throw new Error("createReadStream is not supported in browser environments");if(!C1(this.currentLogFile))throw new Error(`Log file does not exist: ${this.currentLogFile}`);return Eq(this.currentLogFile,{encoding:"utf8"})}async decrypt(w){if(!this.validateEncryptionConfig())throw new Error("Encryption is not configured");let $=this.config.rotation;if(!$.encrypt||typeof $.encrypt==="boolean")throw new Error("Invalid encryption configuration");if(!this.currentKeyId||!this.keys.has(this.currentKeyId))throw new Error("No valid encryption key available");let q=this.keys.get(this.currentKeyId);try{let J=lw.isBuffer(w)?w:lw.from(w,"base64"),Y=J.slice(0,16),U=J.slice(-16),X=J.slice(16,-16),M=x8("aes-256-gcm",q,Y);return M.setAuthTag(U),lw.concat([M.update(X),M.final()]).toString("utf8")}catch(J){throw new Error(`Decryption failed: ${J instanceof Error?J.message:String(J)}`)}}getLevel(){return this.config.level}getLogDirectory(){return this.config.logDirectory}getFormat(){return this.config.format}getRotationConfig(){return this.config.rotation}isBrowserMode(){return l()}isServerMode(){return!l()}setTestEncryptionKey(w,$){this.currentKeyId=w,this.keys.set(w,$)}getTestCurrentKey(){if(!this.currentKeyId||!this.keys.has(this.currentKeyId))return null;return{id:this.currentKeyId,key:this.keys.get(this.currentKeyId)}}getConfig(){return this.config}async box(w){if(!this.enabled)return;let $=new Date,q=this.formatConsoleTimestamp($),J=this.formatFileTimestamp($);if(this.fancy&&!l()){let U=w.split(`
`),X=Math.max(...U.map((z)=>z.length))+2,M=`\u250C${"\u2500".repeat(X)}\u2510`,Q=`\u2514${"\u2500".repeat(X)}\u2518`,V=U.map((z)=>{let N=" ".repeat(X-z.length-2);return`\u2502 ${z}${N} \u2502`});if(this.options.showTags!==!1&&this.name)console.error(this.formatConsoleMessage({timestamp:q,message:i.gray(this.formatTag(this.name)),showTimestamp:!1}));console.error(this.formatConsoleMessage({timestamp:q,message:i.cyan(M)})),V.forEach((z)=>console.error(this.formatConsoleMessage({timestamp:q,message:i.cyan(z),showTimestamp:!1}))),console.error(this.formatConsoleMessage({timestamp:q,message:i.cyan(Q),showTimestamp:!1}))}else if(!l())console.error(`${J} ${this.environment}.INFO: [BOX] ${w}`);let Y=`${J} ${this.environment}.INFO: [BOX] ${w}
`.replace(this.ANSI_PATTERN,"");await this.writeToFile(Y)}async prompt(w){if(l())return Promise.resolve(!0);return new Promise(($)=>{console.error(`${i.cyan("?")} ${w} (y/n) `);let q=(J)=>{let Y=J.toString().trim().toLowerCase();Jw.stdin.removeListener("data",q);try{if(typeof Jw.stdin.setRawMode==="function")Jw.stdin.setRawMode(!1)}catch{}Jw.stdin.pause(),console.error(""),$(Y==="y"||Y==="yes")};try{if(typeof Jw.stdin.setRawMode==="function")Jw.stdin.setRawMode(!0)}catch{}Jw.stdin.resume(),Jw.stdin.once("data",q)})}setFancy(w){this.fancy=w}isFancy(){return this.fancy}pause(){this.enabled=!1}resume(){this.enabled=!0}async start(w,...$){if(!this.enabled)return;let q=w;if($&&$.length>0){let X=/%([sdijfo%])/g,M=0;if(q=w.replace(X,(Q,V)=>{if(V==="%")return"%";if(M>=$.length)return Q;let z=$[M++];switch(V){case"s":return String(z);case"d":case"i":return Number(z).toString();case"j":case"o":return JSON.stringify(z,null,2);default:return Q}}),M<$.length)q+=` ${$.slice(M).map((Q)=>typeof Q==="object"?JSON.stringify(Q,null,2):String(Q)).join(" ")}`}if(this.fancy&&!l()){let X=this.options.showTags!==!1&&this.name?i.gray(this.formatTag(this.name)):"",M=i.blue("\u25D0");console.error(`${M} ${X} ${i.cyan(q)}`)}let U=`[${new Date().toISOString()}] ${this.environment}.INFO: [START] ${q}
`.replace(this.ANSI_PATTERN,"");await this.writeToFile(U)}progress(w,$=""){if(!this.enabled||!this.fancy||l()||w<=0)return{update:()=>{},finish:()=>{},interrupt:()=>{}};if(this.activeProgressBar)console.warn("Warning: Another progress bar is already active. Finishing the previous one."),this.finishProgressBar(this.activeProgressBar,"[Auto-finished]");let q=20;return this.activeProgressBar={total:w,current:0,message:$,barLength:q,lastRenderedLine:""},this.renderProgressBar(this.activeProgressBar),{update:(X,M)=>{if(!this.activeProgressBar||!this.enabled||!this.fancy||l())return;if(this.activeProgressBar.current=Math.max(0,Math.min(w,X)),M!==void 0)this.activeProgressBar.message=M;let Q=this.activeProgressBar.current===this.activeProgressBar.total;this.renderProgressBar(this.activeProgressBar,Q)},finish:(X)=>{if(!this.activeProgressBar||!this.enabled||!this.fancy||l())return;if(this.activeProgressBar.current=this.activeProgressBar.total,X!==void 0)this.activeProgressBar.message=X;this.renderProgressBar(this.activeProgressBar,!0),this.finishProgressBar(this.activeProgressBar)},interrupt:(X,M="info")=>{if(!this.activeProgressBar||!this.enabled||!this.fancy||l())return;Jw.stdout.write(`${"\r".padEnd(Jw.stdout.columns||80)}\r`),this.log(M,X),setTimeout(()=>{if(this.activeProgressBar)this.renderProgressBar(this.activeProgressBar)},50)}}}renderProgressBar(w,$=!1){if(!this.enabled||!this.fancy||l()||!Jw.stdout.isTTY)return;let q=Math.min(100,Math.max(0,Math.round(w.current/w.total*100))),J=Math.round(w.barLength*q/100),Y=w.barLength-J,U=i.green("\u2501".repeat(J)),X=i.gray("\u2501".repeat(Y)),M=`[${U}${X}]`,Q=`${q}%`.padStart(4),V=w.message?` ${w.message}`:"",z=$||q===100?i.green("\u2713"):i.blue("\u25B6"),N=this.options.showTags!==!1&&this.name?` ${i.gray(this.formatTag(this.name))}`:"",F=`\r${z}${N} ${M} ${Q}${V}`,W=Jw.stdout.columns||80,E=" ".repeat(Math.max(0,W-F.replace(this.ANSI_PATTERN,"").length));if(w.lastRenderedLine=`${F}${E}`,Jw.stdout.write(w.lastRenderedLine),$)Jw.stdout.write(`
`)}finishProgressBar(w,$){if(!this.enabled||!this.fancy||l()||!Jw.stdout.isTTY){this.activeProgressBar=null;return}if(w.current<w.total)w.current=w.total;if($)w.message=$;this.renderProgressBar(w,!0),this.activeProgressBar=null}async clear(w={}){if(l()){console.warn("Log clearing is not supported in browser environments.");return}try{console.warn("Clearing logs...",this.config.logDirectory);let $=await h$(this.config.logDirectory),q=[];for(let J of $){if(!(w.name?new RegExp(w.name.replace("*",".*")).test(J):J.startsWith(this.name))||!J.endsWith(".log"))continue;let U=U$(this.config.logDirectory,J);if(w.before)try{if((await K$(U)).mtime>=w.before)continue}catch(X){console.error(`Failed to get stats for file ${U}:`,X);continue}q.push(U)}if(q.length===0){console.warn("No log files matched the criteria for clearing.");return}console.warn(`Preparing to delete ${q.length} log file(s)...`);for(let J of q)try{await i$(J),console.warn(`Deleted log file: ${J}`)}catch(Y){console.error(`Failed to delete log file ${J}:`,Y)}console.warn("Log clearing process finished.")}catch($){console.error("Error during log clearing process:",$)}}}var lX=new F$("stacks");import{appendFile as mJ,mkdir as _J}from"fs/promises";import{dirname as MU}from"path";import*as vJ from"process";import{italic as xJ,stripAnsi as QU}from"@stacksjs/cli";import{basename as pX,delimiter as rX,dirname as xq,extname as oX,isAbsolute as aX,join as eX,normalize as tX,parse as sX,relative as n8,resolve as Iq,sep as wz,toNamespacedPath as $z}from"path";import Pq from"process";function A1(w){return l8(`logs/${w||""}`)}function B1(w="",$){let q=Pq.cwd();while(q.includes("storage"))q=Iq(q,"..");let J=Iq(q,w);if($?.relative)return n8(Pq.cwd(),J);return J}function l8(w){return B1(`storage/${w||""}`)}var d8=new Set([".","!","?"]),Gz=new Set([...d8,":",'"',"'","\u201D"]);var j1=[],I1=[],_q={},C$={},L$={};function vq(w){return typeof w==="string"?new RegExp(`^${w}$`,"i"):w}function d$(w,$){if(w===$)return $;if(w===w.toLowerCase())return $.toLowerCase();if(w===w.toUpperCase())return $.toUpperCase();if(w[0]===w[0].toUpperCase())return $.charAt(0).toUpperCase()+$.slice(1).toLowerCase();return $.toLowerCase()}function p8(w,...$){return w.replace(/\$(\d{1,2})/g,(q,J)=>$[Number(J)]||"")}function r8(w,$){return w.replace($[0],(...q)=>{let J=p8($[1],...q);if(q[0]==="")return d$(w[q[q.length-2]-1],J);return d$(q[0],J)})}function kq(w,$,q){if(!w.length||_q[w])return $;for(let J=q.length-1;J>=0;J--){let Y=q[J];if(Y[0].test($))return r8($,Y)}return $}function uq(w,$,q){return(J)=>{let Y=J.toLowerCase();if($[Y])return d$(J,Y);if(w[Y])return d$(J,w[Y]);return kq(Y,J,q)}}function bq(w,$,q){return(J)=>{let Y=J.toLowerCase();if($[Y])return!0;if(w[Y])return!1;return kq(Y,Y,q)===Y}}var Kw=(w,$={})=>{let{count:q=2,inclusive:J=!1}=$;if(typeof w!=="string")throw new TypeError("Word must be a string");let Y=q===1?Kw.singular(w):Kw.plural(w);return J?`${q} ${Y}`:Y};Kw.plural=uq(L$,C$,j1);Kw.isPlural=bq(L$,C$,j1);Kw.singular=uq(C$,L$,I1);Kw.isSingular=bq(C$,L$,I1);Kw.addPluralRule=(w,$)=>{j1.push([vq(w),$])};Kw.addSingularRule=(w,$)=>{I1.push([vq(w),$])};Kw.addUncountableRule=(w)=>{if(typeof w==="string"){_q[w.toLowerCase()]=!0;return}Kw.addPluralRule(w,"$0"),Kw.addSingularRule(w,"$0")};Kw.addIrregularRule=(w,$)=>{let q=$.toLowerCase(),J=w.toLowerCase();L$[J]=q,C$[q]=J};[["I","we"],["me","us"],["he","they"],["she","they"],["them","them"],["myself","ourselves"],["yourself","yourselves"],["itself","themselves"],["herself","themselves"],["himself","themselves"],["themself","themselves"],["is","are"],["was","were"],["has","have"],["this","these"],["that","those"],["my","our"],["its","their"],["his","their"],["her","their"],["echo","echoes"],["dingo","dingoes"],["volcano","volcanoes"],["tornado","tornadoes"],["torpedo","torpedoes"],["genus","genera"],["viscus","viscera"],["stigma","stigmata"],["stoma","stomata"],["dogma","dogmata"],["lemma","lemmata"],["schema","schemata"],["anathema","anathemata"],["ox","oxen"],["axe","axes"],["die","dice"],["yes","yeses"],["foot","feet"],["eave","eaves"],["goose","geese"],["tooth","teeth"],["quiz","quizzes"],["human","humans"],["proof","proofs"],["carve","carves"],["valve","valves"],["looey","looies"],["thief","thieves"],["groove","grooves"],["pickaxe","pickaxes"],["passerby","passersby"],["canvas","canvases"]].forEach(([w,$])=>Kw.addIrregularRule(w,$));[[/s?$/i,"s"],[/[^\x20-\x7F]$/,"$0"],[/([^aeiou]ese)$/i,"$1"],[/(ax|test)is$/i,"$1es"],[/(alias|[^aou]us|t[lm]as|gas|ris)$/i,"$1es"],[/(e[mn]u)s?$/i,"$1s"],[/([^l]ias|[aeiou]las|[ejzr]as|[iu]am)$/i,"$1"],[/(alumn|syllab|vir|radi|nucle|fung|cact|stimul|termin|bacill|foc|uter|loc|strat)(?:us|i)$/i,"$1i"],[/(alumn|alg|vertebr)(?:a|ae)$/i,"$1ae"],[/(seraph|cherub)(?:im)?$/i,"$1im"],[/(her|at|gr)o$/i,"$1oes"],[/(agend|addend|millenni|dat|extrem|bacteri|desiderat|strat|candelabr|errat|ov|symposi|curricul|automat|quor)(?:a|um)$/i,"$1a"],[/(apheli|hyperbat|periheli|asyndet|noumen|phenomen|criteri|organ|prolegomen|hedr|automat)(?:a|on)$/i,"$1a"],[/sis$/i,"ses"],[/(?:(kni|wi|li)fe|(ar|l|ea|eo|oa|hoo)f)$/i,"$1$2ves"],[/([^aeiouy]|qu)y$/i,"$1ies"],[/([^ch][ieo][ln])ey$/i,"$1ies"],[/(x|ch|ss|sh|zz)$/i,"$1es"],[/(matr|cod|mur|sil|vert|ind|append)(?:ix|ex)$/i,"$1ices"],[/\b((?:tit)?m|l)(?:ice|ouse)$/i,"$1ice"],[/(pe)(?:rson|ople)$/i,"$1ople"],[/(child)(?:ren)?$/i,"$1ren"],[/eaux$/i,"$0"],[/m[ae]n$/i,"men"],["thou","you"]].forEach(([w,$])=>Kw.addPluralRule(w,$));[[/s$/i,""],[/(ss)$/i,"$1"],[/(wi|kni|(?:after|half|high|low|mid|non|night|\W|^)li)ves$/i,"$1fe"],[/(ar|(?:wo|[ae])l|[eo][ao])ves$/i,"$1f"],[/ies$/i,"y"],[/(dg|ss|ois|lk|ok|wn|mb|th|ch|ec|oal|is|ck|ix|sser|ts|wb)ies$/i,"$1ie"],[/\b(l|(?:neck|cross|hog|aun)?t|coll|faer|food|gen|goon|group|hipp|junk|vegg|(?:pork)?p|charl|calor|cut)ies$/i,"$1ie"],[/\b(mon|smil)ies$/i,"$1ey"],[/\b((?:tit)?m|l)ice$/i,"$1ouse"],[/(seraph|cherub)im$/i,"$1"],[/(x|ch|ss|sh|zz|tto|go|cho|alias|[^aou]us|t[lm]as|gas|(?:her|at|gr)o|[aeiou]ris)(?:es)?$/i,"$1"],[/(analy|diagno|parenthe|progno|synop|the|empha|cri|ne)(?:sis|ses)$/i,"$1sis"],[/(movie|twelve|abuse|e[mn]u)s$/i,"$1"],[/(test)(?:is|es)$/i,"$1is"],[/(alumn|syllab|vir|radi|nucle|fung|cact|stimul|termin|bacill|foc|uter|loc|strat)(?:us|i)$/i,"$1us"],[/(agend|addend|millenni|dat|extrem|bacteri|desiderat|strat|candelabr|errat|ov|symposi|curricul|quor)a$/i,"$1um"],[/(apheli|hyperbat|periheli|asyndet|noumen|phenomen|criteri|organ|prolegomen|hedr|automat)a$/i,"$1on"],[/(alumn|alg|vertebr)ae$/i,"$1a"],[/(cod|mur|sil|vert|ind)ices$/i,"$1ex"],[/(matr|append)ices$/i,"$1ix"],[/(pe)(rson|ople)$/i,"$1rson"],[/(child)ren$/i,"$1"],[/(eau)x?$/i,"$1"],[/men$/i,"man"]].forEach(([w,$])=>Kw.addSingularRule(w,$));["adulthood","advice","agenda","aid","aircraft","alcohol","ammo","analytics","anime","athletics","audio","bison","blood","bream","buffalo","butter","carp","cash","chassis","chess","clothing","cod","commerce","cooperation","corps","debris","diabetes","digestion","elk","energy","equipment","excretion","expertise","firmware","flounder","fun","gallows","garbage","graffiti","hardware","headquarters","health","herpes","highjinks","homework","housework","information","jeans","justice","kudos","labour","literature","machinery","mackerel","mail","media","mews","moose","music","mud","manga","news","only","personnel","pike","plankton","pliers","police","pollution","premises","rain","research","rice","salmon","scissors","series","sewage","shambles","shrimp","software","staff","swine","tennis","traffic","transportation","trout","tuna","wealth","welfare","whiting","wildebeest","wildlife","you",/pok[e\u00E9]mon$/i,/[^aeiou]ese$/i,/deer$/i,/fish$/i,/measles$/i,/o[iu]s$/i,/pox$/i,/sheep$/i].forEach(Kw.addUncountableRule);var Nz=JSON.parse('{"$":"dollar","%":"percent","&":"and","<":"less",">":"greater","|":"or","\xA2":"cent","\xA3":"pound","\xA4":"currency","\xA5":"yen","\xA9":"(c)","\xAA":"a","\xAE":"(r)","\xBA":"o","\xC0":"A","\xC1":"A","\xC2":"A","\xC3":"A","\xC4":"A","\xC5":"A","\xC6":"AE","\xC7":"C","\xC8":"E","\xC9":"E","\xCA":"E","\xCB":"E","\xCC":"I","\xCD":"I","\xCE":"I","\xCF":"I","\xD0":"D","\xD1":"N","\xD2":"O","\xD3":"O","\xD4":"O","\xD5":"O","\xD6":"O","\xD8":"O","\xD9":"U","\xDA":"U","\xDB":"U","\xDC":"U","\xDD":"Y","\xDE":"TH","\xDF":"ss","\xE0":"a","\xE1":"a","\xE2":"a","\xE3":"a","\xE4":"a","\xE5":"a","\xE6":"ae","\xE7":"c","\xE8":"e","\xE9":"e","\xEA":"e","\xEB":"e","\xEC":"i","\xED":"i","\xEE":"i","\xEF":"i","\xF0":"d","\xF1":"n","\xF2":"o","\xF3":"o","\xF4":"o","\xF5":"o","\xF6":"o","\xF8":"o","\xF9":"u","\xFA":"u","\xFB":"u","\xFC":"u","\xFD":"y","\xFE":"th","\xFF":"y","\u0100":"A","\u0101":"a","\u0102":"A","\u0103":"a","\u0104":"A","\u0105":"a","\u0106":"C","\u0107":"c","\u010C":"C","\u010D":"c","\u010E":"D","\u010F":"d","\u0110":"DJ","\u0111":"dj","\u0112":"E","\u0113":"e","\u0116":"E","\u0117":"e","\u0118":"e","\u0119":"e","\u011A":"E","\u011B":"e","\u011E":"G","\u011F":"g","\u0122":"G","\u0123":"g","\u0128":"I","\u0129":"i","\u012A":"i","\u012B":"i","\u012E":"I","\u012F":"i","\u0130":"I","\u0131":"i","\u0136":"k","\u0137":"k","\u013B":"L","\u013C":"l","\u013D":"L","\u013E":"l","\u0141":"L","\u0142":"l","\u0143":"N","\u0144":"n","\u0145":"N","\u0146":"n","\u0147":"N","\u0148":"n","\u014C":"O","\u014D":"o","\u0150":"O","\u0151":"o","\u0152":"OE","\u0153":"oe","\u0154":"R","\u0155":"r","\u0158":"R","\u0159":"r","\u015A":"S","\u015B":"s","\u015E":"S","\u015F":"s","\u0160":"S","\u0161":"s","\u0162":"T","\u0163":"t","\u0164":"T","\u0165":"t","\u0168":"U","\u0169":"u","\u016A":"u","\u016B":"u","\u016E":"U","\u016F":"u","\u0170":"U","\u0171":"u","\u0172":"U","\u0173":"u","\u0174":"W","\u0175":"w","\u0176":"Y","\u0177":"y","\u0178":"Y","\u0179":"Z","\u017A":"z","\u017B":"Z","\u017C":"z","\u017D":"Z","\u017E":"z","\u018F":"E","\u0192":"f","\u01A0":"O","\u01A1":"o","\u01AF":"U","\u01B0":"u","\u01C8":"LJ","\u01C9":"lj","\u01CB":"NJ","\u01CC":"nj","\u0218":"S","\u0219":"s","\u021A":"T","\u021B":"t","\u0259":"e","\u02DA":"o","\u0386":"A","\u0388":"E","\u0389":"H","\u038A":"I","\u038C":"O","\u038E":"Y","\u038F":"W","\u0390":"i","\u0391":"A","\u0392":"B","\u0393":"G","\u0394":"D","\u0395":"E","\u0396":"Z","\u0397":"H","\u0398":"8","\u0399":"I","\u039A":"K","\u039B":"L","\u039C":"M","\u039D":"N","\u039E":"3","\u039F":"O","\u03A0":"P","\u03A1":"R","\u03A3":"S","\u03A4":"T","\u03A5":"Y","\u03A6":"F","\u03A7":"X","\u03A8":"PS","\u03A9":"W","\u03AA":"I","\u03AB":"Y","\u03AC":"a","\u03AD":"e","\u03AE":"h","\u03AF":"i","\u03B0":"y","\u03B1":"a","\u03B2":"b","\u03B3":"g","\u03B4":"d","\u03B5":"e","\u03B6":"z","\u03B7":"h","\u03B8":"8","\u03B9":"i","\u03BA":"k","\u03BB":"l","\u03BC":"m","\u03BD":"n","\u03BE":"3","\u03BF":"o","\u03C0":"p","\u03C1":"r","\u03C2":"s","\u03C3":"s","\u03C4":"t","\u03C5":"y","\u03C6":"f","\u03C7":"x","\u03C8":"ps","\u03C9":"w","\u03CA":"i","\u03CB":"y","\u03CC":"o","\u03CD":"y","\u03CE":"w","\u0401":"Yo","\u0402":"DJ","\u0404":"Ye","\u0406":"I","\u0407":"Yi","\u0408":"J","\u0409":"LJ","\u040A":"NJ","\u040B":"C","\u040F":"DZ","\u0410":"A","\u0411":"B","\u0412":"V","\u0413":"G","\u0414":"D","\u0415":"E","\u0416":"Zh","\u0417":"Z","\u0418":"I","\u0419":"J","\u041A":"K","\u041B":"L","\u041C":"M","\u041D":"N","\u041E":"O","\u041F":"P","\u0420":"R","\u0421":"S","\u0422":"T","\u0423":"U","\u0424":"F","\u0425":"H","\u0426":"C","\u0427":"Ch","\u0428":"Sh","\u0429":"Sh","\u042A":"U","\u042B":"Y","\u042C":"","\u042D":"E","\u042E":"Yu","\u042F":"Ya","\u0430":"a","\u0431":"b","\u0432":"v","\u0433":"g","\u0434":"d","\u0435":"e","\u0436":"zh","\u0437":"z","\u0438":"i","\u0439":"j","\u043A":"k","\u043B":"l","\u043C":"m","\u043D":"n","\u043E":"o","\u043F":"p","\u0440":"r","\u0441":"s","\u0442":"t","\u0443":"u","\u0444":"f","\u0445":"h","\u0446":"c","\u0447":"ch","\u0448":"sh","\u0449":"sh","\u044A":"u","\u044B":"y","\u044C":"","\u044D":"e","\u044E":"yu","\u044F":"ya","\u0451":"yo","\u0452":"dj","\u0454":"ye","\u0456":"i","\u0457":"yi","\u0458":"j","\u0459":"lj","\u045A":"nj","\u045B":"c","\u045D":"u","\u045F":"dz","\u0490":"G","\u0491":"g","\u0492":"GH","\u0493":"gh","\u049A":"KH","\u049B":"kh","\u04A2":"NG","\u04A3":"ng","\u04AE":"UE","\u04AF":"ue","\u04B0":"U","\u04B1":"u","\u04BA":"H","\u04BB":"h","\u04D8":"AE","\u04D9":"ae","\u04E8":"OE","\u04E9":"oe","\u0531":"A","\u0532":"B","\u0533":"G","\u0534":"D","\u0535":"E","\u0536":"Z","\u0537":"E\'","\u0538":"Y\'","\u0539":"T\'","\u053A":"JH","\u053B":"I","\u053C":"L","\u053D":"X","\u053E":"C\'","\u053F":"K","\u0540":"H","\u0541":"D\'","\u0542":"GH","\u0543":"TW","\u0544":"M","\u0545":"Y","\u0546":"N","\u0547":"SH","\u0549":"CH","\u054A":"P","\u054B":"J","\u054C":"R\'","\u054D":"S","\u054E":"V","\u054F":"T","\u0550":"R","\u0551":"C","\u0553":"P\'","\u0554":"Q\'","\u0555":"O\'\'","\u0556":"F","\u0587":"EV","\u0621":"a","\u0622":"aa","\u0623":"a","\u0624":"u","\u0625":"i","\u0626":"e","\u0627":"a","\u0628":"b","\u0629":"h","\u062A":"t","\u062B":"th","\u062C":"j","\u062D":"h","\u062E":"kh","\u062F":"d","\u0630":"th","\u0631":"r","\u0632":"z","\u0633":"s","\u0634":"sh","\u0635":"s","\u0636":"dh","\u0637":"t","\u0638":"z","\u0639":"a","\u063A":"gh","\u0641":"f","\u0642":"q","\u0643":"k","\u0644":"l","\u0645":"m","\u0646":"n","\u0647":"h","\u0648":"w","\u0649":"a","\u064A":"y","\u064B":"an","\u064C":"on","\u064D":"en","\u064E":"a","\u064F":"u","\u0650":"e","\u0652":"","\u0660":"0","\u0661":"1","\u0662":"2","\u0663":"3","\u0664":"4","\u0665":"5","\u0666":"6","\u0667":"7","\u0668":"8","\u0669":"9","\u067E":"p","\u0686":"ch","\u0698":"zh","\u06A9":"k","\u06AF":"g","\u06CC":"y","\u06F0":"0","\u06F1":"1","\u06F2":"2","\u06F3":"3","\u06F4":"4","\u06F5":"5","\u06F6":"6","\u06F7":"7","\u06F8":"8","\u06F9":"9","\u0E3F":"baht","\u10D0":"a","\u10D1":"b","\u10D2":"g","\u10D3":"d","\u10D4":"e","\u10D5":"v","\u10D6":"z","\u10D7":"t","\u10D8":"i","\u10D9":"k","\u10DA":"l","\u10DB":"m","\u10DC":"n","\u10DD":"o","\u10DE":"p","\u10DF":"zh","\u10E0":"r","\u10E1":"s","\u10E2":"t","\u10E3":"u","\u10E4":"f","\u10E5":"k","\u10E6":"gh","\u10E7":"q","\u10E8":"sh","\u10E9":"ch","\u10EA":"ts","\u10EB":"dz","\u10EC":"ts","\u10ED":"ch","\u10EE":"kh","\u10EF":"j","\u10F0":"h","\u1E62":"S","\u1E63":"s","\u1E80":"W","\u1E81":"w","\u1E82":"W","\u1E83":"w","\u1E84":"W","\u1E85":"w","\u1E9E":"SS","\u1EA0":"A","\u1EA1":"a","\u1EA2":"A","\u1EA3":"a","\u1EA4":"A","\u1EA5":"a","\u1EA6":"A","\u1EA7":"a","\u1EA8":"A","\u1EA9":"a","\u1EAA":"A","\u1EAB":"a","\u1EAC":"A","\u1EAD":"a","\u1EAE":"A","\u1EAF":"a","\u1EB0":"A","\u1EB1":"a","\u1EB2":"A","\u1EB3":"a","\u1EB4":"A","\u1EB5":"a","\u1EB6":"A","\u1EB7":"a","\u1EB8":"E","\u1EB9":"e","\u1EBA":"E","\u1EBB":"e","\u1EBC":"E","\u1EBD":"e","\u1EBE":"E","\u1EBF":"e","\u1EC0":"E","\u1EC1":"e","\u1EC2":"E","\u1EC3":"e","\u1EC4":"E","\u1EC5":"e","\u1EC6":"E","\u1EC7":"e","\u1EC8":"I","\u1EC9":"i","\u1ECA":"I","\u1ECB":"i","\u1ECC":"O","\u1ECD":"o","\u1ECE":"O","\u1ECF":"o","\u1ED0":"O","\u1ED1":"o","\u1ED2":"O","\u1ED3":"o","\u1ED4":"O","\u1ED5":"o","\u1ED6":"O","\u1ED7":"o","\u1ED8":"O","\u1ED9":"o","\u1EDA":"O","\u1EDB":"o","\u1EDC":"O","\u1EDD":"o","\u1EDE":"O","\u1EDF":"o","\u1EE0":"O","\u1EE1":"o","\u1EE2":"O","\u1EE3":"o","\u1EE4":"U","\u1EE5":"u","\u1EE6":"U","\u1EE7":"u","\u1EE8":"U","\u1EE9":"u","\u1EEA":"U","\u1EEB":"u","\u1EEC":"U","\u1EED":"u","\u1EEE":"U","\u1EEF":"u","\u1EF0":"U","\u1EF1":"u","\u1EF2":"Y","\u1EF3":"y","\u1EF4":"Y","\u1EF5":"y","\u1EF6":"Y","\u1EF7":"y","\u1EF8":"Y","\u1EF9":"y","\u2013":"-","\u2018":"\'","\u2019":"\'","\u201C":"\\"","\u201D":"\\"","\u201E":"\\"","\u2020":"+","\u2022":"*","\u2026":"...","\u20A0":"ecu","\u20A2":"cruzeiro","\u20A3":"french franc","\u20A4":"lira","\u20A5":"mill","\u20A6":"naira","\u20A7":"peseta","\u20A8":"rupee","\u20A9":"won","\u20AA":"new shequel","\u20AB":"dong","\u20AC":"euro","\u20AD":"kip","\u20AE":"tugrik","\u20AF":"drachma","\u20B0":"penny","\u20B1":"peso","\u20B2":"guarani","\u20B3":"austral","\u20B4":"hryvnia","\u20B5":"cedi","\u20B8":"kazakhstani tenge","\u20B9":"indian rupee","\u20BA":"turkish lira","\u20BD":"russian ruble","\u20BF":"bitcoin","\u2120":"sm","\u2122":"tm","\u2202":"d","\u2206":"delta","\u2211":"sum","\u221E":"infinity","\u2665":"love","\u5143":"yuan","\u5186":"yen","\uFDFC":"rial","\uFEF5":"laa","\uFEF7":"laa","\uFEF9":"lai","\uFEFB":"la"}'),Ez=JSON.parse('{"bg":{"\u0419":"Y","\u0426":"Ts","\u0429":"Sht","\u042A":"A","\u042C":"Y","\u0439":"y","\u0446":"ts","\u0449":"sht","\u044A":"a","\u044C":"y"},"de":{"\xC4":"AE","\xE4":"ae","\xD6":"OE","\xF6":"oe","\xDC":"UE","\xFC":"ue","\xDF":"ss","%":"prozent","&":"und","|":"oder","\u2211":"summe","\u221E":"unendlich","\u2665":"liebe"},"es":{"%":"por ciento","&":"y","<":"menor que",">":"mayor que","|":"o","\xA2":"centavos","\xA3":"libras","\xA4":"moneda","\u20A3":"francos","\u2211":"suma","\u221E":"infinito","\u2665":"amor"},"fr":{"%":"pourcent","&":"et","<":"plus petit",">":"plus grand","|":"ou","\xA2":"centime","\xA3":"livre","\xA4":"devise","\u20A3":"franc","\u2211":"somme","\u221E":"infini","\u2665":"amour"},"pt":{"%":"porcento","&":"e","<":"menor",">":"maior","|":"ou","\xA2":"centavo","\u2211":"soma","\xA3":"libra","\u221E":"infinito","\u2665":"amor"},"uk":{"\u0418":"Y","\u0438":"y","\u0419":"Y","\u0439":"y","\u0426":"Ts","\u0446":"ts","\u0425":"Kh","\u0445":"kh","\u0429":"Shch","\u0449":"shch","\u0413":"H","\u0433":"h"},"vi":{"\u0110":"D","\u0111":"d"},"da":{"\xD8":"OE","\xF8":"oe","\xC5":"AA","\xE5":"aa","%":"procent","&":"og","|":"eller","$":"dollar","<":"mindre end",">":"st\xF8rre end"},"nb":{"&":"og","\xC5":"AA","\xC6":"AE","\xD8":"OE","\xE5":"aa","\xE6":"ae","\xF8":"oe"},"it":{"&":"e"},"nl":{"&":"en"},"sv":{"&":"och","\xC5":"AA","\xC4":"AE","\xD6":"OE","\xE5":"aa","\xE4":"ae","\xF6":"oe"}}');var kJ=g$(PJ(),1);class l1{static isTestEnvironment=!1;static shouldExitProcess=!0;static handle(w,$){if(this.shouldExitProcess=$?.shouldExit!==!1,$?.silent!==!0)this.writeErrorToConsole(w);let q;if($?.message)q=$.message;else if(w instanceof Error)q=w.message;else if(typeof w==="string")q=w;else q=JSON.stringify(w);let J=new Error(q);if(w instanceof Error)Object.assign(J,w);return this.writeErrorToFile(J).catch((Y)=>console.error(Y)),J}static handleError(w,$){return this.handle(w,$),w}static async writeErrorToFile(w){if(!(w instanceof Error)){console.error("Error is not an instance of Error:",w);return}let $=`[${new Date().toISOString()}] ${w.name}: ${w.message}
`,q=A1("stacks.log")??A1("errors.log");try{await _J(xq(q),{recursive:!0}),await mJ(q,$)}catch(J){console.error("Failed to write to error file:",J)}}static writeErrorToConsole(w){let $;if(w instanceof Error)$=w.message;else if(typeof w==="string")$=w;else $=JSON.stringify(w);if(console.error($),$.includes("bunx --bun cdk destroy")||$===`Failed to execute command: ${xJ("bunx --bun eslint . --fix")}`||$===`Failed to execute command: ${xJ("bun storage/framework/core/actions/src/lint/fix.ts")}`){if(!this.isTestEnvironment)console.log("No need to worry. The edge function is currently being destroyed. Please run `buddy undeploy` shortly again, and continue doing so until it succeeds running."),console.log("Hoping to see you back soon!")}if(this.shouldExitProcess)vJ.exit(1)}}var WU="storage/logs/stacks.log";async function HU(w,$){let J=`[${new Date().toISOString()}] ${w}
`,Y=$?.logFile??WU,U=MU(Y);if(!kJ.default.existsSync(U))await _J(U,{recursive:!0});await mJ(Y,J)}function uJ(w,$){let q,J;if($&&typeof $==="object"&&!("shouldExit"in $)&&!("silent"in $)&&!("message"in $))J=$,$=void 0;let Y=w instanceof Error?w.message:String(w);if($&&"message"in $)q=`${Y}: ${$.message}`;else q=Y;let U=`ERROR: ${QU(q)}`;if(J)U+=`
Context: ${JSON.stringify(J,null,2)}`;HU(U);let X=new Error(q);if(w instanceof Error)Object.assign(X,w);return l1.handle(X,{...$,message:q})}var VU={withStackTrace:!1},gJ=(w,$,q=VU)=>{let J=$.isOk()?{type:"Ok",value:$.value}:{type:"Err",value:$.error},Y=q.withStackTrace?new Error().stack:void 0;return{data:J,message:w,stack:Y}};function $$(w,$,q,J){function Y(U){return U instanceof q?U:new q(function(X){X(U)})}return new(q||(q=Promise))(function(U,X){function M(z){try{V(J.next(z))}catch(N){X(N)}}function Q(z){try{V(J.throw(z))}catch(N){X(N)}}function V(z){z.done?U(z.value):Y(z.value).then(M,Q)}V((J=J.apply(w,$||[])).next())})}function bJ(w){var $=typeof Symbol==="function"&&Symbol.iterator,q=$&&w[$],J=0;if(q)return q.call(w);if(w&&typeof w.length==="number")return{next:function(){if(w&&J>=w.length)w=void 0;return{value:w&&w[J++],done:!w}}};throw new TypeError($?"Object is not iterable.":"Symbol.iterator is not defined.")}function mw(w){return this instanceof mw?(this.v=w,this):new mw(w)}function SJ(w,$,q){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var J=q.apply(w,$||[]),Y,U=[];return Y=Object.create((typeof AsyncIterator==="function"?AsyncIterator:Object).prototype),M("next"),M("throw"),M("return",X),Y[Symbol.asyncIterator]=function(){return this},Y;function X(W){return function(E){return Promise.resolve(E).then(W,N)}}function M(W,E){if(J[W]){if(Y[W]=function(B){return new Promise(function(j,P){U.push([W,B,j,P])>1||Q(W,B)})},E)Y[W]=E(Y[W])}}function Q(W,E){try{V(J[W](E))}catch(B){F(U[0][3],B)}}function V(W){W.value instanceof mw?Promise.resolve(W.value.v).then(z,N):F(U[0][2],W)}function z(W){Q("next",W)}function N(W){Q("throw",W)}function F(W,E){if(W(E),U.shift(),U.length)Q(U[0][0],U[0][1])}}function DU(w){var $,q;return $={},J("next"),J("throw",function(Y){throw Y}),J("return"),$[Symbol.iterator]=function(){return this},$;function J(Y,U){$[Y]=w[Y]?function(X){return(q=!q)?{value:mw(w[Y](X)),done:!1}:U?U(X):X}:U}}function NU(w){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var $=w[Symbol.asyncIterator],q;return $?$.call(w):(w=typeof bJ==="function"?bJ(w):w[Symbol.iterator](),q={},J("next"),J("throw"),J("return"),q[Symbol.asyncIterator]=function(){return this},q);function J(U){q[U]=w[U]&&function(X){return new Promise(function(M,Q){X=w[U](X),Y(M,Q,X.done,X.value)})}}function Y(U,X,M,Q){Promise.resolve(Q).then(function(V){U({value:V,done:M})},X)}}class f{constructor(w){this._promise=w}static fromSafePromise(w){let $=w.then((q)=>new yw(q));return new f($)}static fromPromise(w,$){let q=w.then((J)=>new yw(J)).catch((J)=>new Fw($(J)));return new f(q)}static fromThrowable(w,$){return(...q)=>{return new f((()=>$$(this,void 0,void 0,function*(){try{return new yw(yield w(...q))}catch(J){return new Fw($?$(J):J)}}))())}}static combine(w){return CU(w)}static combineWithAllErrors(w){return LU(w)}map(w){return new f(this._promise.then(($)=>$$(this,void 0,void 0,function*(){if($.isErr())return new Fw($.error);return new yw(yield w($.value))})))}andThrough(w){return new f(this._promise.then(($)=>$$(this,void 0,void 0,function*(){if($.isErr())return new Fw($.error);let q=yield w($.value);if(q.isErr())return new Fw(q.error);return new yw($.value)})))}andTee(w){return new f(this._promise.then(($)=>$$(this,void 0,void 0,function*(){if($.isErr())return new Fw($.error);try{yield w($.value)}catch(q){}return new yw($.value)})))}orTee(w){return new f(this._promise.then(($)=>$$(this,void 0,void 0,function*(){if($.isOk())return new yw($.value);try{yield w($.error)}catch(q){}return new Fw($.error)})))}mapErr(w){return new f(this._promise.then(($)=>$$(this,void 0,void 0,function*(){if($.isOk())return new yw($.value);return new Fw(yield w($.error))})))}andThen(w){return new f(this._promise.then(($)=>{if($.isErr())return new Fw($.error);let q=w($.value);return q instanceof f?q._promise:q}))}orElse(w){return new f(this._promise.then(($)=>$$(this,void 0,void 0,function*(){if($.isErr())return w($.error);return new yw($.value)})))}match(w,$){return this._promise.then((q)=>q.match(w,$))}unwrapOr(w){return this._promise.then(($)=>$.unwrapOr(w))}safeUnwrap(){return SJ(this,arguments,function*w(){return yield mw(yield mw(yield*DU(NU(yield mw(this._promise.then(($)=>$.safeUnwrap()))))))})}then(w,$){return this._promise.then(w,$)}[Symbol.asyncIterator](){return SJ(this,arguments,function*w(){let $=yield mw(this._promise);if($.isErr())yield yield mw(P$($.error));return yield mw($.value)})}}function P$(w){return new f(Promise.resolve(new Fw(w)))}var{fromPromise:EU,fromSafePromise:FU,fromThrowable:GQ}=f,hJ=(w)=>{let $=hw([]);for(let q of w)if(q.isErr()){$=Iw(q.error);break}else $.map((J)=>J.push(q.value));return $},CU=(w)=>f.fromSafePromise(Promise.all(w)).andThen(hJ),iJ=(w)=>{let $=hw([]);for(let q of w)if(q.isErr()&&$.isErr())$.error.push(q.error);else if(q.isErr()&&$.isOk())$=Iw([q.error]);else if(q.isOk()&&$.isOk())$.value.push(q.value);return $},LU=(w)=>f.fromSafePromise(Promise.all(w)).andThen(iJ),J1;(function(w){function $(Y,U){return(...X)=>{try{let M=Y(...X);return hw(M)}catch(M){return Iw(U?U(M):M)}}}w.fromThrowable=$;function q(Y){return hJ(Y)}w.combine=q;function J(Y){return iJ(Y)}w.combineWithAllErrors=J})(J1||(J1={}));function hw(w){return new yw(w)}function Iw(w){return new Fw(w)}class yw{constructor(w){this.value=w}isOk(){return!0}isErr(){return!this.isOk()}map(w){return hw(w(this.value))}mapErr(w){return hw(this.value)}andThen(w){return w(this.value)}andThrough(w){return w(this.value).map(($)=>this.value)}andTee(w){try{w(this.value)}catch($){}return hw(this.value)}orTee(w){return hw(this.value)}orElse(w){return hw(this.value)}asyncAndThen(w){return w(this.value)}asyncAndThrough(w){return w(this.value).map(()=>this.value)}asyncMap(w){return f.fromSafePromise(w(this.value))}unwrapOr(w){return this.value}match(w,$){return w(this.value)}safeUnwrap(){let w=this.value;return function*(){return w}()}_unsafeUnwrap(w){return this.value}_unsafeUnwrapErr(w){throw gJ("Called `_unsafeUnwrapErr` on an Ok",this,w)}*[Symbol.iterator](){return this.value}}class Fw{constructor(w){this.error=w}isOk(){return!1}isErr(){return!this.isOk()}map(w){return Iw(this.error)}mapErr(w){return Iw(w(this.error))}andThrough(w){return Iw(this.error)}andTee(w){return Iw(this.error)}orTee(w){try{w(this.error)}catch($){}return Iw(this.error)}andThen(w){return Iw(this.error)}orElse(w){return w(this.error)}asyncAndThen(w){return P$(this.error)}asyncAndThrough(w){return P$(this.error)}asyncMap(w){return P$(this.error)}unwrapOr(w){return w}match(w,$){return $(this.error)}safeUnwrap(){let w=this.error;return function*(){throw yield Iw(w),new Error("Do not use this generator out of `safeTry`")}()}_unsafeUnwrap(w){throw gJ("Called `_unsafeUnwrap` on an Err",this,w)}_unsafeUnwrapErr(w){return this.error}*[Symbol.iterator](){let w=this;return yield w,w}}var yU=J1.fromThrowable;var _w=new F$("stacks",{level:"debug",logDirectory:B1("storage/logs"),showTags:!1,fancy:!0});function x$(...w){return w.map(($)=>typeof $==="object"?JSON.stringify($,null,2):String($)).join(" ")}var Sw={info:async(...w)=>{let $=x$(...w);await _w.info($)},success:async(w)=>{await _w.success(w)},warn:async(w,$)=>{await _w.warn(w,$)},warning:async(w)=>{await _w.warn(w)},error:async(w,$)=>{let q=typeof w==="string"?w:w instanceof Error?w:JSON.stringify(w);await _w.error(q),uJ(w,$)},debug:async(...w)=>{let $=x$(...w);await _w.debug($)},dump:(...w)=>{let $=x$(...w);_w.debug(`DUMP: ${$}`)},dd:(...w)=>{let $=x$(...w);_w.error($),RU.exit(1)},echo:(...w)=>{let $=x$(...w);_w.info(`ECHO: ${$}`)},time:(w)=>{return _w.time(w)}};var r9=g$(Kq(),1);import UX from"node-fetch";var l9="https://www.iana.org/whois?q=",d9={"whois.denic.de":"-T dn,ace","whois.nic.fr":"-V Md5.2"},Uq={"br.com":"whois.centralnic.net","cn.com":"whois.centralnic.net","de.com":"whois.centralnic.net","eu.com":"whois.centralnic.net","gb.com":"whois.centralnic.net","gb.net":"whois.centralnic.net","gr.com":"whois.centralnic.net","hu.com":"whois.centralnic.net","in.net":"whois.centralnic.net","no.com":"whois.centralnic.net","qc.com":"whois.centralnic.net","ru.com":"whois.centralnic.net","sa.com":"whois.centralnic.net","se.com":"whois.centralnic.net","se.net":"whois.centralnic.net","uk.com":"whois.centralnic.net","uk.net":"whois.centralnic.net","us.com":"whois.centralnic.net","uy.com":"whois.centralnic.net","za.com":"whois.centralnic.net","jpn.com":"whois.centralnic.ne","web.com":"whois.centralnic.ne",com:"whois.verisign-grs.com","za.net":"whois.za.net",net:"whois.verisign-grs.com","eu.org":"whois.eu.org","za.org":"whois.za.org",org:"whois.pir.org","llyw.cymru":"whois.nic.llyw.cymru","gov.scot":"whois.nic.gov.scot","gov.wales":"whois.nic.gov.wales",edu:"whois.educause.edu",gov:"whois.dotgov.gov",int:"whois.iana.org","e164.arpa":"whois.ripe.net",arpa:"whois.iana.org",aero:"whois.aero",asia:"whois.nic.asia",biz:"whois.nic.biz",cat:"whois.nic.cat",coop:"whois.nic.coop",info:"whois.afilias.net",jobs:"whois.nic.jobs",mobi:"whois.afilias.net",museum:"whois.nic.museum",name:"whois.nic.name",post:"whois.dotpostregistry.net",pro:"whois.nic.pro",tel:"whois.nic.tel",travel:"whois.nic.travel",xxx:"whois.nic.xxx",ac:"whois.nic.ac",ae:"whois.aeda.net.ae",af:"whois.nic.af",ag:"whois.nic.ag",ai:"whois.nic.ai",am:"whois.amnic.net",ar:"whois.nic.ar",as:"whois.nic.as","priv.at":"whois.nic.priv.at",at:"whois.nic.at",au:"whois.auda.org.au",aw:"whois.nic.aw",ax:"whois.ax",be:"whois.dns.be",bf:"whois.registre.bf",bg:"whois.register.bg",bh:"whois.nic.bh",bi:"whois1.nic.bi",bj:"whois.nic.bj",bm:"whois.afilias-srs.net",bn:"whois.bnnic.bn",bo:"whois.nic.bo",br:"whois.registro.br",by:"whois.cctld.by",bw:"whois.nic.net.bw",bz:"whois.afilias-grs.info","co.ca":"whois.co.ca",ca:"whois.cira.ca",cc:"ccwhois.verisign-grs.com",cd:"whois.nic.cd",ch:"whois.nic.ch",ci:"whois.nic.ci",cl:"whois.nic.cl",cm:"whois.netcom.cm","edu.cn":"whois.edu.cn",cn:"whois.cnnic.cn","uk.co":"whois.uk.co",co:"whois.nic.co",cr:"whois.nic.cr",cx:"whois.nic.cx",cz:"whois.nic.cz",de:"whois.denic.de",dk:"whois.dk-hostmaster.dk",dm:"whois.dmdomains.dm",do:"whois.nic.do",dz:"whois.nic.dz",ec:"whois.nic.ec",ee:"whois.tld.ee",eu:"whois.eu",fi:"whois.fi",fj:"www.whois.fj",fm:"whois.nic.fm",fo:"whois.nic.fo",fr:"whois.nic.fr",gd:"whois.nic.gd",ge:"whois.nic.ge",gf:"whois.mediaserv.net",gg:"whois.gg",gh:"whois.nic.gh",gi:"whois2.afilias-grs.net",gl:"whois.nic.gl",gp:"whois.nic.gp",gq:"whois.dominio.gq",gs:"whois.nic.gs",gy:"whois.registry.gy",hk:"whois.hkirc.hk",hm:"whois.registry.hm",hn:"whois.nic.hn",hr:"whois.dns.hr",ht:"whois.nic.ht",hu:"whois.nic.hu",id:"whois.id",ie:"whois.weare.ie",il:"whois.isoc.org.il",im:"whois.nic.im",in:"whois.registry.in",io:"whois.nic.io",iq:"whois.cmc.iq",ir:"whois.nic.ir",is:"whois.isnic.is",it:"whois.nic.it",je:"whois.je",jp:"whois.jprs.jp",ke:"whois.kenic.or.ke",kg:"whois.kg",ki:"whois.nic.ki",kn:"whois.nic.kn",kr:"whois.kr",kw:"whois.nic.kw",ky:"whois.kyregistry.ky",kz:"whois.nic.kz",la:"whois.nic.la",lb:"whois.lbdr.org.lb",lc:"whois2.afilias-grs.net",li:"whois.nic.li",lk:"whois.nic.lk",ls:"whois.nic.ls",lt:"whois.domreg.lt",lu:"whois.dns.lu",lv:"whois.nic.lv",ly:"whois.nic.ly",ma:"whois.registre.ma",md:"whois.nic.md",me:"whois.nic.me",mg:"whois.nic.mg",mk:"whois.marnet.mk",ml:"whois.dot.ml",mm:"whois.registry.gov.mm",mn:"whois.nic.mn",mq:"whois.mediaserv.net",mr:"whois.nic.mr",ms:"whois.nic.ms",mt:"whois.nic.org.mt",mu:"whois.nic.mu",mw:"whois.nic.mw",mx:"whois.mx",my:"whois.mynic.my",mz:"whois.nic.mz",na:"whois.na-nic.com.na",nc:"whois.nc",nf:"whois.nic.nf",ng:"whois.nic.net.ng",nl:"whois.domain-registry.nl",no:"whois.norid.no",nu:"whois.iis.nu",nz:"whois.irs.net.nz",om:"whois.registry.om",pe:"kero.yachay.pe",pf:"whois.registry.pf",pk:"whois.pknic.net.pk","co.pl":"whois.co.pl",pl:"whois.dns.pl",pm:"whois.nic.pm",pr:"whois.afilias-srs.net",ps:"whois.pnina.ps",pt:"whois.dns.pt",pw:"whois.nic.pw",qa:"whois.registry.qa",re:"whois.nic.re",ro:"whois.rotld.ro",rs:"whois.rnids.rs","ac.ru":"whois.free.net","edu.ru":"whois.informika.ru","com.ru":"whois.flexireg.net","msk.ru":"whois.flexireg.net","net.ru":"whois.nic.net.ru","nov.ru":"whois.flexireg.net","org.ru":"whois.nic.net.ru","pp.ru":"whois.nic.net.ru","spb.ru":"whois.flexireg.net",ru:"whois.tcinet.ru",rw:"whois.ricta.org.rw",sa:"whois.nic.net.sa",sb:"whois.nic.net.sb",sc:"whois2.afilias-grs.net",sd:"whois.sdnic.sd",se:"whois.iis.se",sg:"whois.sgnic.sg",sh:"whois.nic.sh",si:"whois.register.si",sk:"whois.sk-nic.sk",sl:"whois.nic.sl",sm:"whois.nic.sm",sn:"whois.nic.sn",so:"whois.nic.so",ss:"whois.nic.ss",st:"whois.nic.st","msk.su":"whois.flexireg.net","nov.su":"whois.flexireg.net","spb.su":"whois.flexireg.net",su:"whois.tcinet.ru",sx:"whois.sx",sy:"whois.tld.sy",tc:"whois.nic.tc",td:"whois.nic.td",tf:"whois.nic.tf",tg:"whois.nic.tg",th:"whois.thnic.co.th",tk:"whois.dot.tk",tl:"whois.nic.tl",tm:"whois.nic.tm",tn:"whois.ati.tn",to:"whois.tonic.to",tr:"whois.trabis.gov.tr",tv:"whois.nic.tv",tw:"whois.twnic.net.tw",tz:"whois.tznic.or.tz","biz.ua":"whois.biz.ua","co.ua":"whois.co.ua","pp.ua":"whois.pp.ua",ua:"whois.ua",ug:"whois.co.ug","ac.uk":"whois.nic.ac.uk","gov.uk":"whois.gov.uk",uk:"whois.nic.uk","fed.us":"whois.nic.gov",us:"whois.nic.us",uy:"whois.nic.org.uy",uz:"whois.cctld.uz",vc:"whois2.afilias-grs.net",ve:"whois.nic.ve",vg:"whois.nic.vg",vu:"whois.dnrs.vu",wf:"whois.nic.wf",ws:"whois.website.ws",yt:"whois.nic.yt","ac.za":"whois.ac.za","co.za":"whois.registry.net.za","gov.za":"whois.gov.za","net.za":"net-whois.registry.net.za","org.za":"org-whois.registry.net.za","web.za":"web-whois.registry.net.za",zm:"whois.zicta.zm","xn--2scrj9c":"whois.registry.in","xn--3e0b707e":"whois.kr","xn--3hcrj9c":"whois.registry.in","xn--45br5cyl":"whois.registry.in","xn--45brj9c":"whois.registry.in","xn--4dbrk0ce":"whois.isoc.org.il","xn--80ao21a":"whois.nic.kz","xn--90a3ac":"whois.rnids.rs","xn--90ae":"whois.imena.bg","xn--90ais":"whois.cctld.by","xn--clchc0ea0b2g2a9gcd":"whois.sgnic.sg","xn--d1alf":"whois.marnet.mk","xn--e1a4c":"whois.eu","xn--fiqs8s":"cwhois.cnnic.cn","xn--fiqz9s":"cwhois.cnnic.cn","xn--fpcrj9c3d":"whois.registry.in","xn--fzc2c9e2c":"whois.nic.lk","xn--gecrj9c":"whois.registry.in","xn--h2breg3eve":"whois.registry.in","xn--h2brj9c8c":"whois.registry.in","xn--h2brj9c":"whois.registry.in","xn--j1amh":"whois.dotukr.com","xn--j6w193g":"whois.hkirc.hk","xn--kprw13d":"whois.twnic.net.tw","xn--kpry57d":"whois.twnic.net.tw","xn--lgbbat1ad8j":"whois.nic.dz","xn--mgb9awbf":"whois.registry.om","xn--mgba3a4f16a":"whois.nic.ir","xn--mgbaam7a8h":"whois.aeda.net.ae","xn--mgbah1a3hjkrd":"whois.nic.mr","xn--mgbbh1a71e":"whois.registry.in","xn--mgbbh1a":"whois.registry.in","xn--mgberp4a5d4ar":"whois.nic.net.sa","xn--mgbgu82a":"whois.registry.in","xn--mgbtx2b":"whois.cmc.iq","xn--mgbx4cd0ab":"whois.mynic.my","xn--node":"whois.itdc.ge","xn--o3cw4h":"whois.thnic.co.th","xn--ogbpf8fl":"whois.tld.sy","xn--p1ai":"whois.tcinet.ru","xn--pgbs0dh":"whois.ati.tn","xn--q7ce6a":"whois.nic.la","xn--qxa6a":"whois.eu","xn--rvc1e0am3e":"whois.registry.in","xn--s9brj9c":"whois.registry.in","xn--wgbh1c":"whois.dotmasr.eg","xn--wgbl6a":"whois.registry.qa","xn--xkc2al3hye2a":"whois.nic.lk","xn--xkc2dl3a5ee0h":"whois.registry.in","xn--y9a3aq":"whois.amnic.net","xn--yfro4i67o":"whois.sgnic.sg","xn--ygbi2ammx":"whois.pnina.ps"};var f9;((q)=>{q[q.SOCKS4=0]="SOCKS4";q[q.SOCKS5=1]="SOCKS5"})(f9||={});function Oq(w){if(Array.isArray(w))return w.slice();if(typeof w==="object"&&w!==null){let $={};for(let q in w)if(Object.prototype.hasOwnProperty.call(w,q))$[q]=Oq(w[q]);return $}return w}var MX=g$(Kq(),1);async function OX(w){let $=l9+w;try{let q=await UX($);if(q.ok){let Y=(await q.text()).match(/whois:\s+(\S+)/);if(Y?.[1])return Y[1]}}catch(q){console.error("Error in getting WhoIs server data from IANA",q)}return""}function XX(w){if(w==="com")return"whois.verisign-grs.com";return Uq[w]}function p9(w){let $=w.split(".");for(let q=$.length-1;q>0;q--){let J=$.slice(q).join(".");if(Uq[J])return J}return $[$.length-1]}function zX(w){return d9[w]}class G1{static iterParse(w,$){let q="",J=null,Y="";for(let U=0;U<w.length;U++){let X=w[U];if(X===`
`||Y===":"&&X===" "){if(q.trim()in $)J=q.trim();else if(J!==null){let M=q.trim();if(M!==""){let Q=$[J];if(Array.isArray(Q))Q.push(M);else $[J]=M;J=null}}q=""}else if(X!==":")q=q+X;if(Y=X,q==="Record maintained by"||q===">>>")break}return $}static parseData(w,$){if(!$)$={"Domain Name":"","Creation Date":"","Updated Date":"","Registry Expiry Date":"","Domain Status":[],Registrar:""};return $=G1.iterParse(w,$),$}}async function GX(w,$,q,J,Y,U){let X=new TextDecoder(Y),M=new TextEncoder;if(!U){let V=new KX.Socket;return new Promise((z,N)=>{try{V.connect({port:J,host:q},()=>{if($!=="")V.write(M.encode(`${$} ${w}\r
`));else V.write(M.encode(`${w}\r
`))}),V.on("data",(F)=>{z(X.decode(F))}),V.on("error",(F)=>{N(F)})}catch(F){N(F)}})}let Q={proxy:{host:U.ip,port:U.port,type:U.type===1?5:4},command:"connect",destination:{host:q,port:J}};if(U.username&&U.password)Q.proxy.userId=U.username,Q.proxy.password=U.password;return new Promise((V,z)=>{r9.SocksClient.createConnection(Q,(N,F)=>{if(N)z(N);else{if(!F)z(new Error("No socket info received!"));if($!=="")F?.socket.write(M.encode(`${$} ${w}\r
`));else F?.socket.write(M.encode(`${w}\r
`));F?.socket.on("data",(W)=>{V(X.decode(W))}),F?.socket.resume()}})})}async function Xq(w,$=!1,q=null){let J,Y=43,U="",X,M="utf-8";if(!q)J=p9(w),X=null;else J=q.tld?q.tld:p9(w),M=q.encoding?q.encoding:"utf-8",X=q.proxy?q.proxy:null,U=q.server?q.server:"",Y=q.serverPort?q.serverPort:43;if(U===""){let z=XX(J);if(!z){if(Sw.debug(`No WhoIs server found for TLD: ${J}! Attempting IANA WhoIs database for server!`),z=await OX(J),!z)return Sw.debug("WhoIs server could not be found!"),{_raw:"",parsedData:null};Sw.debug(`WhoIs sever found for ${J}: ${U}`)}U=z}let V=zX(U)||"";try{Sw.debug(`Attempting WHOIS lookup for ${w} on server ${U}`);let z=await GX(w,V,U,Y,M,X);if(Sw.debug("Raw WHOIS data received:",z),!$){let F=G1.parseData(z,null);return{_raw:z,parsedData:F}}let N=null;if(q?.parseData)N=Oq(q.parseData);try{let F=G1.parseData(z,N);return{_raw:z,parsedData:F}}catch(F){return console.error("Error in parsing WhoIs data!",F),{_raw:z,parsedData:null}}}catch(z){return Sw.debug(`Error in WHOIS lookup for ${w} on server ${U}`,z),{_raw:"",parsedData:null}}}function w4(w,$=null){return Sw.debug(`Lookup called for ${w}`),Xq(w,!0,$)}async function $4(w,$=!1,q=1,J=!1,Y=null){let U=[];if($){if(q>w.length)q=w.length;for(let X=0;X<w.length;X+=q){let M=w.slice(X,X+q);U=await Promise.all(M.map(async(Q)=>{return await Xq(Q,J,Y)}))}}else for(let X=0;X<w.length;X++){let M=await Xq(w[X],J,Y);U.push(M)}return U}var export_SocksClient=MX.SocksClient;export{Xq as whois,GX as tcpWhois,w4 as lookup,XX as getWhoIsServer,p9 as getTLD,zX as getParameters,OX as findWhoIsServer,$4 as batchWhois,G1 as WhoIsParser,export_SocksClient as SocksClient,Uq as SERVERS,f9 as ProxyType,d9 as PARAMETERS,l9 as IANA_CHK_URL};
