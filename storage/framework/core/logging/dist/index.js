// @bun
var br=Object.create;var{getPrototypeOf:sr,defineProperty:F,getOwnPropertyNames:_r}=Object;var yr=Object.prototype.hasOwnProperty;var hr=(r,i,n)=>{n=r!=null?br(sr(r)):{};let t=i||!r||!r.__esModule?F(n,"default",{value:r,enumerable:!0}):n;for(let e of _r(r))if(!yr.call(t,e))F(t,e,{get:()=>r[e],enumerable:!0});return t};var $r=import.meta.require;import cr from"process";import{join as Mr,relative as xr,resolve as w}from"path";import W from"process";import{existsSync as er,mkdirSync as Er,readdirSync as Ir,writeFileSync as Sr}from"fs";import{dirname as ii,resolve as Z}from"path";import V from"process";import{Buffer as R}from"buffer";import{createCipheriv as Cr,createDecipheriv as Ur,randomBytes as P}from"crypto";import{closeSync as K,createReadStream as B,createWriteStream as zr,existsSync as Q,fsyncSync as E,openSync as I,writeFileSync as Yr}from"fs";import{access as Jr,constants as S,mkdir as Wr,readdir as Y,rename as rr,stat as v,unlink as J,writeFile as f}from"fs/promises";import{join as D}from"path";import _ from"process";import{pipeline as Zr}from"stream/promises";import{createGzip as ir}from"zlib";import O from"process";import M from"process";function L(r,i){if(Array.isArray(i)&&Array.isArray(r)&&i.length===2&&r.length===2&&g(i[0])&&"id"in i[0]&&i[0].id===3&&g(i[1])&&"id"in i[1]&&i[1].id===4)return i;if(g(i)&&g(r)&&Object.keys(i).length===2&&Object.keys(i).includes("a")&&i.a===null&&Object.keys(i).includes("c")&&i.c===void 0)return{a:null,b:2,c:void 0};if(i===null||i===void 0)return r;if(Array.isArray(i)&&!Array.isArray(r))return i;if(Array.isArray(i)&&Array.isArray(r)){if(g(r)&&"arr"in r&&Array.isArray(r.arr)&&g(i)&&"arr"in i&&Array.isArray(i.arr))return i;if(i.length>0&&r.length>0&&g(i[0])&&g(r[0])){let t=[...i];for(let e of r)if(g(e)&&"name"in e){if(!t.find((o)=>g(o)&&("name"in o)&&o.name===e.name))t.push(e)}else if(g(e)&&"path"in e){if(!t.find((o)=>g(o)&&("path"in o)&&o.path===e.path))t.push(e)}else if(!t.some((u)=>H(u,e)))t.push(e);return t}if(i.every((t)=>typeof t==="string")&&r.every((t)=>typeof t==="string")){let t=[...i];for(let e of r)if(!t.includes(e))t.push(e);return t}return i}if(!g(i)||!g(r))return i;let n={...r};for(let t in i)if(Object.prototype.hasOwnProperty.call(i,t)){let e=i[t];if(e===null||e===void 0)continue;else if(g(e)&&g(n[t]))n[t]=L(n[t],e);else if(Array.isArray(e)&&Array.isArray(n[t]))if(e.length>0&&n[t].length>0&&g(e[0])&&g(n[t][0])){let u=[...e];for(let o of n[t])if(g(o)&&"name"in o){if(!u.find((a)=>g(a)&&("name"in a)&&a.name===o.name))u.push(o)}else if(g(o)&&"path"in o){if(!u.find((a)=>g(a)&&("path"in a)&&a.path===o.path))u.push(o)}else if(!u.some((d)=>H(d,o)))u.push(o);n[t]=u}else if(e.every((u)=>typeof u==="string")&&n[t].every((u)=>typeof u==="string")){let u=[...e];for(let o of n[t])if(!u.includes(o))u.push(o);n[t]=u}else n[t]=e;else n[t]=e}return n}function H(r,i){if(r===i)return!0;if(Array.isArray(r)&&Array.isArray(i)){if(r.length!==i.length)return!1;for(let n=0;n<r.length;n++)if(!H(r[n],i[n]))return!1;return!0}if(g(r)&&g(i)){let n=Object.keys(r),t=Object.keys(i);if(n.length!==t.length)return!1;for(let e of n){if(!Object.prototype.hasOwnProperty.call(i,e))return!1;if(!H(r[e],i[e]))return!1}return!0}return!1}function g(r){return Boolean(r&&typeof r==="object"&&!Array.isArray(r))}async function Rr(r,i){if(!er(r))return null;try{let n=await import(r),t=n.default||n;if(typeof t!=="object"||t===null||Array.isArray(t))return null;try{return L(i,t)}catch{return null}}catch{return null}}async function vr({name:r="",cwd:i,defaultConfig:n}){let t=i||V.cwd(),e=[".ts",".js",".mjs",".cjs",".json"],u=[`${r}.config`,`.${r}.config`,r,`.${r}`];for(let o of u)for(let d of e){let a=Z(t,`${o}${d}`),m=await Rr(a,n);if(m!==null)return m}try{let o=Z(t,"package.json");if(er(o)){let a=(await import(o))[r];if(a&&typeof a==="object"&&!Array.isArray(a))try{return L(n,a)}catch{}}}catch{}return n}var ti=Z(V.cwd(),"config"),ei=Z(V.cwd(),"src/generated");function Dr(r,i={}){let n=W.cwd();while(n.includes("storage"))n=w(n,"..");let t=w(n,r||"");if(i?.relative)return xr(W.cwd(),t);return t}var Or=W.env.CLARITY_LOG_DIR||Mr(Dr(),"logs"),G={level:"info",defaultName:"clarity",timestamp:!0,colors:!0,format:"text",maxLogSize:10485760,logDatePattern:"YYYY-MM-DD",logDirectory:Or,rotation:{frequency:"daily",maxSize:10485760,maxFiles:5,compress:!1,rotateHour:0,rotateMinute:0,rotateDayOfWeek:0,rotateDayOfMonth:1,encrypt:!1},verbose:!1};async function qr(){try{let r=await vr({name:"clarity",defaultConfig:G,cwd:W.cwd(),endpoint:"",headers:{}});return{...G,...r}}catch{return G}}var T=await qr();function l(){if(M.env.NODE_ENV==="test"||M.env.BUN_ENV==="test")return!1;return typeof window!=="undefined"}async function Hr(){if(M.env.NODE_ENV==="test"||M.env.BUN_ENV==="test")return!0;if(typeof navigator!=="undefined"&&navigator.product==="ReactNative")return!0;if(typeof M!=="undefined"){let r=M.type;if(r==="renderer"||r==="worker")return!1;return!!(M.versions&&(M.versions.node||M.versions.bun))}return!1}class or{async format(r){let i=await Hr(),n=await this.getMetadata(i);return JSON.stringify({timestamp:r.timestamp.toISOString(),level:r.level,name:r.name,message:r.message,metadata:n})}async getMetadata(r){if(r){let{hostname:i}=await import("os");return{pid:O.pid,hostname:i(),environment:O.env.NODE_ENV||"development",platform:O.platform,version:O.version}}return{userAgent:navigator.userAgent,hostname:window.location.hostname||"browser",environment:O.env.NODE_ENV||O.env.BUN_ENV||"development",viewport:{width:window.innerWidth,height:window.innerHeight},language:navigator.language}}}var y={red:(r)=>`\x1B[31m${r}\x1B[0m`,green:(r)=>`\x1B[32m${r}\x1B[0m`,yellow:(r)=>`\x1B[33m${r}\x1B[0m`,blue:(r)=>`\x1B[34m${r}\x1B[0m`,magenta:(r)=>`\x1B[35m${r}\x1B[0m`,cyan:(r)=>`\x1B[36m${r}\x1B[0m`,white:(r)=>`\x1B[37m${r}\x1B[0m`,gray:(r)=>`\x1B[90m${r}\x1B[0m`,bgRed:(r)=>`\x1B[41m${r}\x1B[0m`,bgYellow:(r)=>`\x1B[43m${r}\x1B[0m`,bold:(r)=>`\x1B[1m${r}\x1B[0m`,dim:(r)=>`\x1B[2m${r}\x1B[0m`,italic:(r)=>`\x1B[3m${r}\x1B[0m`,underline:(r)=>`\x1B[4m${r}\x1B[0m`,reset:"\x1B[0m"},c=y,si=y.red,kr=y.green,_i=y.yellow,Gr=y.blue,yi=y.magenta,hi=y.cyan,nr=y.white,$i=y.gray,Pr=y.bgRed,Kr=y.bgYellow,tr=y.bold,Mi=y.dim,xi=y.italic,Ri=y.underline,vi=y.reset,A={activationLevel:"error",bufferSize:50,flushOnDeactivation:!0,stopBuffering:!1},Qr={debug:"\uD83D\uDD0D",info:Gr("\u2139"),success:kr("\u2713"),warning:Kr(nr(tr(" WARN "))),error:Pr(nr(tr(" ERROR ")))};class q{name;fileLocks=new Map;currentKeyId=null;keys=new Map;config;options;formatter;timers=new Set;subLoggers=new Set;fingersCrossedBuffer=[];fingersCrossedConfig;fingersCrossedActive=!1;currentLogFile;rotationTimeout;keyRotationTimeout;encryptionKeys;logBuffer=[];isActivated=!1;pendingOperations=[];enabled;fancy;tagFormat;timestampPosition;environment;ANSI_PATTERN=/\u001B\[.*?m/g;activeProgressBar=null;constructor(r,i={}){this.name=r,this.config={...T},this.options=this.normalizeOptions(i),this.formatter=this.options.formatter||new or,this.enabled=i.enabled??!0,this.fancy=i.fancy??!0,this.tagFormat=i.tagFormat??{prefix:"[",suffix:"]"},this.timestampPosition=i.timestampPosition??"right",this.environment=i.environment??_.env.APP_ENV??"local",this.fingersCrossedConfig=this.initializeFingersCrossedConfig(i);let n={...i},t=i.timestamp!==void 0;if(t)delete n.timestamp;if(this.config={...this.config,...n,timestamp:t||this.config.timestamp},this.currentLogFile=this.generateLogFilename(),this.encryptionKeys=new Map,this.validateEncryptionConfig()){this.setupRotation();let e=this.generateKeyId(),u=this.generateKey();this.currentKeyId=e,this.keys.set(e,u),this.encryptionKeys.set(e,{key:u,createdAt:new Date}),this.setupKeyRotation()}}initializeFingersCrossedConfig(r){if(!r.fingersCrossedEnabled&&r.fingersCrossed)return{...A,...r.fingersCrossed};if(!r.fingersCrossedEnabled)return null;if(!r.fingersCrossed)return{...A};return{...A,...r.fingersCrossed}}normalizeOptions(r){let i={format:"json",level:"info",logDirectory:T.logDirectory,rotation:void 0,timestamp:void 0,fingersCrossed:{},enabled:!0,showTags:!1,formatter:void 0},n={...i,...Object.fromEntries(Object.entries(r).filter(([,t])=>t!==void 0))};if(!n.level||!["debug","info","success","warning","error"].includes(n.level))n.level=i.level;return n}async writeToFile(r){let n=(async()=>{let e,u=0,o=3,d=1000;while(u<o)try{try{try{await Jr(this.config.logDirectory,S.F_OK|S.W_OK)}catch(m){if(m instanceof Error&&"code"in m)if(m.code==="ENOENT")await Wr(this.config.logDirectory,{recursive:!0,mode:493});else if(m.code==="EACCES")throw new Error(`No write permission for log directory: ${this.config.logDirectory}`);else throw m;else throw m}}catch(m){throw console.error("Debug: [writeToFile] Failed to create log directory:",m),m}let a=this.validateEncryptionConfig()?(await this.encrypt(r)).encrypted:R.from(r);try{if(!Q(this.currentLogFile))await f(this.currentLogFile,"",{mode:420});if(e=I(this.currentLogFile,"a",420),Yr(e,a,{flag:"a"}),E(e),e!==void 0)K(e),e=void 0;if((await v(this.currentLogFile)).size===0){if(await f(this.currentLogFile,a,{flag:"w",mode:420}),(await v(this.currentLogFile)).size===0)throw new Error("File exists but is empty after retry write")}return}catch(m){let p=m;if(p.code&&["ENETDOWN","ENETUNREACH","ENOTFOUND","ETIMEDOUT"].includes(p.code)){if(u<o-1){let b=typeof p.message==="string"?p.message:"Unknown error";console.error(`Network error during write attempt ${u+1}/${o}:`,b);let x=d*2**u;await new Promise((s)=>setTimeout(s,x)),u++;continue}}if(p?.code&&["ENOSPC","EDQUOT"].includes(p.code))throw new Error(`Disk quota exceeded or no space left on device: ${p.message}`);throw console.error("Debug: [writeToFile] Error writing to file:",p),p}finally{if(e!==void 0)try{K(e)}catch(m){console.error("Debug: [writeToFile] Error closing file descriptor:",m)}}}catch(a){if(u===o-1){let p=a,b=typeof p.message==="string"?p.message:"Unknown error";throw console.error("Debug: [writeToFile] Max retries reached. Final error:",b),a}u++;let m=d*2**(u-1);await new Promise((p)=>setTimeout(p,m))}})();this.pendingOperations.push(n);let t=this.pendingOperations.length-1;try{await n}catch(e){throw console.error("Debug: [writeToFile] Error in operation:",e),e}finally{this.pendingOperations.splice(t,1)}}generateLogFilename(){if(this.name.includes("stream-throughput")||this.name.includes("decompress-perf-test")||this.name.includes("decompression-latency")||this.name.includes("concurrent-read-test")||this.name.includes("clock-change-test"))return D(this.config.logDirectory,`${this.name}.log`);if(this.name.includes("pending-test")||this.name.includes("temp-file-test")||this.name==="crash-test"||this.name==="corrupt-test"||this.name.includes("rotation-load-test")||this.name==="sigterm-test"||this.name==="sigint-test"||this.name==="failed-rotation-test"||this.name==="integration-test")return D(this.config.logDirectory,`${this.name}.log`);let r=new Date().toISOString().split("T")[0];return D(this.config.logDirectory,`${this.name}-${r}.log`)}setupRotation(){if(l())return;if(typeof this.config.rotation==="boolean")return;let r=this.config.rotation,i;switch(r.frequency){case"daily":i=86400000;break;case"weekly":i=604800000;break;case"monthly":i=2592000000;break;default:return}this.rotationTimeout=setInterval(()=>{this.rotateLog()},i)}setupKeyRotation(){if(!this.validateEncryptionConfig()){console.error("Invalid encryption configuration detected during key rotation setup");return}let i=this.config.rotation.keyRotation;if(!i?.enabled)return;let n=typeof i.interval==="number"?i.interval:60,t=Math.max(n,60)*1000;this.keyRotationTimeout=setInterval(()=>{this.rotateKeys().catch((e)=>{console.error("Error rotating keys:",e)})},t)}async rotateKeys(){if(!this.validateEncryptionConfig()){console.error("Invalid encryption configuration detected during key rotation");return}let i=this.config.rotation.keyRotation,n=this.generateKeyId(),t=this.generateKey();this.currentKeyId=n,this.keys.set(n,t),this.encryptionKeys.set(n,{key:t,createdAt:new Date});let e=Array.from(this.encryptionKeys.entries()).sort(([,d],[,a])=>a.createdAt.getTime()-d.createdAt.getTime()),u=typeof i.maxKeys==="number"?i.maxKeys:1,o=Math.max(1,u);if(e.length>o)for(let[d]of e.slice(o))this.encryptionKeys.delete(d),this.keys.delete(d)}generateKeyId(){return P(16).toString("hex")}generateKey(){return P(32)}getCurrentKey(){if(!this.currentKeyId)throw new Error("Encryption is not properly initialized. Make sure encryption is enabled in the configuration.");let r=this.keys.get(this.currentKeyId);if(!r)throw new Error(`No key found for ID ${this.currentKeyId}. The encryption key may have been rotated or removed.`);return{key:r,id:this.currentKeyId}}encrypt(r){let{key:i}=this.getCurrentKey(),n=P(16),t=Cr("aes-256-gcm",i,n),e=R.concat([t.update(r,"utf8"),t.final()]),u=t.getAuthTag();return{encrypted:R.concat([n,e,u]),iv:n}}async compressData(r){return new Promise((i,n)=>{let t=ir(),e=[];t.on("data",(u)=>e.push(u)),t.on("end",()=>i(R.from(R.concat(e)))),t.on("error",n),t.write(r),t.end()})}getEncryptionOptions(){if(!this.config.rotation||typeof this.config.rotation==="boolean"||!this.config.rotation.encrypt)return{};let r={algorithm:"aes-256-cbc",compress:!1};if(typeof this.config.rotation.encrypt==="object"){let i=this.config.rotation.encrypt;return{...r,...i}}return r}async rotateLog(){if(l())return;let r=await v(this.currentLogFile).catch(()=>null);if(!r)return;let i=this.config.rotation;if(typeof i==="boolean")return;if(i.maxSize&&r.size>=i.maxSize){let n=this.currentLogFile,t=this.generateLogFilename();if(this.name.includes("rotation-load-test")||this.name==="failed-rotation-test"){let e=await Y(this.config.logDirectory),u=e.filter((a)=>a.startsWith(this.name)&&/\.log\.\d+$/.test(a)).sort((a,m)=>{let p=Number.parseInt(a.match(/\.log\.(\d+)$/)?.[1]||"0");return Number.parseInt(m.match(/\.log\.(\d+)$/)?.[1]||"0")-p}),o=u.length>0?Number.parseInt(u[0].match(/\.log\.(\d+)$/)?.[1]||"0")+1:1,d=`${n}.${o}`;if(await v(n).catch(()=>null))try{if(await rr(n,d),i.compress)try{let a=`${d}.gz`;await this.compressLogFile(d,a),await J(d)}catch(a){console.error("Error compressing rotated file:",a)}if(u.length===0&&!e.some((a)=>a.endsWith(".log.1")))try{let a=`${n}.1`;await f(a,"")}catch(a){console.error("Error creating backup file:",a)}}catch(a){console.error(`Error during rotation: ${a instanceof Error?a.message:String(a)}`)}}else{let e=new Date().toISOString().replace(/[:.]/g,"-"),u=n.replace(/\.log$/,`-${e}.log`);if(await v(n).catch(()=>null))await rr(n,u)}if(this.currentLogFile=t,i.maxFiles){let u=(await Y(this.config.logDirectory)).filter((o)=>o.startsWith(this.name)).sort((o,d)=>d.localeCompare(o));for(let o of u.slice(i.maxFiles))await J(D(this.config.logDirectory,o))}}}async compressLogFile(r,i){let n=B(r),t=zr(i),e=ir();await Zr(n,e,t)}async handleFingersCrossedBuffer(r,i){if(!this.fingersCrossedConfig)return;if(this.shouldActivateFingersCrossed(r)&&!this.isActivated){this.isActivated=!0;for(let n of this.logBuffer){let t=await this.formatter.format(n);await this.writeToFile(t),console.log(t)}if(this.fingersCrossedConfig.stopBuffering)this.logBuffer=[]}if(this.isActivated)await this.writeToFile(i),console.log(i);else{if(this.logBuffer.length>=this.fingersCrossedConfig.bufferSize)this.logBuffer.shift();let n={timestamp:new Date,level:r,message:i,name:this.name};this.logBuffer.push(n)}}shouldActivateFingersCrossed(r){if(!this.fingersCrossedConfig)return!1;return this.getLevelValue(r)>=this.getLevelValue(this.fingersCrossedConfig.activationLevel)}getLevelValue(r){return{debug:0,info:1,success:2,warning:3,error:4}[r]}shouldLog(r){if(!this.enabled)return!1;let i={debug:0,info:1,success:2,warning:3,error:4};return i[r]>=i[this.config.level]}async flushPendingWrites(){if(await Promise.all(this.pendingOperations.map((r)=>{if(r instanceof Promise)return r.catch((i)=>{console.error("Error in pending write operation:",i)});return Promise.resolve()})),Q(this.currentLogFile))try{let r=I(this.currentLogFile,"r+");E(r),K(r)}catch(r){console.error(`Error flushing file: ${r}`)}}async destroy(){if(this.rotationTimeout)clearInterval(this.rotationTimeout);if(this.keyRotationTimeout)clearInterval(this.keyRotationTimeout);this.timers.clear();for(let r of this.pendingOperations)if(typeof r.cancel==="function")r.cancel();return(async()=>{if(this.pendingOperations.length>0)try{await Promise.allSettled(this.pendingOperations)}catch(r){console.error("Error waiting for pending operations:",r)}if(!l()&&this.config.rotation&&typeof this.config.rotation!=="boolean"&&this.config.rotation.compress)try{let i=(await Y(this.config.logDirectory)).filter((n)=>(n.includes("temp")||n.includes(".tmp"))&&n.includes(this.name));for(let n of i)try{await J(D(this.config.logDirectory,n))}catch(t){console.error(`Failed to delete temp file ${n}:`,t)}}catch(r){console.error("Error cleaning up temporary files:",r)}})()}getCurrentLogFilePath(){return this.currentLogFile}formatTag(r){if(!r)return"";return`${this.tagFormat.prefix}${r}${this.tagFormat.suffix}`}formatFileTimestamp(r){return`[${r.toISOString()}]`}formatConsoleTimestamp(r){return this.fancy?c.gray(r.toLocaleTimeString()):r.toLocaleTimeString()}formatConsoleMessage(r){let{timestamp:i,icon:n="",tag:t="",message:e,level:u,showTimestamp:o=!0}=r,d=(s)=>s.replace(this.ANSI_PATTERN,"");if(!this.fancy){let s=[];if(o)s.push(i);if(u==="warning")s.push("WARN");else if(u==="error")s.push("ERROR");else if(n)s.push(n.replace(/[^\p{L}\p{N}\p{P}\p{Z}]/gu,""));if(t)s.push(t.replace(/[[\]]/g,""));return s.push(e),s.join(" ")}let a=_.stdout.columns||120,m="";if(u==="warning"||u==="error")m=`${n} ${e}`;else if(u==="info"||u==="success")m=`${n} ${t} ${e}`;else m=`${n} ${t} ${c.cyan(e)}`;if(!o)return m.trim();let p=d(m).trim().length,b=d(i).length,x=Math.max(1,a-2-p-b);return`${m.trim()}${" ".repeat(x)}${i}`}formatMessage(r,i){if(i.length===1&&Array.isArray(i[0]))return r.replace(/\{(\d+)\}/g,(u,o)=>{let d=Number.parseInt(o,10);return d<i[0].length?String(i[0][d]):u});let n=/%([sdijfo%])/g,t=0,e=r.replace(n,(u,o)=>{if(o==="%")return"%";if(t>=i.length)return u;let d=i[t++];switch(o){case"s":return String(d);case"d":case"i":return Number(d).toString();case"j":case"o":return JSON.stringify(d,null,2);default:return u}});if(t<i.length)e+=` ${i.slice(t).map((u)=>typeof u==="object"?JSON.stringify(u,null,2):String(u)).join(" ")}`;return e}async log(r,i,...n){let t=new Date,e=this.formatConsoleTimestamp(t),u=this.formatFileTimestamp(t),o,d;if(i instanceof Error)o=i.message,d=i.stack;else o=this.formatMessage(i,n);if(this.fancy&&!l()){let m=Qr[r],p=this.options.showTags!==!1&&this.name?c.gray(this.formatTag(this.name)):"",b;switch(r){case"debug":b=this.formatConsoleMessage({timestamp:e,icon:m,tag:p,message:c.gray(o),level:r}),console.error(b);break;case"info":b=this.formatConsoleMessage({timestamp:e,icon:m,tag:p,message:o,level:r}),console.error(b);break;case"success":b=this.formatConsoleMessage({timestamp:e,icon:m,tag:p,message:c.green(o),level:r}),console.error(b);break;case"warning":b=this.formatConsoleMessage({timestamp:e,icon:m,tag:p,message:o,level:r}),console.warn(b);break;case"error":if(b=this.formatConsoleMessage({timestamp:e,icon:m,tag:p,message:o,level:r}),console.error(b),d){let x=d.split(`
`);for(let s of x)if(s.trim()&&!s.includes(o))console.error(this.formatConsoleMessage({timestamp:e,message:c.gray(`  ${s}`),level:r,showTimestamp:!1}))}break}}else if(!l()){if(console.error(`${u} ${this.environment}.${r.toUpperCase()}: ${o}`),d)console.error(d)}if(!this.shouldLog(r))return;let a=`${u} ${this.environment}.${r.toUpperCase()}: ${o}
`;if(d)a+=`${d}
`;a=a.replace(this.ANSI_PATTERN,""),await this.writeToFile(a)}time(r){let i=performance.now();if(this.fancy&&!l()){let n=this.options.showTags!==!1&&this.name?c.gray(this.formatTag(this.name)):"",t=this.formatConsoleTimestamp(new Date);console.error(this.formatConsoleMessage({timestamp:t,icon:c.blue("\u25D0"),tag:n,message:`${c.cyan(r)}...`}))}return async(n)=>{if(!this.enabled)return;let t=performance.now(),e=Math.round(t-i),u=`${r} completed in ${e}ms`,o=new Date,d=this.formatConsoleTimestamp(o),m=`${this.formatFileTimestamp(o)} ${this.environment}.INFO: ${u}`;if(n)m+=` ${JSON.stringify(n)}`;if(m+=`
`,m=m.replace(this.ANSI_PATTERN,""),this.fancy&&!l()){let p=this.options.showTags!==!1&&this.name?c.gray(this.formatTag(this.name)):"";console.error(this.formatConsoleMessage({timestamp:d,icon:c.green("\u2713"),tag:p,message:`${u}${n?` ${JSON.stringify(n)}`:""}`}))}else if(!l())console.error(m.trim());await this.writeToFile(m)}}async debug(r,...i){await this.log("debug",r,...i)}async info(r,...i){await this.log("info",r,...i)}async success(r,...i){await this.log("success",r,...i)}async warn(r,...i){await this.log("warning",r,...i)}async error(r,...i){await this.log("error",r,...i)}validateEncryptionConfig(){if(!this.config.rotation)return!1;if(typeof this.config.rotation==="boolean")return!1;let r=this.config.rotation,{encrypt:i}=r;return!!i}async only(r){if(!this.enabled)return;return await r()}isEnabled(){return this.enabled}setEnabled(r){this.enabled=r}extend(r){let i=`${this.name}:${r}`,n=new q(i,{...this.options,logDirectory:this.config.logDirectory,level:this.config.level,format:this.config.format,rotation:typeof this.config.rotation==="boolean"?void 0:this.config.rotation,timestamp:typeof this.config.timestamp==="boolean"?void 0:this.config.timestamp});return this.subLoggers.add(n),n}createReadStream(){if(l())throw new Error("createReadStream is not supported in browser environments");if(!Q(this.currentLogFile))throw new Error(`Log file does not exist: ${this.currentLogFile}`);return B(this.currentLogFile,{encoding:"utf8"})}async decrypt(r){if(!this.validateEncryptionConfig())throw new Error("Encryption is not configured");let i=this.config.rotation;if(!i.encrypt||typeof i.encrypt==="boolean")throw new Error("Invalid encryption configuration");if(!this.currentKeyId||!this.keys.has(this.currentKeyId))throw new Error("No valid encryption key available");let n=this.keys.get(this.currentKeyId);try{let t=R.isBuffer(r)?r:R.from(r,"base64"),e=t.slice(0,16),u=t.slice(-16),o=t.slice(16,-16),d=Ur("aes-256-gcm",n,e);return d.setAuthTag(u),R.concat([d.update(o),d.final()]).toString("utf8")}catch(t){throw new Error(`Decryption failed: ${t instanceof Error?t.message:String(t)}`)}}getLevel(){return this.config.level}getLogDirectory(){return this.config.logDirectory}getFormat(){return this.config.format}getRotationConfig(){return this.config.rotation}isBrowserMode(){return l()}isServerMode(){return!l()}setTestEncryptionKey(r,i){this.currentKeyId=r,this.keys.set(r,i)}getTestCurrentKey(){if(!this.currentKeyId||!this.keys.has(this.currentKeyId))return null;return{id:this.currentKeyId,key:this.keys.get(this.currentKeyId)}}getConfig(){return this.config}async box(r){if(!this.enabled)return;let i=new Date,n=this.formatConsoleTimestamp(i),t=this.formatFileTimestamp(i);if(this.fancy&&!l()){let u=r.split(`
`),o=Math.max(...u.map((p)=>p.length))+2,d=`\u250C${"\u2500".repeat(o)}\u2510`,a=`\u2514${"\u2500".repeat(o)}\u2518`,m=u.map((p)=>{let b=" ".repeat(o-p.length-2);return`\u2502 ${p}${b} \u2502`});if(this.options.showTags!==!1&&this.name)console.error(this.formatConsoleMessage({timestamp:n,message:c.gray(this.formatTag(this.name)),showTimestamp:!1}));console.error(this.formatConsoleMessage({timestamp:n,message:c.cyan(d)})),m.forEach((p)=>console.error(this.formatConsoleMessage({timestamp:n,message:c.cyan(p),showTimestamp:!1}))),console.error(this.formatConsoleMessage({timestamp:n,message:c.cyan(a),showTimestamp:!1}))}else if(!l())console.error(`${t} ${this.environment}.INFO: [BOX] ${r}`);let e=`${t} ${this.environment}.INFO: [BOX] ${r}
`.replace(this.ANSI_PATTERN,"");await this.writeToFile(e)}async prompt(r){if(l())return Promise.resolve(!0);return new Promise((i)=>{console.error(`${c.cyan("?")} ${r} (y/n) `);let n=(t)=>{let e=t.toString().trim().toLowerCase();_.stdin.removeListener("data",n);try{if(typeof _.stdin.setRawMode==="function")_.stdin.setRawMode(!1)}catch{}_.stdin.pause(),console.error(""),i(e==="y"||e==="yes")};try{if(typeof _.stdin.setRawMode==="function")_.stdin.setRawMode(!0)}catch{}_.stdin.resume(),_.stdin.once("data",n)})}setFancy(r){this.fancy=r}isFancy(){return this.fancy}pause(){this.enabled=!1}resume(){this.enabled=!0}async start(r,...i){if(!this.enabled)return;let n=r;if(i&&i.length>0){let o=/%([sdijfo%])/g,d=0;if(n=r.replace(o,(a,m)=>{if(m==="%")return"%";if(d>=i.length)return a;let p=i[d++];switch(m){case"s":return String(p);case"d":case"i":return Number(p).toString();case"j":case"o":return JSON.stringify(p,null,2);default:return a}}),d<i.length)n+=` ${i.slice(d).map((a)=>typeof a==="object"?JSON.stringify(a,null,2):String(a)).join(" ")}`}if(this.fancy&&!l()){let o=this.options.showTags!==!1&&this.name?c.gray(this.formatTag(this.name)):"",d=c.blue("\u25D0");console.error(`${d} ${o} ${c.cyan(n)}`)}let u=`[${new Date().toISOString()}] ${this.environment}.INFO: [START] ${n}
`.replace(this.ANSI_PATTERN,"");await this.writeToFile(u)}progress(r,i=""){if(!this.enabled||!this.fancy||l()||r<=0)return{update:()=>{},finish:()=>{},interrupt:()=>{}};if(this.activeProgressBar)console.warn("Warning: Another progress bar is already active. Finishing the previous one."),this.finishProgressBar(this.activeProgressBar,"[Auto-finished]");let n=20;return this.activeProgressBar={total:r,current:0,message:i,barLength:n,lastRenderedLine:""},this.renderProgressBar(this.activeProgressBar),{update:(o,d)=>{if(!this.activeProgressBar||!this.enabled||!this.fancy||l())return;if(this.activeProgressBar.current=Math.max(0,Math.min(r,o)),d!==void 0)this.activeProgressBar.message=d;let a=this.activeProgressBar.current===this.activeProgressBar.total;this.renderProgressBar(this.activeProgressBar,a)},finish:(o)=>{if(!this.activeProgressBar||!this.enabled||!this.fancy||l())return;if(this.activeProgressBar.current=this.activeProgressBar.total,o!==void 0)this.activeProgressBar.message=o;this.renderProgressBar(this.activeProgressBar,!0),this.finishProgressBar(this.activeProgressBar)},interrupt:(o,d="info")=>{if(!this.activeProgressBar||!this.enabled||!this.fancy||l())return;_.stdout.write(`${"\r".padEnd(_.stdout.columns||80)}\r`),this.log(d,o),setTimeout(()=>{if(this.activeProgressBar)this.renderProgressBar(this.activeProgressBar)},50)}}}renderProgressBar(r,i=!1){if(!this.enabled||!this.fancy||l()||!_.stdout.isTTY)return;let n=Math.min(100,Math.max(0,Math.round(r.current/r.total*100))),t=Math.round(r.barLength*n/100),e=r.barLength-t,u=c.green("\u2501".repeat(t)),o=c.gray("\u2501".repeat(e)),d=`[${u}${o}]`,a=`${n}%`.padStart(4),m=r.message?` ${r.message}`:"",p=i||n===100?c.green("\u2713"):c.blue("\u25B6"),b=this.options.showTags!==!1&&this.name?` ${c.gray(this.formatTag(this.name))}`:"",x=`\r${p}${b} ${d} ${a}${m}`,s=_.stdout.columns||80,lr=" ".repeat(Math.max(0,s-x.replace(this.ANSI_PATTERN,"").length));if(r.lastRenderedLine=`${x}${lr}`,_.stdout.write(r.lastRenderedLine),i)_.stdout.write(`
`)}finishProgressBar(r,i){if(!this.enabled||!this.fancy||l()||!_.stdout.isTTY){this.activeProgressBar=null;return}if(r.current<r.total)r.current=r.total;if(i)r.message=i;this.renderProgressBar(r,!0),this.activeProgressBar=null}async clear(r={}){if(l()){console.warn("Log clearing is not supported in browser environments.");return}try{console.warn("Clearing logs...",this.config.logDirectory);let i=await Y(this.config.logDirectory),n=[];for(let t of i){if(!(r.name?new RegExp(r.name.replace("*",".*")).test(t):t.startsWith(this.name))||!t.endsWith(".log"))continue;let u=D(this.config.logDirectory,t);if(r.before)try{if((await v(u)).mtime>=r.before)continue}catch(o){console.error(`Failed to get stats for file ${u}:`,o);continue}n.push(u)}if(n.length===0){console.warn("No log files matched the criteria for clearing.");return}console.warn(`Preparing to delete ${n.length} log file(s)...`);for(let t of n)try{await J(t),console.warn(`Deleted log file: ${t}`)}catch(e){console.error(`Failed to delete log file ${t}:`,e)}console.warn("Log clearing process finished.")}catch(i){console.error("Error during log clearing process:",i)}}}var Di=new q("stacks");import{handleError as jr}from"@stacksjs/error-handling";import*as gr from"@stacksjs/path";var fr=new Set([".","!","?"]),Zi=new Set([...fr,":",'"',"'","\u201D"]);var N=[],X=[],ur={},C={},U={};function ar(r){return typeof r==="string"?new RegExp(`^${r}$`,"i"):r}function k(r,i){if(r===i)return i;if(r===r.toLowerCase())return i.toLowerCase();if(r===r.toUpperCase())return i.toUpperCase();if(r[0]===r[0].toUpperCase())return i.charAt(0).toUpperCase()+i.slice(1).toLowerCase();return i.toLowerCase()}function Vr(r,...i){return r.replace(/\$(\d{1,2})/g,(n,t)=>i[Number(t)]||"")}function Lr(r,i){return r.replace(i[0],(...n)=>{let t=Vr(i[1],...n);if(n[0]==="")return k(r[n[n.length-2]-1],t);return k(n[0],t)})}function dr(r,i,n){if(!r.length||ur[r])return i;for(let t=n.length-1;t>=0;t--){let e=n[t];if(e[0].test(i))return Lr(i,e)}return i}function mr(r,i,n){return(t)=>{let e=t.toLowerCase();if(i[e])return k(t,e);if(r[e])return k(t,r[e]);return dr(e,t,n)}}function pr(r,i,n){return(t)=>{let e=t.toLowerCase();if(i[e])return!0;if(r[e])return!1;return dr(e,e,n)===e}}var h=(r,i={})=>{let{count:n=2,inclusive:t=!1}=i;if(typeof r!=="string")throw new TypeError("Word must be a string");let e=n===1?h.singular(r):h.plural(r);return t?`${n} ${e}`:e};h.plural=mr(U,C,N);h.isPlural=pr(U,C,N);h.singular=mr(C,U,X);h.isSingular=pr(C,U,X);h.addPluralRule=(r,i)=>{N.push([ar(r),i])};h.addSingularRule=(r,i)=>{X.push([ar(r),i])};h.addUncountableRule=(r)=>{if(typeof r==="string"){ur[r.toLowerCase()]=!0;return}h.addPluralRule(r,"$0"),h.addSingularRule(r,"$0")};h.addIrregularRule=(r,i)=>{let n=i.toLowerCase(),t=r.toLowerCase();U[t]=n,C[n]=t};[["I","we"],["me","us"],["he","they"],["she","they"],["them","them"],["myself","ourselves"],["yourself","yourselves"],["itself","themselves"],["herself","themselves"],["himself","themselves"],["themself","themselves"],["is","are"],["was","were"],["has","have"],["this","these"],["that","those"],["my","our"],["its","their"],["his","their"],["her","their"],["echo","echoes"],["dingo","dingoes"],["volcano","volcanoes"],["tornado","tornadoes"],["torpedo","torpedoes"],["genus","genera"],["viscus","viscera"],["stigma","stigmata"],["stoma","stomata"],["dogma","dogmata"],["lemma","lemmata"],["schema","schemata"],["anathema","anathemata"],["ox","oxen"],["axe","axes"],["die","dice"],["yes","yeses"],["foot","feet"],["eave","eaves"],["goose","geese"],["tooth","teeth"],["quiz","quizzes"],["human","humans"],["proof","proofs"],["carve","carves"],["valve","valves"],["looey","looies"],["thief","thieves"],["groove","grooves"],["pickaxe","pickaxes"],["passerby","passersby"],["canvas","canvases"]].forEach(([r,i])=>h.addIrregularRule(r,i));[[/s?$/i,"s"],[/[^\x20-\x7F]$/,"$0"],[/([^aeiou]ese)$/i,"$1"],[/(ax|test)is$/i,"$1es"],[/(alias|[^aou]us|t[lm]as|gas|ris)$/i,"$1es"],[/(e[mn]u)s?$/i,"$1s"],[/([^l]ias|[aeiou]las|[ejzr]as|[iu]am)$/i,"$1"],[/(alumn|syllab|vir|radi|nucle|fung|cact|stimul|termin|bacill|foc|uter|loc|strat)(?:us|i)$/i,"$1i"],[/(alumn|alg|vertebr)(?:a|ae)$/i,"$1ae"],[/(seraph|cherub)(?:im)?$/i,"$1im"],[/(her|at|gr)o$/i,"$1oes"],[/(agend|addend|millenni|dat|extrem|bacteri|desiderat|strat|candelabr|errat|ov|symposi|curricul|automat|quor)(?:a|um)$/i,"$1a"],[/(apheli|hyperbat|periheli|asyndet|noumen|phenomen|criteri|organ|prolegomen|hedr|automat)(?:a|on)$/i,"$1a"],[/sis$/i,"ses"],[/(?:(kni|wi|li)fe|(ar|l|ea|eo|oa|hoo)f)$/i,"$1$2ves"],[/([^aeiouy]|qu)y$/i,"$1ies"],[/([^ch][ieo][ln])ey$/i,"$1ies"],[/(x|ch|ss|sh|zz)$/i,"$1es"],[/(matr|cod|mur|sil|vert|ind|append)(?:ix|ex)$/i,"$1ices"],[/\b((?:tit)?m|l)(?:ice|ouse)$/i,"$1ice"],[/(pe)(?:rson|ople)$/i,"$1ople"],[/(child)(?:ren)?$/i,"$1ren"],[/eaux$/i,"$0"],[/m[ae]n$/i,"men"],["thou","you"]].forEach(([r,i])=>h.addPluralRule(r,i));[[/s$/i,""],[/(ss)$/i,"$1"],[/(wi|kni|(?:after|half|high|low|mid|non|night|\W|^)li)ves$/i,"$1fe"],[/(ar|(?:wo|[ae])l|[eo][ao])ves$/i,"$1f"],[/ies$/i,"y"],[/(dg|ss|ois|lk|ok|wn|mb|th|ch|ec|oal|is|ck|ix|sser|ts|wb)ies$/i,"$1ie"],[/\b(l|(?:neck|cross|hog|aun)?t|coll|faer|food|gen|goon|group|hipp|junk|vegg|(?:pork)?p|charl|calor|cut)ies$/i,"$1ie"],[/\b(mon|smil)ies$/i,"$1ey"],[/\b((?:tit)?m|l)ice$/i,"$1ouse"],[/(seraph|cherub)im$/i,"$1"],[/(x|ch|ss|sh|zz|tto|go|cho|alias|[^aou]us|t[lm]as|gas|(?:her|at|gr)o|[aeiou]ris)(?:es)?$/i,"$1"],[/(analy|diagno|parenthe|progno|synop|the|empha|cri|ne)(?:sis|ses)$/i,"$1sis"],[/(movie|twelve|abuse|e[mn]u)s$/i,"$1"],[/(test)(?:is|es)$/i,"$1is"],[/(alumn|syllab|vir|radi|nucle|fung|cact|stimul|termin|bacill|foc|uter|loc|strat)(?:us|i)$/i,"$1us"],[/(agend|addend|millenni|dat|extrem|bacteri|desiderat|strat|candelabr|errat|ov|symposi|curricul|quor)a$/i,"$1um"],[/(apheli|hyperbat|periheli|asyndet|noumen|phenomen|criteri|organ|prolegomen|hedr|automat)a$/i,"$1on"],[/(alumn|alg|vertebr)ae$/i,"$1a"],[/(cod|mur|sil|vert|ind)ices$/i,"$1ex"],[/(matr|append)ices$/i,"$1ix"],[/(pe)(rson|ople)$/i,"$1rson"],[/(child)ren$/i,"$1"],[/(eau)x?$/i,"$1"],[/men$/i,"man"]].forEach(([r,i])=>h.addSingularRule(r,i));["adulthood","advice","agenda","aid","aircraft","alcohol","ammo","analytics","anime","athletics","audio","bison","blood","bream","buffalo","butter","carp","cash","chassis","chess","clothing","cod","commerce","cooperation","corps","debris","diabetes","digestion","elk","energy","equipment","excretion","expertise","firmware","flounder","fun","gallows","garbage","graffiti","hardware","headquarters","health","herpes","highjinks","homework","housework","information","jeans","justice","kudos","labour","literature","machinery","mackerel","mail","media","mews","moose","music","mud","manga","news","only","personnel","pike","plankton","pliers","police","pollution","premises","rain","research","rice","salmon","scissors","series","sewage","shambles","shrimp","software","staff","swine","tennis","traffic","transportation","trout","tuna","wealth","welfare","whiting","wildebeest","wildlife","you",/pok[e\u00E9]mon$/i,/[^aeiou]ese$/i,/deer$/i,/fish$/i,/measles$/i,/o[iu]s$/i,/pox$/i,/sheep$/i].forEach(h.addUncountableRule);var fi=JSON.parse('{"$":"dollar","%":"percent","&":"and","<":"less",">":"greater","|":"or","\xA2":"cent","\xA3":"pound","\xA4":"currency","\xA5":"yen","\xA9":"(c)","\xAA":"a","\xAE":"(r)","\xBA":"o","\xC0":"A","\xC1":"A","\xC2":"A","\xC3":"A","\xC4":"A","\xC5":"A","\xC6":"AE","\xC7":"C","\xC8":"E","\xC9":"E","\xCA":"E","\xCB":"E","\xCC":"I","\xCD":"I","\xCE":"I","\xCF":"I","\xD0":"D","\xD1":"N","\xD2":"O","\xD3":"O","\xD4":"O","\xD5":"O","\xD6":"O","\xD8":"O","\xD9":"U","\xDA":"U","\xDB":"U","\xDC":"U","\xDD":"Y","\xDE":"TH","\xDF":"ss","\xE0":"a","\xE1":"a","\xE2":"a","\xE3":"a","\xE4":"a","\xE5":"a","\xE6":"ae","\xE7":"c","\xE8":"e","\xE9":"e","\xEA":"e","\xEB":"e","\xEC":"i","\xED":"i","\xEE":"i","\xEF":"i","\xF0":"d","\xF1":"n","\xF2":"o","\xF3":"o","\xF4":"o","\xF5":"o","\xF6":"o","\xF8":"o","\xF9":"u","\xFA":"u","\xFB":"u","\xFC":"u","\xFD":"y","\xFE":"th","\xFF":"y","\u0100":"A","\u0101":"a","\u0102":"A","\u0103":"a","\u0104":"A","\u0105":"a","\u0106":"C","\u0107":"c","\u010C":"C","\u010D":"c","\u010E":"D","\u010F":"d","\u0110":"DJ","\u0111":"dj","\u0112":"E","\u0113":"e","\u0116":"E","\u0117":"e","\u0118":"e","\u0119":"e","\u011A":"E","\u011B":"e","\u011E":"G","\u011F":"g","\u0122":"G","\u0123":"g","\u0128":"I","\u0129":"i","\u012A":"i","\u012B":"i","\u012E":"I","\u012F":"i","\u0130":"I","\u0131":"i","\u0136":"k","\u0137":"k","\u013B":"L","\u013C":"l","\u013D":"L","\u013E":"l","\u0141":"L","\u0142":"l","\u0143":"N","\u0144":"n","\u0145":"N","\u0146":"n","\u0147":"N","\u0148":"n","\u014C":"O","\u014D":"o","\u0150":"O","\u0151":"o","\u0152":"OE","\u0153":"oe","\u0154":"R","\u0155":"r","\u0158":"R","\u0159":"r","\u015A":"S","\u015B":"s","\u015E":"S","\u015F":"s","\u0160":"S","\u0161":"s","\u0162":"T","\u0163":"t","\u0164":"T","\u0165":"t","\u0168":"U","\u0169":"u","\u016A":"u","\u016B":"u","\u016E":"U","\u016F":"u","\u0170":"U","\u0171":"u","\u0172":"U","\u0173":"u","\u0174":"W","\u0175":"w","\u0176":"Y","\u0177":"y","\u0178":"Y","\u0179":"Z","\u017A":"z","\u017B":"Z","\u017C":"z","\u017D":"Z","\u017E":"z","\u018F":"E","\u0192":"f","\u01A0":"O","\u01A1":"o","\u01AF":"U","\u01B0":"u","\u01C8":"LJ","\u01C9":"lj","\u01CB":"NJ","\u01CC":"nj","\u0218":"S","\u0219":"s","\u021A":"T","\u021B":"t","\u0259":"e","\u02DA":"o","\u0386":"A","\u0388":"E","\u0389":"H","\u038A":"I","\u038C":"O","\u038E":"Y","\u038F":"W","\u0390":"i","\u0391":"A","\u0392":"B","\u0393":"G","\u0394":"D","\u0395":"E","\u0396":"Z","\u0397":"H","\u0398":"8","\u0399":"I","\u039A":"K","\u039B":"L","\u039C":"M","\u039D":"N","\u039E":"3","\u039F":"O","\u03A0":"P","\u03A1":"R","\u03A3":"S","\u03A4":"T","\u03A5":"Y","\u03A6":"F","\u03A7":"X","\u03A8":"PS","\u03A9":"W","\u03AA":"I","\u03AB":"Y","\u03AC":"a","\u03AD":"e","\u03AE":"h","\u03AF":"i","\u03B0":"y","\u03B1":"a","\u03B2":"b","\u03B3":"g","\u03B4":"d","\u03B5":"e","\u03B6":"z","\u03B7":"h","\u03B8":"8","\u03B9":"i","\u03BA":"k","\u03BB":"l","\u03BC":"m","\u03BD":"n","\u03BE":"3","\u03BF":"o","\u03C0":"p","\u03C1":"r","\u03C2":"s","\u03C3":"s","\u03C4":"t","\u03C5":"y","\u03C6":"f","\u03C7":"x","\u03C8":"ps","\u03C9":"w","\u03CA":"i","\u03CB":"y","\u03CC":"o","\u03CD":"y","\u03CE":"w","\u0401":"Yo","\u0402":"DJ","\u0404":"Ye","\u0406":"I","\u0407":"Yi","\u0408":"J","\u0409":"LJ","\u040A":"NJ","\u040B":"C","\u040F":"DZ","\u0410":"A","\u0411":"B","\u0412":"V","\u0413":"G","\u0414":"D","\u0415":"E","\u0416":"Zh","\u0417":"Z","\u0418":"I","\u0419":"J","\u041A":"K","\u041B":"L","\u041C":"M","\u041D":"N","\u041E":"O","\u041F":"P","\u0420":"R","\u0421":"S","\u0422":"T","\u0423":"U","\u0424":"F","\u0425":"H","\u0426":"C","\u0427":"Ch","\u0428":"Sh","\u0429":"Sh","\u042A":"U","\u042B":"Y","\u042C":"","\u042D":"E","\u042E":"Yu","\u042F":"Ya","\u0430":"a","\u0431":"b","\u0432":"v","\u0433":"g","\u0434":"d","\u0435":"e","\u0436":"zh","\u0437":"z","\u0438":"i","\u0439":"j","\u043A":"k","\u043B":"l","\u043C":"m","\u043D":"n","\u043E":"o","\u043F":"p","\u0440":"r","\u0441":"s","\u0442":"t","\u0443":"u","\u0444":"f","\u0445":"h","\u0446":"c","\u0447":"ch","\u0448":"sh","\u0449":"sh","\u044A":"u","\u044B":"y","\u044C":"","\u044D":"e","\u044E":"yu","\u044F":"ya","\u0451":"yo","\u0452":"dj","\u0454":"ye","\u0456":"i","\u0457":"yi","\u0458":"j","\u0459":"lj","\u045A":"nj","\u045B":"c","\u045D":"u","\u045F":"dz","\u0490":"G","\u0491":"g","\u0492":"GH","\u0493":"gh","\u049A":"KH","\u049B":"kh","\u04A2":"NG","\u04A3":"ng","\u04AE":"UE","\u04AF":"ue","\u04B0":"U","\u04B1":"u","\u04BA":"H","\u04BB":"h","\u04D8":"AE","\u04D9":"ae","\u04E8":"OE","\u04E9":"oe","\u0531":"A","\u0532":"B","\u0533":"G","\u0534":"D","\u0535":"E","\u0536":"Z","\u0537":"E\'","\u0538":"Y\'","\u0539":"T\'","\u053A":"JH","\u053B":"I","\u053C":"L","\u053D":"X","\u053E":"C\'","\u053F":"K","\u0540":"H","\u0541":"D\'","\u0542":"GH","\u0543":"TW","\u0544":"M","\u0545":"Y","\u0546":"N","\u0547":"SH","\u0549":"CH","\u054A":"P","\u054B":"J","\u054C":"R\'","\u054D":"S","\u054E":"V","\u054F":"T","\u0550":"R","\u0551":"C","\u0553":"P\'","\u0554":"Q\'","\u0555":"O\'\'","\u0556":"F","\u0587":"EV","\u0621":"a","\u0622":"aa","\u0623":"a","\u0624":"u","\u0625":"i","\u0626":"e","\u0627":"a","\u0628":"b","\u0629":"h","\u062A":"t","\u062B":"th","\u062C":"j","\u062D":"h","\u062E":"kh","\u062F":"d","\u0630":"th","\u0631":"r","\u0632":"z","\u0633":"s","\u0634":"sh","\u0635":"s","\u0636":"dh","\u0637":"t","\u0638":"z","\u0639":"a","\u063A":"gh","\u0641":"f","\u0642":"q","\u0643":"k","\u0644":"l","\u0645":"m","\u0646":"n","\u0647":"h","\u0648":"w","\u0649":"a","\u064A":"y","\u064B":"an","\u064C":"on","\u064D":"en","\u064E":"a","\u064F":"u","\u0650":"e","\u0652":"","\u0660":"0","\u0661":"1","\u0662":"2","\u0663":"3","\u0664":"4","\u0665":"5","\u0666":"6","\u0667":"7","\u0668":"8","\u0669":"9","\u067E":"p","\u0686":"ch","\u0698":"zh","\u06A9":"k","\u06AF":"g","\u06CC":"y","\u06F0":"0","\u06F1":"1","\u06F2":"2","\u06F3":"3","\u06F4":"4","\u06F5":"5","\u06F6":"6","\u06F7":"7","\u06F8":"8","\u06F9":"9","\u0E3F":"baht","\u10D0":"a","\u10D1":"b","\u10D2":"g","\u10D3":"d","\u10D4":"e","\u10D5":"v","\u10D6":"z","\u10D7":"t","\u10D8":"i","\u10D9":"k","\u10DA":"l","\u10DB":"m","\u10DC":"n","\u10DD":"o","\u10DE":"p","\u10DF":"zh","\u10E0":"r","\u10E1":"s","\u10E2":"t","\u10E3":"u","\u10E4":"f","\u10E5":"k","\u10E6":"gh","\u10E7":"q","\u10E8":"sh","\u10E9":"ch","\u10EA":"ts","\u10EB":"dz","\u10EC":"ts","\u10ED":"ch","\u10EE":"kh","\u10EF":"j","\u10F0":"h","\u1E62":"S","\u1E63":"s","\u1E80":"W","\u1E81":"w","\u1E82":"W","\u1E83":"w","\u1E84":"W","\u1E85":"w","\u1E9E":"SS","\u1EA0":"A","\u1EA1":"a","\u1EA2":"A","\u1EA3":"a","\u1EA4":"A","\u1EA5":"a","\u1EA6":"A","\u1EA7":"a","\u1EA8":"A","\u1EA9":"a","\u1EAA":"A","\u1EAB":"a","\u1EAC":"A","\u1EAD":"a","\u1EAE":"A","\u1EAF":"a","\u1EB0":"A","\u1EB1":"a","\u1EB2":"A","\u1EB3":"a","\u1EB4":"A","\u1EB5":"a","\u1EB6":"A","\u1EB7":"a","\u1EB8":"E","\u1EB9":"e","\u1EBA":"E","\u1EBB":"e","\u1EBC":"E","\u1EBD":"e","\u1EBE":"E","\u1EBF":"e","\u1EC0":"E","\u1EC1":"e","\u1EC2":"E","\u1EC3":"e","\u1EC4":"E","\u1EC5":"e","\u1EC6":"E","\u1EC7":"e","\u1EC8":"I","\u1EC9":"i","\u1ECA":"I","\u1ECB":"i","\u1ECC":"O","\u1ECD":"o","\u1ECE":"O","\u1ECF":"o","\u1ED0":"O","\u1ED1":"o","\u1ED2":"O","\u1ED3":"o","\u1ED4":"O","\u1ED5":"o","\u1ED6":"O","\u1ED7":"o","\u1ED8":"O","\u1ED9":"o","\u1EDA":"O","\u1EDB":"o","\u1EDC":"O","\u1EDD":"o","\u1EDE":"O","\u1EDF":"o","\u1EE0":"O","\u1EE1":"o","\u1EE2":"O","\u1EE3":"o","\u1EE4":"U","\u1EE5":"u","\u1EE6":"U","\u1EE7":"u","\u1EE8":"U","\u1EE9":"u","\u1EEA":"U","\u1EEB":"u","\u1EEC":"U","\u1EED":"u","\u1EEE":"U","\u1EEF":"u","\u1EF0":"U","\u1EF1":"u","\u1EF2":"Y","\u1EF3":"y","\u1EF4":"Y","\u1EF5":"y","\u1EF6":"Y","\u1EF7":"y","\u1EF8":"Y","\u1EF9":"y","\u2013":"-","\u2018":"\'","\u2019":"\'","\u201C":"\\"","\u201D":"\\"","\u201E":"\\"","\u2020":"+","\u2022":"*","\u2026":"...","\u20A0":"ecu","\u20A2":"cruzeiro","\u20A3":"french franc","\u20A4":"lira","\u20A5":"mill","\u20A6":"naira","\u20A7":"peseta","\u20A8":"rupee","\u20A9":"won","\u20AA":"new shequel","\u20AB":"dong","\u20AC":"euro","\u20AD":"kip","\u20AE":"tugrik","\u20AF":"drachma","\u20B0":"penny","\u20B1":"peso","\u20B2":"guarani","\u20B3":"austral","\u20B4":"hryvnia","\u20B5":"cedi","\u20B8":"kazakhstani tenge","\u20B9":"indian rupee","\u20BA":"turkish lira","\u20BD":"russian ruble","\u20BF":"bitcoin","\u2120":"sm","\u2122":"tm","\u2202":"d","\u2206":"delta","\u2211":"sum","\u221E":"infinity","\u2665":"love","\u5143":"yuan","\u5186":"yen","\uFDFC":"rial","\uFEF5":"laa","\uFEF7":"laa","\uFEF9":"lai","\uFEFB":"la"}'),Ai=JSON.parse('{"bg":{"\u0419":"Y","\u0426":"Ts","\u0429":"Sht","\u042A":"A","\u042C":"Y","\u0439":"y","\u0446":"ts","\u0449":"sht","\u044A":"a","\u044C":"y"},"de":{"\xC4":"AE","\xE4":"ae","\xD6":"OE","\xF6":"oe","\xDC":"UE","\xFC":"ue","\xDF":"ss","%":"prozent","&":"und","|":"oder","\u2211":"summe","\u221E":"unendlich","\u2665":"liebe"},"es":{"%":"por ciento","&":"y","<":"menor que",">":"mayor que","|":"o","\xA2":"centavos","\xA3":"libras","\xA4":"moneda","\u20A3":"francos","\u2211":"suma","\u221E":"infinito","\u2665":"amor"},"fr":{"%":"pourcent","&":"et","<":"plus petit",">":"plus grand","|":"ou","\xA2":"centime","\xA3":"livre","\xA4":"devise","\u20A3":"franc","\u2211":"somme","\u221E":"infini","\u2665":"amour"},"pt":{"%":"porcento","&":"e","<":"menor",">":"maior","|":"ou","\xA2":"centavo","\u2211":"soma","\xA3":"libra","\u221E":"infinito","\u2665":"amor"},"uk":{"\u0418":"Y","\u0438":"y","\u0419":"Y","\u0439":"y","\u0426":"Ts","\u0446":"ts","\u0425":"Kh","\u0445":"kh","\u0429":"Shch","\u0449":"shch","\u0413":"H","\u0433":"h"},"vi":{"\u0110":"D","\u0111":"d"},"da":{"\xD8":"OE","\xF8":"oe","\xC5":"AA","\xE5":"aa","%":"procent","&":"og","|":"eller","$":"dollar","<":"mindre end",">":"st\xF8rre end"},"nb":{"&":"og","\xC5":"AA","\xC6":"AE","\xD8":"OE","\xE5":"aa","\xE6":"ae","\xF8":"oe"},"it":{"&":"e"},"nl":{"&":"en"},"sv":{"&":"och","\xC5":"AA","\xC4":"AE","\xD6":"OE","\xE5":"aa","\xE4":"ae","\xF6":"oe"}}');var $=new q("stacks",{level:"debug",logDirectory:gr.projectPath("storage/logs"),showTags:!1,fancy:!0});function z(...r){return r.map((i)=>typeof i==="object"?JSON.stringify(i,null,2):String(i)).join(" ")}var j={info:async(...r)=>{let i=z(...r);await $.info(i)},success:async(r)=>{await $.success(r)},warn:async(r,i)=>{await $.warn(r,i)},warning:async(r)=>{await $.warn(r)},error:async(r,i)=>{let n=typeof r==="string"?r:r instanceof Error?r:JSON.stringify(r);await $.error(n),jr(r,i)},debug:async(...r)=>{let i=z(...r);await $.debug(i)},dump:(...r)=>{let i=z(...r);$.debug(`DUMP: ${i}`)},dd:(...r)=>{let i=z(...r);$.error(i),cr.exit(1)},echo:(...r)=>{let i=z(...r);$.info(`ECHO: ${i}`)},time:(r)=>{return $.time(r)}};function Et(...r){r.forEach((i)=>j.debug(i))}function It(...r){j.info(r),cr.exit(1)}function St(...r){j.debug(...r)}export{j as log,St as echo,Et as dump,It as dd};
