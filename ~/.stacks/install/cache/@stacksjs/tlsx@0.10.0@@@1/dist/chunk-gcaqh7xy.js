import{B as LX,v as xY,w as c,x as A0}from"./chunk-s5xt8spa.js";var o=c((tE,MZ)=>{MZ.exports={options:{usePureJavaScript:!1}}});var PZ=c((eE,DZ)=>{var E0={};DZ.exports=E0;var zZ={};E0.encode=function(J,$,Z){if(typeof $!=="string")throw new TypeError('"alphabet" must be a string.');if(Z!==void 0&&typeof Z!=="number")throw new TypeError('"maxline" must be a number.');var X="";if(!(J instanceof Uint8Array))X=gY(J,$);else{var Q=0,Y=$.length,U=$.charAt(0),G=[0];for(Q=0;Q<J.length;++Q){for(var E=0,W=J[Q];E<G.length;++E)W+=G[E]<<8,G[E]=W%Y,W=W/Y|0;while(W>0)G.push(W%Y),W=W/Y|0}for(Q=0;J[Q]===0&&Q<J.length-1;++Q)X+=U;for(Q=G.length-1;Q>=0;--Q)X+=$[G[Q]]}if(Z){var H=new RegExp(".{1,"+Z+"}","g");X=X.match(H).join(`\r
`)}return X};E0.decode=function(J,$){if(typeof J!=="string")throw new TypeError('"input" must be a string.');if(typeof $!=="string")throw new TypeError('"alphabet" must be a string.');var Z=zZ[$];if(!Z){Z=zZ[$]=[];for(var X=0;X<$.length;++X)Z[$.charCodeAt(X)]=X}J=J.replace(/\s/g,"");var Q=$.length,Y=$.charAt(0),U=[0];for(var X=0;X<J.length;X++){var G=Z[J.charCodeAt(X)];if(G===void 0)return;for(var E=0,W=G;E<U.length;++E)W+=U[E]*Q,U[E]=W&255,W>>=8;while(W>0)U.push(W&255),W>>=8}for(var H=0;J[H]===Y&&H<J.length-1;++H)U.push(0);if(typeof Buffer!=="undefined")return Buffer.from(U.reverse());return new Uint8Array(U.reverse())};function gY(J,$){var Z=0,X=$.length,Q=$.charAt(0),Y=[0];for(Z=0;Z<J.length();++Z){for(var U=0,G=J.at(Z);U<Y.length;++U)G+=Y[U]<<8,Y[U]=G%X,G=G/X|0;while(G>0)Y.push(G%X),G=G/X|0}var E="";for(Z=0;J.at(Z)===0&&Z<J.length()-1;++Z)E+=Q;for(Z=Y.length-1;Z>=0;--Z)E+=$[Y[Z]];return E}});var XJ=c((JH,TZ)=>{var KZ=o(),RZ=PZ(),R=TZ.exports=KZ.util=KZ.util||{};(function(){if(typeof process!=="undefined"&&process.nextTick){if(R.nextTick=process.nextTick,typeof setImmediate==="function")R.setImmediate=setImmediate;else R.setImmediate=R.nextTick;return}if(typeof setImmediate==="function"){R.setImmediate=function(){return setImmediate.apply(void 0,arguments)},R.nextTick=function(G){return setImmediate(G)};return}if(R.setImmediate=function(G){setTimeout(G,0)},typeof window!=="undefined"&&typeof window.postMessage==="function"){let G=function(E){if(E.source===window&&E.data===J){E.stopPropagation();var W=$.slice();$.length=0,W.forEach(function(H){H()})}};var U=G,J="forge.setImmediate",$=[];R.setImmediate=function(E){if($.push(E),$.length===1)window.postMessage(J,"*")},window.addEventListener("message",G,!0)}if(typeof MutationObserver!=="undefined"){var Z=Date.now(),X=!0,Q=document.createElement("div"),$=[];new MutationObserver(function(){var E=$.slice();$.length=0,E.forEach(function(W){W()})}).observe(Q,{attributes:!0});var Y=R.setImmediate;R.setImmediate=function(E){if(Date.now()-Z>15)Z=Date.now(),Y(E);else if($.push(E),$.length===1)Q.setAttribute("a",X=!X)}}R.nextTick=R.setImmediate})();R.isNodejs=typeof process!=="undefined"&&process.versions&&process.versions.node;R.globalScope=function(){if(R.isNodejs)return global;return typeof self==="undefined"?window:self}();R.isArray=Array.isArray||function(J){return Object.prototype.toString.call(J)==="[object Array]"};R.isArrayBuffer=function(J){return typeof ArrayBuffer!=="undefined"&&J instanceof ArrayBuffer};R.isArrayBufferView=function(J){return J&&R.isArrayBuffer(J.buffer)&&J.byteLength!==void 0};function EX(J){if(!(J===8||J===16||J===24||J===32))throw new Error("Only 8, 16, 24, or 32 bits supported: "+J)}R.ByteBuffer=H0;function H0(J){if(this.data="",this.read=0,typeof J==="string")this.data=J;else if(R.isArrayBuffer(J)||R.isArrayBufferView(J))if(typeof Buffer!=="undefined"&&J instanceof Buffer)this.data=J.toString("binary");else{var $=new Uint8Array(J);try{this.data=String.fromCharCode.apply(null,$)}catch(X){for(var Z=0;Z<$.length;++Z)this.putByte($[Z])}}else if(J instanceof H0||typeof J==="object"&&typeof J.data==="string"&&typeof J.read==="number")this.data=J.data,this.read=J.read;this._constructedStringLength=0}R.ByteStringBuffer=H0;var lY=4096;R.ByteStringBuffer.prototype._optimizeConstructedString=function(J){if(this._constructedStringLength+=J,this._constructedStringLength>lY)this.data.substr(0,1),this._constructedStringLength=0};R.ByteStringBuffer.prototype.length=function(){return this.data.length-this.read};R.ByteStringBuffer.prototype.isEmpty=function(){return this.length()<=0};R.ByteStringBuffer.prototype.putByte=function(J){return this.putBytes(String.fromCharCode(J))};R.ByteStringBuffer.prototype.fillWithByte=function(J,$){J=String.fromCharCode(J);var Z=this.data;while($>0){if($&1)Z+=J;if($>>>=1,$>0)J+=J}return this.data=Z,this._optimizeConstructedString($),this};R.ByteStringBuffer.prototype.putBytes=function(J){return this.data+=J,this._optimizeConstructedString(J.length),this};R.ByteStringBuffer.prototype.putString=function(J){return this.putBytes(R.encodeUtf8(J))};R.ByteStringBuffer.prototype.putInt16=function(J){return this.putBytes(String.fromCharCode(J>>8&255)+String.fromCharCode(J&255))};R.ByteStringBuffer.prototype.putInt24=function(J){return this.putBytes(String.fromCharCode(J>>16&255)+String.fromCharCode(J>>8&255)+String.fromCharCode(J&255))};R.ByteStringBuffer.prototype.putInt32=function(J){return this.putBytes(String.fromCharCode(J>>24&255)+String.fromCharCode(J>>16&255)+String.fromCharCode(J>>8&255)+String.fromCharCode(J&255))};R.ByteStringBuffer.prototype.putInt16Le=function(J){return this.putBytes(String.fromCharCode(J&255)+String.fromCharCode(J>>8&255))};R.ByteStringBuffer.prototype.putInt24Le=function(J){return this.putBytes(String.fromCharCode(J&255)+String.fromCharCode(J>>8&255)+String.fromCharCode(J>>16&255))};R.ByteStringBuffer.prototype.putInt32Le=function(J){return this.putBytes(String.fromCharCode(J&255)+String.fromCharCode(J>>8&255)+String.fromCharCode(J>>16&255)+String.fromCharCode(J>>24&255))};R.ByteStringBuffer.prototype.putInt=function(J,$){EX($);var Z="";do $-=8,Z+=String.fromCharCode(J>>$&255);while($>0);return this.putBytes(Z)};R.ByteStringBuffer.prototype.putSignedInt=function(J,$){if(J<0)J+=2<<$-1;return this.putInt(J,$)};R.ByteStringBuffer.prototype.putBuffer=function(J){return this.putBytes(J.getBytes())};R.ByteStringBuffer.prototype.getByte=function(){return this.data.charCodeAt(this.read++)};R.ByteStringBuffer.prototype.getInt16=function(){var J=this.data.charCodeAt(this.read)<<8^this.data.charCodeAt(this.read+1);return this.read+=2,J};R.ByteStringBuffer.prototype.getInt24=function(){var J=this.data.charCodeAt(this.read)<<16^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2);return this.read+=3,J};R.ByteStringBuffer.prototype.getInt32=function(){var J=this.data.charCodeAt(this.read)<<24^this.data.charCodeAt(this.read+1)<<16^this.data.charCodeAt(this.read+2)<<8^this.data.charCodeAt(this.read+3);return this.read+=4,J};R.ByteStringBuffer.prototype.getInt16Le=function(){var J=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8;return this.read+=2,J};R.ByteStringBuffer.prototype.getInt24Le=function(){var J=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16;return this.read+=3,J};R.ByteStringBuffer.prototype.getInt32Le=function(){var J=this.data.charCodeAt(this.read)^this.data.charCodeAt(this.read+1)<<8^this.data.charCodeAt(this.read+2)<<16^this.data.charCodeAt(this.read+3)<<24;return this.read+=4,J};R.ByteStringBuffer.prototype.getInt=function(J){EX(J);var $=0;do $=($<<8)+this.data.charCodeAt(this.read++),J-=8;while(J>0);return $};R.ByteStringBuffer.prototype.getSignedInt=function(J){var $=this.getInt(J),Z=2<<J-2;if($>=Z)$-=Z<<1;return $};R.ByteStringBuffer.prototype.getBytes=function(J){var $;if(J)J=Math.min(this.length(),J),$=this.data.slice(this.read,this.read+J),this.read+=J;else if(J===0)$="";else $=this.read===0?this.data:this.data.slice(this.read),this.clear();return $};R.ByteStringBuffer.prototype.bytes=function(J){return typeof J==="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+J)};R.ByteStringBuffer.prototype.at=function(J){return this.data.charCodeAt(this.read+J)};R.ByteStringBuffer.prototype.setAt=function(J,$){return this.data=this.data.substr(0,this.read+J)+String.fromCharCode($)+this.data.substr(this.read+J+1),this};R.ByteStringBuffer.prototype.last=function(){return this.data.charCodeAt(this.data.length-1)};R.ByteStringBuffer.prototype.copy=function(){var J=R.createBuffer(this.data);return J.read=this.read,J};R.ByteStringBuffer.prototype.compact=function(){if(this.read>0)this.data=this.data.slice(this.read),this.read=0;return this};R.ByteStringBuffer.prototype.clear=function(){return this.data="",this.read=0,this};R.ByteStringBuffer.prototype.truncate=function(J){var $=Math.max(0,this.length()-J);return this.data=this.data.substr(this.read,$),this.read=0,this};R.ByteStringBuffer.prototype.toHex=function(){var J="";for(var $=this.read;$<this.data.length;++$){var Z=this.data.charCodeAt($);if(Z<16)J+="0";J+=Z.toString(16)}return J};R.ByteStringBuffer.prototype.toString=function(){return R.decodeUtf8(this.bytes())};function pY(J,$){$=$||{},this.read=$.readOffset||0,this.growSize=$.growSize||1024;var Z=R.isArrayBuffer(J),X=R.isArrayBufferView(J);if(Z||X){if(Z)this.data=new DataView(J);else this.data=new DataView(J.buffer,J.byteOffset,J.byteLength);this.write="writeOffset"in $?$.writeOffset:this.data.byteLength;return}if(this.data=new DataView(new ArrayBuffer(0)),this.write=0,J!==null&&J!==void 0)this.putBytes(J);if("writeOffset"in $)this.write=$.writeOffset}R.DataBuffer=pY;R.DataBuffer.prototype.length=function(){return this.write-this.read};R.DataBuffer.prototype.isEmpty=function(){return this.length()<=0};R.DataBuffer.prototype.accommodate=function(J,$){if(this.length()>=J)return this;$=Math.max($||this.growSize,J);var Z=new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength),X=new Uint8Array(this.length()+$);return X.set(Z),this.data=new DataView(X.buffer),this};R.DataBuffer.prototype.putByte=function(J){return this.accommodate(1),this.data.setUint8(this.write++,J),this};R.DataBuffer.prototype.fillWithByte=function(J,$){this.accommodate($);for(var Z=0;Z<$;++Z)this.data.setUint8(J);return this};R.DataBuffer.prototype.putBytes=function(J,$){if(R.isArrayBufferView(J)){var Z=new Uint8Array(J.buffer,J.byteOffset,J.byteLength),X=Z.byteLength-Z.byteOffset;this.accommodate(X);var Q=new Uint8Array(this.data.buffer,this.write);return Q.set(Z),this.write+=X,this}if(R.isArrayBuffer(J)){var Z=new Uint8Array(J);this.accommodate(Z.byteLength);var Q=new Uint8Array(this.data.buffer);return Q.set(Z,this.write),this.write+=Z.byteLength,this}if(J instanceof R.DataBuffer||typeof J==="object"&&typeof J.read==="number"&&typeof J.write==="number"&&R.isArrayBufferView(J.data)){var Z=new Uint8Array(J.data.byteLength,J.read,J.length());this.accommodate(Z.byteLength);var Q=new Uint8Array(J.data.byteLength,this.write);return Q.set(Z),this.write+=Z.byteLength,this}if(J instanceof R.ByteStringBuffer)J=J.data,$="binary";if($=$||"binary",typeof J==="string"){var Y;if($==="hex")return this.accommodate(Math.ceil(J.length/2)),Y=new Uint8Array(this.data.buffer,this.write),this.write+=R.binary.hex.decode(J,Y,this.write),this;if($==="base64")return this.accommodate(Math.ceil(J.length/4)*3),Y=new Uint8Array(this.data.buffer,this.write),this.write+=R.binary.base64.decode(J,Y,this.write),this;if($==="utf8")J=R.encodeUtf8(J),$="binary";if($==="binary"||$==="raw")return this.accommodate(J.length),Y=new Uint8Array(this.data.buffer,this.write),this.write+=R.binary.raw.decode(Y),this;if($==="utf16")return this.accommodate(J.length*2),Y=new Uint16Array(this.data.buffer,this.write),this.write+=R.text.utf16.encode(Y),this;throw new Error("Invalid encoding: "+$)}throw Error("Invalid parameter: "+J)};R.DataBuffer.prototype.putBuffer=function(J){return this.putBytes(J),J.clear(),this};R.DataBuffer.prototype.putString=function(J){return this.putBytes(J,"utf16")};R.DataBuffer.prototype.putInt16=function(J){return this.accommodate(2),this.data.setInt16(this.write,J),this.write+=2,this};R.DataBuffer.prototype.putInt24=function(J){return this.accommodate(3),this.data.setInt16(this.write,J>>8&65535),this.data.setInt8(this.write,J>>16&255),this.write+=3,this};R.DataBuffer.prototype.putInt32=function(J){return this.accommodate(4),this.data.setInt32(this.write,J),this.write+=4,this};R.DataBuffer.prototype.putInt16Le=function(J){return this.accommodate(2),this.data.setInt16(this.write,J,!0),this.write+=2,this};R.DataBuffer.prototype.putInt24Le=function(J){return this.accommodate(3),this.data.setInt8(this.write,J>>16&255),this.data.setInt16(this.write,J>>8&65535,!0),this.write+=3,this};R.DataBuffer.prototype.putInt32Le=function(J){return this.accommodate(4),this.data.setInt32(this.write,J,!0),this.write+=4,this};R.DataBuffer.prototype.putInt=function(J,$){EX($),this.accommodate($/8);do $-=8,this.data.setInt8(this.write++,J>>$&255);while($>0);return this};R.DataBuffer.prototype.putSignedInt=function(J,$){if(EX($),this.accommodate($/8),J<0)J+=2<<$-1;return this.putInt(J,$)};R.DataBuffer.prototype.getByte=function(){return this.data.getInt8(this.read++)};R.DataBuffer.prototype.getInt16=function(){var J=this.data.getInt16(this.read);return this.read+=2,J};R.DataBuffer.prototype.getInt24=function(){var J=this.data.getInt16(this.read)<<8^this.data.getInt8(this.read+2);return this.read+=3,J};R.DataBuffer.prototype.getInt32=function(){var J=this.data.getInt32(this.read);return this.read+=4,J};R.DataBuffer.prototype.getInt16Le=function(){var J=this.data.getInt16(this.read,!0);return this.read+=2,J};R.DataBuffer.prototype.getInt24Le=function(){var J=this.data.getInt8(this.read)^this.data.getInt16(this.read+1,!0)<<8;return this.read+=3,J};R.DataBuffer.prototype.getInt32Le=function(){var J=this.data.getInt32(this.read,!0);return this.read+=4,J};R.DataBuffer.prototype.getInt=function(J){EX(J);var $=0;do $=($<<8)+this.data.getInt8(this.read++),J-=8;while(J>0);return $};R.DataBuffer.prototype.getSignedInt=function(J){var $=this.getInt(J),Z=2<<J-2;if($>=Z)$-=Z<<1;return $};R.DataBuffer.prototype.getBytes=function(J){var $;if(J)J=Math.min(this.length(),J),$=this.data.slice(this.read,this.read+J),this.read+=J;else if(J===0)$="";else $=this.read===0?this.data:this.data.slice(this.read),this.clear();return $};R.DataBuffer.prototype.bytes=function(J){return typeof J==="undefined"?this.data.slice(this.read):this.data.slice(this.read,this.read+J)};R.DataBuffer.prototype.at=function(J){return this.data.getUint8(this.read+J)};R.DataBuffer.prototype.setAt=function(J,$){return this.data.setUint8(J,$),this};R.DataBuffer.prototype.last=function(){return this.data.getUint8(this.write-1)};R.DataBuffer.prototype.copy=function(){return new R.DataBuffer(this)};R.DataBuffer.prototype.compact=function(){if(this.read>0){var J=new Uint8Array(this.data.buffer,this.read),$=new Uint8Array(J.byteLength);$.set(J),this.data=new DataView($),this.write-=this.read,this.read=0}return this};R.DataBuffer.prototype.clear=function(){return this.data=new DataView(new ArrayBuffer(0)),this.read=this.write=0,this};R.DataBuffer.prototype.truncate=function(J){return this.write=Math.max(0,this.length()-J),this.read=Math.min(this.read,this.write),this};R.DataBuffer.prototype.toHex=function(){var J="";for(var $=this.read;$<this.data.byteLength;++$){var Z=this.data.getUint8($);if(Z<16)J+="0";J+=Z.toString(16)}return J};R.DataBuffer.prototype.toString=function(J){var $=new Uint8Array(this.data,this.read,this.length());if(J=J||"utf8",J==="binary"||J==="raw")return R.binary.raw.encode($);if(J==="hex")return R.binary.hex.encode($);if(J==="base64")return R.binary.base64.encode($);if(J==="utf8")return R.text.utf8.decode($);if(J==="utf16")return R.text.utf16.decode($);throw new Error("Invalid encoding: "+J)};R.createBuffer=function(J,$){if($=$||"raw",J!==void 0&&$==="utf8")J=R.encodeUtf8(J);return new R.ByteBuffer(J)};R.fillString=function(J,$){var Z="";while($>0){if($&1)Z+=J;if($>>>=1,$>0)J+=J}return Z};R.xorBytes=function(J,$,Z){var X="",Q="",Y="",U=0,G=0;for(;Z>0;--Z,++U){if(Q=J.charCodeAt(U)^$.charCodeAt(U),G>=10)X+=Y,Y="",G=0;Y+=String.fromCharCode(Q),++G}return X+=Y,X};R.hexToBytes=function(J){var $="",Z=0;if(J.length&!0)Z=1,$+=String.fromCharCode(parseInt(J[0],16));for(;Z<J.length;Z+=2)$+=String.fromCharCode(parseInt(J.substr(Z,2),16));return $};R.bytesToHex=function(J){return R.createBuffer(J).toHex()};R.int32ToBytes=function(J){return String.fromCharCode(J>>24&255)+String.fromCharCode(J>>16&255)+String.fromCharCode(J>>8&255)+String.fromCharCode(J&255)};var C$="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",S$=[62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51],AZ="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz";R.encode64=function(J,$){var Z="",X="",Q,Y,U,G=0;while(G<J.length){if(Q=J.charCodeAt(G++),Y=J.charCodeAt(G++),U=J.charCodeAt(G++),Z+=C$.charAt(Q>>2),Z+=C$.charAt((Q&3)<<4|Y>>4),isNaN(Y))Z+="==";else Z+=C$.charAt((Y&15)<<2|U>>6),Z+=isNaN(U)?"=":C$.charAt(U&63);if($&&Z.length>$)X+=Z.substr(0,$)+`\r
`,Z=Z.substr($)}return X+=Z,X};R.decode64=function(J){J=J.replace(/[^A-Za-z0-9\+\/\=]/g,"");var $="",Z,X,Q,Y,U=0;while(U<J.length)if(Z=S$[J.charCodeAt(U++)-43],X=S$[J.charCodeAt(U++)-43],Q=S$[J.charCodeAt(U++)-43],Y=S$[J.charCodeAt(U++)-43],$+=String.fromCharCode(Z<<2|X>>4),Q!==64){if($+=String.fromCharCode((X&15)<<4|Q>>2),Y!==64)$+=String.fromCharCode((Q&3)<<6|Y)}return $};R.encodeUtf8=function(J){return unescape(encodeURIComponent(J))};R.decodeUtf8=function(J){return decodeURIComponent(escape(J))};R.binary={raw:{},hex:{},base64:{},base58:{},baseN:{encode:RZ.encode,decode:RZ.decode}};R.binary.raw.encode=function(J){return String.fromCharCode.apply(null,J)};R.binary.raw.decode=function(J,$,Z){var X=$;if(!X)X=new Uint8Array(J.length);Z=Z||0;var Q=Z;for(var Y=0;Y<J.length;++Y)X[Q++]=J.charCodeAt(Y);return $?Q-Z:X};R.binary.hex.encode=R.bytesToHex;R.binary.hex.decode=function(J,$,Z){var X=$;if(!X)X=new Uint8Array(Math.ceil(J.length/2));Z=Z||0;var Q=0,Y=Z;if(J.length&1)Q=1,X[Y++]=parseInt(J[0],16);for(;Q<J.length;Q+=2)X[Y++]=parseInt(J.substr(Q,2),16);return $?Y-Z:X};R.binary.base64.encode=function(J,$){var Z="",X="",Q,Y,U,G=0;while(G<J.byteLength){if(Q=J[G++],Y=J[G++],U=J[G++],Z+=C$.charAt(Q>>2),Z+=C$.charAt((Q&3)<<4|Y>>4),isNaN(Y))Z+="==";else Z+=C$.charAt((Y&15)<<2|U>>6),Z+=isNaN(U)?"=":C$.charAt(U&63);if($&&Z.length>$)X+=Z.substr(0,$)+`\r
`,Z=Z.substr($)}return X+=Z,X};R.binary.base64.decode=function(J,$,Z){var X=$;if(!X)X=new Uint8Array(Math.ceil(J.length/4)*3);J=J.replace(/[^A-Za-z0-9\+\/\=]/g,""),Z=Z||0;var Q,Y,U,G,E=0,W=Z;while(E<J.length)if(Q=S$[J.charCodeAt(E++)-43],Y=S$[J.charCodeAt(E++)-43],U=S$[J.charCodeAt(E++)-43],G=S$[J.charCodeAt(E++)-43],X[W++]=Q<<2|Y>>4,U!==64){if(X[W++]=(Y&15)<<4|U>>2,G!==64)X[W++]=(U&3)<<6|G}return $?W-Z:X.subarray(0,W)};R.binary.base58.encode=function(J,$){return R.binary.baseN.encode(J,AZ,$)};R.binary.base58.decode=function(J,$){return R.binary.baseN.decode(J,AZ,$)};R.text={utf8:{},utf16:{}};R.text.utf8.encode=function(J,$,Z){J=R.encodeUtf8(J);var X=$;if(!X)X=new Uint8Array(J.length);Z=Z||0;var Q=Z;for(var Y=0;Y<J.length;++Y)X[Q++]=J.charCodeAt(Y);return $?Q-Z:X};R.text.utf8.decode=function(J){return R.decodeUtf8(String.fromCharCode.apply(null,J))};R.text.utf16.encode=function(J,$,Z){var X=$;if(!X)X=new Uint8Array(J.length*2);var Q=new Uint16Array(X.buffer);Z=Z||0;var Y=Z,U=Z;for(var G=0;G<J.length;++G)Q[U++]=J.charCodeAt(G),Y+=2;return $?Y-Z:X};R.text.utf16.decode=function(J){return String.fromCharCode.apply(null,new Uint16Array(J.buffer))};R.deflate=function(J,$,Z){if($=R.decode64(J.deflate(R.encode64($)).rval),Z){var X=2,Q=$.charCodeAt(1);if(Q&32)X=6;$=$.substring(X,$.length-4)}return $};R.inflate=function(J,$,Z){var X=J.inflate(R.encode64($)).rval;return X===null?null:R.decode64(X)};var O0=function(J,$,Z){if(!J)throw new Error("WebStorage not available.");var X;if(Z===null)X=J.removeItem($);else Z=R.encode64(JSON.stringify(Z)),X=J.setItem($,Z);if(typeof X!=="undefined"&&X.rval!==!0){var Q=new Error(X.error.message);throw Q.id=X.error.id,Q.name=X.error.name,Q}},V0=function(J,$){if(!J)throw new Error("WebStorage not available.");var Z=J.getItem($);if(J.init)if(Z.rval===null){if(Z.error){var X=new Error(Z.error.message);throw X.id=Z.error.id,X.name=Z.error.name,X}Z=null}else Z=Z.rval;if(Z!==null)Z=JSON.parse(R.decode64(Z));return Z},cY=function(J,$,Z,X){var Q=V0(J,$);if(Q===null)Q={};Q[Z]=X,O0(J,$,Q)},nY=function(J,$,Z){var X=V0(J,$);if(X!==null)X=Z in X?X[Z]:null;return X},oY=function(J,$,Z){var X=V0(J,$);if(X!==null&&Z in X){delete X[Z];var Q=!0;for(var Y in X){Q=!1;break}if(Q)X=null;O0(J,$,X)}},aY=function(J,$){O0(J,$,null)},wX=function(J,$,Z){var X=null;if(typeof Z==="undefined")Z=["web","flash"];var Q,Y=!1,U=null;for(var G in Z){Q=Z[G];try{if(Q==="flash"||Q==="both"){if($[0]===null)throw new Error("Flash local storage not available.");X=J.apply(this,$),Y=Q==="flash"}if(Q==="web"||Q==="both")$[0]=localStorage,X=J.apply(this,$),Y=!0}catch(E){U=E}if(Y)break}if(!Y)throw U;return X};R.setItem=function(J,$,Z,X,Q){wX(cY,arguments,Q)};R.getItem=function(J,$,Z,X){return wX(nY,arguments,X)};R.removeItem=function(J,$,Z,X){wX(oY,arguments,X)};R.clearItems=function(J,$,Z){wX(aY,arguments,Z)};R.isEmpty=function(J){for(var $ in J)if(J.hasOwnProperty($))return!1;return!0};R.format=function(J){var $=/%./g,Z,X,Q=0,Y=[],U=0;while(Z=$.exec(J)){if(X=J.substring(U,$.lastIndex-2),X.length>0)Y.push(X);U=$.lastIndex;var G=Z[0][1];switch(G){case"s":case"o":if(Q<arguments.length)Y.push(arguments[Q+++1]);else Y.push("<?>");break;case"%":Y.push("%");break;default:Y.push("<%"+G+"?>")}}return Y.push(J.substring(U)),Y.join("")};R.formatNumber=function(J,$,Z,X){var Q=J,Y=isNaN($=Math.abs($))?2:$,U=Z===void 0?",":Z,G=X===void 0?".":X,E=Q<0?"-":"",W=parseInt(Q=Math.abs(+Q||0).toFixed(Y),10)+"",H=W.length>3?W.length%3:0;return E+(H?W.substr(0,H)+G:"")+W.substr(H).replace(/(\d{3})(?=\d)/g,"$1"+G)+(Y?U+Math.abs(Q-W).toFixed(Y).slice(2):"")};R.formatSize=function(J){if(J>=1073741824)J=R.formatNumber(J/1073741824,2,".","")+" GiB";else if(J>=1048576)J=R.formatNumber(J/1048576,2,".","")+" MiB";else if(J>=1024)J=R.formatNumber(J/1024,0)+" KiB";else J=R.formatNumber(J,0)+" bytes";return J};R.bytesFromIP=function(J){if(J.indexOf(".")!==-1)return R.bytesFromIPv4(J);if(J.indexOf(":")!==-1)return R.bytesFromIPv6(J);return null};R.bytesFromIPv4=function(J){if(J=J.split("."),J.length!==4)return null;var $=R.createBuffer();for(var Z=0;Z<J.length;++Z){var X=parseInt(J[Z],10);if(isNaN(X))return null;$.putByte(X)}return $.getBytes()};R.bytesFromIPv6=function(J){var $=0;J=J.split(":").filter(function(U){if(U.length===0)++$;return!0});var Z=(8-J.length+$)*2,X=R.createBuffer();for(var Q=0;Q<8;++Q){if(!J[Q]||J[Q].length===0){X.fillWithByte(0,Z),Z=0;continue}var Y=R.hexToBytes(J[Q]);if(Y.length<2)X.putByte(0);X.putBytes(Y)}return X.getBytes()};R.bytesToIP=function(J){if(J.length===4)return R.bytesToIPv4(J);if(J.length===16)return R.bytesToIPv6(J);return null};R.bytesToIPv4=function(J){if(J.length!==4)return null;var $=[];for(var Z=0;Z<J.length;++Z)$.push(J.charCodeAt(Z));return $.join(".")};R.bytesToIPv6=function(J){if(J.length!==16)return null;var $=[],Z=[],X=0;for(var Q=0;Q<J.length;Q+=2){var Y=R.bytesToHex(J[Q]+J[Q+1]);while(Y[0]==="0"&&Y!=="0")Y=Y.substr(1);if(Y==="0"){var U=Z[Z.length-1],G=$.length;if(!U||G!==U.end+1)Z.push({start:G,end:G});else if(U.end=G,U.end-U.start>Z[X].end-Z[X].start)X=Z.length-1}$.push(Y)}if(Z.length>0){var E=Z[X];if(E.end-E.start>0){if($.splice(E.start,E.end-E.start+1,""),E.start===0)$.unshift("");if(E.end===7)$.push("")}}return $.join(":")};R.estimateCores=function(J,$){if(typeof J==="function")$=J,J={};if(J=J||{},"cores"in R&&!J.update)return $(null,R.cores);if(typeof navigator!=="undefined"&&"hardwareConcurrency"in navigator&&navigator.hardwareConcurrency>0)return R.cores=navigator.hardwareConcurrency,$(null,R.cores);if(typeof Worker==="undefined")return R.cores=1,$(null,R.cores);if(typeof Blob==="undefined")return R.cores=2,$(null,R.cores);var Z=URL.createObjectURL(new Blob(["(",function(){self.addEventListener("message",function(U){var G=Date.now(),E=G+4;while(Date.now()<E);self.postMessage({st:G,et:E})})}.toString(),")()"],{type:"application/javascript"}));X([],5,16);function X(U,G,E){if(G===0){var W=Math.floor(U.reduce(function(H,O){return H+O},0)/U.length);return R.cores=Math.max(1,W),URL.revokeObjectURL(Z),$(null,R.cores)}Q(E,function(H,O){U.push(Y(E,O)),X(U,G-1,E)})}function Q(U,G){var E=[],W=[];for(var H=0;H<U;++H){var O=new Worker(Z);O.addEventListener("message",function(M){if(W.push(M.data),W.length===U){for(var P=0;P<U;++P)E[P].terminate();G(null,W)}}),E.push(O)}for(var H=0;H<U;++H)E[H].postMessage(H)}function Y(U,G){var E=[];for(var W=0;W<U;++W){var H=G[W],O=E[W]=[];for(var M=0;M<U;++M){if(W===M)continue;var P=G[M];if(H.st>P.st&&H.st<P.et||P.st>H.st&&P.st<H.et)O.push(M)}}return E.reduce(function(z,A){return Math.max(z,A.length)},0)}}});var IX=c(($H,NZ)=>{var NJ=o();XJ();NZ.exports=NJ.cipher=NJ.cipher||{};NJ.cipher.algorithms=NJ.cipher.algorithms||{};NJ.cipher.createCipher=function(J,$){var Z=J;if(typeof Z==="string"){if(Z=NJ.cipher.getAlgorithm(Z),Z)Z=Z()}if(!Z)throw new Error("Unsupported algorithm: "+J);return new NJ.cipher.BlockCipher({algorithm:Z,key:$,decrypt:!1})};NJ.cipher.createDecipher=function(J,$){var Z=J;if(typeof Z==="string"){if(Z=NJ.cipher.getAlgorithm(Z),Z)Z=Z()}if(!Z)throw new Error("Unsupported algorithm: "+J);return new NJ.cipher.BlockCipher({algorithm:Z,key:$,decrypt:!0})};NJ.cipher.registerAlgorithm=function(J,$){J=J.toUpperCase(),NJ.cipher.algorithms[J]=$};NJ.cipher.getAlgorithm=function(J){if(J=J.toUpperCase(),J in NJ.cipher.algorithms)return NJ.cipher.algorithms[J];return null};var q0=NJ.cipher.BlockCipher=function(J){this.algorithm=J.algorithm,this.mode=this.algorithm.mode,this.blockSize=this.mode.blockSize,this._finish=!1,this._input=null,this.output=null,this._op=J.decrypt?this.mode.decrypt:this.mode.encrypt,this._decrypt=J.decrypt,this.algorithm.initialize(J)};q0.prototype.start=function(J){J=J||{};var $={};for(var Z in J)$[Z]=J[Z];$.decrypt=this._decrypt,this._finish=!1,this._input=NJ.util.createBuffer(),this.output=J.output||NJ.util.createBuffer(),this.mode.start($)};q0.prototype.update=function(J){if(J)this._input.putBuffer(J);while(!this._op.call(this.mode,this._input,this.output,this._finish)&&!this._finish);this._input.compact()};q0.prototype.finish=function(J){if(J&&(this.mode.name==="ECB"||this.mode.name==="CBC"))this.mode.pad=function(Z){return J(this.blockSize,Z,!1)},this.mode.unpad=function(Z){return J(this.blockSize,Z,!0)};var $={};if($.decrypt=this._decrypt,$.overflow=this._input.length()%this.blockSize,!this._decrypt&&this.mode.pad){if(!this.mode.pad(this._input,$))return!1}if(this._finish=!0,this.update(),this._decrypt&&this.mode.unpad){if(!this.mode.unpad(this.output,$))return!1}if(this.mode.afterFinish){if(!this.mode.afterFinish(this.output,$))return!1}return!0}});var M0=c((XH,CZ)=>{var CJ=o();XJ();CJ.cipher=CJ.cipher||{};var s=CZ.exports=CJ.cipher.modes=CJ.cipher.modes||{};s.ecb=function(J){J=J||{},this.name="ECB",this.cipher=J.cipher,this.blockSize=J.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};s.ecb.prototype.start=function(J){};s.ecb.prototype.encrypt=function(J,$,Z){if(J.length()<this.blockSize&&!(Z&&J.length()>0))return!0;for(var X=0;X<this._ints;++X)this._inBlock[X]=J.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var X=0;X<this._ints;++X)$.putInt32(this._outBlock[X])};s.ecb.prototype.decrypt=function(J,$,Z){if(J.length()<this.blockSize&&!(Z&&J.length()>0))return!0;for(var X=0;X<this._ints;++X)this._inBlock[X]=J.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var X=0;X<this._ints;++X)$.putInt32(this._outBlock[X])};s.ecb.prototype.pad=function(J,$){var Z=J.length()===this.blockSize?this.blockSize:this.blockSize-J.length();return J.fillWithByte(Z,Z),!0};s.ecb.prototype.unpad=function(J,$){if($.overflow>0)return!1;var Z=J.length(),X=J.at(Z-1);if(X>this.blockSize<<2)return!1;return J.truncate(X),!0};s.cbc=function(J){J=J||{},this.name="CBC",this.cipher=J.cipher,this.blockSize=J.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints)};s.cbc.prototype.start=function(J){if(J.iv===null){if(!this._prev)throw new Error("Invalid IV parameter.");this._iv=this._prev.slice(0)}else if(!("iv"in J))throw new Error("Invalid IV parameter.");else this._iv=BX(J.iv,this.blockSize),this._prev=this._iv.slice(0)};s.cbc.prototype.encrypt=function(J,$,Z){if(J.length()<this.blockSize&&!(Z&&J.length()>0))return!0;for(var X=0;X<this._ints;++X)this._inBlock[X]=this._prev[X]^J.getInt32();this.cipher.encrypt(this._inBlock,this._outBlock);for(var X=0;X<this._ints;++X)$.putInt32(this._outBlock[X]);this._prev=this._outBlock};s.cbc.prototype.decrypt=function(J,$,Z){if(J.length()<this.blockSize&&!(Z&&J.length()>0))return!0;for(var X=0;X<this._ints;++X)this._inBlock[X]=J.getInt32();this.cipher.decrypt(this._inBlock,this._outBlock);for(var X=0;X<this._ints;++X)$.putInt32(this._prev[X]^this._outBlock[X]);this._prev=this._inBlock.slice(0)};s.cbc.prototype.pad=function(J,$){var Z=J.length()===this.blockSize?this.blockSize:this.blockSize-J.length();return J.fillWithByte(Z,Z),!0};s.cbc.prototype.unpad=function(J,$){if($.overflow>0)return!1;var Z=J.length(),X=J.at(Z-1);if(X>this.blockSize<<2)return!1;return J.truncate(X),!0};s.cfb=function(J){J=J||{},this.name="CFB",this.cipher=J.cipher,this.blockSize=J.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialBlock=new Array(this._ints),this._partialOutput=CJ.util.createBuffer(),this._partialBytes=0};s.cfb.prototype.start=function(J){if(!("iv"in J))throw new Error("Invalid IV parameter.");this._iv=BX(J.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};s.cfb.prototype.encrypt=function(J,$,Z){var X=J.length();if(X===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&X>=this.blockSize){for(var Q=0;Q<this._ints;++Q)this._inBlock[Q]=J.getInt32()^this._outBlock[Q],$.putInt32(this._inBlock[Q]);return}var Y=(this.blockSize-X)%this.blockSize;if(Y>0)Y=this.blockSize-Y;this._partialOutput.clear();for(var Q=0;Q<this._ints;++Q)this._partialBlock[Q]=J.getInt32()^this._outBlock[Q],this._partialOutput.putInt32(this._partialBlock[Q]);if(Y>0)J.read-=this.blockSize;else for(var Q=0;Q<this._ints;++Q)this._inBlock[Q]=this._partialBlock[Q];if(this._partialBytes>0)this._partialOutput.getBytes(this._partialBytes);if(Y>0&&!Z)return $.putBytes(this._partialOutput.getBytes(Y-this._partialBytes)),this._partialBytes=Y,!0;$.putBytes(this._partialOutput.getBytes(X-this._partialBytes)),this._partialBytes=0};s.cfb.prototype.decrypt=function(J,$,Z){var X=J.length();if(X===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&X>=this.blockSize){for(var Q=0;Q<this._ints;++Q)this._inBlock[Q]=J.getInt32(),$.putInt32(this._inBlock[Q]^this._outBlock[Q]);return}var Y=(this.blockSize-X)%this.blockSize;if(Y>0)Y=this.blockSize-Y;this._partialOutput.clear();for(var Q=0;Q<this._ints;++Q)this._partialBlock[Q]=J.getInt32(),this._partialOutput.putInt32(this._partialBlock[Q]^this._outBlock[Q]);if(Y>0)J.read-=this.blockSize;else for(var Q=0;Q<this._ints;++Q)this._inBlock[Q]=this._partialBlock[Q];if(this._partialBytes>0)this._partialOutput.getBytes(this._partialBytes);if(Y>0&&!Z)return $.putBytes(this._partialOutput.getBytes(Y-this._partialBytes)),this._partialBytes=Y,!0;$.putBytes(this._partialOutput.getBytes(X-this._partialBytes)),this._partialBytes=0};s.ofb=function(J){J=J||{},this.name="OFB",this.cipher=J.cipher,this.blockSize=J.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=CJ.util.createBuffer(),this._partialBytes=0};s.ofb.prototype.start=function(J){if(!("iv"in J))throw new Error("Invalid IV parameter.");this._iv=BX(J.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};s.ofb.prototype.encrypt=function(J,$,Z){var X=J.length();if(J.length()===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&X>=this.blockSize){for(var Q=0;Q<this._ints;++Q)$.putInt32(J.getInt32()^this._outBlock[Q]),this._inBlock[Q]=this._outBlock[Q];return}var Y=(this.blockSize-X)%this.blockSize;if(Y>0)Y=this.blockSize-Y;this._partialOutput.clear();for(var Q=0;Q<this._ints;++Q)this._partialOutput.putInt32(J.getInt32()^this._outBlock[Q]);if(Y>0)J.read-=this.blockSize;else for(var Q=0;Q<this._ints;++Q)this._inBlock[Q]=this._outBlock[Q];if(this._partialBytes>0)this._partialOutput.getBytes(this._partialBytes);if(Y>0&&!Z)return $.putBytes(this._partialOutput.getBytes(Y-this._partialBytes)),this._partialBytes=Y,!0;$.putBytes(this._partialOutput.getBytes(X-this._partialBytes)),this._partialBytes=0};s.ofb.prototype.decrypt=s.ofb.prototype.encrypt;s.ctr=function(J){J=J||{},this.name="CTR",this.cipher=J.cipher,this.blockSize=J.blockSize||16,this._ints=this.blockSize/4,this._inBlock=null,this._outBlock=new Array(this._ints),this._partialOutput=CJ.util.createBuffer(),this._partialBytes=0};s.ctr.prototype.start=function(J){if(!("iv"in J))throw new Error("Invalid IV parameter.");this._iv=BX(J.iv,this.blockSize),this._inBlock=this._iv.slice(0),this._partialBytes=0};s.ctr.prototype.encrypt=function(J,$,Z){var X=J.length();if(X===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&X>=this.blockSize)for(var Q=0;Q<this._ints;++Q)$.putInt32(J.getInt32()^this._outBlock[Q]);else{var Y=(this.blockSize-X)%this.blockSize;if(Y>0)Y=this.blockSize-Y;this._partialOutput.clear();for(var Q=0;Q<this._ints;++Q)this._partialOutput.putInt32(J.getInt32()^this._outBlock[Q]);if(Y>0)J.read-=this.blockSize;if(this._partialBytes>0)this._partialOutput.getBytes(this._partialBytes);if(Y>0&&!Z)return $.putBytes(this._partialOutput.getBytes(Y-this._partialBytes)),this._partialBytes=Y,!0;$.putBytes(this._partialOutput.getBytes(X-this._partialBytes)),this._partialBytes=0}jX(this._inBlock)};s.ctr.prototype.decrypt=s.ctr.prototype.encrypt;s.gcm=function(J){J=J||{},this.name="GCM",this.cipher=J.cipher,this.blockSize=J.blockSize||16,this._ints=this.blockSize/4,this._inBlock=new Array(this._ints),this._outBlock=new Array(this._ints),this._partialOutput=CJ.util.createBuffer(),this._partialBytes=0,this._R=3774873600};s.gcm.prototype.start=function(J){if(!("iv"in J))throw new Error("Invalid IV parameter.");var $=CJ.util.createBuffer(J.iv);this._cipherLength=0;var Z;if("additionalData"in J)Z=CJ.util.createBuffer(J.additionalData);else Z=CJ.util.createBuffer();if("tagLength"in J)this._tagLength=J.tagLength;else this._tagLength=128;if(this._tag=null,J.decrypt){if(this._tag=CJ.util.createBuffer(J.tag).getBytes(),this._tag.length!==this._tagLength/8)throw new Error("Authentication tag does not match tag length.")}this._hashBlock=new Array(this._ints),this.tag=null,this._hashSubkey=new Array(this._ints),this.cipher.encrypt([0,0,0,0],this._hashSubkey),this.componentBits=4,this._m=this.generateHashTable(this._hashSubkey,this.componentBits);var X=$.length();if(X===12)this._j0=[$.getInt32(),$.getInt32(),$.getInt32(),1];else{this._j0=[0,0,0,0];while($.length()>0)this._j0=this.ghash(this._hashSubkey,this._j0,[$.getInt32(),$.getInt32(),$.getInt32(),$.getInt32()]);this._j0=this.ghash(this._hashSubkey,this._j0,[0,0].concat(F0(X*8)))}this._inBlock=this._j0.slice(0),jX(this._inBlock),this._partialBytes=0,Z=CJ.util.createBuffer(Z),this._aDataLength=F0(Z.length()*8);var Q=Z.length()%this.blockSize;if(Q)Z.fillWithByte(0,this.blockSize-Q);this._s=[0,0,0,0];while(Z.length()>0)this._s=this.ghash(this._hashSubkey,this._s,[Z.getInt32(),Z.getInt32(),Z.getInt32(),Z.getInt32()])};s.gcm.prototype.encrypt=function(J,$,Z){var X=J.length();if(X===0)return!0;if(this.cipher.encrypt(this._inBlock,this._outBlock),this._partialBytes===0&&X>=this.blockSize){for(var Q=0;Q<this._ints;++Q)$.putInt32(this._outBlock[Q]^=J.getInt32());this._cipherLength+=this.blockSize}else{var Y=(this.blockSize-X)%this.blockSize;if(Y>0)Y=this.blockSize-Y;this._partialOutput.clear();for(var Q=0;Q<this._ints;++Q)this._partialOutput.putInt32(J.getInt32()^this._outBlock[Q]);if(Y<=0||Z){if(Z){var U=X%this.blockSize;this._cipherLength+=U,this._partialOutput.truncate(this.blockSize-U)}else this._cipherLength+=this.blockSize;for(var Q=0;Q<this._ints;++Q)this._outBlock[Q]=this._partialOutput.getInt32();this._partialOutput.read-=this.blockSize}if(this._partialBytes>0)this._partialOutput.getBytes(this._partialBytes);if(Y>0&&!Z)return J.read-=this.blockSize,$.putBytes(this._partialOutput.getBytes(Y-this._partialBytes)),this._partialBytes=Y,!0;$.putBytes(this._partialOutput.getBytes(X-this._partialBytes)),this._partialBytes=0}this._s=this.ghash(this._hashSubkey,this._s,this._outBlock),jX(this._inBlock)};s.gcm.prototype.decrypt=function(J,$,Z){var X=J.length();if(X<this.blockSize&&!(Z&&X>0))return!0;this.cipher.encrypt(this._inBlock,this._outBlock),jX(this._inBlock),this._hashBlock[0]=J.getInt32(),this._hashBlock[1]=J.getInt32(),this._hashBlock[2]=J.getInt32(),this._hashBlock[3]=J.getInt32(),this._s=this.ghash(this._hashSubkey,this._s,this._hashBlock);for(var Q=0;Q<this._ints;++Q)$.putInt32(this._outBlock[Q]^this._hashBlock[Q]);if(X<this.blockSize)this._cipherLength+=X%this.blockSize;else this._cipherLength+=this.blockSize};s.gcm.prototype.afterFinish=function(J,$){var Z=!0;if($.decrypt&&$.overflow)J.truncate(this.blockSize-$.overflow);this.tag=CJ.util.createBuffer();var X=this._aDataLength.concat(F0(this._cipherLength*8));this._s=this.ghash(this._hashSubkey,this._s,X);var Q=[];this.cipher.encrypt(this._j0,Q);for(var Y=0;Y<this._ints;++Y)this.tag.putInt32(this._s[Y]^Q[Y]);if(this.tag.truncate(this.tag.length()%(this._tagLength/8)),$.decrypt&&this.tag.bytes()!==this._tag)Z=!1;return Z};s.gcm.prototype.multiply=function(J,$){var Z=[0,0,0,0],X=$.slice(0);for(var Q=0;Q<128;++Q){var Y=J[Q/32|0]&1<<31-Q%32;if(Y)Z[0]^=X[0],Z[1]^=X[1],Z[2]^=X[2],Z[3]^=X[3];this.pow(X,X)}return Z};s.gcm.prototype.pow=function(J,$){var Z=J[3]&1;for(var X=3;X>0;--X)$[X]=J[X]>>>1|(J[X-1]&1)<<31;if($[0]=J[0]>>>1,Z)$[0]^=this._R};s.gcm.prototype.tableMultiply=function(J){var $=[0,0,0,0];for(var Z=0;Z<32;++Z){var X=Z/8|0,Q=J[X]>>>(7-Z%8)*4&15,Y=this._m[Z][Q];$[0]^=Y[0],$[1]^=Y[1],$[2]^=Y[2],$[3]^=Y[3]}return $};s.gcm.prototype.ghash=function(J,$,Z){return $[0]^=Z[0],$[1]^=Z[1],$[2]^=Z[2],$[3]^=Z[3],this.tableMultiply($)};s.gcm.prototype.generateHashTable=function(J,$){var Z=8/$,X=4*Z,Q=16*Z,Y=new Array(Q);for(var U=0;U<Q;++U){var G=[0,0,0,0],E=U/X|0,W=(X-1-U%X)*$;G[E]=1<<$-1<<W,Y[U]=this.generateSubHashTable(this.multiply(G,J),$)}return Y};s.gcm.prototype.generateSubHashTable=function(J,$){var Z=1<<$,X=Z>>>1,Q=new Array(Z);Q[X]=J.slice(0);var Y=X>>>1;while(Y>0)this.pow(Q[2*Y],Q[Y]=[]),Y>>=1;Y=2;while(Y<X){for(var U=1;U<Y;++U){var G=Q[Y],E=Q[U];Q[Y+U]=[G[0]^E[0],G[1]^E[1],G[2]^E[2],G[3]^E[3]]}Y*=2}Q[0]=[0,0,0,0];for(Y=X+1;Y<Z;++Y){var W=Q[Y^X];Q[Y]=[J[0]^W[0],J[1]^W[1],J[2]^W[2],J[3]^W[3]]}return Q};function BX(J,$){if(typeof J==="string")J=CJ.util.createBuffer(J);if(CJ.util.isArray(J)&&J.length>4){var Z=J;J=CJ.util.createBuffer();for(var X=0;X<Z.length;++X)J.putByte(Z[X])}if(J.length()<$)throw new Error("Invalid IV length; got "+J.length()+" bytes and expected "+$+" bytes.");if(!CJ.util.isArray(J)){var Q=[],Y=$/4;for(var X=0;X<Y;++X)Q.push(J.getInt32());J=Q}return J}function jX(J){J[J.length-1]=J[J.length-1]+1&4294967295}function F0(J){return[J/4294967296|0,J&4294967295]}});var L$=c((ZH,IZ)=>{var HJ=o();IX();M0();XJ();IZ.exports=HJ.aes=HJ.aes||{};HJ.aes.startEncrypting=function(J,$,Z,X){var Q=xX({key:J,output:Z,decrypt:!1,mode:X});return Q.start($),Q};HJ.aes.createEncryptionCipher=function(J,$){return xX({key:J,output:null,decrypt:!1,mode:$})};HJ.aes.startDecrypting=function(J,$,Z,X){var Q=xX({key:J,output:Z,decrypt:!0,mode:X});return Q.start($),Q};HJ.aes.createDecryptionCipher=function(J,$){return xX({key:J,output:null,decrypt:!0,mode:$})};HJ.aes.Algorithm=function(J,$){if(!P0)LZ();var Z=this;Z.name=J,Z.mode=new $({blockSize:16,cipher:{encrypt:function(X,Q){return D0(Z._w,X,Q,!1)},decrypt:function(X,Q){return D0(Z._w,X,Q,!0)}}}),Z._init=!1};HJ.aes.Algorithm.prototype.initialize=function(J){if(this._init)return;var $=J.key,Z;if(typeof $==="string"&&($.length===16||$.length===24||$.length===32))$=HJ.util.createBuffer($);else if(HJ.util.isArray($)&&($.length===16||$.length===24||$.length===32)){Z=$,$=HJ.util.createBuffer();for(var X=0;X<Z.length;++X)$.putByte(Z[X])}if(!HJ.util.isArray($)){Z=$,$=[];var Q=Z.length();if(Q===16||Q===24||Q===32){Q=Q>>>2;for(var X=0;X<Q;++X)$.push(Z.getInt32())}}if(!HJ.util.isArray($)||!($.length===4||$.length===6||$.length===8))throw new Error("Invalid key parameter.");var Y=this.mode.name,U=["CFB","OFB","CTR","GCM"].indexOf(Y)!==-1;this._w=wZ($,J.decrypt&&!U),this._init=!0};HJ.aes._expandKey=function(J,$){if(!P0)LZ();return wZ(J,$)};HJ.aes._updateBlock=D0;a$("AES-ECB",HJ.cipher.modes.ecb);a$("AES-CBC",HJ.cipher.modes.cbc);a$("AES-CFB",HJ.cipher.modes.cfb);a$("AES-OFB",HJ.cipher.modes.ofb);a$("AES-CTR",HJ.cipher.modes.ctr);a$("AES-GCM",HJ.cipher.modes.gcm);function a$(J,$){var Z=function(){return new HJ.aes.Algorithm(J,$)};HJ.cipher.registerAlgorithm(J,Z)}var P0=!1,o$=4,cJ,z0,SZ,h$,U$;function LZ(){P0=!0,SZ=[0,1,2,4,8,16,32,64,128,27,54];var J=new Array(256);for(var $=0;$<128;++$)J[$]=$<<1,J[$+128]=$+128<<1^283;cJ=new Array(256),z0=new Array(256),h$=new Array(4),U$=new Array(4);for(var $=0;$<4;++$)h$[$]=new Array(256),U$[$]=new Array(256);var Z=0,X=0,Q,Y,U,G,E,W,H;for(var $=0;$<256;++$){G=X^X<<1^X<<2^X<<3^X<<4,G=G>>8^G&255^99,cJ[Z]=G,z0[G]=Z,E=J[G],Q=J[Z],Y=J[Q],U=J[Y],W=E<<24^G<<16^G<<8^(G^E),H=(Q^Y^U)<<24^(Z^U)<<16^(Z^Y^U)<<8^(Z^Q^U);for(var O=0;O<4;++O)h$[O][Z]=W,U$[O][G]=H,W=W<<24|W>>>8,H=H<<24|H>>>8;if(Z===0)Z=X=1;else Z=Q^J[J[J[Q^U]]],X^=J[J[X]]}}function wZ(J,$){var Z=J.slice(0),X,Q=1,Y=Z.length,U=Y+6+1,G=o$*U;for(var E=Y;E<G;++E){if(X=Z[E-1],E%Y===0)X=cJ[X>>>16&255]<<24^cJ[X>>>8&255]<<16^cJ[X&255]<<8^cJ[X>>>24]^SZ[Q]<<24,Q++;else if(Y>6&&E%Y===4)X=cJ[X>>>24]<<24^cJ[X>>>16&255]<<16^cJ[X>>>8&255]<<8^cJ[X&255];Z[E]=Z[E-Y]^X}if($){var W,H=U$[0],O=U$[1],M=U$[2],P=U$[3],z=Z.slice(0);G=Z.length;for(var E=0,A=G-o$;E<G;E+=o$,A-=o$)if(E===0||E===G-o$)z[E]=Z[A],z[E+1]=Z[A+3],z[E+2]=Z[A+2],z[E+3]=Z[A+1];else for(var T=0;T<o$;++T)W=Z[A+T],z[E+(3&-T)]=H[cJ[W>>>24]]^O[cJ[W>>>16&255]]^M[cJ[W>>>8&255]]^P[cJ[W&255]];Z=z}return Z}function D0(J,$,Z,X){var Q=J.length/4-1,Y,U,G,E,W;if(X)Y=U$[0],U=U$[1],G=U$[2],E=U$[3],W=z0;else Y=h$[0],U=h$[1],G=h$[2],E=h$[3],W=cJ;var H,O,M,P,z,A,T;H=$[0]^J[0],O=$[X?3:1]^J[1],M=$[2]^J[2],P=$[X?1:3]^J[3];var C=3;for(var L=1;L<Q;++L)z=Y[H>>>24]^U[O>>>16&255]^G[M>>>8&255]^E[P&255]^J[++C],A=Y[O>>>24]^U[M>>>16&255]^G[P>>>8&255]^E[H&255]^J[++C],T=Y[M>>>24]^U[P>>>16&255]^G[H>>>8&255]^E[O&255]^J[++C],P=Y[P>>>24]^U[H>>>16&255]^G[O>>>8&255]^E[M&255]^J[++C],H=z,O=A,M=T;Z[0]=W[H>>>24]<<24^W[O>>>16&255]<<16^W[M>>>8&255]<<8^W[P&255]^J[++C],Z[X?3:1]=W[O>>>24]<<24^W[M>>>16&255]<<16^W[P>>>8&255]<<8^W[H&255]^J[++C],Z[2]=W[M>>>24]<<24^W[P>>>16&255]<<16^W[H>>>8&255]<<8^W[O&255]^J[++C],Z[X?1:3]=W[P>>>24]<<24^W[H>>>16&255]<<16^W[O>>>8&255]<<8^W[M&255]^J[++C]}function xX(J){J=J||{};var $=(J.mode||"CBC").toUpperCase(),Z="AES-"+$,X;if(J.decrypt)X=HJ.cipher.createDecipher(Z,J.key);else X=HJ.cipher.createCipher(Z,J.key);var Q=X.start;return X.start=function(Y,U){var G=null;if(U instanceof HJ.util.ByteBuffer)G=U,U={};U=U||{},U.output=G,U.iv=Y,Q.call(X,U)},X}});var w$=c((QH,BZ)=>{var HX=o();HX.pki=HX.pki||{};var K0=BZ.exports=HX.pki.oids=HX.oids=HX.oids||{};function j(J,$){K0[J]=$,K0[$]=J}function QJ(J,$){K0[J]=$}j("1.2.840.113549.1.1.1","rsaEncryption");j("1.2.840.113549.1.1.4","md5WithRSAEncryption");j("1.2.840.113549.1.1.5","sha1WithRSAEncryption");j("1.2.840.113549.1.1.7","RSAES-OAEP");j("1.2.840.113549.1.1.8","mgf1");j("1.2.840.113549.1.1.9","pSpecified");j("1.2.840.113549.1.1.10","RSASSA-PSS");j("1.2.840.113549.1.1.11","sha256WithRSAEncryption");j("1.2.840.113549.1.1.12","sha384WithRSAEncryption");j("1.2.840.113549.1.1.13","sha512WithRSAEncryption");j("1.3.101.112","EdDSA25519");j("1.2.840.10040.4.3","dsa-with-sha1");j("1.3.14.3.2.7","desCBC");j("1.3.14.3.2.26","sha1");j("1.3.14.3.2.29","sha1WithRSASignature");j("2.16.840.1.101.3.4.2.1","sha256");j("2.16.840.1.101.3.4.2.2","sha384");j("2.16.840.1.101.3.4.2.3","sha512");j("2.16.840.1.101.3.4.2.4","sha224");j("2.16.840.1.101.3.4.2.5","sha512-224");j("2.16.840.1.101.3.4.2.6","sha512-256");j("1.2.840.113549.2.2","md2");j("1.2.840.113549.2.5","md5");j("1.2.840.113549.1.7.1","data");j("1.2.840.113549.1.7.2","signedData");j("1.2.840.113549.1.7.3","envelopedData");j("1.2.840.113549.1.7.4","signedAndEnvelopedData");j("1.2.840.113549.1.7.5","digestedData");j("1.2.840.113549.1.7.6","encryptedData");j("1.2.840.113549.1.9.1","emailAddress");j("1.2.840.113549.1.9.2","unstructuredName");j("1.2.840.113549.1.9.3","contentType");j("1.2.840.113549.1.9.4","messageDigest");j("1.2.840.113549.1.9.5","signingTime");j("1.2.840.113549.1.9.6","counterSignature");j("1.2.840.113549.1.9.7","challengePassword");j("1.2.840.113549.1.9.8","unstructuredAddress");j("1.2.840.113549.1.9.14","extensionRequest");j("1.2.840.113549.1.9.20","friendlyName");j("1.2.840.113549.1.9.21","localKeyId");j("1.2.840.113549.1.9.22.1","x509Certificate");j("1.2.840.113549.1.12.10.1.1","keyBag");j("1.2.840.113549.1.12.10.1.2","pkcs8ShroudedKeyBag");j("1.2.840.113549.1.12.10.1.3","certBag");j("1.2.840.113549.1.12.10.1.4","crlBag");j("1.2.840.113549.1.12.10.1.5","secretBag");j("1.2.840.113549.1.12.10.1.6","safeContentsBag");j("1.2.840.113549.1.5.13","pkcs5PBES2");j("1.2.840.113549.1.5.12","pkcs5PBKDF2");j("1.2.840.113549.1.12.1.1","pbeWithSHAAnd128BitRC4");j("1.2.840.113549.1.12.1.2","pbeWithSHAAnd40BitRC4");j("1.2.840.113549.1.12.1.3","pbeWithSHAAnd3-KeyTripleDES-CBC");j("1.2.840.113549.1.12.1.4","pbeWithSHAAnd2-KeyTripleDES-CBC");j("1.2.840.113549.1.12.1.5","pbeWithSHAAnd128BitRC2-CBC");j("1.2.840.113549.1.12.1.6","pbewithSHAAnd40BitRC2-CBC");j("1.2.840.113549.2.7","hmacWithSHA1");j("1.2.840.113549.2.8","hmacWithSHA224");j("1.2.840.113549.2.9","hmacWithSHA256");j("1.2.840.113549.2.10","hmacWithSHA384");j("1.2.840.113549.2.11","hmacWithSHA512");j("1.2.840.113549.3.7","des-EDE3-CBC");j("2.16.840.1.101.3.4.1.2","aes128-CBC");j("2.16.840.1.101.3.4.1.22","aes192-CBC");j("2.16.840.1.101.3.4.1.42","aes256-CBC");j("2.5.4.3","commonName");j("2.5.4.4","surname");j("2.5.4.5","serialNumber");j("2.5.4.6","countryName");j("2.5.4.7","localityName");j("2.5.4.8","stateOrProvinceName");j("2.5.4.9","streetAddress");j("2.5.4.10","organizationName");j("2.5.4.11","organizationalUnitName");j("2.5.4.12","title");j("2.5.4.13","description");j("2.5.4.15","businessCategory");j("2.5.4.17","postalCode");j("2.5.4.42","givenName");j("1.3.6.1.4.1.311.60.2.1.2","jurisdictionOfIncorporationStateOrProvinceName");j("1.3.6.1.4.1.311.60.2.1.3","jurisdictionOfIncorporationCountryName");j("2.16.840.1.113730.1.1","nsCertType");j("2.16.840.1.113730.1.13","nsComment");QJ("2.5.29.1","authorityKeyIdentifier");QJ("2.5.29.2","keyAttributes");QJ("2.5.29.3","certificatePolicies");QJ("2.5.29.4","keyUsageRestriction");QJ("2.5.29.5","policyMapping");QJ("2.5.29.6","subtreesConstraint");QJ("2.5.29.7","subjectAltName");QJ("2.5.29.8","issuerAltName");QJ("2.5.29.9","subjectDirectoryAttributes");QJ("2.5.29.10","basicConstraints");QJ("2.5.29.11","nameConstraints");QJ("2.5.29.12","policyConstraints");QJ("2.5.29.13","basicConstraints");j("2.5.29.14","subjectKeyIdentifier");j("2.5.29.15","keyUsage");QJ("2.5.29.16","privateKeyUsagePeriod");j("2.5.29.17","subjectAltName");j("2.5.29.18","issuerAltName");j("2.5.29.19","basicConstraints");QJ("2.5.29.20","cRLNumber");QJ("2.5.29.21","cRLReason");QJ("2.5.29.22","expirationDate");QJ("2.5.29.23","instructionCode");QJ("2.5.29.24","invalidityDate");QJ("2.5.29.25","cRLDistributionPoints");QJ("2.5.29.26","issuingDistributionPoint");QJ("2.5.29.27","deltaCRLIndicator");QJ("2.5.29.28","issuingDistributionPoint");QJ("2.5.29.29","certificateIssuer");QJ("2.5.29.30","nameConstraints");j("2.5.29.31","cRLDistributionPoints");j("2.5.29.32","certificatePolicies");QJ("2.5.29.33","policyMappings");QJ("2.5.29.34","policyConstraints");j("2.5.29.35","authorityKeyIdentifier");QJ("2.5.29.36","policyConstraints");j("2.5.29.37","extKeyUsage");QJ("2.5.29.46","freshestCRL");QJ("2.5.29.54","inhibitAnyPolicy");j("1.3.6.1.4.1.11129.2.4.2","timestampList");j("1.3.6.1.5.5.7.1.1","authorityInfoAccess");j("1.3.6.1.5.5.7.3.1","serverAuth");j("1.3.6.1.5.5.7.3.2","clientAuth");j("1.3.6.1.5.5.7.3.3","codeSigning");j("1.3.6.1.5.5.7.3.4","emailProtection");j("1.3.6.1.5.5.7.3.8","timeStamping")});var G$=c((YH,xZ)=>{var qJ=o();XJ();w$();var _=xZ.exports=qJ.asn1=qJ.asn1||{};_.Class={UNIVERSAL:0,APPLICATION:64,CONTEXT_SPECIFIC:128,PRIVATE:192};_.Type={NONE:0,BOOLEAN:1,INTEGER:2,BITSTRING:3,OCTETSTRING:4,NULL:5,OID:6,ODESC:7,EXTERNAL:8,REAL:9,ENUMERATED:10,EMBEDDED:11,UTF8:12,ROID:13,SEQUENCE:16,SET:17,PRINTABLESTRING:19,IA5STRING:22,UTCTIME:23,GENERALIZEDTIME:24,BMPSTRING:30};_.create=function(J,$,Z,X,Q){if(qJ.util.isArray(X)){var Y=[];for(var U=0;U<X.length;++U)if(X[U]!==void 0)Y.push(X[U]);X=Y}var G={tagClass:J,type:$,constructed:Z,composed:Z||qJ.util.isArray(X),value:X};if(Q&&"bitStringContents"in Q)G.bitStringContents=Q.bitStringContents,G.original=_.copy(G);return G};_.copy=function(J,$){var Z;if(qJ.util.isArray(J)){Z=[];for(var X=0;X<J.length;++X)Z.push(_.copy(J[X],$));return Z}if(typeof J==="string")return J;if(Z={tagClass:J.tagClass,type:J.type,constructed:J.constructed,composed:J.composed,value:_.copy(J.value,$)},$&&!$.excludeBitStringContents)Z.bitStringContents=J.bitStringContents;return Z};_.equals=function(J,$,Z){if(qJ.util.isArray(J)){if(!qJ.util.isArray($))return!1;if(J.length!==$.length)return!1;for(var X=0;X<J.length;++X)if(!_.equals(J[X],$[X]))return!1;return!0}if(typeof J!==typeof $)return!1;if(typeof J==="string")return J===$;var Q=J.tagClass===$.tagClass&&J.type===$.type&&J.constructed===$.constructed&&J.composed===$.composed&&_.equals(J.value,$.value);if(Z&&Z.includeBitStringContents)Q=Q&&J.bitStringContents===$.bitStringContents;return Q};_.getBerValueLength=function(J){var $=J.getByte();if($===128)return;var Z,X=$&128;if(!X)Z=$;else Z=J.getInt(($&127)<<3);return Z};function OX(J,$,Z){if(Z>$){var X=new Error("Too few bytes to parse DER.");throw X.available=J.length(),X.remaining=$,X.requested=Z,X}}var iY=function(J,$){var Z=J.getByte();if($--,Z===128)return;var X,Q=Z&128;if(!Q)X=Z;else{var Y=Z&127;OX(J,$,Y),X=J.getInt(Y<<3)}if(X<0)throw new Error("Negative length: "+X);return X};_.fromDer=function(J,$){if($===void 0)$={strict:!0,parseAllBytes:!0,decodeBitStrings:!0};if(typeof $==="boolean")$={strict:$,parseAllBytes:!0,decodeBitStrings:!0};if(!("strict"in $))$.strict=!0;if(!("parseAllBytes"in $))$.parseAllBytes=!0;if(!("decodeBitStrings"in $))$.decodeBitStrings=!0;if(typeof J==="string")J=qJ.util.createBuffer(J);var Z=J.length(),X=kX(J,J.length(),0,$);if($.parseAllBytes&&J.length()!==0){var Q=new Error("Unparsed DER bytes remain after ASN.1 parsing.");throw Q.byteCount=Z,Q.remaining=J.length(),Q}return X};function kX(J,$,Z,X){var Q;OX(J,$,2);var Y=J.getByte();$--;var U=Y&192,G=Y&31;Q=J.length();var E=iY(J,$);if($-=Q-J.length(),E!==void 0&&E>$){if(X.strict){var W=new Error("Too few bytes to read ASN.1 value.");throw W.available=J.length(),W.remaining=$,W.requested=E,W}E=$}var H,O,M=(Y&32)===32;if(M)if(H=[],E===void 0)for(;;){if(OX(J,$,2),J.bytes(2)===String.fromCharCode(0,0)){J.getBytes(2),$-=2;break}Q=J.length(),H.push(kX(J,$,Z+1,X)),$-=Q-J.length()}else while(E>0)Q=J.length(),H.push(kX(J,E,Z+1,X)),$-=Q-J.length(),E-=Q-J.length();if(H===void 0&&U===_.Class.UNIVERSAL&&G===_.Type.BITSTRING)O=J.bytes(E);if(H===void 0&&X.decodeBitStrings&&U===_.Class.UNIVERSAL&&G===_.Type.BITSTRING&&E>1){var P=J.read,z=$,A=0;if(G===_.Type.BITSTRING)OX(J,$,1),A=J.getByte(),$--;if(A===0)try{Q=J.length();var T={strict:!0,decodeBitStrings:!0},C=kX(J,$,Z+1,T),L=Q-J.length();if($-=L,G==_.Type.BITSTRING)L++;var w=C.tagClass;if(L===E&&(w===_.Class.UNIVERSAL||w===_.Class.CONTEXT_SPECIFIC))H=[C]}catch(v){}if(H===void 0)J.read=P,$=z}if(H===void 0){if(E===void 0){if(X.strict)throw new Error("Non-constructed ASN.1 object of indefinite length.");E=$}if(G===_.Type.BMPSTRING){H="";for(;E>0;E-=2)OX(J,$,2),H+=String.fromCharCode(J.getInt16()),$-=2}else H=J.getBytes(E),$-=E}var f=O===void 0?null:{bitStringContents:O};return _.create(U,G,M,H,f)}_.toDer=function(J){var $=qJ.util.createBuffer(),Z=J.tagClass|J.type,X=qJ.util.createBuffer(),Q=!1;if("bitStringContents"in J){if(Q=!0,J.original)Q=_.equals(J,J.original)}if(Q)X.putBytes(J.bitStringContents);else if(J.composed){if(J.constructed)Z|=32;else X.putByte(0);for(var Y=0;Y<J.value.length;++Y)if(J.value[Y]!==void 0)X.putBuffer(_.toDer(J.value[Y]))}else if(J.type===_.Type.BMPSTRING)for(var Y=0;Y<J.value.length;++Y)X.putInt16(J.value.charCodeAt(Y));else if(J.type===_.Type.INTEGER&&J.value.length>1&&(J.value.charCodeAt(0)===0&&(J.value.charCodeAt(1)&128)===0||J.value.charCodeAt(0)===255&&(J.value.charCodeAt(1)&128)===128))X.putBytes(J.value.substr(1));else X.putBytes(J.value);if($.putByte(Z),X.length()<=127)$.putByte(X.length()&127);else{var U=X.length(),G="";do G+=String.fromCharCode(U&255),U=U>>>8;while(U>0);$.putByte(G.length|128);for(var Y=G.length-1;Y>=0;--Y)$.putByte(G.charCodeAt(Y))}return $.putBuffer(X),$};_.oidToDer=function(J){var $=J.split("."),Z=qJ.util.createBuffer();Z.putByte(40*parseInt($[0],10)+parseInt($[1],10));var X,Q,Y,U;for(var G=2;G<$.length;++G){X=!0,Q=[],Y=parseInt($[G],10);do{if(U=Y&127,Y=Y>>>7,!X)U|=128;Q.push(U),X=!1}while(Y>0);for(var E=Q.length-1;E>=0;--E)Z.putByte(Q[E])}return Z};_.derToOid=function(J){var $;if(typeof J==="string")J=qJ.util.createBuffer(J);var Z=J.getByte();$=Math.floor(Z/40)+"."+Z%40;var X=0;while(J.length()>0)if(Z=J.getByte(),X=X<<7,Z&128)X+=Z&127;else $+="."+(X+Z),X=0;return $};_.utcTimeToDate=function(J){var $=new Date,Z=parseInt(J.substr(0,2),10);Z=Z>=50?1900+Z:2000+Z;var X=parseInt(J.substr(2,2),10)-1,Q=parseInt(J.substr(4,2),10),Y=parseInt(J.substr(6,2),10),U=parseInt(J.substr(8,2),10),G=0;if(J.length>11){var E=J.charAt(10),W=10;if(E!=="+"&&E!=="-")G=parseInt(J.substr(10,2),10),W+=2}if($.setUTCFullYear(Z,X,Q),$.setUTCHours(Y,U,G,0),W){if(E=J.charAt(W),E==="+"||E==="-"){var H=parseInt(J.substr(W+1,2),10),O=parseInt(J.substr(W+4,2),10),M=H*60+O;if(M*=60000,E==="+")$.setTime(+$-M);else $.setTime(+$+M)}}return $};_.generalizedTimeToDate=function(J){var $=new Date,Z=parseInt(J.substr(0,4),10),X=parseInt(J.substr(4,2),10)-1,Q=parseInt(J.substr(6,2),10),Y=parseInt(J.substr(8,2),10),U=parseInt(J.substr(10,2),10),G=parseInt(J.substr(12,2),10),E=0,W=0,H=!1;if(J.charAt(J.length-1)==="Z")H=!0;var O=J.length-5,M=J.charAt(O);if(M==="+"||M==="-"){var P=parseInt(J.substr(O+1,2),10),z=parseInt(J.substr(O+4,2),10);if(W=P*60+z,W*=60000,M==="+")W*=-1;H=!0}if(J.charAt(14)===".")E=parseFloat(J.substr(14),10)*1000;if(H)$.setUTCFullYear(Z,X,Q),$.setUTCHours(Y,U,G,E),$.setTime(+$+W);else $.setFullYear(Z,X,Q),$.setHours(Y,U,G,E);return $};_.dateToUtcTime=function(J){if(typeof J==="string")return J;var $="",Z=[];Z.push((""+J.getUTCFullYear()).substr(2)),Z.push(""+(J.getUTCMonth()+1)),Z.push(""+J.getUTCDate()),Z.push(""+J.getUTCHours()),Z.push(""+J.getUTCMinutes()),Z.push(""+J.getUTCSeconds());for(var X=0;X<Z.length;++X){if(Z[X].length<2)$+="0";$+=Z[X]}return $+="Z",$};_.dateToGeneralizedTime=function(J){if(typeof J==="string")return J;var $="",Z=[];Z.push(""+J.getUTCFullYear()),Z.push(""+(J.getUTCMonth()+1)),Z.push(""+J.getUTCDate()),Z.push(""+J.getUTCHours()),Z.push(""+J.getUTCMinutes()),Z.push(""+J.getUTCSeconds());for(var X=0;X<Z.length;++X){if(Z[X].length<2)$+="0";$+=Z[X]}return $+="Z",$};_.integerToDer=function(J){var $=qJ.util.createBuffer();if(J>=-128&&J<128)return $.putSignedInt(J,8);if(J>=-32768&&J<32768)return $.putSignedInt(J,16);if(J>=-8388608&&J<8388608)return $.putSignedInt(J,24);if(J>=-2147483648&&J<2147483648)return $.putSignedInt(J,32);var Z=new Error("Integer too large; max is 32-bits.");throw Z.integer=J,Z};_.derToInteger=function(J){if(typeof J==="string")J=qJ.util.createBuffer(J);var $=J.length()*8;if($>32)throw new Error("Integer too large; max is 32-bits.");return J.getSignedInt($)};_.validate=function(J,$,Z,X){var Q=!1;if((J.tagClass===$.tagClass||typeof $.tagClass==="undefined")&&(J.type===$.type||typeof $.type==="undefined")){if(J.constructed===$.constructed||typeof $.constructed==="undefined"){if(Q=!0,$.value&&qJ.util.isArray($.value)){var Y=0;for(var U=0;Q&&U<$.value.length;++U){if(Q=$.value[U].optional||!1,J.value[Y]){if(Q=_.validate(J.value[Y],$.value[U],Z,X),Q)++Y;else if($.value[U].optional)Q=!0}if(!Q&&X)X.push("["+$.name+'] Tag class "'+$.tagClass+'", type "'+$.type+'" expected value length "'+$.value.length+'", got "'+J.value.length+'"')}}if(Q&&Z){if($.capture)Z[$.capture]=J.value;if($.captureAsn1)Z[$.captureAsn1]=J;if($.captureBitStringContents&&"bitStringContents"in J)Z[$.captureBitStringContents]=J.bitStringContents;if($.captureBitStringValue&&"bitStringContents"in J){var G;if(J.bitStringContents.length<2)Z[$.captureBitStringValue]="";else{var E=J.bitStringContents.charCodeAt(0);if(E!==0)throw new Error("captureBitStringValue only supported for zero unused bits");Z[$.captureBitStringValue]=J.bitStringContents.slice(1)}}}}else if(X)X.push("["+$.name+'] Expected constructed "'+$.constructed+'", got "'+J.constructed+'"')}else if(X){if(J.tagClass!==$.tagClass)X.push("["+$.name+'] Expected tag class "'+$.tagClass+'", got "'+J.tagClass+'"');if(J.type!==$.type)X.push("["+$.name+'] Expected type "'+$.type+'", got "'+J.type+'"')}return Q};var jZ=/[^\\u0000-\\u00ff]/;_.prettyPrint=function(J,$,Z){var X="";if($=$||0,Z=Z||2,$>0)X+=`
`;var Q="";for(var Y=0;Y<$*Z;++Y)Q+=" ";switch(X+=Q+"Tag: ",J.tagClass){case _.Class.UNIVERSAL:X+="Universal:";break;case _.Class.APPLICATION:X+="Application:";break;case _.Class.CONTEXT_SPECIFIC:X+="Context-Specific:";break;case _.Class.PRIVATE:X+="Private:";break}if(J.tagClass===_.Class.UNIVERSAL)switch(X+=J.type,J.type){case _.Type.NONE:X+=" (None)";break;case _.Type.BOOLEAN:X+=" (Boolean)";break;case _.Type.INTEGER:X+=" (Integer)";break;case _.Type.BITSTRING:X+=" (Bit string)";break;case _.Type.OCTETSTRING:X+=" (Octet string)";break;case _.Type.NULL:X+=" (Null)";break;case _.Type.OID:X+=" (Object Identifier)";break;case _.Type.ODESC:X+=" (Object Descriptor)";break;case _.Type.EXTERNAL:X+=" (External or Instance of)";break;case _.Type.REAL:X+=" (Real)";break;case _.Type.ENUMERATED:X+=" (Enumerated)";break;case _.Type.EMBEDDED:X+=" (Embedded PDV)";break;case _.Type.UTF8:X+=" (UTF8)";break;case _.Type.ROID:X+=" (Relative Object Identifier)";break;case _.Type.SEQUENCE:X+=" (Sequence)";break;case _.Type.SET:X+=" (Set)";break;case _.Type.PRINTABLESTRING:X+=" (Printable String)";break;case _.Type.IA5String:X+=" (IA5String (ASCII))";break;case _.Type.UTCTIME:X+=" (UTC time)";break;case _.Type.GENERALIZEDTIME:X+=" (Generalized time)";break;case _.Type.BMPSTRING:X+=" (BMP String)";break}else X+=J.type;if(X+=`
`,X+=Q+"Constructed: "+J.constructed+`
`,J.composed){var U=0,G="";for(var Y=0;Y<J.value.length;++Y)if(J.value[Y]!==void 0){if(U+=1,G+=_.prettyPrint(J.value[Y],$+1,Z),Y+1<J.value.length)G+=","}X+=Q+"Sub values: "+U+G}else{if(X+=Q+"Value: ",J.type===_.Type.OID){var E=_.derToOid(J.value);if(X+=E,qJ.pki&&qJ.pki.oids){if(E in qJ.pki.oids)X+=" ("+qJ.pki.oids[E]+") "}}if(J.type===_.Type.INTEGER)try{X+=_.derToInteger(J.value)}catch(H){X+="0x"+qJ.util.bytesToHex(J.value)}else if(J.type===_.Type.BITSTRING){if(J.value.length>1)X+="0x"+qJ.util.bytesToHex(J.value.slice(1));else X+="(none)";if(J.value.length>0){var W=J.value.charCodeAt(0);if(W==1)X+=" (1 unused bit shown)";else if(W>1)X+=" ("+W+" unused bits shown)"}}else if(J.type===_.Type.OCTETSTRING){if(!jZ.test(J.value))X+="("+J.value+") ";X+="0x"+qJ.util.bytesToHex(J.value)}else if(J.type===_.Type.UTF8)try{X+=qJ.util.decodeUtf8(J.value)}catch(H){if(H.message==="URI malformed")X+="0x"+qJ.util.bytesToHex(J.value)+" (malformed UTF8)";else throw H}else if(J.type===_.Type.PRINTABLESTRING||J.type===_.Type.IA5String)X+=J.value;else if(jZ.test(J.value))X+="0x"+qJ.util.bytesToHex(J.value);else if(J.value.length===0)X+="[null]";else X+=J.value}return X}});var E$=c((UH,kZ)=>{var vX=o();kZ.exports=vX.md=vX.md||{};vX.md.algorithms=vX.md.algorithms||{}});var i$=c((GH,vZ)=>{var K$=o();E$();XJ();var sY=vZ.exports=K$.hmac=K$.hmac||{};sY.create=function(){var J=null,$=null,Z=null,X=null,Q={};return Q.start=function(Y,U){if(Y!==null)if(typeof Y==="string")if(Y=Y.toLowerCase(),Y in K$.md.algorithms)$=K$.md.algorithms[Y].create();else throw new Error('Unknown hash algorithm "'+Y+'"');else $=Y;if(U===null)U=J;else{if(typeof U==="string")U=K$.util.createBuffer(U);else if(K$.util.isArray(U)){var G=U;U=K$.util.createBuffer();for(var E=0;E<G.length;++E)U.putByte(G[E])}var W=U.length();if(W>$.blockLength)$.start(),$.update(U.bytes()),U=$.digest();Z=K$.util.createBuffer(),X=K$.util.createBuffer(),W=U.length();for(var E=0;E<W;++E){var G=U.at(E);Z.putByte(54^G),X.putByte(92^G)}if(W<$.blockLength){var G=$.blockLength-W;for(var E=0;E<G;++E)Z.putByte(54),X.putByte(92)}J=U,Z=Z.bytes(),X=X.bytes()}$.start(),$.update(Z)},Q.update=function(Y){$.update(Y)},Q.getMac=function(){var Y=$.digest().bytes();return $.start(),$.update(X),$.update(Y),$.digest()},Q.digest=Q.getMac,Q}});var _X=c((WH,fZ)=>{var H$=o();E$();XJ();var _Z=fZ.exports=H$.md5=H$.md5||{};H$.md.md5=H$.md.algorithms.md5=_Z;_Z.create=function(){if(!hZ)rY();var J=null,$=H$.util.createBuffer(),Z=new Array(16),X={algorithm:"md5",blockLength:64,digestLength:16,messageLength:0,fullMessageLength:null,messageLengthSize:8};return X.start=function(){X.messageLength=0,X.fullMessageLength=X.messageLength64=[];var Q=X.messageLengthSize/4;for(var Y=0;Y<Q;++Y)X.fullMessageLength.push(0);return $=H$.util.createBuffer(),J={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878},X},X.start(),X.update=function(Q,Y){if(Y==="utf8")Q=H$.util.encodeUtf8(Q);var U=Q.length;X.messageLength+=U,U=[U/4294967296>>>0,U>>>0];for(var G=X.fullMessageLength.length-1;G>=0;--G)X.fullMessageLength[G]+=U[1],U[1]=U[0]+(X.fullMessageLength[G]/4294967296>>>0),X.fullMessageLength[G]=X.fullMessageLength[G]>>>0,U[0]=U[1]/4294967296>>>0;if($.putBytes(Q),yZ(J,Z,$),$.read>2048||$.length()===0)$.compact();return X},X.digest=function(){var Q=H$.util.createBuffer();Q.putBytes($.bytes());var Y=X.fullMessageLength[X.fullMessageLength.length-1]+X.messageLengthSize,U=Y&X.blockLength-1;Q.putBytes(R0.substr(0,X.blockLength-U));var G,E=0;for(var W=X.fullMessageLength.length-1;W>=0;--W)G=X.fullMessageLength[W]*8+E,E=G/4294967296>>>0,Q.putInt32Le(G>>>0);var H={h0:J.h0,h1:J.h1,h2:J.h2,h3:J.h3};yZ(H,Z,Q);var O=H$.util.createBuffer();return O.putInt32Le(H.h0),O.putInt32Le(H.h1),O.putInt32Le(H.h2),O.putInt32Le(H.h3),O},X};var R0=null,yX=null,VX=null,s$=null,hZ=!1;function rY(){R0=String.fromCharCode(128),R0+=H$.util.fillString(String.fromCharCode(0),64),yX=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,1,6,11,0,5,10,15,4,9,14,3,8,13,2,7,12,5,8,11,14,1,4,7,10,13,0,3,6,9,12,15,2,0,7,14,5,12,3,10,1,8,15,6,13,4,11,2,9],VX=[7,12,17,22,7,12,17,22,7,12,17,22,7,12,17,22,5,9,14,20,5,9,14,20,5,9,14,20,5,9,14,20,4,11,16,23,4,11,16,23,4,11,16,23,4,11,16,23,6,10,15,21,6,10,15,21,6,10,15,21,6,10,15,21],s$=new Array(64);for(var J=0;J<64;++J)s$[J]=Math.floor(Math.abs(Math.sin(J+1))*4294967296);hZ=!0}function yZ(J,$,Z){var X,Q,Y,U,G,E,W,H,O=Z.length();while(O>=64){Q=J.h0,Y=J.h1,U=J.h2,G=J.h3;for(H=0;H<16;++H)$[H]=Z.getInt32Le(),E=G^Y&(U^G),X=Q+E+s$[H]+$[H],W=VX[H],Q=G,G=U,U=Y,Y+=X<<W|X>>>32-W;for(;H<32;++H)E=U^G&(Y^U),X=Q+E+s$[H]+$[yX[H]],W=VX[H],Q=G,G=U,U=Y,Y+=X<<W|X>>>32-W;for(;H<48;++H)E=Y^U^G,X=Q+E+s$[H]+$[yX[H]],W=VX[H],Q=G,G=U,U=Y,Y+=X<<W|X>>>32-W;for(;H<64;++H)E=U^(Y|~G),X=Q+E+s$[H]+$[yX[H]],W=VX[H],Q=G,G=U,U=Y,Y+=X<<W|X>>>32-W;J.h0=J.h0+Q|0,J.h1=J.h1+Y|0,J.h2=J.h2+U|0,J.h3=J.h3+G|0,O-=64}}});var f$=c((EH,bZ)=>{var fX=o();XJ();var uZ=bZ.exports=fX.pem=fX.pem||{};uZ.encode=function(J,$){$=$||{};var Z="-----BEGIN "+J.type+`-----\r
`,X;if(J.procType)X={name:"Proc-Type",values:[String(J.procType.version),J.procType.type]},Z+=hX(X);if(J.contentDomain)X={name:"Content-Domain",values:[J.contentDomain]},Z+=hX(X);if(J.dekInfo){if(X={name:"DEK-Info",values:[J.dekInfo.algorithm]},J.dekInfo.parameters)X.values.push(J.dekInfo.parameters);Z+=hX(X)}if(J.headers)for(var Q=0;Q<J.headers.length;++Q)Z+=hX(J.headers[Q]);if(J.procType)Z+=`\r
`;return Z+=fX.util.encode64(J.body,$.maxline||64)+`\r
`,Z+="-----END "+J.type+`-----\r
`,Z};uZ.decode=function(J){var $=[],Z=/\s*-----BEGIN ([A-Z0-9- ]+)-----\r?\n?([\x21-\x7e\s]+?(?:\r?\n\r?\n))?([:A-Za-z0-9+\/=\s]+?)-----END \1-----/g,X=/([\x21-\x7e]+):\s*([\x21-\x7e\s^:]+)/,Q=/\r?\n/,Y;while(!0){if(Y=Z.exec(J),!Y)break;var U=Y[1];if(U==="NEW CERTIFICATE REQUEST")U="CERTIFICATE REQUEST";var G={type:U,procType:null,contentDomain:null,dekInfo:null,headers:[],body:fX.util.decode64(Y[3])};if($.push(G),!Y[2])continue;var E=Y[2].split(Q),W=0;while(Y&&W<E.length){var H=E[W].replace(/\s+$/,"");for(var O=W+1;O<E.length;++O){var M=E[O];if(!/\s/.test(M[0]))break;H+=M,W=O}if(Y=H.match(X),Y){var P={name:Y[1],values:[]},z=Y[2].split(",");for(var A=0;A<z.length;++A)P.values.push(tY(z[A]));if(!G.procType){if(P.name!=="Proc-Type")throw new Error('Invalid PEM formatted message. The first encapsulated header must be "Proc-Type".');else if(P.values.length!==2)throw new Error('Invalid PEM formatted message. The "Proc-Type" header must have two subfields.');G.procType={version:z[0],type:z[1]}}else if(!G.contentDomain&&P.name==="Content-Domain")G.contentDomain=z[0]||"";else if(!G.dekInfo&&P.name==="DEK-Info"){if(P.values.length===0)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must have at least one subfield.');G.dekInfo={algorithm:z[0],parameters:z[1]||null}}else G.headers.push(P)}++W}if(G.procType==="ENCRYPTED"&&!G.dekInfo)throw new Error('Invalid PEM formatted message. The "DEK-Info" header must be present if "Proc-Type" is "ENCRYPTED".')}if($.length===0)throw new Error("Invalid PEM formatted message.");return $};function hX(J){var $=J.name+": ",Z=[],X=function(E,W){return" "+W};for(var Q=0;Q<J.values.length;++Q)Z.push(J.values[Q].replace(/^(\S+\r\n)/,X));$+=Z.join(",")+`\r
`;var Y=0,U=-1;for(var Q=0;Q<$.length;++Q,++Y)if(Y>65&&U!==-1){var G=$[U];if(G===",")++U,$=$.substr(0,U)+`\r
 `+$.substr(U);else $=$.substr(0,U)+`\r
`+G+$.substr(U+1);Y=Q-U-1,U=-1,++Q}else if($[Q]===" "||$[Q]==="\t"||$[Q]===",")U=Q;return $}function tY(J){return J.replace(/^\s+/,"")}});var qX=c((HH,dZ)=>{var MJ=o();IX();M0();XJ();dZ.exports=MJ.des=MJ.des||{};MJ.des.startEncrypting=function(J,$,Z,X){var Q=uX({key:J,output:Z,decrypt:!1,mode:X||($===null?"ECB":"CBC")});return Q.start($),Q};MJ.des.createEncryptionCipher=function(J,$){return uX({key:J,output:null,decrypt:!1,mode:$})};MJ.des.startDecrypting=function(J,$,Z,X){var Q=uX({key:J,output:Z,decrypt:!0,mode:X||($===null?"ECB":"CBC")});return Q.start($),Q};MJ.des.createDecryptionCipher=function(J,$){return uX({key:J,output:null,decrypt:!0,mode:$})};MJ.des.Algorithm=function(J,$){var Z=this;Z.name=J,Z.mode=new $({blockSize:8,cipher:{encrypt:function(X,Q){return mZ(Z._keys,X,Q,!1)},decrypt:function(X,Q){return mZ(Z._keys,X,Q,!0)}}}),Z._init=!1};MJ.des.Algorithm.prototype.initialize=function(J){if(this._init)return;var $=MJ.util.createBuffer(J.key);if(this.name.indexOf("3DES")===0){if($.length()!==24)throw new Error("Invalid Triple-DES key size: "+$.length()*8)}this._keys=GU($),this._init=!0};O$("DES-ECB",MJ.cipher.modes.ecb);O$("DES-CBC",MJ.cipher.modes.cbc);O$("DES-CFB",MJ.cipher.modes.cfb);O$("DES-OFB",MJ.cipher.modes.ofb);O$("DES-CTR",MJ.cipher.modes.ctr);O$("3DES-ECB",MJ.cipher.modes.ecb);O$("3DES-CBC",MJ.cipher.modes.cbc);O$("3DES-CFB",MJ.cipher.modes.cfb);O$("3DES-OFB",MJ.cipher.modes.ofb);O$("3DES-CTR",MJ.cipher.modes.ctr);function O$(J,$){var Z=function(){return new MJ.des.Algorithm(J,$)};MJ.cipher.registerAlgorithm(J,Z)}var eY=[16843776,0,65536,16843780,16842756,66564,4,65536,1024,16843776,16843780,1024,16778244,16842756,16777216,4,1028,16778240,16778240,66560,66560,16842752,16842752,16778244,65540,16777220,16777220,65540,0,1028,66564,16777216,65536,16843780,4,16842752,16843776,16777216,16777216,1024,16842756,65536,66560,16777220,1024,4,16778244,66564,16843780,65540,16842752,16778244,16777220,1028,66564,16843776,1028,16778240,16778240,0,65540,66560,0,16842756],JU=[-2146402272,-2147450880,32768,1081376,1048576,32,-2146435040,-2147450848,-2147483616,-2146402272,-2146402304,-2147483648,-2147450880,1048576,32,-2146435040,1081344,1048608,-2147450848,0,-2147483648,32768,1081376,-2146435072,1048608,-2147483616,0,1081344,32800,-2146402304,-2146435072,32800,0,1081376,-2146435040,1048576,-2147450848,-2146435072,-2146402304,32768,-2146435072,-2147450880,32,-2146402272,1081376,32,32768,-2147483648,32800,-2146402304,1048576,-2147483616,1048608,-2147450848,-2147483616,1048608,1081344,0,-2147450880,32800,-2147483648,-2146435040,-2146402272,1081344],$U=[520,134349312,0,134348808,134218240,0,131592,134218240,131080,134217736,134217736,131072,134349320,131080,134348800,520,134217728,8,134349312,512,131584,134348800,134348808,131592,134218248,131584,131072,134218248,8,134349320,512,134217728,134349312,134217728,131080,520,131072,134349312,134218240,0,512,131080,134349320,134218240,134217736,512,0,134348808,134218248,131072,134217728,134349320,8,131592,131584,134217736,134348800,134218248,520,134348800,131592,8,134348808,131584],XU=[8396801,8321,8321,128,8396928,8388737,8388609,8193,0,8396800,8396800,8396929,129,0,8388736,8388609,1,8192,8388608,8396801,128,8388608,8193,8320,8388737,1,8320,8388736,8192,8396928,8396929,129,8388736,8388609,8396800,8396929,129,0,0,8396800,8320,8388736,8388737,1,8396801,8321,8321,128,8396929,129,1,8192,8388609,8193,8396928,8388737,8193,8320,8388608,8396801,128,8388608,8192,8396928],ZU=[256,34078976,34078720,1107296512,524288,256,1073741824,34078720,1074266368,524288,33554688,1074266368,1107296512,1107820544,524544,1073741824,33554432,1074266112,1074266112,0,1073742080,1107820800,1107820800,33554688,1107820544,1073742080,0,1107296256,34078976,33554432,1107296256,524544,524288,1107296512,256,33554432,1073741824,34078720,1107296512,1074266368,33554688,1073741824,1107820544,34078976,1074266368,256,33554432,1107820544,1107820800,524544,1107296256,1107820800,34078720,0,1074266112,1107296256,524544,33554688,1073742080,524288,0,1074266112,34078976,1073742080],QU=[536870928,541065216,16384,541081616,541065216,16,541081616,4194304,536887296,4210704,4194304,536870928,4194320,536887296,536870912,16400,0,4194320,536887312,16384,4210688,536887312,16,541065232,541065232,0,4210704,541081600,16400,4210688,541081600,536870912,536887296,16,541065232,4210688,541081616,4194304,16400,536870928,4194304,536887296,536870912,16400,536870928,541081616,4210688,541065216,4210704,541081600,0,541065232,16,16384,541065216,4210704,16384,4194320,536887312,0,541081600,536870912,4194320,536887312],YU=[2097152,69206018,67110914,0,2048,67110914,2099202,69208064,69208066,2097152,0,67108866,2,67108864,69206018,2050,67110912,2099202,2097154,67110912,67108866,69206016,69208064,2097154,69206016,2048,2050,69208066,2099200,2,67108864,2099200,67108864,2099200,2097152,67110914,67110914,69206018,69206018,2,2097154,67108864,67110912,2097152,69208064,2050,2099202,69208064,2050,67108866,69208066,69206016,2099200,0,2,69208066,0,2099202,69206016,2048,67108866,67110912,2048,2097154],UU=[268439616,4096,262144,268701760,268435456,268439616,64,268435456,262208,268697600,268701760,266240,268701696,266304,4096,64,268697600,268435520,268439552,4160,266240,262208,268697664,268701696,4160,0,0,268697664,268435520,268439552,266304,262144,266304,262144,268701696,4096,64,268697664,4096,266304,268439552,64,268435520,268697600,268697664,268435456,262144,268439616,0,268701760,262208,268435520,268697600,268439552,268439616,0,268701760,266240,266240,4160,4160,262208,268435456,268701696];function GU(J){var $=[0,4,536870912,536870916,65536,65540,536936448,536936452,512,516,536871424,536871428,66048,66052,536936960,536936964],Z=[0,1,1048576,1048577,67108864,67108865,68157440,68157441,256,257,1048832,1048833,67109120,67109121,68157696,68157697],X=[0,8,2048,2056,16777216,16777224,16779264,16779272,0,8,2048,2056,16777216,16777224,16779264,16779272],Q=[0,2097152,134217728,136314880,8192,2105344,134225920,136323072,131072,2228224,134348800,136445952,139264,2236416,134356992,136454144],Y=[0,262144,16,262160,0,262144,16,262160,4096,266240,4112,266256,4096,266240,4112,266256],U=[0,1024,32,1056,0,1024,32,1056,33554432,33555456,33554464,33555488,33554432,33555456,33554464,33555488],G=[0,268435456,524288,268959744,2,268435458,524290,268959746,0,268435456,524288,268959744,2,268435458,524290,268959746],E=[0,65536,2048,67584,536870912,536936448,536872960,536938496,131072,196608,133120,198656,537001984,537067520,537004032,537069568],W=[0,262144,0,262144,2,262146,2,262146,33554432,33816576,33554432,33816576,33554434,33816578,33554434,33816578],H=[0,268435456,8,268435464,0,268435456,8,268435464,1024,268436480,1032,268436488,1024,268436480,1032,268436488],O=[0,32,0,32,1048576,1048608,1048576,1048608,8192,8224,8192,8224,1056768,1056800,1056768,1056800],M=[0,16777216,512,16777728,2097152,18874368,2097664,18874880,67108864,83886080,67109376,83886592,69206016,85983232,69206528,85983744],P=[0,4096,134217728,134221824,524288,528384,134742016,134746112,16,4112,134217744,134221840,524304,528400,134742032,134746128],z=[0,4,256,260,0,4,256,260,1,5,257,261,1,5,257,261],A=J.length()>8?3:1,T=[],C=[0,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0],L=0,w;for(var f=0;f<A;f++){var v=J.getInt32(),x=J.getInt32();w=(v>>>4^x)&252645135,x^=w,v^=w<<4,w=(x>>>-16^v)&65535,v^=w,x^=w<<-16,w=(v>>>2^x)&858993459,x^=w,v^=w<<2,w=(x>>>-16^v)&65535,v^=w,x^=w<<-16,w=(v>>>1^x)&1431655765,x^=w,v^=w<<1,w=(x>>>8^v)&16711935,v^=w,x^=w<<8,w=(v>>>1^x)&1431655765,x^=w,v^=w<<1,w=v<<8|x>>>20&240,v=x<<24|x<<8&16711680|x>>>8&65280|x>>>24&240,x=w;for(var p=0;p<C.length;++p){if(C[p])v=v<<2|v>>>26,x=x<<2|x>>>26;else v=v<<1|v>>>27,x=x<<1|x>>>27;v&=-15,x&=-15;var a=$[v>>>28]|Z[v>>>24&15]|X[v>>>20&15]|Q[v>>>16&15]|Y[v>>>12&15]|U[v>>>8&15]|G[v>>>4&15],YJ=E[x>>>28]|W[x>>>24&15]|H[x>>>20&15]|O[x>>>16&15]|M[x>>>12&15]|P[x>>>8&15]|z[x>>>4&15];w=(YJ>>>16^a)&65535,T[L++]=a^w,T[L++]=YJ^w<<16}}return T}function mZ(J,$,Z,X){var Q=J.length===32?3:9,Y;if(Q===3)Y=X?[30,-2,-2]:[0,32,2];else Y=X?[94,62,-2,32,64,2,30,-2,-2]:[0,32,2,62,30,-2,64,96,2];var U,G=$[0],E=$[1];U=(G>>>4^E)&252645135,E^=U,G^=U<<4,U=(G>>>16^E)&65535,E^=U,G^=U<<16,U=(E>>>2^G)&858993459,G^=U,E^=U<<2,U=(E>>>8^G)&16711935,G^=U,E^=U<<8,U=(G>>>1^E)&1431655765,E^=U,G^=U<<1,G=G<<1|G>>>31,E=E<<1|E>>>31;for(var W=0;W<Q;W+=3){var H=Y[W+1],O=Y[W+2];for(var M=Y[W];M!=H;M+=O){var P=E^J[M],z=(E>>>4|E<<28)^J[M+1];U=G,G=E,E=U^(JU[P>>>24&63]|XU[P>>>16&63]|QU[P>>>8&63]|UU[P&63]|eY[z>>>24&63]|$U[z>>>16&63]|ZU[z>>>8&63]|YU[z&63])}U=G,G=E,E=U}G=G>>>1|G<<31,E=E>>>1|E<<31,U=(G>>>1^E)&1431655765,E^=U,G^=U<<1,U=(E>>>8^G)&16711935,G^=U,E^=U<<8,U=(E>>>2^G)&858993459,G^=U,E^=U<<2,U=(G>>>16^E)&65535,E^=U,G^=U<<16,U=(G>>>4^E)&252645135,E^=U,G^=U<<4,Z[0]=G,Z[1]=E}function uX(J){J=J||{};var $=(J.mode||"CBC").toUpperCase(),Z="DES-"+$,X;if(J.decrypt)X=MJ.cipher.createDecipher(Z,J.key);else X=MJ.cipher.createCipher(Z,J.key);var Q=X.start;return X.start=function(Y,U){var G=null;if(U instanceof MJ.util.ByteBuffer)G=U,U={};U=U||{},U.output=G,U.iv=Y,Q.call(X,U)},X}});var bX=c((OH,gZ)=>{var nJ=o();i$();E$();XJ();var WU=nJ.pkcs5=nJ.pkcs5||{},R$;if(nJ.util.isNodejs&&!nJ.options.usePureJavaScript)R$=A0("crypto");gZ.exports=nJ.pbkdf2=WU.pbkdf2=function(J,$,Z,X,Q,Y){if(typeof Q==="function")Y=Q,Q=null;if(nJ.util.isNodejs&&!nJ.options.usePureJavaScript&&R$.pbkdf2&&(Q===null||typeof Q!=="object")&&(R$.pbkdf2Sync.length>4||(!Q||Q==="sha1"))){if(typeof Q!=="string")Q="sha1";if(J=Buffer.from(J,"binary"),$=Buffer.from($,"binary"),!Y){if(R$.pbkdf2Sync.length===4)return R$.pbkdf2Sync(J,$,Z,X).toString("binary");return R$.pbkdf2Sync(J,$,Z,X,Q).toString("binary")}if(R$.pbkdf2Sync.length===4)return R$.pbkdf2(J,$,Z,X,function(w,f){if(w)return Y(w);Y(null,f.toString("binary"))});return R$.pbkdf2(J,$,Z,X,Q,function(w,f){if(w)return Y(w);Y(null,f.toString("binary"))})}if(typeof Q==="undefined"||Q===null)Q="sha1";if(typeof Q==="string"){if(!(Q in nJ.md.algorithms))throw new Error("Unknown hash algorithm: "+Q);Q=nJ.md[Q].create()}var U=Q.digestLength;if(X>4294967295*U){var G=new Error("Derived key is too long.");if(Y)return Y(G);throw G}var E=Math.ceil(X/U),W=X-(E-1)*U,H=nJ.hmac.create();H.start(Q,J);var O="",M,P,z;if(!Y){for(var A=1;A<=E;++A){H.start(null,null),H.update($),H.update(nJ.util.int32ToBytes(A)),M=z=H.digest().getBytes();for(var T=2;T<=Z;++T)H.start(null,null),H.update(z),P=H.digest().getBytes(),M=nJ.util.xorBytes(M,P,U),z=P;O+=A<E?M:M.substr(0,W)}return O}var A=1,T;function C(){if(A>E)return Y(null,O);H.start(null,null),H.update($),H.update(nJ.util.int32ToBytes(A)),M=z=H.digest().getBytes(),T=2,L()}function L(){if(T<=Z)return H.start(null,null),H.update(z),P=H.digest().getBytes(),M=nJ.util.xorBytes(M,P,U),z=P,++T,nJ.util.setImmediate(L);O+=A<E?M:M.substr(0,W),++A,C()}C()}});var N0=c((VH,oZ)=>{var V$=o();E$();XJ();var pZ=oZ.exports=V$.sha256=V$.sha256||{};V$.md.sha256=V$.md.algorithms.sha256=pZ;pZ.create=function(){if(!cZ)EU();var J=null,$=V$.util.createBuffer(),Z=new Array(64),X={algorithm:"sha256",blockLength:64,digestLength:32,messageLength:0,fullMessageLength:null,messageLengthSize:8};return X.start=function(){X.messageLength=0,X.fullMessageLength=X.messageLength64=[];var Q=X.messageLengthSize/4;for(var Y=0;Y<Q;++Y)X.fullMessageLength.push(0);return $=V$.util.createBuffer(),J={h0:1779033703,h1:3144134277,h2:1013904242,h3:2773480762,h4:1359893119,h5:2600822924,h6:528734635,h7:1541459225},X},X.start(),X.update=function(Q,Y){if(Y==="utf8")Q=V$.util.encodeUtf8(Q);var U=Q.length;X.messageLength+=U,U=[U/4294967296>>>0,U>>>0];for(var G=X.fullMessageLength.length-1;G>=0;--G)X.fullMessageLength[G]+=U[1],U[1]=U[0]+(X.fullMessageLength[G]/4294967296>>>0),X.fullMessageLength[G]=X.fullMessageLength[G]>>>0,U[0]=U[1]/4294967296>>>0;if($.putBytes(Q),lZ(J,Z,$),$.read>2048||$.length()===0)$.compact();return X},X.digest=function(){var Q=V$.util.createBuffer();Q.putBytes($.bytes());var Y=X.fullMessageLength[X.fullMessageLength.length-1]+X.messageLengthSize,U=Y&X.blockLength-1;Q.putBytes(T0.substr(0,X.blockLength-U));var G,E,W=X.fullMessageLength[0]*8;for(var H=0;H<X.fullMessageLength.length-1;++H)G=X.fullMessageLength[H+1]*8,E=G/4294967296>>>0,W+=E,Q.putInt32(W>>>0),W=G>>>0;Q.putInt32(W);var O={h0:J.h0,h1:J.h1,h2:J.h2,h3:J.h3,h4:J.h4,h5:J.h5,h6:J.h6,h7:J.h7};lZ(O,Z,Q);var M=V$.util.createBuffer();return M.putInt32(O.h0),M.putInt32(O.h1),M.putInt32(O.h2),M.putInt32(O.h3),M.putInt32(O.h4),M.putInt32(O.h5),M.putInt32(O.h6),M.putInt32(O.h7),M},X};var T0=null,cZ=!1,nZ=null;function EU(){T0=String.fromCharCode(128),T0+=V$.util.fillString(String.fromCharCode(0),64),nZ=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],cZ=!0}function lZ(J,$,Z){var X,Q,Y,U,G,E,W,H,O,M,P,z,A,T,C,L=Z.length();while(L>=64){for(W=0;W<16;++W)$[W]=Z.getInt32();for(;W<64;++W)X=$[W-2],X=(X>>>17|X<<15)^(X>>>19|X<<13)^X>>>10,Q=$[W-15],Q=(Q>>>7|Q<<25)^(Q>>>18|Q<<14)^Q>>>3,$[W]=X+$[W-7]+Q+$[W-16]|0;H=J.h0,O=J.h1,M=J.h2,P=J.h3,z=J.h4,A=J.h5,T=J.h6,C=J.h7;for(W=0;W<64;++W)U=(z>>>6|z<<26)^(z>>>11|z<<21)^(z>>>25|z<<7),G=T^z&(A^T),Y=(H>>>2|H<<30)^(H>>>13|H<<19)^(H>>>22|H<<10),E=H&O|M&(H^O),X=C+U+G+nZ[W]+$[W],Q=Y+E,C=T,T=A,A=z,z=P+X>>>0,P=M,M=O,O=H,H=X+Q>>>0;J.h0=J.h0+H|0,J.h1=J.h1+O|0,J.h2=J.h2+M|0,J.h3=J.h3+P|0,J.h4=J.h4+z|0,J.h5=J.h5+A|0,J.h6=J.h6+T|0,J.h7=J.h7+C|0,L-=64}}});var C0=c((qH,aZ)=>{var q$=o();XJ();var mX=null;if(q$.util.isNodejs&&!q$.options.usePureJavaScript&&!process.versions["node-webkit"])mX=A0("crypto");var HU=aZ.exports=q$.prng=q$.prng||{};HU.create=function(J){var $={plugin:J,key:null,seed:null,time:null,reseeds:0,generated:0,keyBytes:""},Z=J.md,X=new Array(32);for(var Q=0;Q<32;++Q)X[Q]=Z.create();$.pools=X,$.pool=0,$.generate=function(W,H){if(!H)return $.generateSync(W);var O=$.plugin.cipher,M=$.plugin.increment,P=$.plugin.formatKey,z=$.plugin.formatSeed,A=q$.util.createBuffer();$.key=null,T();function T(C){if(C)return H(C);if(A.length()>=W)return H(null,A.getBytes(W));if($.generated>1048575)$.key=null;if($.key===null)return q$.util.nextTick(function(){Y(T)});var L=O($.key,$.seed);$.generated+=L.length,A.putBytes(L),$.key=P(O($.key,M($.seed))),$.seed=z(O($.key,$.seed)),q$.util.setImmediate(T)}},$.generateSync=function(W){var H=$.plugin.cipher,O=$.plugin.increment,M=$.plugin.formatKey,P=$.plugin.formatSeed;$.key=null;var z=q$.util.createBuffer();while(z.length()<W){if($.generated>1048575)$.key=null;if($.key===null)U();var A=H($.key,$.seed);$.generated+=A.length,z.putBytes(A),$.key=M(H($.key,O($.seed))),$.seed=P(H($.key,$.seed))}return z.getBytes(W)};function Y(W){if($.pools[0].messageLength>=32)return G(),W();var H=32-$.pools[0].messageLength<<5;$.seedFile(H,function(O,M){if(O)return W(O);$.collect(M),G(),W()})}function U(){if($.pools[0].messageLength>=32)return G();var W=32-$.pools[0].messageLength<<5;$.collect($.seedFileSync(W)),G()}function G(){$.reseeds=$.reseeds===4294967295?0:$.reseeds+1;var W=$.plugin.md.create();W.update($.keyBytes);var H=1;for(var O=0;O<32;++O){if($.reseeds%H===0)W.update($.pools[O].digest().getBytes()),$.pools[O].start();H=H<<1}$.keyBytes=W.digest().getBytes(),W.start(),W.update($.keyBytes);var M=W.digest().getBytes();$.key=$.plugin.formatKey($.keyBytes),$.seed=$.plugin.formatSeed(M),$.generated=0}function E(W){var H=null,O=q$.util.globalScope,M=O.crypto||O.msCrypto;if(M&&M.getRandomValues)H=function(v){return M.getRandomValues(v)};var P=q$.util.createBuffer();if(H)while(P.length()<W){var z=Math.max(1,Math.min(W-P.length(),65536)/4),A=new Uint32Array(Math.floor(z));try{H(A);for(var T=0;T<A.length;++T)P.putInt32(A[T])}catch(v){if(!(typeof QuotaExceededError!=="undefined"&&v instanceof QuotaExceededError))throw v}}if(P.length()<W){var C,L,w,f=Math.floor(Math.random()*65536);while(P.length()<W){L=16807*(f&65535),C=16807*(f>>16),L+=(C&32767)<<16,L+=C>>15,L=(L&2147483647)+(L>>31),f=L&4294967295;for(var T=0;T<3;++T)w=f>>>(T<<3),w^=Math.floor(Math.random()*256),P.putByte(w&255)}}return P.getBytes(W)}if(mX)$.seedFile=function(W,H){mX.randomBytes(W,function(O,M){if(O)return H(O);H(null,M.toString())})},$.seedFileSync=function(W){return mX.randomBytes(W).toString()};else $.seedFile=function(W,H){try{H(null,E(W))}catch(O){H(O)}},$.seedFileSync=E;return $.collect=function(W){var H=W.length;for(var O=0;O<H;++O)$.pools[$.pool].update(W.substr(O,1)),$.pool=$.pool===31?0:$.pool+1},$.collectInt=function(W,H){var O="";for(var M=0;M<H;M+=8)O+=String.fromCharCode(W>>M&255);$.collect(O)},$.registerWorker=function(W){if(W===self)$.seedFile=function(O,M){function P(z){var A=z.data;if(A.forge&&A.forge.prng)self.removeEventListener("message",P),M(A.forge.prng.err,A.forge.prng.bytes)}self.addEventListener("message",P),self.postMessage({forge:{prng:{needed:O}}})};else{var H=function(O){var M=O.data;if(M.forge&&M.forge.prng)$.seedFile(M.forge.prng.needed,function(P,z){W.postMessage({forge:{prng:{err:P,bytes:z}}})})};W.addEventListener("message",H)}},$}});var J$=c((FH,S0)=>{var SJ=o();L$();N0();C0();XJ();(function(){if(SJ.random&&SJ.random.getBytes){S0.exports=SJ.random;return}(function(J){var $={},Z=new Array(4),X=SJ.util.createBuffer();$.formatKey=function(O){var M=SJ.util.createBuffer(O);return O=new Array(4),O[0]=M.getInt32(),O[1]=M.getInt32(),O[2]=M.getInt32(),O[3]=M.getInt32(),SJ.aes._expandKey(O,!1)},$.formatSeed=function(O){var M=SJ.util.createBuffer(O);return O=new Array(4),O[0]=M.getInt32(),O[1]=M.getInt32(),O[2]=M.getInt32(),O[3]=M.getInt32(),O},$.cipher=function(O,M){return SJ.aes._updateBlock(O,M,Z,!1),X.putInt32(Z[0]),X.putInt32(Z[1]),X.putInt32(Z[2]),X.putInt32(Z[3]),X.getBytes()},$.increment=function(O){return++O[3],O},$.md=SJ.md.sha256;function Q(){var O=SJ.prng.create($);return O.getBytes=function(M,P){return O.generate(M,P)},O.getBytesSync=function(M){return O.generate(M)},O}var Y=Q(),U=null,G=SJ.util.globalScope,E=G.crypto||G.msCrypto;if(E&&E.getRandomValues)U=function(O){return E.getRandomValues(O)};if(SJ.options.usePureJavaScript||!SJ.util.isNodejs&&!U){if(typeof window==="undefined"||window.document===void 0);if(Y.collectInt(+new Date,32),typeof navigator!=="undefined"){var W="";for(var H in navigator)try{if(typeof navigator[H]=="string")W+=navigator[H]}catch(O){}Y.collect(W),W=null}if(J)J().mousemove(function(O){Y.collectInt(O.clientX,16),Y.collectInt(O.clientY,16)}),J().keypress(function(O){Y.collectInt(O.charCode,8)})}if(!SJ.random)SJ.random=Y;else for(var H in Y)SJ.random[H]=Y[H];SJ.random.createInstance=Q,S0.exports=SJ.random})(typeof jQuery!=="undefined"?jQuery:null)})()});var w0=c((MH,rZ)=>{var iJ=o();XJ();var L0=[217,120,249,196,25,221,181,237,40,233,253,121,74,160,216,157,198,126,55,131,43,118,83,142,98,76,100,136,68,139,251,162,23,154,89,245,135,179,79,19,97,69,109,141,9,129,125,50,189,143,64,235,134,183,123,11,240,149,33,34,92,107,78,130,84,214,101,147,206,96,178,28,115,86,192,20,167,140,241,220,18,117,202,31,59,190,228,209,66,61,212,48,163,60,182,38,111,191,14,218,70,105,7,87,39,242,29,155,188,148,67,3,248,17,199,246,144,239,62,231,6,195,213,47,200,102,30,215,8,232,234,222,128,82,238,247,132,170,114,172,53,77,106,42,150,26,210,113,90,21,73,116,75,159,208,94,4,24,164,236,194,224,65,110,15,81,203,204,36,145,175,80,161,244,112,57,153,124,58,133,35,184,180,122,252,2,54,91,37,85,151,49,45,93,250,152,227,138,146,174,5,223,41,16,103,108,186,201,211,0,230,207,225,158,168,44,99,22,1,63,88,226,137,169,13,56,52,27,171,51,255,176,187,72,12,95,185,177,205,46,197,243,219,71,229,165,156,119,10,166,32,104,254,127,193,173],iZ=[1,2,3,5],OU=function(J,$){return J<<$&65535|(J&65535)>>16-$},VU=function(J,$){return(J&65535)>>$|J<<16-$&65535};rZ.exports=iJ.rc2=iJ.rc2||{};iJ.rc2.expandKey=function(J,$){if(typeof J==="string")J=iJ.util.createBuffer(J);$=$||128;var Z=J,X=J.length(),Q=$,Y=Math.ceil(Q/8),U=255>>(Q&7),G;for(G=X;G<128;G++)Z.putByte(L0[Z.at(G-1)+Z.at(G-X)&255]);Z.setAt(128-Y,L0[Z.at(128-Y)&U]);for(G=127-Y;G>=0;G--)Z.setAt(G,L0[Z.at(G+1)^Z.at(G+Y)]);return Z};var sZ=function(J,$,Z){var X=!1,Q=null,Y=null,U=null,G,E,W,H,O=[];J=iJ.rc2.expandKey(J,$);for(W=0;W<64;W++)O.push(J.getInt16Le());if(Z)G=function(z){for(W=0;W<4;W++)z[W]+=O[H]+(z[(W+3)%4]&z[(W+2)%4])+(~z[(W+3)%4]&z[(W+1)%4]),z[W]=OU(z[W],iZ[W]),H++},E=function(z){for(W=0;W<4;W++)z[W]+=O[z[(W+3)%4]&63]};else G=function(z){for(W=3;W>=0;W--)z[W]=VU(z[W],iZ[W]),z[W]-=O[H]+(z[(W+3)%4]&z[(W+2)%4])+(~z[(W+3)%4]&z[(W+1)%4]),H--},E=function(z){for(W=3;W>=0;W--)z[W]-=O[z[(W+3)%4]&63]};var M=function(z){var A=[];for(W=0;W<4;W++){var T=Q.getInt16Le();if(U!==null)if(Z)T^=U.getInt16Le();else U.putInt16Le(T);A.push(T&65535)}H=Z?0:63;for(var C=0;C<z.length;C++)for(var L=0;L<z[C][0];L++)z[C][1](A);for(W=0;W<4;W++){if(U!==null)if(Z)U.putInt16Le(A[W]);else A[W]^=U.getInt16Le();Y.putInt16Le(A[W])}},P=null;return P={start:function(z,A){if(z){if(typeof z==="string")z=iJ.util.createBuffer(z)}X=!1,Q=iJ.util.createBuffer(),Y=A||new iJ.util.createBuffer,U=z,P.output=Y},update:function(z){if(!X)Q.putBuffer(z);while(Q.length()>=8)M([[5,G],[1,E],[6,G],[1,E],[5,G]])},finish:function(z){var A=!0;if(Z)if(z)A=z(8,Q,!Z);else{var T=Q.length()===8?8:8-Q.length();Q.fillWithByte(T,T)}if(A)X=!0,P.update();if(!Z){if(A=Q.length()===0,A)if(z)A=z(8,Y,!Z);else{var C=Y.length(),L=Y.at(C-1);if(L>C)A=!1;else Y.truncate(L)}}return A}},P};iJ.rc2.startEncrypting=function(J,$,Z){var X=iJ.rc2.createEncryptionCipher(J,128);return X.start($,Z),X};iJ.rc2.createEncryptionCipher=function(J,$){return sZ(J,$,!0)};iJ.rc2.startDecrypting=function(J,$,Z){var X=iJ.rc2.createDecryptionCipher(J,128);return X.start($,Z),X};iJ.rc2.createDecryptionCipher=function(J,$){return sZ(J,$,!1)}});var MX=c((zH,YQ)=>{var I0=o();YQ.exports=I0.jsbn=I0.jsbn||{};var A$,qU=244837814094590,tZ=(qU&16777215)==15715070;function I(J,$,Z){if(this.data=[],J!=null)if(typeof J=="number")this.fromNumber(J,$,Z);else if($==null&&typeof J!="string")this.fromString(J,256);else this.fromString(J,$)}I0.jsbn.BigInteger=I;function ZJ(){return new I(null)}function FU(J,$,Z,X,Q,Y){while(--Y>=0){var U=$*this.data[J++]+Z.data[X]+Q;Q=Math.floor(U/67108864),Z.data[X++]=U&67108863}return Q}function MU(J,$,Z,X,Q,Y){var U=$&32767,G=$>>15;while(--Y>=0){var E=this.data[J]&32767,W=this.data[J++]>>15,H=G*E+W*U;E=U*E+((H&32767)<<15)+Z.data[X]+(Q&1073741823),Q=(E>>>30)+(H>>>15)+G*W+(Q>>>30),Z.data[X++]=E&1073741823}return Q}function eZ(J,$,Z,X,Q,Y){var U=$&16383,G=$>>14;while(--Y>=0){var E=this.data[J]&16383,W=this.data[J++]>>14,H=G*E+W*U;E=U*E+((H&16383)<<14)+Z.data[X]+Q,Q=(E>>28)+(H>>14)+G*W,Z.data[X++]=E&268435455}return Q}if(typeof navigator==="undefined")I.prototype.am=eZ,A$=28;else if(tZ&&navigator.appName=="Microsoft Internet Explorer")I.prototype.am=MU,A$=30;else if(tZ&&navigator.appName!="Netscape")I.prototype.am=FU,A$=26;else I.prototype.am=eZ,A$=28;I.prototype.DB=A$;I.prototype.DM=(1<<A$)-1;I.prototype.DV=1<<A$;var B0=52;I.prototype.FV=Math.pow(2,B0);I.prototype.F1=B0-A$;I.prototype.F2=2*A$-B0;var zU="0123456789abcdefghijklmnopqrstuvwxyz",dX=new Array,r$,$$;r$=48;for($$=0;$$<=9;++$$)dX[r$++]=$$;r$=97;for($$=10;$$<36;++$$)dX[r$++]=$$;r$=65;for($$=10;$$<36;++$$)dX[r$++]=$$;function JQ(J){return zU.charAt(J)}function $Q(J,$){var Z=dX[J.charCodeAt($)];return Z==null?-1:Z}function DU(J){for(var $=this.t-1;$>=0;--$)J.data[$]=this.data[$];J.t=this.t,J.s=this.s}function PU(J){if(this.t=1,this.s=J<0?-1:0,J>0)this.data[0]=J;else if(J<-1)this.data[0]=J+this.DV;else this.t=0}function I$(J){var $=ZJ();return $.fromInt(J),$}function KU(J,$){var Z;if($==16)Z=4;else if($==8)Z=3;else if($==256)Z=8;else if($==2)Z=1;else if($==32)Z=5;else if($==4)Z=2;else{this.fromRadix(J,$);return}this.t=0,this.s=0;var X=J.length,Q=!1,Y=0;while(--X>=0){var U=Z==8?J[X]&255:$Q(J,X);if(U<0){if(J.charAt(X)=="-")Q=!0;continue}if(Q=!1,Y==0)this.data[this.t++]=U;else if(Y+Z>this.DB)this.data[this.t-1]|=(U&(1<<this.DB-Y)-1)<<Y,this.data[this.t++]=U>>this.DB-Y;else this.data[this.t-1]|=U<<Y;if(Y+=Z,Y>=this.DB)Y-=this.DB}if(Z==8&&(J[0]&128)!=0){if(this.s=-1,Y>0)this.data[this.t-1]|=(1<<this.DB-Y)-1<<Y}if(this.clamp(),Q)I.ZERO.subTo(this,this)}function RU(){var J=this.s&this.DM;while(this.t>0&&this.data[this.t-1]==J)--this.t}function AU(J){if(this.s<0)return"-"+this.negate().toString(J);var $;if(J==16)$=4;else if(J==8)$=3;else if(J==2)$=1;else if(J==32)$=5;else if(J==4)$=2;else return this.toRadix(J);var Z=(1<<$)-1,X,Q=!1,Y="",U=this.t,G=this.DB-U*this.DB%$;if(U-- >0){if(G<this.DB&&(X=this.data[U]>>G)>0)Q=!0,Y=JQ(X);while(U>=0){if(G<$)X=(this.data[U]&(1<<G)-1)<<$-G,X|=this.data[--U]>>(G+=this.DB-$);else if(X=this.data[U]>>(G-=$)&Z,G<=0)G+=this.DB,--U;if(X>0)Q=!0;if(Q)Y+=JQ(X)}}return Q?Y:"0"}function TU(){var J=ZJ();return I.ZERO.subTo(this,J),J}function NU(){return this.s<0?this.negate():this}function CU(J){var $=this.s-J.s;if($!=0)return $;var Z=this.t;if($=Z-J.t,$!=0)return this.s<0?-$:$;while(--Z>=0)if(($=this.data[Z]-J.data[Z])!=0)return $;return 0}function gX(J){var $=1,Z;if((Z=J>>>16)!=0)J=Z,$+=16;if((Z=J>>8)!=0)J=Z,$+=8;if((Z=J>>4)!=0)J=Z,$+=4;if((Z=J>>2)!=0)J=Z,$+=2;if((Z=J>>1)!=0)J=Z,$+=1;return $}function SU(){if(this.t<=0)return 0;return this.DB*(this.t-1)+gX(this.data[this.t-1]^this.s&this.DM)}function LU(J,$){var Z;for(Z=this.t-1;Z>=0;--Z)$.data[Z+J]=this.data[Z];for(Z=J-1;Z>=0;--Z)$.data[Z]=0;$.t=this.t+J,$.s=this.s}function wU(J,$){for(var Z=J;Z<this.t;++Z)$.data[Z-J]=this.data[Z];$.t=Math.max(this.t-J,0),$.s=this.s}function IU(J,$){var Z=J%this.DB,X=this.DB-Z,Q=(1<<X)-1,Y=Math.floor(J/this.DB),U=this.s<<Z&this.DM,G;for(G=this.t-1;G>=0;--G)$.data[G+Y+1]=this.data[G]>>X|U,U=(this.data[G]&Q)<<Z;for(G=Y-1;G>=0;--G)$.data[G]=0;$.data[Y]=U,$.t=this.t+Y+1,$.s=this.s,$.clamp()}function BU(J,$){$.s=this.s;var Z=Math.floor(J/this.DB);if(Z>=this.t){$.t=0;return}var X=J%this.DB,Q=this.DB-X,Y=(1<<X)-1;$.data[0]=this.data[Z]>>X;for(var U=Z+1;U<this.t;++U)$.data[U-Z-1]|=(this.data[U]&Y)<<Q,$.data[U-Z]=this.data[U]>>X;if(X>0)$.data[this.t-Z-1]|=(this.s&Y)<<Q;$.t=this.t-Z,$.clamp()}function jU(J,$){var Z=0,X=0,Q=Math.min(J.t,this.t);while(Z<Q)X+=this.data[Z]-J.data[Z],$.data[Z++]=X&this.DM,X>>=this.DB;if(J.t<this.t){X-=J.s;while(Z<this.t)X+=this.data[Z],$.data[Z++]=X&this.DM,X>>=this.DB;X+=this.s}else{X+=this.s;while(Z<J.t)X-=J.data[Z],$.data[Z++]=X&this.DM,X>>=this.DB;X-=J.s}if($.s=X<0?-1:0,X<-1)$.data[Z++]=this.DV+X;else if(X>0)$.data[Z++]=X;$.t=Z,$.clamp()}function xU(J,$){var Z=this.abs(),X=J.abs(),Q=Z.t;$.t=Q+X.t;while(--Q>=0)$.data[Q]=0;for(Q=0;Q<X.t;++Q)$.data[Q+Z.t]=Z.am(0,X.data[Q],$,Q,0,Z.t);if($.s=0,$.clamp(),this.s!=J.s)I.ZERO.subTo($,$)}function kU(J){var $=this.abs(),Z=J.t=2*$.t;while(--Z>=0)J.data[Z]=0;for(Z=0;Z<$.t-1;++Z){var X=$.am(Z,$.data[Z],J,2*Z,0,1);if((J.data[Z+$.t]+=$.am(Z+1,2*$.data[Z],J,2*Z+1,X,$.t-Z-1))>=$.DV)J.data[Z+$.t]-=$.DV,J.data[Z+$.t+1]=1}if(J.t>0)J.data[J.t-1]+=$.am(Z,$.data[Z],J,2*Z,0,1);J.s=0,J.clamp()}function vU(J,$,Z){var X=J.abs();if(X.t<=0)return;var Q=this.abs();if(Q.t<X.t){if($!=null)$.fromInt(0);if(Z!=null)this.copyTo(Z);return}if(Z==null)Z=ZJ();var Y=ZJ(),U=this.s,G=J.s,E=this.DB-gX(X.data[X.t-1]);if(E>0)X.lShiftTo(E,Y),Q.lShiftTo(E,Z);else X.copyTo(Y),Q.copyTo(Z);var W=Y.t,H=Y.data[W-1];if(H==0)return;var O=H*(1<<this.F1)+(W>1?Y.data[W-2]>>this.F2:0),M=this.FV/O,P=(1<<this.F1)/O,z=1<<this.F2,A=Z.t,T=A-W,C=$==null?ZJ():$;if(Y.dlShiftTo(T,C),Z.compareTo(C)>=0)Z.data[Z.t++]=1,Z.subTo(C,Z);I.ONE.dlShiftTo(W,C),C.subTo(Y,Y);while(Y.t<W)Y.data[Y.t++]=0;while(--T>=0){var L=Z.data[--A]==H?this.DM:Math.floor(Z.data[A]*M+(Z.data[A-1]+z)*P);if((Z.data[A]+=Y.am(0,L,Z,T,0,W))<L){Y.dlShiftTo(T,C),Z.subTo(C,Z);while(Z.data[A]<--L)Z.subTo(C,Z)}}if($!=null){if(Z.drShiftTo(W,$),U!=G)I.ZERO.subTo($,$)}if(Z.t=W,Z.clamp(),E>0)Z.rShiftTo(E,Z);if(U<0)I.ZERO.subTo(Z,Z)}function yU(J){var $=ZJ();if(this.abs().divRemTo(J,null,$),this.s<0&&$.compareTo(I.ZERO)>0)J.subTo($,$);return $}function u$(J){this.m=J}function _U(J){if(J.s<0||J.compareTo(this.m)>=0)return J.mod(this.m);else return J}function hU(J){return J}function fU(J){J.divRemTo(this.m,null,J)}function uU(J,$,Z){J.multiplyTo($,Z),this.reduce(Z)}function bU(J,$){J.squareTo($),this.reduce($)}u$.prototype.convert=_U;u$.prototype.revert=hU;u$.prototype.reduce=fU;u$.prototype.mulTo=uU;u$.prototype.sqrTo=bU;function mU(){if(this.t<1)return 0;var J=this.data[0];if((J&1)==0)return 0;var $=J&3;return $=$*(2-(J&15)*$)&15,$=$*(2-(J&255)*$)&255,$=$*(2-((J&65535)*$&65535))&65535,$=$*(2-J*$%this.DV)%this.DV,$>0?this.DV-$:-$}function b$(J){this.m=J,this.mp=J.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<J.DB-15)-1,this.mt2=2*J.t}function dU(J){var $=ZJ();if(J.abs().dlShiftTo(this.m.t,$),$.divRemTo(this.m,null,$),J.s<0&&$.compareTo(I.ZERO)>0)this.m.subTo($,$);return $}function gU(J){var $=ZJ();return J.copyTo($),this.reduce($),$}function lU(J){while(J.t<=this.mt2)J.data[J.t++]=0;for(var $=0;$<this.m.t;++$){var Z=J.data[$]&32767,X=Z*this.mpl+((Z*this.mph+(J.data[$]>>15)*this.mpl&this.um)<<15)&J.DM;Z=$+this.m.t,J.data[Z]+=this.m.am(0,X,J,$,0,this.m.t);while(J.data[Z]>=J.DV)J.data[Z]-=J.DV,J.data[++Z]++}if(J.clamp(),J.drShiftTo(this.m.t,J),J.compareTo(this.m)>=0)J.subTo(this.m,J)}function pU(J,$){J.squareTo($),this.reduce($)}function cU(J,$,Z){J.multiplyTo($,Z),this.reduce(Z)}b$.prototype.convert=dU;b$.prototype.revert=gU;b$.prototype.reduce=lU;b$.prototype.mulTo=cU;b$.prototype.sqrTo=pU;function nU(){return(this.t>0?this.data[0]&1:this.s)==0}function oU(J,$){if(J>4294967295||J<1)return I.ONE;var Z=ZJ(),X=ZJ(),Q=$.convert(this),Y=gX(J)-1;Q.copyTo(Z);while(--Y>=0)if($.sqrTo(Z,X),(J&1<<Y)>0)$.mulTo(X,Q,Z);else{var U=Z;Z=X,X=U}return $.revert(Z)}function aU(J,$){var Z;if(J<256||$.isEven())Z=new u$($);else Z=new b$($);return this.exp(J,Z)}I.prototype.copyTo=DU;I.prototype.fromInt=PU;I.prototype.fromString=KU;I.prototype.clamp=RU;I.prototype.dlShiftTo=LU;I.prototype.drShiftTo=wU;I.prototype.lShiftTo=IU;I.prototype.rShiftTo=BU;I.prototype.subTo=jU;I.prototype.multiplyTo=xU;I.prototype.squareTo=kU;I.prototype.divRemTo=vU;I.prototype.invDigit=mU;I.prototype.isEven=nU;I.prototype.exp=oU;I.prototype.toString=AU;I.prototype.negate=TU;I.prototype.abs=NU;I.prototype.compareTo=CU;I.prototype.bitLength=SU;I.prototype.mod=yU;I.prototype.modPowInt=aU;I.ZERO=I$(0);I.ONE=I$(1);function iU(){var J=ZJ();return this.copyTo(J),J}function sU(){if(this.s<0){if(this.t==1)return this.data[0]-this.DV;else if(this.t==0)return-1}else if(this.t==1)return this.data[0];else if(this.t==0)return 0;return(this.data[1]&(1<<32-this.DB)-1)<<this.DB|this.data[0]}function rU(){return this.t==0?this.s:this.data[0]<<24>>24}function tU(){return this.t==0?this.s:this.data[0]<<16>>16}function eU(J){return Math.floor(Math.LN2*this.DB/Math.log(J))}function JG(){if(this.s<0)return-1;else if(this.t<=0||this.t==1&&this.data[0]<=0)return 0;else return 1}function $G(J){if(J==null)J=10;if(this.signum()==0||J<2||J>36)return"0";var $=this.chunkSize(J),Z=Math.pow(J,$),X=I$(Z),Q=ZJ(),Y=ZJ(),U="";this.divRemTo(X,Q,Y);while(Q.signum()>0)U=(Z+Y.intValue()).toString(J).substr(1)+U,Q.divRemTo(X,Q,Y);return Y.intValue().toString(J)+U}function XG(J,$){if(this.fromInt(0),$==null)$=10;var Z=this.chunkSize($),X=Math.pow($,Z),Q=!1,Y=0,U=0;for(var G=0;G<J.length;++G){var E=$Q(J,G);if(E<0){if(J.charAt(G)=="-"&&this.signum()==0)Q=!0;continue}if(U=$*U+E,++Y>=Z)this.dMultiply(X),this.dAddOffset(U,0),Y=0,U=0}if(Y>0)this.dMultiply(Math.pow($,Y)),this.dAddOffset(U,0);if(Q)I.ZERO.subTo(this,this)}function ZG(J,$,Z){if(typeof $=="number")if(J<2)this.fromInt(1);else{if(this.fromNumber(J,Z),!this.testBit(J-1))this.bitwiseTo(I.ONE.shiftLeft(J-1),j0,this);if(this.isEven())this.dAddOffset(1,0);while(!this.isProbablePrime($))if(this.dAddOffset(2,0),this.bitLength()>J)this.subTo(I.ONE.shiftLeft(J-1),this)}else{var X=new Array,Q=J&7;if(X.length=(J>>3)+1,$.nextBytes(X),Q>0)X[0]&=(1<<Q)-1;else X[0]=0;this.fromString(X,256)}}function QG(){var J=this.t,$=new Array;$[0]=this.s;var Z=this.DB-J*this.DB%8,X,Q=0;if(J-- >0){if(Z<this.DB&&(X=this.data[J]>>Z)!=(this.s&this.DM)>>Z)$[Q++]=X|this.s<<this.DB-Z;while(J>=0){if(Z<8)X=(this.data[J]&(1<<Z)-1)<<8-Z,X|=this.data[--J]>>(Z+=this.DB-8);else if(X=this.data[J]>>(Z-=8)&255,Z<=0)Z+=this.DB,--J;if((X&128)!=0)X|=-256;if(Q==0&&(this.s&128)!=(X&128))++Q;if(Q>0||X!=this.s)$[Q++]=X}}return $}function YG(J){return this.compareTo(J)==0}function UG(J){return this.compareTo(J)<0?this:J}function GG(J){return this.compareTo(J)>0?this:J}function WG(J,$,Z){var X,Q,Y=Math.min(J.t,this.t);for(X=0;X<Y;++X)Z.data[X]=$(this.data[X],J.data[X]);if(J.t<this.t){Q=J.s&this.DM;for(X=Y;X<this.t;++X)Z.data[X]=$(this.data[X],Q);Z.t=this.t}else{Q=this.s&this.DM;for(X=Y;X<J.t;++X)Z.data[X]=$(Q,J.data[X]);Z.t=J.t}Z.s=$(this.s,J.s),Z.clamp()}function EG(J,$){return J&$}function HG(J){var $=ZJ();return this.bitwiseTo(J,EG,$),$}function j0(J,$){return J|$}function OG(J){var $=ZJ();return this.bitwiseTo(J,j0,$),$}function XQ(J,$){return J^$}function VG(J){var $=ZJ();return this.bitwiseTo(J,XQ,$),$}function ZQ(J,$){return J&~$}function qG(J){var $=ZJ();return this.bitwiseTo(J,ZQ,$),$}function FG(){var J=ZJ();for(var $=0;$<this.t;++$)J.data[$]=this.DM&~this.data[$];return J.t=this.t,J.s=~this.s,J}function MG(J){var $=ZJ();if(J<0)this.rShiftTo(-J,$);else this.lShiftTo(J,$);return $}function zG(J){var $=ZJ();if(J<0)this.lShiftTo(-J,$);else this.rShiftTo(J,$);return $}function DG(J){if(J==0)return-1;var $=0;if((J&65535)==0)J>>=16,$+=16;if((J&255)==0)J>>=8,$+=8;if((J&15)==0)J>>=4,$+=4;if((J&3)==0)J>>=2,$+=2;if((J&1)==0)++$;return $}function PG(){for(var J=0;J<this.t;++J)if(this.data[J]!=0)return J*this.DB+DG(this.data[J]);if(this.s<0)return this.t*this.DB;return-1}function KG(J){var $=0;while(J!=0)J&=J-1,++$;return $}function RG(){var J=0,$=this.s&this.DM;for(var Z=0;Z<this.t;++Z)J+=KG(this.data[Z]^$);return J}function AG(J){var $=Math.floor(J/this.DB);if($>=this.t)return this.s!=0;return(this.data[$]&1<<J%this.DB)!=0}function TG(J,$){var Z=I.ONE.shiftLeft(J);return this.bitwiseTo(Z,$,Z),Z}function NG(J){return this.changeBit(J,j0)}function CG(J){return this.changeBit(J,ZQ)}function SG(J){return this.changeBit(J,XQ)}function LG(J,$){var Z=0,X=0,Q=Math.min(J.t,this.t);while(Z<Q)X+=this.data[Z]+J.data[Z],$.data[Z++]=X&this.DM,X>>=this.DB;if(J.t<this.t){X+=J.s;while(Z<this.t)X+=this.data[Z],$.data[Z++]=X&this.DM,X>>=this.DB;X+=this.s}else{X+=this.s;while(Z<J.t)X+=J.data[Z],$.data[Z++]=X&this.DM,X>>=this.DB;X+=J.s}if($.s=X<0?-1:0,X>0)$.data[Z++]=X;else if(X<-1)$.data[Z++]=this.DV+X;$.t=Z,$.clamp()}function wG(J){var $=ZJ();return this.addTo(J,$),$}function IG(J){var $=ZJ();return this.subTo(J,$),$}function BG(J){var $=ZJ();return this.multiplyTo(J,$),$}function jG(J){var $=ZJ();return this.divRemTo(J,$,null),$}function xG(J){var $=ZJ();return this.divRemTo(J,null,$),$}function kG(J){var $=ZJ(),Z=ZJ();return this.divRemTo(J,$,Z),new Array($,Z)}function vG(J){this.data[this.t]=this.am(0,J-1,this,0,0,this.t),++this.t,this.clamp()}function yG(J,$){if(J==0)return;while(this.t<=$)this.data[this.t++]=0;this.data[$]+=J;while(this.data[$]>=this.DV){if(this.data[$]-=this.DV,++$>=this.t)this.data[this.t++]=0;++this.data[$]}}function FX(){}function QQ(J){return J}function _G(J,$,Z){J.multiplyTo($,Z)}function hG(J,$){J.squareTo($)}FX.prototype.convert=QQ;FX.prototype.revert=QQ;FX.prototype.mulTo=_G;FX.prototype.sqrTo=hG;function fG(J){return this.exp(J,new FX)}function uG(J,$,Z){var X=Math.min(this.t+J.t,$);Z.s=0,Z.t=X;while(X>0)Z.data[--X]=0;var Q;for(Q=Z.t-this.t;X<Q;++X)Z.data[X+this.t]=this.am(0,J.data[X],Z,X,0,this.t);for(Q=Math.min(J.t,$);X<Q;++X)this.am(0,J.data[X],Z,X,0,$-X);Z.clamp()}function bG(J,$,Z){--$;var X=Z.t=this.t+J.t-$;Z.s=0;while(--X>=0)Z.data[X]=0;for(X=Math.max($-this.t,0);X<J.t;++X)Z.data[this.t+X-$]=this.am($-X,J.data[X],Z,0,0,this.t+X-$);Z.clamp(),Z.drShiftTo(1,Z)}function t$(J){this.r2=ZJ(),this.q3=ZJ(),I.ONE.dlShiftTo(2*J.t,this.r2),this.mu=this.r2.divide(J),this.m=J}function mG(J){if(J.s<0||J.t>2*this.m.t)return J.mod(this.m);else if(J.compareTo(this.m)<0)return J;else{var $=ZJ();return J.copyTo($),this.reduce($),$}}function dG(J){return J}function gG(J){if(J.drShiftTo(this.m.t-1,this.r2),J.t>this.m.t+1)J.t=this.m.t+1,J.clamp();this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);while(J.compareTo(this.r2)<0)J.dAddOffset(1,this.m.t+1);J.subTo(this.r2,J);while(J.compareTo(this.m)>=0)J.subTo(this.m,J)}function lG(J,$){J.squareTo($),this.reduce($)}function pG(J,$,Z){J.multiplyTo($,Z),this.reduce(Z)}t$.prototype.convert=mG;t$.prototype.revert=dG;t$.prototype.reduce=gG;t$.prototype.mulTo=pG;t$.prototype.sqrTo=lG;function cG(J,$){var Z=J.bitLength(),X,Q=I$(1),Y;if(Z<=0)return Q;else if(Z<18)X=1;else if(Z<48)X=3;else if(Z<144)X=4;else if(Z<768)X=5;else X=6;if(Z<8)Y=new u$($);else if($.isEven())Y=new t$($);else Y=new b$($);var U=new Array,G=3,E=X-1,W=(1<<X)-1;if(U[1]=Y.convert(this),X>1){var H=ZJ();Y.sqrTo(U[1],H);while(G<=W)U[G]=ZJ(),Y.mulTo(H,U[G-2],U[G]),G+=2}var O=J.t-1,M,P=!0,z=ZJ(),A;Z=gX(J.data[O])-1;while(O>=0){if(Z>=E)M=J.data[O]>>Z-E&W;else if(M=(J.data[O]&(1<<Z+1)-1)<<E-Z,O>0)M|=J.data[O-1]>>this.DB+Z-E;G=X;while((M&1)==0)M>>=1,--G;if((Z-=G)<0)Z+=this.DB,--O;if(P)U[M].copyTo(Q),P=!1;else{while(G>1)Y.sqrTo(Q,z),Y.sqrTo(z,Q),G-=2;if(G>0)Y.sqrTo(Q,z);else A=Q,Q=z,z=A;Y.mulTo(z,U[M],Q)}while(O>=0&&(J.data[O]&1<<Z)==0)if(Y.sqrTo(Q,z),A=Q,Q=z,z=A,--Z<0)Z=this.DB-1,--O}return Y.revert(Q)}function nG(J){var $=this.s<0?this.negate():this.clone(),Z=J.s<0?J.negate():J.clone();if($.compareTo(Z)<0){var X=$;$=Z,Z=X}var Q=$.getLowestSetBit(),Y=Z.getLowestSetBit();if(Y<0)return $;if(Q<Y)Y=Q;if(Y>0)$.rShiftTo(Y,$),Z.rShiftTo(Y,Z);while($.signum()>0){if((Q=$.getLowestSetBit())>0)$.rShiftTo(Q,$);if((Q=Z.getLowestSetBit())>0)Z.rShiftTo(Q,Z);if($.compareTo(Z)>=0)$.subTo(Z,$),$.rShiftTo(1,$);else Z.subTo($,Z),Z.rShiftTo(1,Z)}if(Y>0)Z.lShiftTo(Y,Z);return Z}function oG(J){if(J<=0)return 0;var $=this.DV%J,Z=this.s<0?J-1:0;if(this.t>0)if($==0)Z=this.data[0]%J;else for(var X=this.t-1;X>=0;--X)Z=($*Z+this.data[X])%J;return Z}function aG(J){var $=J.isEven();if(this.isEven()&&$||J.signum()==0)return I.ZERO;var Z=J.clone(),X=this.clone(),Q=I$(1),Y=I$(0),U=I$(0),G=I$(1);while(Z.signum()!=0){while(Z.isEven()){if(Z.rShiftTo(1,Z),$){if(!Q.isEven()||!Y.isEven())Q.addTo(this,Q),Y.subTo(J,Y);Q.rShiftTo(1,Q)}else if(!Y.isEven())Y.subTo(J,Y);Y.rShiftTo(1,Y)}while(X.isEven()){if(X.rShiftTo(1,X),$){if(!U.isEven()||!G.isEven())U.addTo(this,U),G.subTo(J,G);U.rShiftTo(1,U)}else if(!G.isEven())G.subTo(J,G);G.rShiftTo(1,G)}if(Z.compareTo(X)>=0){if(Z.subTo(X,Z),$)Q.subTo(U,Q);Y.subTo(G,Y)}else{if(X.subTo(Z,X),$)U.subTo(Q,U);G.subTo(Y,G)}}if(X.compareTo(I.ONE)!=0)return I.ZERO;if(G.compareTo(J)>=0)return G.subtract(J);if(G.signum()<0)G.addTo(J,G);else return G;if(G.signum()<0)return G.add(J);else return G}var W$=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509],iG=67108864/W$[W$.length-1];function sG(J){var $,Z=this.abs();if(Z.t==1&&Z.data[0]<=W$[W$.length-1]){for($=0;$<W$.length;++$)if(Z.data[0]==W$[$])return!0;return!1}if(Z.isEven())return!1;$=1;while($<W$.length){var X=W$[$],Q=$+1;while(Q<W$.length&&X<iG)X*=W$[Q++];X=Z.modInt(X);while($<Q)if(X%W$[$++]==0)return!1}return Z.millerRabin(J)}function rG(J){var $=this.subtract(I.ONE),Z=$.getLowestSetBit();if(Z<=0)return!1;var X=$.shiftRight(Z),Q=tG(),Y;for(var U=0;U<J;++U){do Y=new I(this.bitLength(),Q);while(Y.compareTo(I.ONE)<=0||Y.compareTo($)>=0);var G=Y.modPow(X,this);if(G.compareTo(I.ONE)!=0&&G.compareTo($)!=0){var E=1;while(E++<Z&&G.compareTo($)!=0)if(G=G.modPowInt(2,this),G.compareTo(I.ONE)==0)return!1;if(G.compareTo($)!=0)return!1}}return!0}function tG(){return{nextBytes:function(J){for(var $=0;$<J.length;++$)J[$]=Math.floor(Math.random()*256)}}}I.prototype.chunkSize=eU;I.prototype.toRadix=$G;I.prototype.fromRadix=XG;I.prototype.fromNumber=ZG;I.prototype.bitwiseTo=WG;I.prototype.changeBit=TG;I.prototype.addTo=LG;I.prototype.dMultiply=vG;I.prototype.dAddOffset=yG;I.prototype.multiplyLowerTo=uG;I.prototype.multiplyUpperTo=bG;I.prototype.modInt=oG;I.prototype.millerRabin=rG;I.prototype.clone=iU;I.prototype.intValue=sU;I.prototype.byteValue=rU;I.prototype.shortValue=tU;I.prototype.signum=JG;I.prototype.toByteArray=QG;I.prototype.equals=YG;I.prototype.min=UG;I.prototype.max=GG;I.prototype.and=HG;I.prototype.or=OG;I.prototype.xor=VG;I.prototype.andNot=qG;I.prototype.not=FG;I.prototype.shiftLeft=MG;I.prototype.shiftRight=zG;I.prototype.getLowestSetBit=PG;I.prototype.bitCount=RG;I.prototype.testBit=AG;I.prototype.setBit=NG;I.prototype.clearBit=CG;I.prototype.flipBit=SG;I.prototype.add=wG;I.prototype.subtract=IG;I.prototype.multiply=BG;I.prototype.divide=jG;I.prototype.remainder=xG;I.prototype.divideAndRemainder=kG;I.prototype.modPow=cG;I.prototype.modInverse=aG;I.prototype.pow=fG;I.prototype.gcd=nG;I.prototype.isProbablePrime=sG});var e$=c((DH,EQ)=>{var F$=o();E$();XJ();var GQ=EQ.exports=F$.sha1=F$.sha1||{};F$.md.sha1=F$.md.algorithms.sha1=GQ;GQ.create=function(){if(!WQ)eG();var J=null,$=F$.util.createBuffer(),Z=new Array(80),X={algorithm:"sha1",blockLength:64,digestLength:20,messageLength:0,fullMessageLength:null,messageLengthSize:8};return X.start=function(){X.messageLength=0,X.fullMessageLength=X.messageLength64=[];var Q=X.messageLengthSize/4;for(var Y=0;Y<Q;++Y)X.fullMessageLength.push(0);return $=F$.util.createBuffer(),J={h0:1732584193,h1:4023233417,h2:2562383102,h3:271733878,h4:3285377520},X},X.start(),X.update=function(Q,Y){if(Y==="utf8")Q=F$.util.encodeUtf8(Q);var U=Q.length;X.messageLength+=U,U=[U/4294967296>>>0,U>>>0];for(var G=X.fullMessageLength.length-1;G>=0;--G)X.fullMessageLength[G]+=U[1],U[1]=U[0]+(X.fullMessageLength[G]/4294967296>>>0),X.fullMessageLength[G]=X.fullMessageLength[G]>>>0,U[0]=U[1]/4294967296>>>0;if($.putBytes(Q),UQ(J,Z,$),$.read>2048||$.length()===0)$.compact();return X},X.digest=function(){var Q=F$.util.createBuffer();Q.putBytes($.bytes());var Y=X.fullMessageLength[X.fullMessageLength.length-1]+X.messageLengthSize,U=Y&X.blockLength-1;Q.putBytes(x0.substr(0,X.blockLength-U));var G,E,W=X.fullMessageLength[0]*8;for(var H=0;H<X.fullMessageLength.length-1;++H)G=X.fullMessageLength[H+1]*8,E=G/4294967296>>>0,W+=E,Q.putInt32(W>>>0),W=G>>>0;Q.putInt32(W);var O={h0:J.h0,h1:J.h1,h2:J.h2,h3:J.h3,h4:J.h4};UQ(O,Z,Q);var M=F$.util.createBuffer();return M.putInt32(O.h0),M.putInt32(O.h1),M.putInt32(O.h2),M.putInt32(O.h3),M.putInt32(O.h4),M},X};var x0=null,WQ=!1;function eG(){x0=String.fromCharCode(128),x0+=F$.util.fillString(String.fromCharCode(0),64),WQ=!0}function UQ(J,$,Z){var X,Q,Y,U,G,E,W,H,O=Z.length();while(O>=64){Q=J.h0,Y=J.h1,U=J.h2,G=J.h3,E=J.h4;for(H=0;H<16;++H)X=Z.getInt32(),$[H]=X,W=G^Y&(U^G),X=(Q<<5|Q>>>27)+W+E+1518500249+X,E=G,G=U,U=(Y<<30|Y>>>2)>>>0,Y=Q,Q=X;for(;H<20;++H)X=$[H-3]^$[H-8]^$[H-14]^$[H-16],X=X<<1|X>>>31,$[H]=X,W=G^Y&(U^G),X=(Q<<5|Q>>>27)+W+E+1518500249+X,E=G,G=U,U=(Y<<30|Y>>>2)>>>0,Y=Q,Q=X;for(;H<32;++H)X=$[H-3]^$[H-8]^$[H-14]^$[H-16],X=X<<1|X>>>31,$[H]=X,W=Y^U^G,X=(Q<<5|Q>>>27)+W+E+1859775393+X,E=G,G=U,U=(Y<<30|Y>>>2)>>>0,Y=Q,Q=X;for(;H<40;++H)X=$[H-6]^$[H-16]^$[H-28]^$[H-32],X=X<<2|X>>>30,$[H]=X,W=Y^U^G,X=(Q<<5|Q>>>27)+W+E+1859775393+X,E=G,G=U,U=(Y<<30|Y>>>2)>>>0,Y=Q,Q=X;for(;H<60;++H)X=$[H-6]^$[H-16]^$[H-28]^$[H-32],X=X<<2|X>>>30,$[H]=X,W=Y&U|G&(Y^U),X=(Q<<5|Q>>>27)+W+E+2400959708+X,E=G,G=U,U=(Y<<30|Y>>>2)>>>0,Y=Q,Q=X;for(;H<80;++H)X=$[H-6]^$[H-16]^$[H-28]^$[H-32],X=X<<2|X>>>30,$[H]=X,W=Y^U^G,X=(Q<<5|Q>>>27)+W+E+3395469782+X,E=G,G=U,U=(Y<<30|Y>>>2)>>>0,Y=Q,Q=X;J.h0=J.h0+Q|0,J.h1=J.h1+Y|0,J.h2=J.h2+U|0,J.h3=J.h3+G|0,J.h4=J.h4+E|0,O-=64}}});var k0=c((PH,OQ)=>{var M$=o();XJ();J$();e$();var HQ=OQ.exports=M$.pkcs1=M$.pkcs1||{};HQ.encode_rsa_oaep=function(J,$,Z){var X,Q,Y,U;if(typeof Z==="string")X=Z,Q=arguments[3]||void 0,Y=arguments[4]||void 0;else if(Z){if(X=Z.label||void 0,Q=Z.seed||void 0,Y=Z.md||void 0,Z.mgf1&&Z.mgf1.md)U=Z.mgf1.md}if(!Y)Y=M$.md.sha1.create();else Y.start();if(!U)U=Y;var G=Math.ceil(J.n.bitLength()/8),E=G-2*Y.digestLength-2;if($.length>E){var W=new Error("RSAES-OAEP input message length is too long.");throw W.length=$.length,W.maxLength=E,W}if(!X)X="";Y.update(X,"raw");var H=Y.digest(),O="",M=E-$.length;for(var P=0;P<M;P++)O+="\x00";var z=H.getBytes()+O+"\x01"+$;if(!Q)Q=M$.random.getBytes(Y.digestLength);else if(Q.length!==Y.digestLength){var W=new Error("Invalid RSAES-OAEP seed. The seed length must match the digest length.");throw W.seedLength=Q.length,W.digestLength=Y.digestLength,W}var A=lX(Q,G-Y.digestLength-1,U),T=M$.util.xorBytes(z,A,z.length),C=lX(T,Y.digestLength,U),L=M$.util.xorBytes(Q,C,Q.length);return"\x00"+L+T};HQ.decode_rsa_oaep=function(J,$,Z){var X,Q,Y;if(typeof Z==="string")X=Z,Q=arguments[3]||void 0;else if(Z){if(X=Z.label||void 0,Q=Z.md||void 0,Z.mgf1&&Z.mgf1.md)Y=Z.mgf1.md}var U=Math.ceil(J.n.bitLength()/8);if($.length!==U){var T=new Error("RSAES-OAEP encoded message length is invalid.");throw T.length=$.length,T.expectedLength=U,T}if(Q===void 0)Q=M$.md.sha1.create();else Q.start();if(!Y)Y=Q;if(U<2*Q.digestLength+2)throw new Error("RSAES-OAEP key is too short for the hash function.");if(!X)X="";Q.update(X,"raw");var G=Q.digest().getBytes(),E=$.charAt(0),W=$.substring(1,Q.digestLength+1),H=$.substring(1+Q.digestLength),O=lX(H,Q.digestLength,Y),M=M$.util.xorBytes(W,O,W.length),P=lX(M,U-Q.digestLength-1,Y),z=M$.util.xorBytes(H,P,H.length),A=z.substring(0,Q.digestLength),T=E!=="\x00";for(var C=0;C<Q.digestLength;++C)T|=G.charAt(C)!==A.charAt(C);var L=1,w=Q.digestLength;for(var f=Q.digestLength;f<z.length;f++){var v=z.charCodeAt(f),x=v&1^1,p=L?65534:0;T|=v&p,L=L&x,w+=L}if(T||z.charCodeAt(w)!==1)throw new Error("Invalid RSAES-OAEP padding.");return z.substring(w+1)};function lX(J,$,Z){if(!Z)Z=M$.md.sha1.create();var X="",Q=Math.ceil($/Z.digestLength);for(var Y=0;Y<Q;++Y){var U=String.fromCharCode(Y>>24&255,Y>>16&255,Y>>8&255,Y&255);Z.start(),Z.update(J+U),X+=Z.digest().getBytes()}return X.substring(0,$)}});var y0=c((KH,v0)=>{var B$=o();XJ();MX();J$();(function(){if(B$.prime){v0.exports=B$.prime;return}var J=v0.exports=B$.prime=B$.prime||{},$=B$.jsbn.BigInteger,Z=[6,4,2,4,2,4,6,2],X=new $(null);X.fromInt(30);var Q=function(O,M){return O|M};J.generateProbablePrime=function(O,M,P){if(typeof M==="function")P=M,M={};M=M||{};var z=M.algorithm||"PRIMEINC";if(typeof z==="string")z={name:z};z.options=z.options||{};var A=M.prng||B$.random,T={nextBytes:function(C){var L=A.getBytesSync(C.length);for(var w=0;w<C.length;++w)C[w]=L.charCodeAt(w)}};if(z.name==="PRIMEINC")return Y(O,T,z.options,P);throw new Error("Invalid prime generation algorithm: "+z.name)};function Y(O,M,P,z){if("workers"in P)return E(O,M,P,z);return U(O,M,P,z)}function U(O,M,P,z){var A=W(O,M),T=0,C=H(A.bitLength());if("millerRabinTests"in P)C=P.millerRabinTests;var L=10;if("maxBlockTime"in P)L=P.maxBlockTime;G(A,O,M,T,C,L,z)}function G(O,M,P,z,A,T,C){var L=+new Date;do{if(O.bitLength()>M)O=W(M,P);if(O.isProbablePrime(A))return C(null,O);O.dAddOffset(Z[z++%8],0)}while(T<0||+new Date-L<T);B$.util.setImmediate(function(){G(O,M,P,z,A,T,C)})}function E(O,M,P,z){if(typeof Worker==="undefined")return U(O,M,P,z);var A=W(O,M),T=P.workers,C=P.workLoad||100,L=C*30/8,w=P.workerScript||"forge/prime.worker.js";if(T===-1)return B$.util.estimateCores(function(v,x){if(v)x=2;T=x-1,f()});f();function f(){T=Math.max(1,T);var v=[];for(var x=0;x<T;++x)v[x]=new Worker(w);var p=T;for(var x=0;x<T;++x)v[x].addEventListener("message",YJ);var a=!1;function YJ(UJ){if(a)return;--p;var EJ=UJ.data;if(EJ.found){for(var VJ=0;VJ<v.length;++VJ)v[VJ].terminate();return a=!0,z(null,new $(EJ.prime,16))}if(A.bitLength()>O)A=W(O,M);var pJ=A.toString(16);UJ.target.postMessage({hex:pJ,workLoad:C}),A.dAddOffset(L,0)}}}function W(O,M){var P=new $(O,M),z=O-1;if(!P.testBit(z))P.bitwiseTo($.ONE.shiftLeft(z),Q,P);return P.dAddOffset(31-P.mod(X).byteValue(),0),P}function H(O){if(O<=100)return 27;if(O<=150)return 18;if(O<=200)return 15;if(O<=250)return 12;if(O<=300)return 9;if(O<=350)return 8;if(O<=400)return 7;if(O<=500)return 6;if(O<=600)return 5;if(O<=800)return 4;if(O<=1250)return 3;return 2}})()});var zX=c((RH,PQ)=>{var m=o();G$();MX();w$();k0();y0();J$();XJ();if(typeof JJ==="undefined")JJ=m.jsbn.BigInteger;var JJ,_0=m.util.isNodejs?A0("crypto"):null,N=m.asn1,X$=m.util;m.pki=m.pki||{};PQ.exports=m.pki.rsa=m.rsa=m.rsa||{};var l=m.pki,JW=[6,4,2,4,2,4,6,2],$W={name:"PrivateKeyInfo",tagClass:N.Class.UNIVERSAL,type:N.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:N.Class.UNIVERSAL,type:N.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:N.Class.UNIVERSAL,type:N.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:N.Class.UNIVERSAL,type:N.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:N.Class.UNIVERSAL,type:N.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]},XW={name:"RSAPrivateKey",tagClass:N.Class.UNIVERSAL,type:N.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPrivateKey.version",tagClass:N.Class.UNIVERSAL,type:N.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"RSAPrivateKey.modulus",tagClass:N.Class.UNIVERSAL,type:N.Type.INTEGER,constructed:!1,capture:"privateKeyModulus"},{name:"RSAPrivateKey.publicExponent",tagClass:N.Class.UNIVERSAL,type:N.Type.INTEGER,constructed:!1,capture:"privateKeyPublicExponent"},{name:"RSAPrivateKey.privateExponent",tagClass:N.Class.UNIVERSAL,type:N.Type.INTEGER,constructed:!1,capture:"privateKeyPrivateExponent"},{name:"RSAPrivateKey.prime1",tagClass:N.Class.UNIVERSAL,type:N.Type.INTEGER,constructed:!1,capture:"privateKeyPrime1"},{name:"RSAPrivateKey.prime2",tagClass:N.Class.UNIVERSAL,type:N.Type.INTEGER,constructed:!1,capture:"privateKeyPrime2"},{name:"RSAPrivateKey.exponent1",tagClass:N.Class.UNIVERSAL,type:N.Type.INTEGER,constructed:!1,capture:"privateKeyExponent1"},{name:"RSAPrivateKey.exponent2",tagClass:N.Class.UNIVERSAL,type:N.Type.INTEGER,constructed:!1,capture:"privateKeyExponent2"},{name:"RSAPrivateKey.coefficient",tagClass:N.Class.UNIVERSAL,type:N.Type.INTEGER,constructed:!1,capture:"privateKeyCoefficient"}]},ZW={name:"RSAPublicKey",tagClass:N.Class.UNIVERSAL,type:N.Type.SEQUENCE,constructed:!0,value:[{name:"RSAPublicKey.modulus",tagClass:N.Class.UNIVERSAL,type:N.Type.INTEGER,constructed:!1,capture:"publicKeyModulus"},{name:"RSAPublicKey.exponent",tagClass:N.Class.UNIVERSAL,type:N.Type.INTEGER,constructed:!1,capture:"publicKeyExponent"}]},QW=m.pki.rsa.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:N.Class.UNIVERSAL,type:N.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:N.Class.UNIVERSAL,type:N.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:N.Class.UNIVERSAL,type:N.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{name:"SubjectPublicKeyInfo.subjectPublicKey",tagClass:N.Class.UNIVERSAL,type:N.Type.BITSTRING,constructed:!1,value:[{name:"SubjectPublicKeyInfo.subjectPublicKey.RSAPublicKey",tagClass:N.Class.UNIVERSAL,type:N.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"rsaPublicKey"}]}]},YW={name:"DigestInfo",tagClass:N.Class.UNIVERSAL,type:N.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm",tagClass:N.Class.UNIVERSAL,type:N.Type.SEQUENCE,constructed:!0,value:[{name:"DigestInfo.DigestAlgorithm.algorithmIdentifier",tagClass:N.Class.UNIVERSAL,type:N.Type.OID,constructed:!1,capture:"algorithmIdentifier"},{name:"DigestInfo.DigestAlgorithm.parameters",tagClass:N.Class.UNIVERSAL,type:N.Type.NULL,capture:"parameters",optional:!0,constructed:!1}]},{name:"DigestInfo.digest",tagClass:N.Class.UNIVERSAL,type:N.Type.OCTETSTRING,constructed:!1,capture:"digest"}]},UW=function(J){var $;if(J.algorithm in l.oids)$=l.oids[J.algorithm];else{var Z=new Error("Unknown message digest algorithm.");throw Z.algorithm=J.algorithm,Z}var X=N.oidToDer($).getBytes(),Q=N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[]),Y=N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[]);Y.value.push(N.create(N.Class.UNIVERSAL,N.Type.OID,!1,X)),Y.value.push(N.create(N.Class.UNIVERSAL,N.Type.NULL,!1,""));var U=N.create(N.Class.UNIVERSAL,N.Type.OCTETSTRING,!1,J.digest().getBytes());return Q.value.push(Y),Q.value.push(U),N.toDer(Q).getBytes()},zQ=function(J,$,Z){if(Z)return J.modPow($.e,$.n);if(!$.p||!$.q)return J.modPow($.d,$.n);if(!$.dP)$.dP=$.d.mod($.p.subtract(JJ.ONE));if(!$.dQ)$.dQ=$.d.mod($.q.subtract(JJ.ONE));if(!$.qInv)$.qInv=$.q.modInverse($.p);var X;do X=new JJ(m.util.bytesToHex(m.random.getBytes($.n.bitLength()/8)),16);while(X.compareTo($.n)>=0||!X.gcd($.n).equals(JJ.ONE));J=J.multiply(X.modPow($.e,$.n)).mod($.n);var Q=J.mod($.p).modPow($.dP,$.p),Y=J.mod($.q).modPow($.dQ,$.q);while(Q.compareTo(Y)<0)Q=Q.add($.p);var U=Q.subtract(Y).multiply($.qInv).mod($.p).multiply($.q).add(Y);return U=U.multiply(X.modInverse($.n)).mod($.n),U};l.rsa.encrypt=function(J,$,Z){var X=Z,Q,Y=Math.ceil($.n.bitLength()/8);if(Z!==!1&&Z!==!0)X=Z===2,Q=DQ(J,$,Z);else Q=m.util.createBuffer(),Q.putBytes(J);var U=new JJ(Q.toHex(),16),G=zQ(U,$,X),E=G.toString(16),W=m.util.createBuffer(),H=Y-Math.ceil(E.length/2);while(H>0)W.putByte(0),--H;return W.putBytes(m.util.hexToBytes(E)),W.getBytes()};l.rsa.decrypt=function(J,$,Z,X){var Q=Math.ceil($.n.bitLength()/8);if(J.length!==Q){var Y=new Error("Encrypted message length is invalid.");throw Y.length=J.length,Y.expected=Q,Y}var U=new JJ(m.util.createBuffer(J).toHex(),16);if(U.compareTo($.n)>=0)throw new Error("Encrypted message is invalid.");var G=zQ(U,$,Z),E=G.toString(16),W=m.util.createBuffer(),H=Q-Math.ceil(E.length/2);while(H>0)W.putByte(0),--H;if(W.putBytes(m.util.hexToBytes(E)),X!==!1)return pX(W.getBytes(),$,Z);return W.getBytes()};l.rsa.createKeyPairGenerationState=function(J,$,Z){if(typeof J==="string")J=parseInt(J,10);J=J||2048,Z=Z||{};var X=Z.prng||m.random,Q={nextBytes:function(G){var E=X.getBytesSync(G.length);for(var W=0;W<G.length;++W)G[W]=E.charCodeAt(W)}},Y=Z.algorithm||"PRIMEINC",U;if(Y==="PRIMEINC")U={algorithm:Y,state:0,bits:J,rng:Q,eInt:$||65537,e:new JJ(null),p:null,q:null,qBits:J>>1,pBits:J-(J>>1),pqState:0,num:null,keys:null},U.e.fromInt(U.eInt);else throw new Error("Invalid key generation algorithm: "+Y);return U};l.rsa.stepKeyPairGenerationState=function(J,$){if(!("algorithm"in J))J.algorithm="PRIMEINC";var Z=new JJ(null);Z.fromInt(30);var X=0,Q=function(O,M){return O|M},Y=+new Date,U,G=0;while(J.keys===null&&($<=0||G<$)){if(J.state===0){var E=J.p===null?J.pBits:J.qBits,W=E-1;if(J.pqState===0){if(J.num=new JJ(E,J.rng),!J.num.testBit(W))J.num.bitwiseTo(JJ.ONE.shiftLeft(W),Q,J.num);J.num.dAddOffset(31-J.num.mod(Z).byteValue(),0),X=0,++J.pqState}else if(J.pqState===1)if(J.num.bitLength()>E)J.pqState=0;else if(J.num.isProbablePrime(WW(J.num.bitLength())))++J.pqState;else J.num.dAddOffset(JW[X++%8],0);else if(J.pqState===2)J.pqState=J.num.subtract(JJ.ONE).gcd(J.e).compareTo(JJ.ONE)===0?3:0;else if(J.pqState===3){if(J.pqState=0,J.p===null)J.p=J.num;else J.q=J.num;if(J.p!==null&&J.q!==null)++J.state;J.num=null}}else if(J.state===1){if(J.p.compareTo(J.q)<0)J.num=J.p,J.p=J.q,J.q=J.num;++J.state}else if(J.state===2)J.p1=J.p.subtract(JJ.ONE),J.q1=J.q.subtract(JJ.ONE),J.phi=J.p1.multiply(J.q1),++J.state;else if(J.state===3)if(J.phi.gcd(J.e).compareTo(JJ.ONE)===0)++J.state;else J.p=null,J.q=null,J.state=0;else if(J.state===4)if(J.n=J.p.multiply(J.q),J.n.bitLength()===J.bits)++J.state;else J.q=null,J.state=0;else if(J.state===5){var H=J.e.modInverse(J.phi);J.keys={privateKey:l.rsa.setPrivateKey(J.n,J.e,H,J.p,J.q,H.mod(J.p1),H.mod(J.q1),J.q.modInverse(J.p)),publicKey:l.rsa.setPublicKey(J.n,J.e)}}U=+new Date,G+=U-Y,Y=U}return J.keys!==null};l.rsa.generateKeyPair=function(J,$,Z,X){if(arguments.length===1){if(typeof J==="object")Z=J,J=void 0;else if(typeof J==="function")X=J,J=void 0}else if(arguments.length===2)if(typeof J==="number"){if(typeof $==="function")X=$,$=void 0;else if(typeof $!=="number")Z=$,$=void 0}else Z=J,X=$,J=void 0,$=void 0;else if(arguments.length===3)if(typeof $==="number"){if(typeof Z==="function")X=Z,Z=void 0}else X=Z,Z=$,$=void 0;if(Z=Z||{},J===void 0)J=Z.bits||2048;if($===void 0)$=Z.e||65537;if(!m.options.usePureJavaScript&&!Z.prng&&J>=256&&J<=16384&&($===65537||$===3)){if(X){if(VQ("generateKeyPair"))return _0.generateKeyPair("rsa",{modulusLength:J,publicExponent:$,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}},function(G,E,W){if(G)return X(G);X(null,{privateKey:l.privateKeyFromPem(W),publicKey:l.publicKeyFromPem(E)})});if(qQ("generateKey")&&qQ("exportKey"))return X$.globalScope.crypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:J,publicExponent:MQ($),hash:{name:"SHA-256"}},!0,["sign","verify"]).then(function(G){return X$.globalScope.crypto.subtle.exportKey("pkcs8",G.privateKey)}).then(void 0,function(G){X(G)}).then(function(G){if(G){var E=l.privateKeyFromAsn1(N.fromDer(m.util.createBuffer(G)));X(null,{privateKey:E,publicKey:l.setRsaPublicKey(E.n,E.e)})}});if(FQ("generateKey")&&FQ("exportKey")){var Q=X$.globalScope.msCrypto.subtle.generateKey({name:"RSASSA-PKCS1-v1_5",modulusLength:J,publicExponent:MQ($),hash:{name:"SHA-256"}},!0,["sign","verify"]);Q.oncomplete=function(G){var E=G.target.result,W=X$.globalScope.msCrypto.subtle.exportKey("pkcs8",E.privateKey);W.oncomplete=function(H){var O=H.target.result,M=l.privateKeyFromAsn1(N.fromDer(m.util.createBuffer(O)));X(null,{privateKey:M,publicKey:l.setRsaPublicKey(M.n,M.e)})},W.onerror=function(H){X(H)}},Q.onerror=function(G){X(G)};return}}else if(VQ("generateKeyPairSync")){var Y=_0.generateKeyPairSync("rsa",{modulusLength:J,publicExponent:$,publicKeyEncoding:{type:"spki",format:"pem"},privateKeyEncoding:{type:"pkcs8",format:"pem"}});return{privateKey:l.privateKeyFromPem(Y.privateKey),publicKey:l.publicKeyFromPem(Y.publicKey)}}}var U=l.rsa.createKeyPairGenerationState(J,$,Z);if(!X)return l.rsa.stepKeyPairGenerationState(U,0),U.keys;GW(U,Z,X)};l.setRsaPublicKey=l.rsa.setPublicKey=function(J,$){var Z={n:J,e:$};return Z.encrypt=function(X,Q,Y){if(typeof Q==="string")Q=Q.toUpperCase();else if(Q===void 0)Q="RSAES-PKCS1-V1_5";if(Q==="RSAES-PKCS1-V1_5")Q={encode:function(G,E,W){return DQ(G,E,2).getBytes()}};else if(Q==="RSA-OAEP"||Q==="RSAES-OAEP")Q={encode:function(G,E){return m.pkcs1.encode_rsa_oaep(E,G,Y)}};else if(["RAW","NONE","NULL",null].indexOf(Q)!==-1)Q={encode:function(G){return G}};else if(typeof Q==="string")throw new Error('Unsupported encryption scheme: "'+Q+'".');var U=Q.encode(X,Z,!0);return l.rsa.encrypt(U,Z,!0)},Z.verify=function(X,Q,Y,U){if(typeof Y==="string")Y=Y.toUpperCase();else if(Y===void 0)Y="RSASSA-PKCS1-V1_5";if(U===void 0)U={_parseAllDigestBytes:!0};if(!("_parseAllDigestBytes"in U))U._parseAllDigestBytes=!0;if(Y==="RSASSA-PKCS1-V1_5")Y={verify:function(E,W){W=pX(W,Z,!0);var H=N.fromDer(W,{parseAllBytes:U._parseAllDigestBytes}),O={},M=[];if(!N.validate(H,YW,O,M)){var P=new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value.");throw P.errors=M,P}var z=N.derToOid(O.algorithmIdentifier);if(!(z===m.oids.md2||z===m.oids.md5||z===m.oids.sha1||z===m.oids.sha224||z===m.oids.sha256||z===m.oids.sha384||z===m.oids.sha512||z===m.oids["sha512-224"]||z===m.oids["sha512-256"])){var P=new Error("Unknown RSASSA-PKCS1-v1_5 DigestAlgorithm identifier.");throw P.oid=z,P}if(z===m.oids.md2||z===m.oids.md5){if(!("parameters"in O))throw new Error("ASN.1 object does not contain a valid RSASSA-PKCS1-v1_5 DigestInfo value. Missing algorithm identifer NULL parameters.")}return E===O.digest}};else if(Y==="NONE"||Y==="NULL"||Y===null)Y={verify:function(E,W){return W=pX(W,Z,!0),E===W}};var G=l.rsa.decrypt(Q,Z,!0,!1);return Y.verify(X,G,Z.n.bitLength())},Z};l.setRsaPrivateKey=l.rsa.setPrivateKey=function(J,$,Z,X,Q,Y,U,G){var E={n:J,e:$,d:Z,p:X,q:Q,dP:Y,dQ:U,qInv:G};return E.decrypt=function(W,H,O){if(typeof H==="string")H=H.toUpperCase();else if(H===void 0)H="RSAES-PKCS1-V1_5";var M=l.rsa.decrypt(W,E,!1,!1);if(H==="RSAES-PKCS1-V1_5")H={decode:pX};else if(H==="RSA-OAEP"||H==="RSAES-OAEP")H={decode:function(P,z){return m.pkcs1.decode_rsa_oaep(z,P,O)}};else if(["RAW","NONE","NULL",null].indexOf(H)!==-1)H={decode:function(P){return P}};else throw new Error('Unsupported encryption scheme: "'+H+'".');return H.decode(M,E,!1)},E.sign=function(W,H){var O=!1;if(typeof H==="string")H=H.toUpperCase();if(H===void 0||H==="RSASSA-PKCS1-V1_5")H={encode:UW},O=1;else if(H==="NONE"||H==="NULL"||H===null)H={encode:function(){return W}},O=1;var M=H.encode(W,E.n.bitLength());return l.rsa.encrypt(M,E,O)},E};l.wrapRsaPrivateKey=function(J){return N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[N.create(N.Class.UNIVERSAL,N.Type.INTEGER,!1,N.integerToDer(0).getBytes()),N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[N.create(N.Class.UNIVERSAL,N.Type.OID,!1,N.oidToDer(l.oids.rsaEncryption).getBytes()),N.create(N.Class.UNIVERSAL,N.Type.NULL,!1,"")]),N.create(N.Class.UNIVERSAL,N.Type.OCTETSTRING,!1,N.toDer(J).getBytes())])};l.privateKeyFromAsn1=function(J){var $={},Z=[];if(N.validate(J,$W,$,Z))J=N.fromDer(m.util.createBuffer($.privateKey));if($={},Z=[],!N.validate(J,XW,$,Z)){var X=new Error("Cannot read private key. ASN.1 object does not contain an RSAPrivateKey.");throw X.errors=Z,X}var Q,Y,U,G,E,W,H,O;return Q=m.util.createBuffer($.privateKeyModulus).toHex(),Y=m.util.createBuffer($.privateKeyPublicExponent).toHex(),U=m.util.createBuffer($.privateKeyPrivateExponent).toHex(),G=m.util.createBuffer($.privateKeyPrime1).toHex(),E=m.util.createBuffer($.privateKeyPrime2).toHex(),W=m.util.createBuffer($.privateKeyExponent1).toHex(),H=m.util.createBuffer($.privateKeyExponent2).toHex(),O=m.util.createBuffer($.privateKeyCoefficient).toHex(),l.setRsaPrivateKey(new JJ(Q,16),new JJ(Y,16),new JJ(U,16),new JJ(G,16),new JJ(E,16),new JJ(W,16),new JJ(H,16),new JJ(O,16))};l.privateKeyToAsn1=l.privateKeyToRSAPrivateKey=function(J){return N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[N.create(N.Class.UNIVERSAL,N.Type.INTEGER,!1,N.integerToDer(0).getBytes()),N.create(N.Class.UNIVERSAL,N.Type.INTEGER,!1,z$(J.n)),N.create(N.Class.UNIVERSAL,N.Type.INTEGER,!1,z$(J.e)),N.create(N.Class.UNIVERSAL,N.Type.INTEGER,!1,z$(J.d)),N.create(N.Class.UNIVERSAL,N.Type.INTEGER,!1,z$(J.p)),N.create(N.Class.UNIVERSAL,N.Type.INTEGER,!1,z$(J.q)),N.create(N.Class.UNIVERSAL,N.Type.INTEGER,!1,z$(J.dP)),N.create(N.Class.UNIVERSAL,N.Type.INTEGER,!1,z$(J.dQ)),N.create(N.Class.UNIVERSAL,N.Type.INTEGER,!1,z$(J.qInv))])};l.publicKeyFromAsn1=function(J){var $={},Z=[];if(N.validate(J,QW,$,Z)){var X=N.derToOid($.publicKeyOid);if(X!==l.oids.rsaEncryption){var Q=new Error("Cannot read public key. Unknown OID.");throw Q.oid=X,Q}J=$.rsaPublicKey}if(Z=[],!N.validate(J,ZW,$,Z)){var Q=new Error("Cannot read public key. ASN.1 object does not contain an RSAPublicKey.");throw Q.errors=Z,Q}var Y=m.util.createBuffer($.publicKeyModulus).toHex(),U=m.util.createBuffer($.publicKeyExponent).toHex();return l.setRsaPublicKey(new JJ(Y,16),new JJ(U,16))};l.publicKeyToAsn1=l.publicKeyToSubjectPublicKeyInfo=function(J){return N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[N.create(N.Class.UNIVERSAL,N.Type.OID,!1,N.oidToDer(l.oids.rsaEncryption).getBytes()),N.create(N.Class.UNIVERSAL,N.Type.NULL,!1,"")]),N.create(N.Class.UNIVERSAL,N.Type.BITSTRING,!1,[l.publicKeyToRSAPublicKey(J)])])};l.publicKeyToRSAPublicKey=function(J){return N.create(N.Class.UNIVERSAL,N.Type.SEQUENCE,!0,[N.create(N.Class.UNIVERSAL,N.Type.INTEGER,!1,z$(J.n)),N.create(N.Class.UNIVERSAL,N.Type.INTEGER,!1,z$(J.e))])};function DQ(J,$,Z){var X=m.util.createBuffer(),Q=Math.ceil($.n.bitLength()/8);if(J.length>Q-11){var Y=new Error("Message is too long for PKCS#1 v1.5 padding.");throw Y.length=J.length,Y.max=Q-11,Y}X.putByte(0),X.putByte(Z);var U=Q-3-J.length,G;if(Z===0||Z===1){G=Z===0?0:255;for(var E=0;E<U;++E)X.putByte(G)}else while(U>0){var W=0,H=m.random.getBytes(U);for(var E=0;E<U;++E)if(G=H.charCodeAt(E),G===0)++W;else X.putByte(G);U=W}return X.putByte(0),X.putBytes(J),X}function pX(J,$,Z,X){var Q=Math.ceil($.n.bitLength()/8),Y=m.util.createBuffer(J),U=Y.getByte(),G=Y.getByte();if(U!==0||Z&&G!==0&&G!==1||!Z&&G!=2||Z&&G===0&&typeof X==="undefined")throw new Error("Encryption block is invalid.");var E=0;if(G===0){E=Q-3-X;for(var W=0;W<E;++W)if(Y.getByte()!==0)throw new Error("Encryption block is invalid.")}else if(G===1){E=0;while(Y.length()>1){if(Y.getByte()!==255){--Y.read;break}++E}}else if(G===2){E=0;while(Y.length()>1){if(Y.getByte()===0){--Y.read;break}++E}}var H=Y.getByte();if(H!==0||E!==Q-3-Y.length())throw new Error("Encryption block is invalid.");return Y.getBytes()}function GW(J,$,Z){if(typeof $==="function")Z=$,$={};$=$||{};var X={algorithm:{name:$.algorithm||"PRIMEINC",options:{workers:$.workers||2,workLoad:$.workLoad||100,workerScript:$.workerScript}}};if("prng"in $)X.prng=$.prng;Q();function Q(){Y(J.pBits,function(G,E){if(G)return Z(G);if(J.p=E,J.q!==null)return U(G,J.q);Y(J.qBits,U)})}function Y(G,E){m.prime.generateProbablePrime(G,X,E)}function U(G,E){if(G)return Z(G);if(J.q=E,J.p.compareTo(J.q)<0){var W=J.p;J.p=J.q,J.q=W}if(J.p.subtract(JJ.ONE).gcd(J.e).compareTo(JJ.ONE)!==0){J.p=null,Q();return}if(J.q.subtract(JJ.ONE).gcd(J.e).compareTo(JJ.ONE)!==0){J.q=null,Y(J.qBits,U);return}if(J.p1=J.p.subtract(JJ.ONE),J.q1=J.q.subtract(JJ.ONE),J.phi=J.p1.multiply(J.q1),J.phi.gcd(J.e).compareTo(JJ.ONE)!==0){J.p=J.q=null,Q();return}if(J.n=J.p.multiply(J.q),J.n.bitLength()!==J.bits){J.q=null,Y(J.qBits,U);return}var H=J.e.modInverse(J.phi);J.keys={privateKey:l.rsa.setPrivateKey(J.n,J.e,H,J.p,J.q,H.mod(J.p1),H.mod(J.q1),J.q.modInverse(J.p)),publicKey:l.rsa.setPublicKey(J.n,J.e)},Z(null,J.keys)}}function z$(J){var $=J.toString(16);if($[0]>="8")$="00"+$;var Z=m.util.hexToBytes($);if(Z.length>1&&(Z.charCodeAt(0)===0&&(Z.charCodeAt(1)&128)===0||Z.charCodeAt(0)===255&&(Z.charCodeAt(1)&128)===128))return Z.substr(1);return Z}function WW(J){if(J<=100)return 27;if(J<=150)return 18;if(J<=200)return 15;if(J<=250)return 12;if(J<=300)return 9;if(J<=350)return 8;if(J<=400)return 7;if(J<=500)return 6;if(J<=600)return 5;if(J<=800)return 4;if(J<=1250)return 3;return 2}function VQ(J){return m.util.isNodejs&&typeof _0[J]==="function"}function qQ(J){return typeof X$.globalScope!=="undefined"&&typeof X$.globalScope.crypto==="object"&&typeof X$.globalScope.crypto.subtle==="object"&&typeof X$.globalScope.crypto.subtle[J]==="function"}function FQ(J){return typeof X$.globalScope!=="undefined"&&typeof X$.globalScope.msCrypto==="object"&&typeof X$.globalScope.msCrypto.subtle==="object"&&typeof X$.globalScope.msCrypto.subtle[J]==="function"}function MQ(J){var $=m.util.hexToBytes(J.toString(16)),Z=new Uint8Array($.length);for(var X=0;X<$.length;++X)Z[X]=$.charCodeAt(X);return Z}});var h0=c((AH,NQ)=>{var u=o();L$();G$();qX();E$();w$();bX();f$();J$();w0();zX();XJ();if(typeof KQ==="undefined")KQ=u.jsbn.BigInteger;var KQ,S=u.asn1,n=u.pki=u.pki||{};NQ.exports=n.pbe=u.pbe=u.pbe||{};var m$=n.oids,EW={name:"EncryptedPrivateKeyInfo",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedPrivateKeyInfo.encryptionAlgorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"encryptionOid"},{name:"AlgorithmIdentifier.parameters",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,captureAsn1:"encryptionParams"}]},{name:"EncryptedPrivateKeyInfo.encryptedData",tagClass:S.Class.UNIVERSAL,type:S.Type.OCTETSTRING,constructed:!1,capture:"encryptedData"}]},HW={name:"PBES2Algorithms",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.keyDerivationFunc.oid",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"kdfOid"},{name:"PBES2Algorithms.params",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.params.salt",tagClass:S.Class.UNIVERSAL,type:S.Type.OCTETSTRING,constructed:!1,capture:"kdfSalt"},{name:"PBES2Algorithms.params.iterationCount",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,capture:"kdfIterationCount"},{name:"PBES2Algorithms.params.keyLength",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,optional:!0,capture:"keyLength"},{name:"PBES2Algorithms.params.prf",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,optional:!0,value:[{name:"PBES2Algorithms.params.prf.algorithm",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"prfOid"}]}]}]},{name:"PBES2Algorithms.encryptionScheme",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"PBES2Algorithms.encryptionScheme.oid",tagClass:S.Class.UNIVERSAL,type:S.Type.OID,constructed:!1,capture:"encOid"},{name:"PBES2Algorithms.encryptionScheme.iv",tagClass:S.Class.UNIVERSAL,type:S.Type.OCTETSTRING,constructed:!1,capture:"encIv"}]}]},OW={name:"pkcs-12PbeParams",tagClass:S.Class.UNIVERSAL,type:S.Type.SEQUENCE,constructed:!0,value:[{name:"pkcs-12PbeParams.salt",tagClass:S.Class.UNIVERSAL,type:S.Type.OCTETSTRING,constructed:!1,capture:"salt"},{name:"pkcs-12PbeParams.iterations",tagClass:S.Class.UNIVERSAL,type:S.Type.INTEGER,constructed:!1,capture:"iterations"}]};n.encryptPrivateKeyInfo=function(J,$,Z){Z=Z||{},Z.saltSize=Z.saltSize||8,Z.count=Z.count||2048,Z.algorithm=Z.algorithm||"aes128",Z.prfAlgorithm=Z.prfAlgorithm||"sha1";var X=u.random.getBytesSync(Z.saltSize),Q=Z.count,Y=S.integerToDer(Q),U,G,E;if(Z.algorithm.indexOf("aes")===0||Z.algorithm==="des"){var W,H,O;switch(Z.algorithm){case"aes128":U=16,W=16,H=m$["aes128-CBC"],O=u.aes.createEncryptionCipher;break;case"aes192":U=24,W=16,H=m$["aes192-CBC"],O=u.aes.createEncryptionCipher;break;case"aes256":U=32,W=16,H=m$["aes256-CBC"],O=u.aes.createEncryptionCipher;break;case"des":U=8,W=8,H=m$.desCBC,O=u.des.createEncryptionCipher;break;default:var M=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw M.algorithm=Z.algorithm,M}var P="hmacWith"+Z.prfAlgorithm.toUpperCase(),z=TQ(P),A=u.pkcs5.pbkdf2($,X,Q,U,z),T=u.random.getBytesSync(W),C=O(A);C.start(T),C.update(S.toDer(J)),C.finish(),E=C.output.getBytes();var L=VW(X,Y,U,P);G=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(m$.pkcs5PBES2).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(m$.pkcs5PBKDF2).getBytes()),L]),S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(H).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.OCTETSTRING,!1,T)])])])}else if(Z.algorithm==="3des"){U=24;var w=new u.util.ByteBuffer(X),A=n.pbe.generatePkcs12Key($,w,1,Q,U),T=n.pbe.generatePkcs12Key($,w,2,Q,U),C=u.des.createEncryptionCipher(A);C.start(T),C.update(S.toDer(J)),C.finish(),E=C.output.getBytes(),G=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(m$["pbeWithSHAAnd3-KeyTripleDES-CBC"]).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OCTETSTRING,!1,X),S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,Y.getBytes())])])}else{var M=new Error("Cannot encrypt private key. Unknown encryption algorithm.");throw M.algorithm=Z.algorithm,M}var f=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[G,S.create(S.Class.UNIVERSAL,S.Type.OCTETSTRING,!1,E)]);return f};n.decryptPrivateKeyInfo=function(J,$){var Z=null,X={},Q=[];if(!S.validate(J,EW,X,Q)){var Y=new Error("Cannot read encrypted private key. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw Y.errors=Q,Y}var U=S.derToOid(X.encryptionOid),G=n.pbe.getCipher(U,X.encryptionParams,$),E=u.util.createBuffer(X.encryptedData);if(G.update(E),G.finish())Z=S.fromDer(G.output);return Z};n.encryptedPrivateKeyToPem=function(J,$){var Z={type:"ENCRYPTED PRIVATE KEY",body:S.toDer(J).getBytes()};return u.pem.encode(Z,{maxline:$})};n.encryptedPrivateKeyFromPem=function(J){var $=u.pem.decode(J)[0];if($.type!=="ENCRYPTED PRIVATE KEY"){var Z=new Error('Could not convert encrypted private key from PEM; PEM header type is "ENCRYPTED PRIVATE KEY".');throw Z.headerType=$.type,Z}if($.procType&&$.procType.type==="ENCRYPTED")throw new Error("Could not convert encrypted private key from PEM; PEM is encrypted.");return S.fromDer($.body)};n.encryptRsaPrivateKey=function(J,$,Z){if(Z=Z||{},!Z.legacy){var X=n.wrapRsaPrivateKey(n.privateKeyToAsn1(J));return X=n.encryptPrivateKeyInfo(X,$,Z),n.encryptedPrivateKeyToPem(X)}var Q,Y,U,G;switch(Z.algorithm){case"aes128":Q="AES-128-CBC",U=16,Y=u.random.getBytesSync(16),G=u.aes.createEncryptionCipher;break;case"aes192":Q="AES-192-CBC",U=24,Y=u.random.getBytesSync(16),G=u.aes.createEncryptionCipher;break;case"aes256":Q="AES-256-CBC",U=32,Y=u.random.getBytesSync(16),G=u.aes.createEncryptionCipher;break;case"3des":Q="DES-EDE3-CBC",U=24,Y=u.random.getBytesSync(8),G=u.des.createEncryptionCipher;break;case"des":Q="DES-CBC",U=8,Y=u.random.getBytesSync(8),G=u.des.createEncryptionCipher;break;default:var E=new Error('Could not encrypt RSA private key; unsupported encryption algorithm "'+Z.algorithm+'".');throw E.algorithm=Z.algorithm,E}var W=u.pbe.opensslDeriveBytes($,Y.substr(0,8),U),H=G(W);H.start(Y),H.update(S.toDer(n.privateKeyToAsn1(J))),H.finish();var O={type:"RSA PRIVATE KEY",procType:{version:"4",type:"ENCRYPTED"},dekInfo:{algorithm:Q,parameters:u.util.bytesToHex(Y).toUpperCase()},body:H.output.getBytes()};return u.pem.encode(O)};n.decryptRsaPrivateKey=function(J,$){var Z=null,X=u.pem.decode(J)[0];if(X.type!=="ENCRYPTED PRIVATE KEY"&&X.type!=="PRIVATE KEY"&&X.type!=="RSA PRIVATE KEY"){var Q=new Error('Could not convert private key from PEM; PEM header type is not "ENCRYPTED PRIVATE KEY", "PRIVATE KEY", or "RSA PRIVATE KEY".');throw Q.headerType=Q,Q}if(X.procType&&X.procType.type==="ENCRYPTED"){var Y,U;switch(X.dekInfo.algorithm){case"DES-CBC":Y=8,U=u.des.createDecryptionCipher;break;case"DES-EDE3-CBC":Y=24,U=u.des.createDecryptionCipher;break;case"AES-128-CBC":Y=16,U=u.aes.createDecryptionCipher;break;case"AES-192-CBC":Y=24,U=u.aes.createDecryptionCipher;break;case"AES-256-CBC":Y=32,U=u.aes.createDecryptionCipher;break;case"RC2-40-CBC":Y=5,U=function(O){return u.rc2.createDecryptionCipher(O,40)};break;case"RC2-64-CBC":Y=8,U=function(O){return u.rc2.createDecryptionCipher(O,64)};break;case"RC2-128-CBC":Y=16,U=function(O){return u.rc2.createDecryptionCipher(O,128)};break;default:var Q=new Error('Could not decrypt private key; unsupported encryption algorithm "'+X.dekInfo.algorithm+'".');throw Q.algorithm=X.dekInfo.algorithm,Q}var G=u.util.hexToBytes(X.dekInfo.parameters),E=u.pbe.opensslDeriveBytes($,G.substr(0,8),Y),W=U(E);if(W.start(G),W.update(u.util.createBuffer(X.body)),W.finish())Z=W.output.getBytes();else return Z}else Z=X.body;if(X.type==="ENCRYPTED PRIVATE KEY")Z=n.decryptPrivateKeyInfo(S.fromDer(Z),$);else Z=S.fromDer(Z);if(Z!==null)Z=n.privateKeyFromAsn1(Z);return Z};n.pbe.generatePkcs12Key=function(J,$,Z,X,Q,Y){var U,G;if(typeof Y==="undefined"||Y===null){if(!("sha1"in u.md))throw new Error('"sha1" hash algorithm unavailable.');Y=u.md.sha1.create()}var{digestLength:E,blockLength:W}=Y,H=new u.util.ByteBuffer,O=new u.util.ByteBuffer;if(J!==null&&J!==void 0){for(G=0;G<J.length;G++)O.putInt16(J.charCodeAt(G));O.putInt16(0)}var M=O.length(),P=$.length(),z=new u.util.ByteBuffer;z.fillWithByte(Z,W);var A=W*Math.ceil(P/W),T=new u.util.ByteBuffer;for(G=0;G<A;G++)T.putByte($.at(G%P));var C=W*Math.ceil(M/W),L=new u.util.ByteBuffer;for(G=0;G<C;G++)L.putByte(O.at(G%M));var w=T;w.putBuffer(L);var f=Math.ceil(Q/E);for(var v=1;v<=f;v++){var x=new u.util.ByteBuffer;x.putBytes(z.bytes()),x.putBytes(w.bytes());for(var p=0;p<X;p++)Y.start(),Y.update(x.getBytes()),x=Y.digest();var a=new u.util.ByteBuffer;for(G=0;G<W;G++)a.putByte(x.at(G%E));var YJ=Math.ceil(P/W)+Math.ceil(M/W),UJ=new u.util.ByteBuffer;for(U=0;U<YJ;U++){var EJ=new u.util.ByteBuffer(w.getBytes(W)),VJ=511;for(G=a.length()-1;G>=0;G--)VJ=VJ>>8,VJ+=a.at(G)+EJ.at(G),EJ.setAt(G,VJ&255);UJ.putBuffer(EJ)}w=UJ,H.putBuffer(x)}return H.truncate(H.length()-Q),H};n.pbe.getCipher=function(J,$,Z){switch(J){case n.oids.pkcs5PBES2:return n.pbe.getCipherForPBES2(J,$,Z);case n.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:case n.oids["pbewithSHAAnd40BitRC2-CBC"]:return n.pbe.getCipherForPKCS12PBE(J,$,Z);default:var X=new Error("Cannot read encrypted PBE data block. Unsupported OID.");throw X.oid=J,X.supportedOids=["pkcs5PBES2","pbeWithSHAAnd3-KeyTripleDES-CBC","pbewithSHAAnd40BitRC2-CBC"],X}};n.pbe.getCipherForPBES2=function(J,$,Z){var X={},Q=[];if(!S.validate($,HW,X,Q)){var Y=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw Y.errors=Q,Y}if(J=S.derToOid(X.kdfOid),J!==n.oids.pkcs5PBKDF2){var Y=new Error("Cannot read encrypted private key. Unsupported key derivation function OID.");throw Y.oid=J,Y.supportedOids=["pkcs5PBKDF2"],Y}if(J=S.derToOid(X.encOid),J!==n.oids["aes128-CBC"]&&J!==n.oids["aes192-CBC"]&&J!==n.oids["aes256-CBC"]&&J!==n.oids["des-EDE3-CBC"]&&J!==n.oids.desCBC){var Y=new Error("Cannot read encrypted private key. Unsupported encryption scheme OID.");throw Y.oid=J,Y.supportedOids=["aes128-CBC","aes192-CBC","aes256-CBC","des-EDE3-CBC","desCBC"],Y}var U=X.kdfSalt,G=u.util.createBuffer(X.kdfIterationCount);G=G.getInt(G.length()<<3);var E,W;switch(n.oids[J]){case"aes128-CBC":E=16,W=u.aes.createDecryptionCipher;break;case"aes192-CBC":E=24,W=u.aes.createDecryptionCipher;break;case"aes256-CBC":E=32,W=u.aes.createDecryptionCipher;break;case"des-EDE3-CBC":E=24,W=u.des.createDecryptionCipher;break;case"desCBC":E=8,W=u.des.createDecryptionCipher;break}var H=AQ(X.prfOid),O=u.pkcs5.pbkdf2(Z,U,G,E,H),M=X.encIv,P=W(O);return P.start(M),P};n.pbe.getCipherForPKCS12PBE=function(J,$,Z){var X={},Q=[];if(!S.validate($,OW,X,Q)){var Y=new Error("Cannot read password-based-encryption algorithm parameters. ASN.1 object is not a supported EncryptedPrivateKeyInfo.");throw Y.errors=Q,Y}var U=u.util.createBuffer(X.salt),G=u.util.createBuffer(X.iterations);G=G.getInt(G.length()<<3);var E,W,H;switch(J){case n.oids["pbeWithSHAAnd3-KeyTripleDES-CBC"]:E=24,W=8,H=u.des.startDecrypting;break;case n.oids["pbewithSHAAnd40BitRC2-CBC"]:E=5,W=8,H=function(A,T){var C=u.rc2.createDecryptionCipher(A,40);return C.start(T,null),C};break;default:var Y=new Error("Cannot read PKCS #12 PBE data block. Unsupported OID.");throw Y.oid=J,Y}var O=AQ(X.prfOid),M=n.pbe.generatePkcs12Key(Z,U,1,G,E,O);O.start();var P=n.pbe.generatePkcs12Key(Z,U,2,G,W,O);return H(M,P)};n.pbe.opensslDeriveBytes=function(J,$,Z,X){if(typeof X==="undefined"||X===null){if(!("md5"in u.md))throw new Error('"md5" hash algorithm unavailable.');X=u.md.md5.create()}if($===null)$="";var Q=[RQ(X,J+$)];for(var Y=16,U=1;Y<Z;++U,Y+=16)Q.push(RQ(X,Q[U-1]+J+$));return Q.join("").substr(0,Z)};function RQ(J,$){return J.start().update($).digest().getBytes()}function AQ(J){var $;if(!J)$="hmacWithSHA1";else if($=n.oids[S.derToOid(J)],!$){var Z=new Error("Unsupported PRF OID.");throw Z.oid=J,Z.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],Z}return TQ($)}function TQ(J){var $=u.md;switch(J){case"hmacWithSHA224":$=u.md.sha512;case"hmacWithSHA1":case"hmacWithSHA256":case"hmacWithSHA384":case"hmacWithSHA512":J=J.substr(8).toLowerCase();break;default:var Z=new Error("Unsupported PRF algorithm.");throw Z.algorithm=J,Z.supported=["hmacWithSHA1","hmacWithSHA224","hmacWithSHA256","hmacWithSHA384","hmacWithSHA512"],Z}if(!$||!(J in $))throw new Error("Unknown hash algorithm: "+J);return $[J].create()}function VW(J,$,Z,X){var Q=S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OCTETSTRING,!1,J),S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,$.getBytes())]);if(X!=="hmacWithSHA1")Q.value.push(S.create(S.Class.UNIVERSAL,S.Type.INTEGER,!1,u.util.hexToBytes(Z.toString(16))),S.create(S.Class.UNIVERSAL,S.Type.SEQUENCE,!0,[S.create(S.Class.UNIVERSAL,S.Type.OID,!1,S.oidToDer(n.oids[X]).getBytes()),S.create(S.Class.UNIVERSAL,S.Type.NULL,!1,"")]));return Q}});var f0=c((TH,LQ)=>{var JX=o();G$();XJ();var h=JX.asn1,$X=LQ.exports=JX.pkcs7asn1=JX.pkcs7asn1||{};JX.pkcs7=JX.pkcs7||{};JX.pkcs7.asn1=$X;var CQ={name:"ContentInfo",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.ContentType",tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:h.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,captureAsn1:"content"}]};$X.contentInfoValidator=CQ;var SQ={name:"EncryptedContentInfo",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentType",tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1,capture:"contentType"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedContentInfo.contentEncryptionAlgorithm.algorithm",tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"EncryptedContentInfo.contentEncryptionAlgorithm.parameter",tagClass:h.Class.UNIVERSAL,captureAsn1:"encParameter"}]},{name:"EncryptedContentInfo.encryptedContent",tagClass:h.Class.CONTEXT_SPECIFIC,type:0,capture:"encryptedContent",captureAsn1:"encryptedContentAsn1"}]};$X.envelopedDataValidator={name:"EnvelopedData",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"EnvelopedData.Version",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"version"},{name:"EnvelopedData.RecipientInfos",tagClass:h.Class.UNIVERSAL,type:h.Type.SET,constructed:!0,captureAsn1:"recipientInfos"}].concat(SQ)};$X.encryptedDataValidator={name:"EncryptedData",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"EncryptedData.Version",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"version"}].concat(SQ)};var qW={name:"SignerInfo",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.version",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1},{name:"SignerInfo.issuerAndSerialNumber",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.issuerAndSerialNumber.issuer",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"SignerInfo.issuerAndSerialNumber.serialNumber",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"SignerInfo.digestAlgorithm",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"SignerInfo.digestAlgorithm.algorithm",tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1,capture:"digestAlgorithm"},{name:"SignerInfo.digestAlgorithm.parameter",tagClass:h.Class.UNIVERSAL,constructed:!1,captureAsn1:"digestParameter",optional:!0}]},{name:"SignerInfo.authenticatedAttributes",tagClass:h.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"authenticatedAttributes"},{name:"SignerInfo.digestEncryptionAlgorithm",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,capture:"signatureAlgorithm"},{name:"SignerInfo.encryptedDigest",tagClass:h.Class.UNIVERSAL,type:h.Type.OCTETSTRING,constructed:!1,capture:"signature"},{name:"SignerInfo.unauthenticatedAttributes",tagClass:h.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,capture:"unauthenticatedAttributes"}]};$X.signedDataValidator={name:"SignedData",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"SignedData.Version",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"version"},{name:"SignedData.DigestAlgorithms",tagClass:h.Class.UNIVERSAL,type:h.Type.SET,constructed:!0,captureAsn1:"digestAlgorithms"},CQ,{name:"SignedData.Certificates",tagClass:h.Class.CONTEXT_SPECIFIC,type:0,optional:!0,captureAsn1:"certificates"},{name:"SignedData.CertificateRevocationLists",tagClass:h.Class.CONTEXT_SPECIFIC,type:1,optional:!0,captureAsn1:"crls"},{name:"SignedData.SignerInfos",tagClass:h.Class.UNIVERSAL,type:h.Type.SET,capture:"signerInfos",optional:!0,value:[qW]}]};$X.recipientInfoValidator={name:"RecipientInfo",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.version",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"version"},{name:"RecipientInfo.issuerAndSerial",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.issuerAndSerial.issuer",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,captureAsn1:"issuer"},{name:"RecipientInfo.issuerAndSerial.serialNumber",tagClass:h.Class.UNIVERSAL,type:h.Type.INTEGER,constructed:!1,capture:"serial"}]},{name:"RecipientInfo.keyEncryptionAlgorithm",tagClass:h.Class.UNIVERSAL,type:h.Type.SEQUENCE,constructed:!0,value:[{name:"RecipientInfo.keyEncryptionAlgorithm.algorithm",tagClass:h.Class.UNIVERSAL,type:h.Type.OID,constructed:!1,capture:"encAlgorithm"},{name:"RecipientInfo.keyEncryptionAlgorithm.parameter",tagClass:h.Class.UNIVERSAL,constructed:!1,captureAsn1:"encParameter",optional:!0}]},{name:"RecipientInfo.encryptedKey",tagClass:h.Class.UNIVERSAL,type:h.Type.OCTETSTRING,constructed:!1,capture:"encKey"}]}});var u0=c((NH,wQ)=>{var d$=o();XJ();d$.mgf=d$.mgf||{};var FW=wQ.exports=d$.mgf.mgf1=d$.mgf1=d$.mgf1||{};FW.create=function(J){var $={generate:function(Z,X){var Q=new d$.util.ByteBuffer,Y=Math.ceil(X/J.digestLength);for(var U=0;U<Y;U++){var G=new d$.util.ByteBuffer;G.putInt32(U),J.start(),J.update(Z+G.getBytes()),Q.putBuffer(J.digest())}return Q.truncate(Q.length()-X),Q.getBytes()}};return $}});var BQ=c((CH,IQ)=>{var cX=o();u0();IQ.exports=cX.mgf=cX.mgf||{};cX.mgf.mgf1=cX.mgf1});var nX=c((SH,jQ)=>{var g$=o();J$();XJ();var MW=jQ.exports=g$.pss=g$.pss||{};MW.create=function(J){if(arguments.length===3)J={md:arguments[0],mgf:arguments[1],saltLength:arguments[2]};var{md:$,mgf:Z}=J,X=$.digestLength,Q=J.salt||null;if(typeof Q==="string")Q=g$.util.createBuffer(Q);var Y;if("saltLength"in J)Y=J.saltLength;else if(Q!==null)Y=Q.length();else throw new Error("Salt length not specified or specific salt not given.");if(Q!==null&&Q.length()!==Y)throw new Error("Given salt length does not match length of given salt.");var U=J.prng||g$.random,G={};return G.encode=function(E,W){var H,O=W-1,M=Math.ceil(O/8),P=E.digest().getBytes();if(M<X+Y+2)throw new Error("Message is too long to encrypt.");var z;if(Q===null)z=U.getBytesSync(Y);else z=Q.bytes();var A=new g$.util.ByteBuffer;A.fillWithByte(0,8),A.putBytes(P),A.putBytes(z),$.start(),$.update(A.getBytes());var T=$.digest().getBytes(),C=new g$.util.ByteBuffer;C.fillWithByte(0,M-Y-X-2),C.putByte(1),C.putBytes(z);var L=C.getBytes(),w=M-X-1,f=Z.generate(T,w),v="";for(H=0;H<w;H++)v+=String.fromCharCode(L.charCodeAt(H)^f.charCodeAt(H));var x=65280>>8*M-O&255;return v=String.fromCharCode(v.charCodeAt(0)&~x)+v.substr(1),v+T+String.fromCharCode(188)},G.verify=function(E,W,H){var O,M=H-1,P=Math.ceil(M/8);if(W=W.substr(-P),P<X+Y+2)throw new Error("Inconsistent parameters to PSS signature verification.");if(W.charCodeAt(P-1)!==188)throw new Error("Encoded message does not end in 0xBC.");var z=P-X-1,A=W.substr(0,z),T=W.substr(z,X),C=65280>>8*P-M&255;if((A.charCodeAt(0)&C)!==0)throw new Error("Bits beyond keysize not zero as expected.");var L=Z.generate(T,z),w="";for(O=0;O<z;O++)w+=String.fromCharCode(A.charCodeAt(O)^L.charCodeAt(O));w=String.fromCharCode(w.charCodeAt(0)&~C)+w.substr(1);var f=P-X-Y-2;for(O=0;O<f;O++)if(w.charCodeAt(O)!==0)throw new Error("Leftmost octets not zero as expected");if(w.charCodeAt(f)!==1)throw new Error("Inconsistent PSS signature, 0x01 marker not found");var v=w.substr(-Y),x=new g$.util.ByteBuffer;x.fillWithByte(0,8),x.putBytes(E),x.putBytes(v),$.start(),$.update(x.getBytes());var p=$.digest().getBytes();return T===p},G}});var iX=c((LH,_Q)=>{var d=o();L$();G$();qX();E$();BQ();w$();f$();nX();zX();XJ();var V=d.asn1,k=_Q.exports=d.pki=d.pki||{},$J=k.oids,zJ={};zJ.CN=$J.commonName;zJ.commonName="CN";zJ.C=$J.countryName;zJ.countryName="C";zJ.L=$J.localityName;zJ.localityName="L";zJ.ST=$J.stateOrProvinceName;zJ.stateOrProvinceName="ST";zJ.O=$J.organizationName;zJ.organizationName="O";zJ.OU=$J.organizationalUnitName;zJ.organizationalUnitName="OU";zJ.E=$J.emailAddress;zJ.emailAddress="E";var kQ=d.pki.rsa.publicKeyValidator,zW={name:"Certificate",tagClass:V.Class.UNIVERSAL,type:V.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate",tagClass:V.Class.UNIVERSAL,type:V.Type.SEQUENCE,constructed:!0,captureAsn1:"tbsCertificate",value:[{name:"Certificate.TBSCertificate.version",tagClass:V.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.version.integer",tagClass:V.Class.UNIVERSAL,type:V.Type.INTEGER,constructed:!1,capture:"certVersion"}]},{name:"Certificate.TBSCertificate.serialNumber",tagClass:V.Class.UNIVERSAL,type:V.Type.INTEGER,constructed:!1,capture:"certSerialNumber"},{name:"Certificate.TBSCertificate.signature",tagClass:V.Class.UNIVERSAL,type:V.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.signature.algorithm",tagClass:V.Class.UNIVERSAL,type:V.Type.OID,constructed:!1,capture:"certinfoSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:V.Class.UNIVERSAL,optional:!0,captureAsn1:"certinfoSignatureParams"}]},{name:"Certificate.TBSCertificate.issuer",tagClass:V.Class.UNIVERSAL,type:V.Type.SEQUENCE,constructed:!0,captureAsn1:"certIssuer"},{name:"Certificate.TBSCertificate.validity",tagClass:V.Class.UNIVERSAL,type:V.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.TBSCertificate.validity.notBefore (utc)",tagClass:V.Class.UNIVERSAL,type:V.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity1UTCTime"},{name:"Certificate.TBSCertificate.validity.notBefore (generalized)",tagClass:V.Class.UNIVERSAL,type:V.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity2GeneralizedTime"},{name:"Certificate.TBSCertificate.validity.notAfter (utc)",tagClass:V.Class.UNIVERSAL,type:V.Type.UTCTIME,constructed:!1,optional:!0,capture:"certValidity3UTCTime"},{name:"Certificate.TBSCertificate.validity.notAfter (generalized)",tagClass:V.Class.UNIVERSAL,type:V.Type.GENERALIZEDTIME,constructed:!1,optional:!0,capture:"certValidity4GeneralizedTime"}]},{name:"Certificate.TBSCertificate.subject",tagClass:V.Class.UNIVERSAL,type:V.Type.SEQUENCE,constructed:!0,captureAsn1:"certSubject"},kQ,{name:"Certificate.TBSCertificate.issuerUniqueID",tagClass:V.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.issuerUniqueID.id",tagClass:V.Class.UNIVERSAL,type:V.Type.BITSTRING,constructed:!1,captureBitStringValue:"certIssuerUniqueId"}]},{name:"Certificate.TBSCertificate.subjectUniqueID",tagClass:V.Class.CONTEXT_SPECIFIC,type:2,constructed:!0,optional:!0,value:[{name:"Certificate.TBSCertificate.subjectUniqueID.id",tagClass:V.Class.UNIVERSAL,type:V.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSubjectUniqueId"}]},{name:"Certificate.TBSCertificate.extensions",tagClass:V.Class.CONTEXT_SPECIFIC,type:3,constructed:!0,captureAsn1:"certExtensions",optional:!0}]},{name:"Certificate.signatureAlgorithm",tagClass:V.Class.UNIVERSAL,type:V.Type.SEQUENCE,constructed:!0,value:[{name:"Certificate.signatureAlgorithm.algorithm",tagClass:V.Class.UNIVERSAL,type:V.Type.OID,constructed:!1,capture:"certSignatureOid"},{name:"Certificate.TBSCertificate.signature.parameters",tagClass:V.Class.UNIVERSAL,optional:!0,captureAsn1:"certSignatureParams"}]},{name:"Certificate.signatureValue",tagClass:V.Class.UNIVERSAL,type:V.Type.BITSTRING,constructed:!1,captureBitStringValue:"certSignature"}]},DW={name:"rsapss",tagClass:V.Class.UNIVERSAL,type:V.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.hashAlgorithm",tagClass:V.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier",tagClass:V.Class.UNIVERSAL,type:V.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.hashAlgorithm.AlgorithmIdentifier.algorithm",tagClass:V.Class.UNIVERSAL,type:V.Type.OID,constructed:!1,capture:"hashOid"}]}]},{name:"rsapss.maskGenAlgorithm",tagClass:V.Class.CONTEXT_SPECIFIC,type:1,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier",tagClass:V.Class.UNIVERSAL,type:V.Class.SEQUENCE,constructed:!0,optional:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.algorithm",tagClass:V.Class.UNIVERSAL,type:V.Type.OID,constructed:!1,capture:"maskGenOid"},{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params",tagClass:V.Class.UNIVERSAL,type:V.Type.SEQUENCE,constructed:!0,value:[{name:"rsapss.maskGenAlgorithm.AlgorithmIdentifier.params.algorithm",tagClass:V.Class.UNIVERSAL,type:V.Type.OID,constructed:!1,capture:"maskGenHashOid"}]}]}]},{name:"rsapss.saltLength",tagClass:V.Class.CONTEXT_SPECIFIC,type:2,optional:!0,value:[{name:"rsapss.saltLength.saltLength",tagClass:V.Class.UNIVERSAL,type:V.Class.INTEGER,constructed:!1,capture:"saltLength"}]},{name:"rsapss.trailerField",tagClass:V.Class.CONTEXT_SPECIFIC,type:3,optional:!0,value:[{name:"rsapss.trailer.trailer",tagClass:V.Class.UNIVERSAL,type:V.Class.INTEGER,constructed:!1,capture:"trailer"}]}]},PW={name:"CertificationRequestInfo",tagClass:V.Class.UNIVERSAL,type:V.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfo",value:[{name:"CertificationRequestInfo.integer",tagClass:V.Class.UNIVERSAL,type:V.Type.INTEGER,constructed:!1,capture:"certificationRequestInfoVersion"},{name:"CertificationRequestInfo.subject",tagClass:V.Class.UNIVERSAL,type:V.Type.SEQUENCE,constructed:!0,captureAsn1:"certificationRequestInfoSubject"},kQ,{name:"CertificationRequestInfo.attributes",tagClass:V.Class.CONTEXT_SPECIFIC,type:0,constructed:!0,optional:!0,capture:"certificationRequestInfoAttributes",value:[{name:"CertificationRequestInfo.attributes",tagClass:V.Class.UNIVERSAL,type:V.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequestInfo.attributes.type",tagClass:V.Class.UNIVERSAL,type:V.Type.OID,constructed:!1},{name:"CertificationRequestInfo.attributes.value",tagClass:V.Class.UNIVERSAL,type:V.Type.SET,constructed:!0}]}]}]},KW={name:"CertificationRequest",tagClass:V.Class.UNIVERSAL,type:V.Type.SEQUENCE,constructed:!0,captureAsn1:"csr",value:[PW,{name:"CertificationRequest.signatureAlgorithm",tagClass:V.Class.UNIVERSAL,type:V.Type.SEQUENCE,constructed:!0,value:[{name:"CertificationRequest.signatureAlgorithm.algorithm",tagClass:V.Class.UNIVERSAL,type:V.Type.OID,constructed:!1,capture:"csrSignatureOid"},{name:"CertificationRequest.signatureAlgorithm.parameters",tagClass:V.Class.UNIVERSAL,optional:!0,captureAsn1:"csrSignatureParams"}]},{name:"CertificationRequest.signature",tagClass:V.Class.UNIVERSAL,type:V.Type.BITSTRING,constructed:!1,captureBitStringValue:"csrSignature"}]};k.RDNAttributesAsArray=function(J,$){var Z=[],X,Q,Y;for(var U=0;U<J.value.length;++U){X=J.value[U];for(var G=0;G<X.value.length;++G){if(Y={},Q=X.value[G],Y.type=V.derToOid(Q.value[0].value),Y.value=Q.value[1].value,Y.valueTagClass=Q.value[1].type,Y.type in $J){if(Y.name=$J[Y.type],Y.name in zJ)Y.shortName=zJ[Y.name]}if($)$.update(Y.type),$.update(Y.value);Z.push(Y)}}return Z};k.CRIAttributesAsArray=function(J){var $=[];for(var Z=0;Z<J.length;++Z){var X=J[Z],Q=V.derToOid(X.value[0].value),Y=X.value[1].value;for(var U=0;U<Y.length;++U){var G={};if(G.type=Q,G.value=Y[U].value,G.valueTagClass=Y[U].type,G.type in $J){if(G.name=$J[G.type],G.name in zJ)G.shortName=zJ[G.name]}if(G.type===$J.extensionRequest){G.extensions=[];for(var E=0;E<G.value.length;++E)G.extensions.push(k.certificateExtensionFromAsn1(G.value[E]))}$.push(G)}}return $};function j$(J,$){if(typeof $==="string")$={shortName:$};var Z=null,X;for(var Q=0;Z===null&&Q<J.attributes.length;++Q)if(X=J.attributes[Q],$.type&&$.type===X.type)Z=X;else if($.name&&$.name===X.name)Z=X;else if($.shortName&&$.shortName===X.shortName)Z=X;return Z}var oX=function(J,$,Z){var X={};if(J!==$J["RSASSA-PSS"])return X;if(Z)X={hash:{algorithmOid:$J.sha1},mgf:{algorithmOid:$J.mgf1,hash:{algorithmOid:$J.sha1}},saltLength:20};var Q={},Y=[];if(!V.validate($,DW,Q,Y)){var U=new Error("Cannot read RSASSA-PSS parameter block.");throw U.errors=Y,U}if(Q.hashOid!==void 0)X.hash=X.hash||{},X.hash.algorithmOid=V.derToOid(Q.hashOid);if(Q.maskGenOid!==void 0)X.mgf=X.mgf||{},X.mgf.algorithmOid=V.derToOid(Q.maskGenOid),X.mgf.hash=X.mgf.hash||{},X.mgf.hash.algorithmOid=V.derToOid(Q.maskGenHashOid);if(Q.saltLength!==void 0)X.saltLength=Q.saltLength.charCodeAt(0);return X},aX=function(J){switch($J[J.signatureOid]){case"sha1WithRSAEncryption":case"sha1WithRSASignature":return d.md.sha1.create();case"md5WithRSAEncryption":return d.md.md5.create();case"sha256WithRSAEncryption":return d.md.sha256.create();case"sha384WithRSAEncryption":return d.md.sha384.create();case"sha512WithRSAEncryption":return d.md.sha512.create();case"RSASSA-PSS":return d.md.sha256.create();default:var $=new Error("Could not compute "+J.type+" digest. Unknown signature OID.");throw $.signatureOid=J.signatureOid,$}},vQ=function(J){var $=J.certificate,Z;switch($.signatureOid){case $J.sha1WithRSAEncryption:case $J.sha1WithRSASignature:break;case $J["RSASSA-PSS"]:var X,Q;if(X=$J[$.signatureParameters.mgf.hash.algorithmOid],X===void 0||d.md[X]===void 0){var Y=new Error("Unsupported MGF hash function.");throw Y.oid=$.signatureParameters.mgf.hash.algorithmOid,Y.name=X,Y}if(Q=$J[$.signatureParameters.mgf.algorithmOid],Q===void 0||d.mgf[Q]===void 0){var Y=new Error("Unsupported MGF function.");throw Y.oid=$.signatureParameters.mgf.algorithmOid,Y.name=Q,Y}if(Q=d.mgf[Q].create(d.md[X].create()),X=$J[$.signatureParameters.hash.algorithmOid],X===void 0||d.md[X]===void 0){var Y=new Error("Unsupported RSASSA-PSS hash function.");throw Y.oid=$.signatureParameters.hash.algorithmOid,Y.name=X,Y}Z=d.pss.create(d.md[X].create(),Q,$.signatureParameters.saltLength);break}return $.publicKey.verify(J.md.digest().getBytes(),J.signature,Z)};k.certificateFromPem=function(J,$,Z){var X=d.pem.decode(J)[0];if(X.type!=="CERTIFICATE"&&X.type!=="X509 CERTIFICATE"&&X.type!=="TRUSTED CERTIFICATE"){var Q=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw Q.headerType=X.type,Q}if(X.procType&&X.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var Y=V.fromDer(X.body,Z);return k.certificateFromAsn1(Y,$)};k.certificateToPem=function(J,$){var Z={type:"CERTIFICATE",body:V.toDer(k.certificateToAsn1(J)).getBytes()};return d.pem.encode(Z,{maxline:$})};k.publicKeyFromPem=function(J){var $=d.pem.decode(J)[0];if($.type!=="PUBLIC KEY"&&$.type!=="RSA PUBLIC KEY"){var Z=new Error('Could not convert public key from PEM; PEM header type is not "PUBLIC KEY" or "RSA PUBLIC KEY".');throw Z.headerType=$.type,Z}if($.procType&&$.procType.type==="ENCRYPTED")throw new Error("Could not convert public key from PEM; PEM is encrypted.");var X=V.fromDer($.body);return k.publicKeyFromAsn1(X)};k.publicKeyToPem=function(J,$){var Z={type:"PUBLIC KEY",body:V.toDer(k.publicKeyToAsn1(J)).getBytes()};return d.pem.encode(Z,{maxline:$})};k.publicKeyToRSAPublicKeyPem=function(J,$){var Z={type:"RSA PUBLIC KEY",body:V.toDer(k.publicKeyToRSAPublicKey(J)).getBytes()};return d.pem.encode(Z,{maxline:$})};k.getPublicKeyFingerprint=function(J,$){$=$||{};var Z=$.md||d.md.sha1.create(),X=$.type||"RSAPublicKey",Q;switch(X){case"RSAPublicKey":Q=V.toDer(k.publicKeyToRSAPublicKey(J)).getBytes();break;case"SubjectPublicKeyInfo":Q=V.toDer(k.publicKeyToAsn1(J)).getBytes();break;default:throw new Error('Unknown fingerprint type "'+$.type+'".')}Z.start(),Z.update(Q);var Y=Z.digest();if($.encoding==="hex"){var U=Y.toHex();if($.delimiter)return U.match(/.{2}/g).join($.delimiter);return U}else if($.encoding==="binary")return Y.getBytes();else if($.encoding)throw new Error('Unknown encoding "'+$.encoding+'".');return Y};k.certificationRequestFromPem=function(J,$,Z){var X=d.pem.decode(J)[0];if(X.type!=="CERTIFICATE REQUEST"){var Q=new Error('Could not convert certification request from PEM; PEM header type is not "CERTIFICATE REQUEST".');throw Q.headerType=X.type,Q}if(X.procType&&X.procType.type==="ENCRYPTED")throw new Error("Could not convert certification request from PEM; PEM is encrypted.");var Y=V.fromDer(X.body,Z);return k.certificationRequestFromAsn1(Y,$)};k.certificationRequestToPem=function(J,$){var Z={type:"CERTIFICATE REQUEST",body:V.toDer(k.certificationRequestToAsn1(J)).getBytes()};return d.pem.encode(Z,{maxline:$})};k.createCertificate=function(){var J={};return J.version=2,J.serialNumber="00",J.signatureOid=null,J.signature=null,J.siginfo={},J.siginfo.algorithmOid=null,J.validity={},J.validity.notBefore=new Date,J.validity.notAfter=new Date,J.issuer={},J.issuer.getField=function($){return j$(J.issuer,$)},J.issuer.addField=function($){Z$([$]),J.issuer.attributes.push($)},J.issuer.attributes=[],J.issuer.hash=null,J.subject={},J.subject.getField=function($){return j$(J.subject,$)},J.subject.addField=function($){Z$([$]),J.subject.attributes.push($)},J.subject.attributes=[],J.subject.hash=null,J.extensions=[],J.publicKey=null,J.md=null,J.setSubject=function($,Z){if(Z$($),J.subject.attributes=$,delete J.subject.uniqueId,Z)J.subject.uniqueId=Z;J.subject.hash=null},J.setIssuer=function($,Z){if(Z$($),J.issuer.attributes=$,delete J.issuer.uniqueId,Z)J.issuer.uniqueId=Z;J.issuer.hash=null},J.setExtensions=function($){for(var Z=0;Z<$.length;++Z)yQ($[Z],{cert:J});J.extensions=$},J.getExtension=function($){if(typeof $==="string")$={name:$};var Z=null,X;for(var Q=0;Z===null&&Q<J.extensions.length;++Q)if(X=J.extensions[Q],$.id&&X.id===$.id)Z=X;else if($.name&&X.name===$.name)Z=X;return Z},J.sign=function($,Z){J.md=Z||d.md.sha1.create();var X=$J[J.md.algorithm+"WithRSAEncryption"];if(!X){var Q=new Error("Could not compute certificate digest. Unknown message digest algorithm OID.");throw Q.algorithm=J.md.algorithm,Q}J.signatureOid=J.siginfo.algorithmOid=X,J.tbsCertificate=k.getTBSCertificate(J);var Y=V.toDer(J.tbsCertificate);J.md.update(Y.getBytes()),J.signature=$.sign(J.md)},J.verify=function($){var Z=!1;if(!J.issued($)){var X=$.issuer,Q=J.subject,Y=new Error("The parent certificate did not issue the given child certificate; the child certificate's issuer does not match the parent's subject.");throw Y.expectedIssuer=Q.attributes,Y.actualIssuer=X.attributes,Y}var U=$.md;if(U===null){U=aX({signatureOid:$.signatureOid,type:"certificate"});var G=$.tbsCertificate||k.getTBSCertificate($),E=V.toDer(G);U.update(E.getBytes())}if(U!==null)Z=vQ({certificate:J,md:U,signature:$.signature});return Z},J.isIssuer=function($){var Z=!1,X=J.issuer,Q=$.subject;if(X.hash&&Q.hash)Z=X.hash===Q.hash;else if(X.attributes.length===Q.attributes.length){Z=!0;var Y,U;for(var G=0;Z&&G<X.attributes.length;++G)if(Y=X.attributes[G],U=Q.attributes[G],Y.type!==U.type||Y.value!==U.value)Z=!1}return Z},J.issued=function($){return $.isIssuer(J)},J.generateSubjectKeyIdentifier=function(){return k.getPublicKeyFingerprint(J.publicKey,{type:"RSAPublicKey"})},J.verifySubjectKeyIdentifier=function(){var $=$J.subjectKeyIdentifier;for(var Z=0;Z<J.extensions.length;++Z){var X=J.extensions[Z];if(X.id===$){var Q=J.generateSubjectKeyIdentifier().getBytes();return d.util.hexToBytes(X.subjectKeyIdentifier)===Q}}return!1},J};k.certificateFromAsn1=function(J,$){var Z={},X=[];if(!V.validate(J,zW,Z,X)){var Q=new Error("Cannot read X.509 certificate. ASN.1 object is not an X509v3 Certificate.");throw Q.errors=X,Q}var Y=V.derToOid(Z.publicKeyOid);if(Y!==k.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var U=k.createCertificate();U.version=Z.certVersion?Z.certVersion.charCodeAt(0):0;var G=d.util.createBuffer(Z.certSerialNumber);U.serialNumber=G.toHex(),U.signatureOid=d.asn1.derToOid(Z.certSignatureOid),U.signatureParameters=oX(U.signatureOid,Z.certSignatureParams,!0),U.siginfo.algorithmOid=d.asn1.derToOid(Z.certinfoSignatureOid),U.siginfo.parameters=oX(U.siginfo.algorithmOid,Z.certinfoSignatureParams,!1),U.signature=Z.certSignature;var E=[];if(Z.certValidity1UTCTime!==void 0)E.push(V.utcTimeToDate(Z.certValidity1UTCTime));if(Z.certValidity2GeneralizedTime!==void 0)E.push(V.generalizedTimeToDate(Z.certValidity2GeneralizedTime));if(Z.certValidity3UTCTime!==void 0)E.push(V.utcTimeToDate(Z.certValidity3UTCTime));if(Z.certValidity4GeneralizedTime!==void 0)E.push(V.generalizedTimeToDate(Z.certValidity4GeneralizedTime));if(E.length>2)throw new Error("Cannot read notBefore/notAfter validity times; more than two times were provided in the certificate.");if(E.length<2)throw new Error("Cannot read notBefore/notAfter validity times; they were not provided as either UTCTime or GeneralizedTime.");if(U.validity.notBefore=E[0],U.validity.notAfter=E[1],U.tbsCertificate=Z.tbsCertificate,$){U.md=aX({signatureOid:U.signatureOid,type:"certificate"});var W=V.toDer(U.tbsCertificate);U.md.update(W.getBytes())}var H=d.md.sha1.create(),O=V.toDer(Z.certIssuer);if(H.update(O.getBytes()),U.issuer.getField=function(z){return j$(U.issuer,z)},U.issuer.addField=function(z){Z$([z]),U.issuer.attributes.push(z)},U.issuer.attributes=k.RDNAttributesAsArray(Z.certIssuer),Z.certIssuerUniqueId)U.issuer.uniqueId=Z.certIssuerUniqueId;U.issuer.hash=H.digest().toHex();var M=d.md.sha1.create(),P=V.toDer(Z.certSubject);if(M.update(P.getBytes()),U.subject.getField=function(z){return j$(U.subject,z)},U.subject.addField=function(z){Z$([z]),U.subject.attributes.push(z)},U.subject.attributes=k.RDNAttributesAsArray(Z.certSubject),Z.certSubjectUniqueId)U.subject.uniqueId=Z.certSubjectUniqueId;if(U.subject.hash=M.digest().toHex(),Z.certExtensions)U.extensions=k.certificateExtensionsFromAsn1(Z.certExtensions);else U.extensions=[];return U.publicKey=k.publicKeyFromAsn1(Z.subjectPublicKeyInfo),U};k.certificateExtensionsFromAsn1=function(J){var $=[];for(var Z=0;Z<J.value.length;++Z){var X=J.value[Z];for(var Q=0;Q<X.value.length;++Q)$.push(k.certificateExtensionFromAsn1(X.value[Q]))}return $};k.certificateExtensionFromAsn1=function(J){var $={};if($.id=V.derToOid(J.value[0].value),$.critical=!1,J.value[1].type===V.Type.BOOLEAN)$.critical=J.value[1].value.charCodeAt(0)!==0,$.value=J.value[2].value;else $.value=J.value[1].value;if($.id in $J){if($.name=$J[$.id],$.name==="keyUsage"){var Z=V.fromDer($.value),X=0,Q=0;if(Z.value.length>1)X=Z.value.charCodeAt(1),Q=Z.value.length>2?Z.value.charCodeAt(2):0;$.digitalSignature=(X&128)===128,$.nonRepudiation=(X&64)===64,$.keyEncipherment=(X&32)===32,$.dataEncipherment=(X&16)===16,$.keyAgreement=(X&8)===8,$.keyCertSign=(X&4)===4,$.cRLSign=(X&2)===2,$.encipherOnly=(X&1)===1,$.decipherOnly=(Q&128)===128}else if($.name==="basicConstraints"){var Z=V.fromDer($.value);if(Z.value.length>0&&Z.value[0].type===V.Type.BOOLEAN)$.cA=Z.value[0].value.charCodeAt(0)!==0;else $.cA=!1;var Y=null;if(Z.value.length>0&&Z.value[0].type===V.Type.INTEGER)Y=Z.value[0].value;else if(Z.value.length>1)Y=Z.value[1].value;if(Y!==null)$.pathLenConstraint=V.derToInteger(Y)}else if($.name==="extKeyUsage"){var Z=V.fromDer($.value);for(var U=0;U<Z.value.length;++U){var G=V.derToOid(Z.value[U].value);if(G in $J)$[$J[G]]=!0;else $[G]=!0}}else if($.name==="nsCertType"){var Z=V.fromDer($.value),X=0;if(Z.value.length>1)X=Z.value.charCodeAt(1);$.client=(X&128)===128,$.server=(X&64)===64,$.email=(X&32)===32,$.objsign=(X&16)===16,$.reserved=(X&8)===8,$.sslCA=(X&4)===4,$.emailCA=(X&2)===2,$.objCA=(X&1)===1}else if($.name==="subjectAltName"||$.name==="issuerAltName"){$.altNames=[];var E,Z=V.fromDer($.value);for(var W=0;W<Z.value.length;++W){E=Z.value[W];var H={type:E.type,value:E.value};switch($.altNames.push(H),E.type){case 1:case 2:case 6:break;case 7:H.ip=d.util.bytesToIP(E.value);break;case 8:H.oid=V.derToOid(E.value);break;default:}}}else if($.name==="subjectKeyIdentifier"){var Z=V.fromDer($.value);$.subjectKeyIdentifier=d.util.bytesToHex(Z.value)}}return $};k.certificationRequestFromAsn1=function(J,$){var Z={},X=[];if(!V.validate(J,KW,Z,X)){var Q=new Error("Cannot read PKCS#10 certificate request. ASN.1 object is not a PKCS#10 CertificationRequest.");throw Q.errors=X,Q}var Y=V.derToOid(Z.publicKeyOid);if(Y!==k.oids.rsaEncryption)throw new Error("Cannot read public key. OID is not RSA.");var U=k.createCertificationRequest();if(U.version=Z.csrVersion?Z.csrVersion.charCodeAt(0):0,U.signatureOid=d.asn1.derToOid(Z.csrSignatureOid),U.signatureParameters=oX(U.signatureOid,Z.csrSignatureParams,!0),U.siginfo.algorithmOid=d.asn1.derToOid(Z.csrSignatureOid),U.siginfo.parameters=oX(U.siginfo.algorithmOid,Z.csrSignatureParams,!1),U.signature=Z.csrSignature,U.certificationRequestInfo=Z.certificationRequestInfo,$){U.md=aX({signatureOid:U.signatureOid,type:"certification request"});var G=V.toDer(U.certificationRequestInfo);U.md.update(G.getBytes())}var E=d.md.sha1.create();return U.subject.getField=function(W){return j$(U.subject,W)},U.subject.addField=function(W){Z$([W]),U.subject.attributes.push(W)},U.subject.attributes=k.RDNAttributesAsArray(Z.certificationRequestInfoSubject,E),U.subject.hash=E.digest().toHex(),U.publicKey=k.publicKeyFromAsn1(Z.subjectPublicKeyInfo),U.getAttribute=function(W){return j$(U,W)},U.addAttribute=function(W){Z$([W]),U.attributes.push(W)},U.attributes=k.CRIAttributesAsArray(Z.certificationRequestInfoAttributes||[]),U};k.createCertificationRequest=function(){var J={};return J.version=0,J.signatureOid=null,J.signature=null,J.siginfo={},J.siginfo.algorithmOid=null,J.subject={},J.subject.getField=function($){return j$(J.subject,$)},J.subject.addField=function($){Z$([$]),J.subject.attributes.push($)},J.subject.attributes=[],J.subject.hash=null,J.publicKey=null,J.attributes=[],J.getAttribute=function($){return j$(J,$)},J.addAttribute=function($){Z$([$]),J.attributes.push($)},J.md=null,J.setSubject=function($){Z$($),J.subject.attributes=$,J.subject.hash=null},J.setAttributes=function($){Z$($),J.attributes=$},J.sign=function($,Z){J.md=Z||d.md.sha1.create();var X=$J[J.md.algorithm+"WithRSAEncryption"];if(!X){var Q=new Error("Could not compute certification request digest. Unknown message digest algorithm OID.");throw Q.algorithm=J.md.algorithm,Q}J.signatureOid=J.siginfo.algorithmOid=X,J.certificationRequestInfo=k.getCertificationRequestInfo(J);var Y=V.toDer(J.certificationRequestInfo);J.md.update(Y.getBytes()),J.signature=$.sign(J.md)},J.verify=function(){var $=!1,Z=J.md;if(Z===null){Z=aX({signatureOid:J.signatureOid,type:"certification request"});var X=J.certificationRequestInfo||k.getCertificationRequestInfo(J),Q=V.toDer(X);Z.update(Q.getBytes())}if(Z!==null)$=vQ({certificate:J,md:Z,signature:J.signature});return $},J};function XX(J){var $=V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,[]),Z,X,Q=J.attributes;for(var Y=0;Y<Q.length;++Y){Z=Q[Y];var U=Z.value,G=V.Type.PRINTABLESTRING;if("valueTagClass"in Z){if(G=Z.valueTagClass,G===V.Type.UTF8)U=d.util.encodeUtf8(U)}X=V.create(V.Class.UNIVERSAL,V.Type.SET,!0,[V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,[V.create(V.Class.UNIVERSAL,V.Type.OID,!1,V.oidToDer(Z.type).getBytes()),V.create(V.Class.UNIVERSAL,G,!1,U)])]),$.value.push(X)}return $}function Z$(J){var $;for(var Z=0;Z<J.length;++Z){if($=J[Z],typeof $.name==="undefined"){if($.type&&$.type in k.oids)$.name=k.oids[$.type];else if($.shortName&&$.shortName in zJ)$.name=k.oids[zJ[$.shortName]]}if(typeof $.type==="undefined")if($.name&&$.name in k.oids)$.type=k.oids[$.name];else{var X=new Error("Attribute type not specified.");throw X.attribute=$,X}if(typeof $.shortName==="undefined"){if($.name&&$.name in zJ)$.shortName=zJ[$.name]}if($.type===$J.extensionRequest){if($.valueConstructed=!0,$.valueTagClass=V.Type.SEQUENCE,!$.value&&$.extensions){$.value=[];for(var Q=0;Q<$.extensions.length;++Q)$.value.push(k.certificateExtensionToAsn1(yQ($.extensions[Q])))}}if(typeof $.value==="undefined"){var X=new Error("Attribute value not specified.");throw X.attribute=$,X}}}function yQ(J,$){if($=$||{},typeof J.name==="undefined"){if(J.id&&J.id in k.oids)J.name=k.oids[J.id]}if(typeof J.id==="undefined")if(J.name&&J.name in k.oids)J.id=k.oids[J.name];else{var Z=new Error("Extension ID not specified.");throw Z.extension=J,Z}if(typeof J.value!=="undefined")return J;if(J.name==="keyUsage"){var X=0,Q=0,Y=0;if(J.digitalSignature)Q|=128,X=7;if(J.nonRepudiation)Q|=64,X=6;if(J.keyEncipherment)Q|=32,X=5;if(J.dataEncipherment)Q|=16,X=4;if(J.keyAgreement)Q|=8,X=3;if(J.keyCertSign)Q|=4,X=2;if(J.cRLSign)Q|=2,X=1;if(J.encipherOnly)Q|=1,X=0;if(J.decipherOnly)Y|=128,X=7;var U=String.fromCharCode(X);if(Y!==0)U+=String.fromCharCode(Q)+String.fromCharCode(Y);else if(Q!==0)U+=String.fromCharCode(Q);J.value=V.create(V.Class.UNIVERSAL,V.Type.BITSTRING,!1,U)}else if(J.name==="basicConstraints"){if(J.value=V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,[]),J.cA)J.value.value.push(V.create(V.Class.UNIVERSAL,V.Type.BOOLEAN,!1,String.fromCharCode(255)));if("pathLenConstraint"in J)J.value.value.push(V.create(V.Class.UNIVERSAL,V.Type.INTEGER,!1,V.integerToDer(J.pathLenConstraint).getBytes()))}else if(J.name==="extKeyUsage"){J.value=V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,[]);var G=J.value.value;for(var E in J){if(J[E]!==!0)continue;if(E in $J)G.push(V.create(V.Class.UNIVERSAL,V.Type.OID,!1,V.oidToDer($J[E]).getBytes()));else if(E.indexOf(".")!==-1)G.push(V.create(V.Class.UNIVERSAL,V.Type.OID,!1,V.oidToDer(E).getBytes()))}}else if(J.name==="nsCertType"){var X=0,Q=0;if(J.client)Q|=128,X=7;if(J.server)Q|=64,X=6;if(J.email)Q|=32,X=5;if(J.objsign)Q|=16,X=4;if(J.reserved)Q|=8,X=3;if(J.sslCA)Q|=4,X=2;if(J.emailCA)Q|=2,X=1;if(J.objCA)Q|=1,X=0;var U=String.fromCharCode(X);if(Q!==0)U+=String.fromCharCode(Q);J.value=V.create(V.Class.UNIVERSAL,V.Type.BITSTRING,!1,U)}else if(J.name==="subjectAltName"||J.name==="issuerAltName"){J.value=V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,[]);var W;for(var H=0;H<J.altNames.length;++H){W=J.altNames[H];var U=W.value;if(W.type===7&&W.ip){if(U=d.util.bytesFromIP(W.ip),U===null){var Z=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw Z.extension=J,Z}}else if(W.type===8)if(W.oid)U=V.oidToDer(V.oidToDer(W.oid));else U=V.oidToDer(U);J.value.value.push(V.create(V.Class.CONTEXT_SPECIFIC,W.type,!1,U))}}else if(J.name==="nsComment"&&$.cert){if(!/^[\x00-\x7F]*$/.test(J.comment)||J.comment.length<1||J.comment.length>128)throw new Error('Invalid "nsComment" content.');J.value=V.create(V.Class.UNIVERSAL,V.Type.IA5STRING,!1,J.comment)}else if(J.name==="subjectKeyIdentifier"&&$.cert){var O=$.cert.generateSubjectKeyIdentifier();J.subjectKeyIdentifier=O.toHex(),J.value=V.create(V.Class.UNIVERSAL,V.Type.OCTETSTRING,!1,O.getBytes())}else if(J.name==="authorityKeyIdentifier"&&$.cert){J.value=V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,[]);var G=J.value.value;if(J.keyIdentifier){var M=J.keyIdentifier===!0?$.cert.generateSubjectKeyIdentifier().getBytes():J.keyIdentifier;G.push(V.create(V.Class.CONTEXT_SPECIFIC,0,!1,M))}if(J.authorityCertIssuer){var P=[V.create(V.Class.CONTEXT_SPECIFIC,4,!0,[XX(J.authorityCertIssuer===!0?$.cert.issuer:J.authorityCertIssuer)])];G.push(V.create(V.Class.CONTEXT_SPECIFIC,1,!0,P))}if(J.serialNumber){var z=d.util.hexToBytes(J.serialNumber===!0?$.cert.serialNumber:J.serialNumber);G.push(V.create(V.Class.CONTEXT_SPECIFIC,2,!1,z))}}else if(J.name==="cRLDistributionPoints"){J.value=V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,[]);var G=J.value.value,A=V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,[]),T=V.create(V.Class.CONTEXT_SPECIFIC,0,!0,[]),W;for(var H=0;H<J.altNames.length;++H){W=J.altNames[H];var U=W.value;if(W.type===7&&W.ip){if(U=d.util.bytesFromIP(W.ip),U===null){var Z=new Error('Extension "ip" value is not a valid IPv4 or IPv6 address.');throw Z.extension=J,Z}}else if(W.type===8)if(W.oid)U=V.oidToDer(V.oidToDer(W.oid));else U=V.oidToDer(U);T.value.push(V.create(V.Class.CONTEXT_SPECIFIC,W.type,!1,U))}A.value.push(V.create(V.Class.CONTEXT_SPECIFIC,0,!0,[T])),G.push(A)}if(typeof J.value==="undefined"){var Z=new Error("Extension value not specified.");throw Z.extension=J,Z}return J}function b0(J,$){switch(J){case $J["RSASSA-PSS"]:var Z=[];if($.hash.algorithmOid!==void 0)Z.push(V.create(V.Class.CONTEXT_SPECIFIC,0,!0,[V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,[V.create(V.Class.UNIVERSAL,V.Type.OID,!1,V.oidToDer($.hash.algorithmOid).getBytes()),V.create(V.Class.UNIVERSAL,V.Type.NULL,!1,"")])]));if($.mgf.algorithmOid!==void 0)Z.push(V.create(V.Class.CONTEXT_SPECIFIC,1,!0,[V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,[V.create(V.Class.UNIVERSAL,V.Type.OID,!1,V.oidToDer($.mgf.algorithmOid).getBytes()),V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,[V.create(V.Class.UNIVERSAL,V.Type.OID,!1,V.oidToDer($.mgf.hash.algorithmOid).getBytes()),V.create(V.Class.UNIVERSAL,V.Type.NULL,!1,"")])])]));if($.saltLength!==void 0)Z.push(V.create(V.Class.CONTEXT_SPECIFIC,2,!0,[V.create(V.Class.UNIVERSAL,V.Type.INTEGER,!1,V.integerToDer($.saltLength).getBytes())]));return V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,Z);default:return V.create(V.Class.UNIVERSAL,V.Type.NULL,!1,"")}}function RW(J){var $=V.create(V.Class.CONTEXT_SPECIFIC,0,!0,[]);if(J.attributes.length===0)return $;var Z=J.attributes;for(var X=0;X<Z.length;++X){var Q=Z[X],Y=Q.value,U=V.Type.UTF8;if("valueTagClass"in Q)U=Q.valueTagClass;if(U===V.Type.UTF8)Y=d.util.encodeUtf8(Y);var G=!1;if("valueConstructed"in Q)G=Q.valueConstructed;var E=V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,[V.create(V.Class.UNIVERSAL,V.Type.OID,!1,V.oidToDer(Q.type).getBytes()),V.create(V.Class.UNIVERSAL,V.Type.SET,!0,[V.create(V.Class.UNIVERSAL,U,G,Y)])]);$.value.push(E)}return $}var AW=new Date("1950-01-01T00:00:00Z"),TW=new Date("2050-01-01T00:00:00Z");function xQ(J){if(J>=AW&&J<TW)return V.create(V.Class.UNIVERSAL,V.Type.UTCTIME,!1,V.dateToUtcTime(J));else return V.create(V.Class.UNIVERSAL,V.Type.GENERALIZEDTIME,!1,V.dateToGeneralizedTime(J))}k.getTBSCertificate=function(J){var $=xQ(J.validity.notBefore),Z=xQ(J.validity.notAfter),X=V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,[V.create(V.Class.CONTEXT_SPECIFIC,0,!0,[V.create(V.Class.UNIVERSAL,V.Type.INTEGER,!1,V.integerToDer(J.version).getBytes())]),V.create(V.Class.UNIVERSAL,V.Type.INTEGER,!1,d.util.hexToBytes(J.serialNumber)),V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,[V.create(V.Class.UNIVERSAL,V.Type.OID,!1,V.oidToDer(J.siginfo.algorithmOid).getBytes()),b0(J.siginfo.algorithmOid,J.siginfo.parameters)]),XX(J.issuer),V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,[$,Z]),XX(J.subject),k.publicKeyToAsn1(J.publicKey)]);if(J.issuer.uniqueId)X.value.push(V.create(V.Class.CONTEXT_SPECIFIC,1,!0,[V.create(V.Class.UNIVERSAL,V.Type.BITSTRING,!1,String.fromCharCode(0)+J.issuer.uniqueId)]));if(J.subject.uniqueId)X.value.push(V.create(V.Class.CONTEXT_SPECIFIC,2,!0,[V.create(V.Class.UNIVERSAL,V.Type.BITSTRING,!1,String.fromCharCode(0)+J.subject.uniqueId)]));if(J.extensions.length>0)X.value.push(k.certificateExtensionsToAsn1(J.extensions));return X};k.getCertificationRequestInfo=function(J){var $=V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,[V.create(V.Class.UNIVERSAL,V.Type.INTEGER,!1,V.integerToDer(J.version).getBytes()),XX(J.subject),k.publicKeyToAsn1(J.publicKey),RW(J)]);return $};k.distinguishedNameToAsn1=function(J){return XX(J)};k.certificateToAsn1=function(J){var $=J.tbsCertificate||k.getTBSCertificate(J);return V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,[$,V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,[V.create(V.Class.UNIVERSAL,V.Type.OID,!1,V.oidToDer(J.signatureOid).getBytes()),b0(J.signatureOid,J.signatureParameters)]),V.create(V.Class.UNIVERSAL,V.Type.BITSTRING,!1,String.fromCharCode(0)+J.signature)])};k.certificateExtensionsToAsn1=function(J){var $=V.create(V.Class.CONTEXT_SPECIFIC,3,!0,[]),Z=V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,[]);$.value.push(Z);for(var X=0;X<J.length;++X)Z.value.push(k.certificateExtensionToAsn1(J[X]));return $};k.certificateExtensionToAsn1=function(J){var $=V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,[]);if($.value.push(V.create(V.Class.UNIVERSAL,V.Type.OID,!1,V.oidToDer(J.id).getBytes())),J.critical)$.value.push(V.create(V.Class.UNIVERSAL,V.Type.BOOLEAN,!1,String.fromCharCode(255)));var Z=J.value;if(typeof J.value!=="string")Z=V.toDer(Z).getBytes();return $.value.push(V.create(V.Class.UNIVERSAL,V.Type.OCTETSTRING,!1,Z)),$};k.certificationRequestToAsn1=function(J){var $=J.certificationRequestInfo||k.getCertificationRequestInfo(J);return V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,[$,V.create(V.Class.UNIVERSAL,V.Type.SEQUENCE,!0,[V.create(V.Class.UNIVERSAL,V.Type.OID,!1,V.oidToDer(J.signatureOid).getBytes()),b0(J.signatureOid,J.signatureParameters)]),V.create(V.Class.UNIVERSAL,V.Type.BITSTRING,!1,String.fromCharCode(0)+J.signature)])};k.createCaStore=function(J){var $={certs:{}};$.getIssuer=function(U){var G=Z(U.issuer);return G},$.addCertificate=function(U){if(typeof U==="string")U=d.pki.certificateFromPem(U);if(X(U.subject),!$.hasCertificate(U))if(U.subject.hash in $.certs){var G=$.certs[U.subject.hash];if(!d.util.isArray(G))G=[G];G.push(U),$.certs[U.subject.hash]=G}else $.certs[U.subject.hash]=U},$.hasCertificate=function(U){if(typeof U==="string")U=d.pki.certificateFromPem(U);var G=Z(U.subject);if(!G)return!1;if(!d.util.isArray(G))G=[G];var E=V.toDer(k.certificateToAsn1(U)).getBytes();for(var W=0;W<G.length;++W){var H=V.toDer(k.certificateToAsn1(G[W])).getBytes();if(E===H)return!0}return!1},$.listAllCertificates=function(){var U=[];for(var G in $.certs)if($.certs.hasOwnProperty(G)){var E=$.certs[G];if(!d.util.isArray(E))U.push(E);else for(var W=0;W<E.length;++W)U.push(E[W])}return U},$.removeCertificate=function(U){var G;if(typeof U==="string")U=d.pki.certificateFromPem(U);if(X(U.subject),!$.hasCertificate(U))return null;var E=Z(U.subject);if(!d.util.isArray(E))return G=$.certs[U.subject.hash],delete $.certs[U.subject.hash],G;var W=V.toDer(k.certificateToAsn1(U)).getBytes();for(var H=0;H<E.length;++H){var O=V.toDer(k.certificateToAsn1(E[H])).getBytes();if(W===O)G=E[H],E.splice(H,1)}if(E.length===0)delete $.certs[U.subject.hash];return G};function Z(U){return X(U),$.certs[U.hash]||null}function X(U){if(!U.hash){var G=d.md.sha1.create();U.attributes=k.RDNAttributesAsArray(XX(U),G),U.hash=G.digest().toHex()}}if(J)for(var Q=0;Q<J.length;++Q){var Y=J[Q];$.addCertificate(Y)}return $};k.certificateError={bad_certificate:"forge.pki.BadCertificate",unsupported_certificate:"forge.pki.UnsupportedCertificate",certificate_revoked:"forge.pki.CertificateRevoked",certificate_expired:"forge.pki.CertificateExpired",certificate_unknown:"forge.pki.CertificateUnknown",unknown_ca:"forge.pki.UnknownCertificateAuthority"};k.verifyCertificateChain=function(J,$,Z){if(typeof Z==="function")Z={verify:Z};Z=Z||{},$=$.slice(0);var X=$.slice(0),Q=Z.validityCheckDate;if(typeof Q==="undefined")Q=new Date;var Y=!0,U=null,G=0;do{var E=$.shift(),W=null,H=!1;if(Q){if(Q<E.validity.notBefore||Q>E.validity.notAfter)U={message:"Certificate is not valid yet or has expired.",error:k.certificateError.certificate_expired,notBefore:E.validity.notBefore,notAfter:E.validity.notAfter,now:Q}}if(U===null){if(W=$[0]||J.getIssuer(E),W===null){if(E.isIssuer(E))H=!0,W=E}if(W){var O=W;if(!d.util.isArray(O))O=[O];var M=!1;while(!M&&O.length>0){W=O.shift();try{M=W.verify(E)}catch(v){}}if(!M)U={message:"Certificate signature is invalid.",error:k.certificateError.bad_certificate}}if(U===null&&(!W||H)&&!J.hasCertificate(E))U={message:"Certificate is not trusted.",error:k.certificateError.unknown_ca}}if(U===null&&W&&!E.isIssuer(W))U={message:"Certificate issuer is invalid.",error:k.certificateError.bad_certificate};if(U===null){var P={keyUsage:!0,basicConstraints:!0};for(var z=0;U===null&&z<E.extensions.length;++z){var A=E.extensions[z];if(A.critical&&!(A.name in P))U={message:"Certificate has an unsupported critical extension.",error:k.certificateError.unsupported_certificate}}}if(U===null&&(!Y||$.length===0&&(!W||H))){var T=E.getExtension("basicConstraints"),C=E.getExtension("keyUsage");if(C!==null){if(!C.keyCertSign||T===null)U={message:"Certificate keyUsage or basicConstraints conflict or indicate that the certificate is not a CA. If the certificate is the only one in the chain or isn't the first then the certificate must be a valid CA.",error:k.certificateError.bad_certificate}}if(U===null&&T!==null&&!T.cA)U={message:"Certificate basicConstraints indicates the certificate is not a CA.",error:k.certificateError.bad_certificate};if(U===null&&C!==null&&"pathLenConstraint"in T){var L=G-1;if(L>T.pathLenConstraint)U={message:"Certificate basicConstraints pathLenConstraint violated.",error:k.certificateError.bad_certificate}}}var w=U===null?!0:U.error,f=Z.verify?Z.verify(w,G,X):w;if(f===!0)U=null;else{if(w===!0)U={message:"The application rejected the certificate.",error:k.certificateError.bad_certificate};if(f||f===0){if(typeof f==="object"&&!d.util.isArray(f)){if(f.message)U.message=f.message;if(f.error)U.error=f.error}else if(typeof f==="string")U.error=f}throw U}Y=!1,++G}while($.length>0);return!0}});var d0=c((wH,fQ)=>{var OJ=o();G$();i$();w$();f0();h0();J$();zX();e$();XJ();iX();var{asn1:D,pki:r}=OJ,PX=fQ.exports=OJ.pkcs12=OJ.pkcs12||{},hQ={name:"ContentInfo",tagClass:D.Class.UNIVERSAL,type:D.Type.SEQUENCE,constructed:!0,value:[{name:"ContentInfo.contentType",tagClass:D.Class.UNIVERSAL,type:D.Type.OID,constructed:!1,capture:"contentType"},{name:"ContentInfo.content",tagClass:D.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"content"}]},NW={name:"PFX",tagClass:D.Class.UNIVERSAL,type:D.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.version",tagClass:D.Class.UNIVERSAL,type:D.Type.INTEGER,constructed:!1,capture:"version"},hQ,{name:"PFX.macData",tagClass:D.Class.UNIVERSAL,type:D.Type.SEQUENCE,constructed:!0,optional:!0,captureAsn1:"mac",value:[{name:"PFX.macData.mac",tagClass:D.Class.UNIVERSAL,type:D.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm",tagClass:D.Class.UNIVERSAL,type:D.Type.SEQUENCE,constructed:!0,value:[{name:"PFX.macData.mac.digestAlgorithm.algorithm",tagClass:D.Class.UNIVERSAL,type:D.Type.OID,constructed:!1,capture:"macAlgorithm"},{name:"PFX.macData.mac.digestAlgorithm.parameters",tagClass:D.Class.UNIVERSAL,captureAsn1:"macAlgorithmParameters"}]},{name:"PFX.macData.mac.digest",tagClass:D.Class.UNIVERSAL,type:D.Type.OCTETSTRING,constructed:!1,capture:"macDigest"}]},{name:"PFX.macData.macSalt",tagClass:D.Class.UNIVERSAL,type:D.Type.OCTETSTRING,constructed:!1,capture:"macSalt"},{name:"PFX.macData.iterations",tagClass:D.Class.UNIVERSAL,type:D.Type.INTEGER,constructed:!1,optional:!0,capture:"macIterations"}]}]},CW={name:"SafeBag",tagClass:D.Class.UNIVERSAL,type:D.Type.SEQUENCE,constructed:!0,value:[{name:"SafeBag.bagId",tagClass:D.Class.UNIVERSAL,type:D.Type.OID,constructed:!1,capture:"bagId"},{name:"SafeBag.bagValue",tagClass:D.Class.CONTEXT_SPECIFIC,constructed:!0,captureAsn1:"bagValue"},{name:"SafeBag.bagAttributes",tagClass:D.Class.UNIVERSAL,type:D.Type.SET,constructed:!0,optional:!0,capture:"bagAttributes"}]},SW={name:"Attribute",tagClass:D.Class.UNIVERSAL,type:D.Type.SEQUENCE,constructed:!0,value:[{name:"Attribute.attrId",tagClass:D.Class.UNIVERSAL,type:D.Type.OID,constructed:!1,capture:"oid"},{name:"Attribute.attrValues",tagClass:D.Class.UNIVERSAL,type:D.Type.SET,constructed:!0,capture:"values"}]},LW={name:"CertBag",tagClass:D.Class.UNIVERSAL,type:D.Type.SEQUENCE,constructed:!0,value:[{name:"CertBag.certId",tagClass:D.Class.UNIVERSAL,type:D.Type.OID,constructed:!1,capture:"certId"},{name:"CertBag.certValue",tagClass:D.Class.CONTEXT_SPECIFIC,constructed:!0,value:[{name:"CertBag.certValue[0]",tagClass:D.Class.UNIVERSAL,type:D.Class.OCTETSTRING,constructed:!1,capture:"cert"}]}]};function DX(J,$,Z,X){var Q=[];for(var Y=0;Y<J.length;Y++)for(var U=0;U<J[Y].safeBags.length;U++){var G=J[Y].safeBags[U];if(X!==void 0&&G.type!==X)continue;if($===null){Q.push(G);continue}if(G.attributes[$]!==void 0&&G.attributes[$].indexOf(Z)>=0)Q.push(G)}return Q}PX.pkcs12FromAsn1=function(J,$,Z){if(typeof $==="string")Z=$,$=!0;else if($===void 0)$=!0;var X={},Q=[];if(!D.validate(J,NW,X,Q)){var Y=new Error("Cannot read PKCS#12 PFX. ASN.1 object is not an PKCS#12 PFX.");throw Y.errors=Y,Y}var U={version:X.version.charCodeAt(0),safeContents:[],getBags:function(T){var C={},L;if("localKeyId"in T)L=T.localKeyId;else if("localKeyIdHex"in T)L=OJ.util.hexToBytes(T.localKeyIdHex);if(L===void 0&&!("friendlyName"in T)&&"bagType"in T)C[T.bagType]=DX(U.safeContents,null,null,T.bagType);if(L!==void 0)C.localKeyId=DX(U.safeContents,"localKeyId",L,T.bagType);if("friendlyName"in T)C.friendlyName=DX(U.safeContents,"friendlyName",T.friendlyName,T.bagType);return C},getBagsByFriendlyName:function(T,C){return DX(U.safeContents,"friendlyName",T,C)},getBagsByLocalKeyId:function(T,C){return DX(U.safeContents,"localKeyId",T,C)}};if(X.version.charCodeAt(0)!==3){var Y=new Error("PKCS#12 PFX of version other than 3 not supported.");throw Y.version=X.version.charCodeAt(0),Y}if(D.derToOid(X.contentType)!==r.oids.data){var Y=new Error("Only PKCS#12 PFX in password integrity mode supported.");throw Y.oid=D.derToOid(X.contentType),Y}var G=X.content.value[0];if(G.tagClass!==D.Class.UNIVERSAL||G.type!==D.Type.OCTETSTRING)throw new Error("PKCS#12 authSafe content data is not an OCTET STRING.");if(G=m0(G),X.mac){var E=null,W=0,H=D.derToOid(X.macAlgorithm);switch(H){case r.oids.sha1:E=OJ.md.sha1.create(),W=20;break;case r.oids.sha256:E=OJ.md.sha256.create(),W=32;break;case r.oids.sha384:E=OJ.md.sha384.create(),W=48;break;case r.oids.sha512:E=OJ.md.sha512.create(),W=64;break;case r.oids.md5:E=OJ.md.md5.create(),W=16;break}if(E===null)throw new Error("PKCS#12 uses unsupported MAC algorithm: "+H);var O=new OJ.util.ByteBuffer(X.macSalt),M="macIterations"in X?parseInt(OJ.util.bytesToHex(X.macIterations),16):1,P=PX.generateKey(Z,O,3,M,W,E),z=OJ.hmac.create();z.start(E,P),z.update(G.value);var A=z.getMac();if(A.getBytes()!==X.macDigest)throw new Error("PKCS#12 MAC could not be verified. Invalid password?")}return wW(U,G.value,$,Z),U};function m0(J){if(J.composed||J.constructed){var $=OJ.util.createBuffer();for(var Z=0;Z<J.value.length;++Z)$.putBytes(J.value[Z].value);J.composed=J.constructed=!1,J.value=$.getBytes()}return J}function wW(J,$,Z,X){if($=D.fromDer($,Z),$.tagClass!==D.Class.UNIVERSAL||$.type!==D.Type.SEQUENCE||$.constructed!==!0)throw new Error("PKCS#12 AuthenticatedSafe expected to be a SEQUENCE OF ContentInfo");for(var Q=0;Q<$.value.length;Q++){var Y=$.value[Q],U={},G=[];if(!D.validate(Y,hQ,U,G)){var E=new Error("Cannot read ContentInfo.");throw E.errors=G,E}var W={encrypted:!1},H=null,O=U.content.value[0];switch(D.derToOid(U.contentType)){case r.oids.data:if(O.tagClass!==D.Class.UNIVERSAL||O.type!==D.Type.OCTETSTRING)throw new Error("PKCS#12 SafeContents Data is not an OCTET STRING.");H=m0(O).value;break;case r.oids.encryptedData:H=IW(O,X),W.encrypted=!0;break;default:var E=new Error("Unsupported PKCS#12 contentType.");throw E.contentType=D.derToOid(U.contentType),E}W.safeBags=BW(H,Z,X),J.safeContents.push(W)}}function IW(J,$){var Z={},X=[];if(!D.validate(J,OJ.pkcs7.asn1.encryptedDataValidator,Z,X)){var Q=new Error("Cannot read EncryptedContentInfo.");throw Q.errors=X,Q}var Y=D.derToOid(Z.contentType);if(Y!==r.oids.data){var Q=new Error("PKCS#12 EncryptedContentInfo ContentType is not Data.");throw Q.oid=Y,Q}Y=D.derToOid(Z.encAlgorithm);var U=r.pbe.getCipher(Y,Z.encParameter,$),G=m0(Z.encryptedContentAsn1),E=OJ.util.createBuffer(G.value);if(U.update(E),!U.finish())throw new Error("Failed to decrypt PKCS#12 SafeContents.");return U.output.getBytes()}function BW(J,$,Z){if(!$&&J.length===0)return[];if(J=D.fromDer(J,$),J.tagClass!==D.Class.UNIVERSAL||J.type!==D.Type.SEQUENCE||J.constructed!==!0)throw new Error("PKCS#12 SafeContents expected to be a SEQUENCE OF SafeBag.");var X=[];for(var Q=0;Q<J.value.length;Q++){var Y=J.value[Q],U={},G=[];if(!D.validate(Y,CW,U,G)){var E=new Error("Cannot read SafeBag.");throw E.errors=G,E}var W={type:D.derToOid(U.bagId),attributes:jW(U.bagAttributes)};X.push(W);var H,O,M=U.bagValue.value[0];switch(W.type){case r.oids.pkcs8ShroudedKeyBag:if(M=r.decryptPrivateKeyInfo(M,Z),M===null)throw new Error("Unable to decrypt PKCS#8 ShroudedKeyBag, wrong password?");case r.oids.keyBag:try{W.key=r.privateKeyFromAsn1(M)}catch(z){W.key=null,W.asn1=M}continue;case r.oids.certBag:H=LW,O=function(){if(D.derToOid(U.certId)!==r.oids.x509Certificate){var z=new Error("Unsupported certificate type, only X.509 supported.");throw z.oid=D.derToOid(U.certId),z}var A=D.fromDer(U.cert,$);try{W.cert=r.certificateFromAsn1(A,!0)}catch(T){W.cert=null,W.asn1=A}};break;default:var E=new Error("Unsupported PKCS#12 SafeBag type.");throw E.oid=W.type,E}if(H!==void 0&&!D.validate(M,H,U,G)){var E=new Error("Cannot read PKCS#12 "+H.name);throw E.errors=G,E}O()}return X}function jW(J){var $={};if(J!==void 0)for(var Z=0;Z<J.length;++Z){var X={},Q=[];if(!D.validate(J[Z],SW,X,Q)){var Y=new Error("Cannot read PKCS#12 BagAttribute.");throw Y.errors=Q,Y}var U=D.derToOid(X.oid);if(r.oids[U]===void 0)continue;$[r.oids[U]]=[];for(var G=0;G<X.values.length;++G)$[r.oids[U]].push(X.values[G].value)}return $}PX.toPkcs12Asn1=function(J,$,Z,X){if(X=X||{},X.saltSize=X.saltSize||8,X.count=X.count||2048,X.algorithm=X.algorithm||X.encAlgorithm||"aes128",!("useMac"in X))X.useMac=!0;if(!("localKeyId"in X))X.localKeyId=null;if(!("generateLocalKeyId"in X))X.generateLocalKeyId=!0;var Q=X.localKeyId,Y;if(Q!==null)Q=OJ.util.hexToBytes(Q);else if(X.generateLocalKeyId)if($){var U=OJ.util.isArray($)?$[0]:$;if(typeof U==="string")U=r.certificateFromPem(U);var G=OJ.md.sha1.create();G.update(D.toDer(r.certificateToAsn1(U)).getBytes()),Q=G.digest().getBytes()}else Q=OJ.random.getBytes(20);var E=[];if(Q!==null)E.push(D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[D.create(D.Class.UNIVERSAL,D.Type.OID,!1,D.oidToDer(r.oids.localKeyId).getBytes()),D.create(D.Class.UNIVERSAL,D.Type.SET,!0,[D.create(D.Class.UNIVERSAL,D.Type.OCTETSTRING,!1,Q)])]));if("friendlyName"in X)E.push(D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[D.create(D.Class.UNIVERSAL,D.Type.OID,!1,D.oidToDer(r.oids.friendlyName).getBytes()),D.create(D.Class.UNIVERSAL,D.Type.SET,!0,[D.create(D.Class.UNIVERSAL,D.Type.BMPSTRING,!1,X.friendlyName)])]));if(E.length>0)Y=D.create(D.Class.UNIVERSAL,D.Type.SET,!0,E);var W=[],H=[];if($!==null)if(OJ.util.isArray($))H=$;else H=[$];var O=[];for(var M=0;M<H.length;++M){if($=H[M],typeof $==="string")$=r.certificateFromPem($);var P=M===0?Y:void 0,z=r.certificateToAsn1($),A=D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[D.create(D.Class.UNIVERSAL,D.Type.OID,!1,D.oidToDer(r.oids.certBag).getBytes()),D.create(D.Class.CONTEXT_SPECIFIC,0,!0,[D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[D.create(D.Class.UNIVERSAL,D.Type.OID,!1,D.oidToDer(r.oids.x509Certificate).getBytes()),D.create(D.Class.CONTEXT_SPECIFIC,0,!0,[D.create(D.Class.UNIVERSAL,D.Type.OCTETSTRING,!1,D.toDer(z).getBytes())])])]),P]);O.push(A)}if(O.length>0){var T=D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,O),C=D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[D.create(D.Class.UNIVERSAL,D.Type.OID,!1,D.oidToDer(r.oids.data).getBytes()),D.create(D.Class.CONTEXT_SPECIFIC,0,!0,[D.create(D.Class.UNIVERSAL,D.Type.OCTETSTRING,!1,D.toDer(T).getBytes())])]);W.push(C)}var L=null;if(J!==null){var w=r.wrapRsaPrivateKey(r.privateKeyToAsn1(J));if(Z===null)L=D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[D.create(D.Class.UNIVERSAL,D.Type.OID,!1,D.oidToDer(r.oids.keyBag).getBytes()),D.create(D.Class.CONTEXT_SPECIFIC,0,!0,[w]),Y]);else L=D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[D.create(D.Class.UNIVERSAL,D.Type.OID,!1,D.oidToDer(r.oids.pkcs8ShroudedKeyBag).getBytes()),D.create(D.Class.CONTEXT_SPECIFIC,0,!0,[r.encryptPrivateKeyInfo(w,Z,X)]),Y]);var f=D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[L]),v=D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[D.create(D.Class.UNIVERSAL,D.Type.OID,!1,D.oidToDer(r.oids.data).getBytes()),D.create(D.Class.CONTEXT_SPECIFIC,0,!0,[D.create(D.Class.UNIVERSAL,D.Type.OCTETSTRING,!1,D.toDer(f).getBytes())])]);W.push(v)}var x=D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,W),p;if(X.useMac){var G=OJ.md.sha1.create(),a=new OJ.util.ByteBuffer(OJ.random.getBytes(X.saltSize)),YJ=X.count,J=PX.generateKey(Z,a,3,YJ,20),UJ=OJ.hmac.create();UJ.start(G,J),UJ.update(D.toDer(x).getBytes());var EJ=UJ.getMac();p=D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[D.create(D.Class.UNIVERSAL,D.Type.OID,!1,D.oidToDer(r.oids.sha1).getBytes()),D.create(D.Class.UNIVERSAL,D.Type.NULL,!1,"")]),D.create(D.Class.UNIVERSAL,D.Type.OCTETSTRING,!1,EJ.getBytes())]),D.create(D.Class.UNIVERSAL,D.Type.OCTETSTRING,!1,a.getBytes()),D.create(D.Class.UNIVERSAL,D.Type.INTEGER,!1,D.integerToDer(YJ).getBytes())])}return D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[D.create(D.Class.UNIVERSAL,D.Type.INTEGER,!1,D.integerToDer(3).getBytes()),D.create(D.Class.UNIVERSAL,D.Type.SEQUENCE,!0,[D.create(D.Class.UNIVERSAL,D.Type.OID,!1,D.oidToDer(r.oids.data).getBytes()),D.create(D.Class.CONTEXT_SPECIFIC,0,!0,[D.create(D.Class.UNIVERSAL,D.Type.OCTETSTRING,!1,D.toDer(x).getBytes())])]),p])};PX.generateKey=OJ.pbe.generatePkcs12Key});var l0=c((IH,uQ)=>{var x$=o();G$();w$();h0();f$();bX();d0();nX();zX();XJ();iX();var g0=x$.asn1,ZX=uQ.exports=x$.pki=x$.pki||{};ZX.pemToDer=function(J){var $=x$.pem.decode(J)[0];if($.procType&&$.procType.type==="ENCRYPTED")throw new Error("Could not convert PEM to DER; PEM is encrypted.");return x$.util.createBuffer($.body)};ZX.privateKeyFromPem=function(J){var $=x$.pem.decode(J)[0];if($.type!=="PRIVATE KEY"&&$.type!=="RSA PRIVATE KEY"){var Z=new Error('Could not convert private key from PEM; PEM header type is not "PRIVATE KEY" or "RSA PRIVATE KEY".');throw Z.headerType=$.type,Z}if($.procType&&$.procType.type==="ENCRYPTED")throw new Error("Could not convert private key from PEM; PEM is encrypted.");var X=g0.fromDer($.body);return ZX.privateKeyFromAsn1(X)};ZX.privateKeyToPem=function(J,$){var Z={type:"RSA PRIVATE KEY",body:g0.toDer(ZX.privateKeyToAsn1(J)).getBytes()};return x$.pem.encode(Z,{maxline:$})};ZX.privateKeyInfoToPem=function(J,$){var Z={type:"PRIVATE KEY",body:g0.toDer(J).getBytes()};return x$.pem.encode(Z,{maxline:$})}});var i0=c((BH,nQ)=>{var B=o();G$();i$();_X();f$();l0();J$();e$();XJ();var eX=function(J,$,Z,X){var Q=B.util.createBuffer(),Y=J.length>>1,U=Y+(J.length&1),G=J.substr(0,U),E=J.substr(Y,U),W=B.util.createBuffer(),H=B.hmac.create();Z=$+Z;var O=Math.ceil(X/16),M=Math.ceil(X/20);H.start("MD5",G);var P=B.util.createBuffer();W.putBytes(Z);for(var z=0;z<O;++z)H.start(null,null),H.update(W.getBytes()),W.putBuffer(H.digest()),H.start(null,null),H.update(W.bytes()+Z),P.putBuffer(H.digest());H.start("SHA1",E);var A=B.util.createBuffer();W.clear(),W.putBytes(Z);for(var z=0;z<M;++z)H.start(null,null),H.update(W.getBytes()),W.putBuffer(H.digest()),H.start(null,null),H.update(W.bytes()+Z),A.putBuffer(H.digest());return Q.putBytes(B.util.xorBytes(P.getBytes(),A.getBytes(),X)),Q},xW=function(J,$,Z){var X=B.hmac.create();X.start("SHA1",J);var Q=B.util.createBuffer();return Q.putInt32($[0]),Q.putInt32($[1]),Q.putByte(Z.type),Q.putByte(Z.version.major),Q.putByte(Z.version.minor),Q.putInt16(Z.length),Q.putBytes(Z.fragment.bytes()),X.update(Q.getBytes()),X.digest().getBytes()},kW=function(J,$,Z){var X=!1;try{var Q=J.deflate($.fragment.getBytes());$.fragment=B.util.createBuffer(Q),$.length=Q.length,X=!0}catch(Y){}return X},vW=function(J,$,Z){var X=!1;try{var Q=J.inflate($.fragment.getBytes());$.fragment=B.util.createBuffer(Q),$.length=Q.length,X=!0}catch(Y){}return X},rJ=function(J,$){var Z=0;switch($){case 1:Z=J.getByte();break;case 2:Z=J.getInt16();break;case 3:Z=J.getInt24();break;case 4:Z=J.getInt32();break}return B.util.createBuffer(J.getBytes(Z))},Q$=function(J,$,Z){J.putInt(Z.length(),$<<3),J.putBuffer(Z)},F={};F.Versions={TLS_1_0:{major:3,minor:1},TLS_1_1:{major:3,minor:2},TLS_1_2:{major:3,minor:3}};F.SupportedVersions=[F.Versions.TLS_1_1,F.Versions.TLS_1_0];F.Version=F.SupportedVersions[0];F.MaxFragment=15360;F.ConnectionEnd={server:0,client:1};F.PRFAlgorithm={tls_prf_sha256:0};F.BulkCipherAlgorithm={none:null,rc4:0,des3:1,aes:2};F.CipherType={stream:0,block:1,aead:2};F.MACAlgorithm={none:null,hmac_md5:0,hmac_sha1:1,hmac_sha256:2,hmac_sha384:3,hmac_sha512:4};F.CompressionMethod={none:0,deflate:1};F.ContentType={change_cipher_spec:20,alert:21,handshake:22,application_data:23,heartbeat:24};F.HandshakeType={hello_request:0,client_hello:1,server_hello:2,certificate:11,server_key_exchange:12,certificate_request:13,server_hello_done:14,certificate_verify:15,client_key_exchange:16,finished:20};F.Alert={};F.Alert.Level={warning:1,fatal:2};F.Alert.Description={close_notify:0,unexpected_message:10,bad_record_mac:20,decryption_failed:21,record_overflow:22,decompression_failure:30,handshake_failure:40,bad_certificate:42,unsupported_certificate:43,certificate_revoked:44,certificate_expired:45,certificate_unknown:46,illegal_parameter:47,unknown_ca:48,access_denied:49,decode_error:50,decrypt_error:51,export_restriction:60,protocol_version:70,insufficient_security:71,internal_error:80,user_canceled:90,no_renegotiation:100};F.HeartbeatMessageType={heartbeat_request:1,heartbeat_response:2};F.CipherSuites={};F.getCipherSuite=function(J){var $=null;for(var Z in F.CipherSuites){var X=F.CipherSuites[Z];if(X.id[0]===J.charCodeAt(0)&&X.id[1]===J.charCodeAt(1)){$=X;break}}return $};F.handleUnexpected=function(J,$){var Z=!J.open&&J.entity===F.ConnectionEnd.client;if(!Z)J.error(J,{message:"Unexpected message. Received TLS record out of order.",send:!0,alert:{level:F.Alert.Level.fatal,description:F.Alert.Description.unexpected_message}})};F.handleHelloRequest=function(J,$,Z){if(!J.handshaking&&J.handshakes>0)F.queue(J,F.createAlert(J,{level:F.Alert.Level.warning,description:F.Alert.Description.no_renegotiation})),F.flush(J);J.process()};F.parseHelloMessage=function(J,$,Z){var X=null,Q=J.entity===F.ConnectionEnd.client;if(Z<38)J.error(J,{message:Q?"Invalid ServerHello message. Message too short.":"Invalid ClientHello message. Message too short.",send:!0,alert:{level:F.Alert.Level.fatal,description:F.Alert.Description.illegal_parameter}});else{var Y=$.fragment,U=Y.length();if(X={version:{major:Y.getByte(),minor:Y.getByte()},random:B.util.createBuffer(Y.getBytes(32)),session_id:rJ(Y,1),extensions:[]},Q)X.cipher_suite=Y.getBytes(2),X.compression_method=Y.getByte();else X.cipher_suites=rJ(Y,2),X.compression_methods=rJ(Y,1);if(U=Z-(U-Y.length()),U>0){var G=rJ(Y,2);while(G.length()>0)X.extensions.push({type:[G.getByte(),G.getByte()],data:rJ(G,2)});if(!Q)for(var E=0;E<X.extensions.length;++E){var W=X.extensions[E];if(W.type[0]===0&&W.type[1]===0){var H=rJ(W.data,2);while(H.length()>0){var O=H.getByte();if(O!==0)break;J.session.extensions.server_name.serverNameList.push(rJ(H,2).getBytes())}}}}if(J.session.version){if(X.version.major!==J.session.version.major||X.version.minor!==J.session.version.minor)return J.error(J,{message:"TLS version change is disallowed during renegotiation.",send:!0,alert:{level:F.Alert.Level.fatal,description:F.Alert.Description.protocol_version}})}if(Q)J.session.cipherSuite=F.getCipherSuite(X.cipher_suite);else{var M=B.util.createBuffer(X.cipher_suites.bytes());while(M.length()>0)if(J.session.cipherSuite=F.getCipherSuite(M.getBytes(2)),J.session.cipherSuite!==null)break}if(J.session.cipherSuite===null)return J.error(J,{message:"No cipher suites in common.",send:!0,alert:{level:F.Alert.Level.fatal,description:F.Alert.Description.handshake_failure},cipherSuite:B.util.bytesToHex(X.cipher_suite)});if(Q)J.session.compressionMethod=X.compression_method;else J.session.compressionMethod=F.CompressionMethod.none}return X};F.createSecurityParameters=function(J,$){var Z=J.entity===F.ConnectionEnd.client,X=$.random.bytes(),Q=Z?J.session.sp.client_random:X,Y=Z?X:F.createRandom().getBytes();J.session.sp={entity:J.entity,prf_algorithm:F.PRFAlgorithm.tls_prf_sha256,bulk_cipher_algorithm:null,cipher_type:null,enc_key_length:null,block_length:null,fixed_iv_length:null,record_iv_length:null,mac_algorithm:null,mac_length:null,mac_key_length:null,compression_algorithm:J.session.compressionMethod,pre_master_secret:null,master_secret:null,client_random:Q,server_random:Y}};F.handleServerHello=function(J,$,Z){var X=F.parseHelloMessage(J,$,Z);if(J.fail)return;if(X.version.minor<=J.version.minor)J.version.minor=X.version.minor;else return J.error(J,{message:"Incompatible TLS version.",send:!0,alert:{level:F.Alert.Level.fatal,description:F.Alert.Description.protocol_version}});J.session.version=J.version;var Q=X.session_id.bytes();if(Q.length>0&&Q===J.session.id)J.expect=dQ,J.session.resuming=!0,J.session.sp.server_random=X.random.bytes();else J.expect=_W,J.session.resuming=!1,F.createSecurityParameters(J,X);J.session.id=Q,J.process()};F.handleClientHello=function(J,$,Z){var X=F.parseHelloMessage(J,$,Z);if(J.fail)return;var Q=X.session_id.bytes(),Y=null;if(J.sessionCache){if(Y=J.sessionCache.getSession(Q),Y===null)Q="";else if(Y.version.major!==X.version.major||Y.version.minor>X.version.minor)Y=null,Q=""}if(Q.length===0)Q=B.random.getBytes(32);if(J.session.id=Q,J.session.clientHelloVersion=X.version,J.session.sp={},Y)J.version=J.session.version=Y.version,J.session.sp=Y.sp;else{var U;for(var G=1;G<F.SupportedVersions.length;++G)if(U=F.SupportedVersions[G],U.minor<=X.version.minor)break;J.version={major:U.major,minor:U.minor},J.session.version=J.version}if(Y!==null)J.expect=o0,J.session.resuming=!0,J.session.sp.client_random=X.random.bytes();else J.expect=J.verifyClient!==!1?gW:n0,J.session.resuming=!1,F.createSecurityParameters(J,X);if(J.open=!0,F.queue(J,F.createRecord(J,{type:F.ContentType.handshake,data:F.createServerHello(J)})),J.session.resuming)F.queue(J,F.createRecord(J,{type:F.ContentType.change_cipher_spec,data:F.createChangeCipherSpec()})),J.state.pending=F.createConnectionState(J),J.state.current.write=J.state.pending.write,F.queue(J,F.createRecord(J,{type:F.ContentType.handshake,data:F.createFinished(J)}));else if(F.queue(J,F.createRecord(J,{type:F.ContentType.handshake,data:F.createCertificate(J)})),!J.fail){if(F.queue(J,F.createRecord(J,{type:F.ContentType.handshake,data:F.createServerKeyExchange(J)})),J.verifyClient!==!1)F.queue(J,F.createRecord(J,{type:F.ContentType.handshake,data:F.createCertificateRequest(J)}));F.queue(J,F.createRecord(J,{type:F.ContentType.handshake,data:F.createServerHelloDone(J)}))}F.flush(J),J.process()};F.handleCertificate=function(J,$,Z){if(Z<3)return J.error(J,{message:"Invalid Certificate message. Message too short.",send:!0,alert:{level:F.Alert.Level.fatal,description:F.Alert.Description.illegal_parameter}});var X=$.fragment,Q={certificate_list:rJ(X,3)},Y,U,G=[];try{while(Q.certificate_list.length()>0)Y=rJ(Q.certificate_list,3),U=B.asn1.fromDer(Y),Y=B.pki.certificateFromAsn1(U,!0),G.push(Y)}catch(W){return J.error(J,{message:"Could not parse certificate list.",cause:W,send:!0,alert:{level:F.Alert.Level.fatal,description:F.Alert.Description.bad_certificate}})}var E=J.entity===F.ConnectionEnd.client;if((E||J.verifyClient===!0)&&G.length===0)J.error(J,{message:E?"No server certificate provided.":"No client certificate provided.",send:!0,alert:{level:F.Alert.Level.fatal,description:F.Alert.Description.illegal_parameter}});else if(G.length===0)J.expect=E?bQ:n0;else{if(E)J.session.serverCertificate=G[0];else J.session.clientCertificate=G[0];if(F.verifyCertificateChain(J,G))J.expect=E?bQ:n0}J.process()};F.handleServerKeyExchange=function(J,$,Z){if(Z>0)return J.error(J,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:F.Alert.Level.fatal,description:F.Alert.Description.unsupported_certificate}});J.expect=hW,J.process()};F.handleClientKeyExchange=function(J,$,Z){if(Z<48)return J.error(J,{message:"Invalid key parameters. Only RSA is supported.",send:!0,alert:{level:F.Alert.Level.fatal,description:F.Alert.Description.unsupported_certificate}});var X=$.fragment,Q={enc_pre_master_secret:rJ(X,2).getBytes()},Y=null;if(J.getPrivateKey)try{Y=J.getPrivateKey(J,J.session.serverCertificate),Y=B.pki.privateKeyFromPem(Y)}catch(E){J.error(J,{message:"Could not get private key.",cause:E,send:!0,alert:{level:F.Alert.Level.fatal,description:F.Alert.Description.internal_error}})}if(Y===null)return J.error(J,{message:"No private key set.",send:!0,alert:{level:F.Alert.Level.fatal,description:F.Alert.Description.internal_error}});try{var U=J.session.sp;U.pre_master_secret=Y.decrypt(Q.enc_pre_master_secret);var G=J.session.clientHelloVersion;if(G.major!==U.pre_master_secret.charCodeAt(0)||G.minor!==U.pre_master_secret.charCodeAt(1))throw new Error("TLS version rollback attack detected.")}catch(E){U.pre_master_secret=B.random.getBytes(48)}if(J.expect=o0,J.session.clientCertificate!==null)J.expect=lW;J.process()};F.handleCertificateRequest=function(J,$,Z){if(Z<3)return J.error(J,{message:"Invalid CertificateRequest. Message too short.",send:!0,alert:{level:F.Alert.Level.fatal,description:F.Alert.Description.illegal_parameter}});var X=$.fragment,Q={certificate_types:rJ(X,1),certificate_authorities:rJ(X,2)};J.session.certificateRequest=Q,J.expect=fW,J.process()};F.handleCertificateVerify=function(J,$,Z){if(Z<2)return J.error(J,{message:"Invalid CertificateVerify. Message too short.",send:!0,alert:{level:F.Alert.Level.fatal,description:F.Alert.Description.illegal_parameter}});var X=$.fragment;X.read-=4;var Q=X.bytes();X.read+=4;var Y={signature:rJ(X,2).getBytes()},U=B.util.createBuffer();U.putBuffer(J.session.md5.digest()),U.putBuffer(J.session.sha1.digest()),U=U.getBytes();try{var G=J.session.clientCertificate;if(!G.publicKey.verify(U,Y.signature,"NONE"))throw new Error("CertificateVerify signature does not match.");J.session.md5.update(Q),J.session.sha1.update(Q)}catch(E){return J.error(J,{message:"Bad signature in CertificateVerify.",send:!0,alert:{level:F.Alert.Level.fatal,description:F.Alert.Description.handshake_failure}})}J.expect=o0,J.process()};F.handleServerHelloDone=function(J,$,Z){if(Z>0)return J.error(J,{message:"Invalid ServerHelloDone message. Invalid length.",send:!0,alert:{level:F.Alert.Level.fatal,description:F.Alert.Description.record_overflow}});if(J.serverCertificate===null){var X={message:"No server certificate provided. Not enough security.",send:!0,alert:{level:F.Alert.Level.fatal,description:F.Alert.Description.insufficient_security}},Q=0,Y=J.verify(J,X.alert.description,Q,[]);if(Y!==!0){if(Y||Y===0){if(typeof Y==="object"&&!B.util.isArray(Y)){if(Y.message)X.message=Y.message;if(Y.alert)X.alert.description=Y.alert}else if(typeof Y==="number")X.alert.description=Y}return J.error(J,X)}}if(J.session.certificateRequest!==null)$=F.createRecord(J,{type:F.ContentType.handshake,data:F.createCertificate(J)}),F.queue(J,$);$=F.createRecord(J,{type:F.ContentType.handshake,data:F.createClientKeyExchange(J)}),F.queue(J,$),J.expect=mW;var U=function(G,E){if(G.session.certificateRequest!==null&&G.session.clientCertificate!==null)F.queue(G,F.createRecord(G,{type:F.ContentType.handshake,data:F.createCertificateVerify(G,E)}));F.queue(G,F.createRecord(G,{type:F.ContentType.change_cipher_spec,data:F.createChangeCipherSpec()})),G.state.pending=F.createConnectionState(G),G.state.current.write=G.state.pending.write,F.queue(G,F.createRecord(G,{type:F.ContentType.handshake,data:F.createFinished(G)})),G.expect=dQ,F.flush(G),G.process()};if(J.session.certificateRequest===null||J.session.clientCertificate===null)return U(J,null);F.getClientSignature(J,U)};F.handleChangeCipherSpec=function(J,$){if($.fragment.getByte()!==1)return J.error(J,{message:"Invalid ChangeCipherSpec message received.",send:!0,alert:{level:F.Alert.Level.fatal,description:F.Alert.Description.illegal_parameter}});var Z=J.entity===F.ConnectionEnd.client;if(J.session.resuming&&Z||!J.session.resuming&&!Z)J.state.pending=F.createConnectionState(J);if(J.state.current.read=J.state.pending.read,!J.session.resuming&&Z||J.session.resuming&&!Z)J.state.pending=null;J.expect=Z?uW:pW,J.process()};F.handleFinished=function(J,$,Z){var X=$.fragment;X.read-=4;var Q=X.bytes();X.read+=4;var Y=$.fragment.getBytes();X=B.util.createBuffer(),X.putBuffer(J.session.md5.digest()),X.putBuffer(J.session.sha1.digest());var U=J.entity===F.ConnectionEnd.client,G=U?"server finished":"client finished",E=J.session.sp,W=12,H=eX;if(X=H(E.master_secret,G,X.getBytes(),W),X.getBytes()!==Y)return J.error(J,{message:"Invalid verify_data in Finished message.",send:!0,alert:{level:F.Alert.Level.fatal,description:F.Alert.Description.decrypt_error}});if(J.session.md5.update(Q),J.session.sha1.update(Q),J.session.resuming&&U||!J.session.resuming&&!U)F.queue(J,F.createRecord(J,{type:F.ContentType.change_cipher_spec,data:F.createChangeCipherSpec()})),J.state.current.write=J.state.pending.write,J.state.pending=null,F.queue(J,F.createRecord(J,{type:F.ContentType.handshake,data:F.createFinished(J)}));J.expect=U?bW:cW,J.handshaking=!1,++J.handshakes,J.peerCertificate=U?J.session.serverCertificate:J.session.clientCertificate,F.flush(J),J.isConnected=!0,J.connected(J),J.process()};F.handleAlert=function(J,$){var Z=$.fragment,X={level:Z.getByte(),description:Z.getByte()},Q;switch(X.description){case F.Alert.Description.close_notify:Q="Connection closed.";break;case F.Alert.Description.unexpected_message:Q="Unexpected message.";break;case F.Alert.Description.bad_record_mac:Q="Bad record MAC.";break;case F.Alert.Description.decryption_failed:Q="Decryption failed.";break;case F.Alert.Description.record_overflow:Q="Record overflow.";break;case F.Alert.Description.decompression_failure:Q="Decompression failed.";break;case F.Alert.Description.handshake_failure:Q="Handshake failure.";break;case F.Alert.Description.bad_certificate:Q="Bad certificate.";break;case F.Alert.Description.unsupported_certificate:Q="Unsupported certificate.";break;case F.Alert.Description.certificate_revoked:Q="Certificate revoked.";break;case F.Alert.Description.certificate_expired:Q="Certificate expired.";break;case F.Alert.Description.certificate_unknown:Q="Certificate unknown.";break;case F.Alert.Description.illegal_parameter:Q="Illegal parameter.";break;case F.Alert.Description.unknown_ca:Q="Unknown certificate authority.";break;case F.Alert.Description.access_denied:Q="Access denied.";break;case F.Alert.Description.decode_error:Q="Decode error.";break;case F.Alert.Description.decrypt_error:Q="Decrypt error.";break;case F.Alert.Description.export_restriction:Q="Export restriction.";break;case F.Alert.Description.protocol_version:Q="Unsupported protocol version.";break;case F.Alert.Description.insufficient_security:Q="Insufficient security.";break;case F.Alert.Description.internal_error:Q="Internal error.";break;case F.Alert.Description.user_canceled:Q="User canceled.";break;case F.Alert.Description.no_renegotiation:Q="Renegotiation not supported.";break;default:Q="Unknown error.";break}if(X.description===F.Alert.Description.close_notify)return J.close();J.error(J,{message:Q,send:!1,origin:J.entity===F.ConnectionEnd.client?"server":"client",alert:X}),J.process()};F.handleHandshake=function(J,$){var Z=$.fragment,X=Z.getByte(),Q=Z.getInt24();if(Q>Z.length())return J.fragmented=$,$.fragment=B.util.createBuffer(),Z.read-=4,J.process();J.fragmented=null,Z.read-=4;var Y=Z.bytes(Q+4);if(Z.read+=4,X in tX[J.entity][J.expect]){if(J.entity===F.ConnectionEnd.server&&!J.open&&!J.fail)J.handshaking=!0,J.session={version:null,extensions:{server_name:{serverNameList:[]}},cipherSuite:null,compressionMethod:null,serverCertificate:null,clientCertificate:null,md5:B.md.md5.create(),sha1:B.md.sha1.create()};if(X!==F.HandshakeType.hello_request&&X!==F.HandshakeType.certificate_verify&&X!==F.HandshakeType.finished)J.session.md5.update(Y),J.session.sha1.update(Y);tX[J.entity][J.expect][X](J,$,Q)}else F.handleUnexpected(J,$)};F.handleApplicationData=function(J,$){J.data.putBuffer($.fragment),J.dataReady(J),J.process()};F.handleHeartbeat=function(J,$){var Z=$.fragment,X=Z.getByte(),Q=Z.getInt16(),Y=Z.getBytes(Q);if(X===F.HeartbeatMessageType.heartbeat_request){if(J.handshaking||Q>Y.length)return J.process();F.queue(J,F.createRecord(J,{type:F.ContentType.heartbeat,data:F.createHeartbeat(F.HeartbeatMessageType.heartbeat_response,Y)})),F.flush(J)}else if(X===F.HeartbeatMessageType.heartbeat_response){if(Y!==J.expectedHeartbeatPayload)return J.process();if(J.heartbeatReceived)J.heartbeatReceived(J,B.util.createBuffer(Y))}J.process()};var yW=0,_W=1,bQ=2,hW=3,fW=4,dQ=5,uW=6,bW=7,mW=8,dW=0,gW=1,n0=2,lW=3,o0=4,pW=5,cW=6,q=F.handleUnexpected,gQ=F.handleChangeCipherSpec,wJ=F.handleAlert,oJ=F.handleHandshake,lQ=F.handleApplicationData,IJ=F.handleHeartbeat,a0=[];a0[F.ConnectionEnd.client]=[[q,wJ,oJ,q,IJ],[q,wJ,oJ,q,IJ],[q,wJ,oJ,q,IJ],[q,wJ,oJ,q,IJ],[q,wJ,oJ,q,IJ],[gQ,wJ,q,q,IJ],[q,wJ,oJ,q,IJ],[q,wJ,oJ,lQ,IJ],[q,wJ,oJ,q,IJ]];a0[F.ConnectionEnd.server]=[[q,wJ,oJ,q,IJ],[q,wJ,oJ,q,IJ],[q,wJ,oJ,q,IJ],[q,wJ,oJ,q,IJ],[gQ,wJ,q,q,IJ],[q,wJ,oJ,q,IJ],[q,wJ,oJ,lQ,IJ],[q,wJ,oJ,q,IJ]];var{handleHelloRequest:k$,handleServerHello:nW,handleCertificate:pQ,handleServerKeyExchange:mQ,handleCertificateRequest:p0,handleServerHelloDone:sX,handleFinished:cQ}=F,tX=[];tX[F.ConnectionEnd.client]=[[q,q,nW,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q],[k$,q,q,q,q,q,q,q,q,q,q,pQ,mQ,p0,sX,q,q,q,q,q,q],[k$,q,q,q,q,q,q,q,q,q,q,q,mQ,p0,sX,q,q,q,q,q,q],[k$,q,q,q,q,q,q,q,q,q,q,q,q,p0,sX,q,q,q,q,q,q],[k$,q,q,q,q,q,q,q,q,q,q,q,q,q,sX,q,q,q,q,q,q],[k$,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q],[k$,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,cQ],[k$,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q],[k$,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q]];var{handleClientHello:oW,handleClientKeyExchange:aW,handleCertificateVerify:iW}=F;tX[F.ConnectionEnd.server]=[[q,oW,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q],[q,q,q,q,q,q,q,q,q,q,q,pQ,q,q,q,q,q,q,q,q,q],[q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,aW,q,q,q,q],[q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,iW,q,q,q,q,q],[q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q],[q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,cQ],[q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q],[q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q,q]];F.generateKeys=function(J,$){var Z=eX,X=$.client_random+$.server_random;if(!J.session.resuming)$.master_secret=Z($.pre_master_secret,"master secret",X,48).bytes(),$.pre_master_secret=null;X=$.server_random+$.client_random;var Q=2*$.mac_key_length+2*$.enc_key_length,Y=J.version.major===F.Versions.TLS_1_0.major&&J.version.minor===F.Versions.TLS_1_0.minor;if(Y)Q+=2*$.fixed_iv_length;var U=Z($.master_secret,"key expansion",X,Q),G={client_write_MAC_key:U.getBytes($.mac_key_length),server_write_MAC_key:U.getBytes($.mac_key_length),client_write_key:U.getBytes($.enc_key_length),server_write_key:U.getBytes($.enc_key_length)};if(Y)G.client_write_IV=U.getBytes($.fixed_iv_length),G.server_write_IV=U.getBytes($.fixed_iv_length);return G};F.createConnectionState=function(J){var $=J.entity===F.ConnectionEnd.client,Z=function(){var Y={sequenceNumber:[0,0],macKey:null,macLength:0,macFunction:null,cipherState:null,cipherFunction:function(U){return!0},compressionState:null,compressFunction:function(U){return!0},updateSequenceNumber:function(){if(Y.sequenceNumber[1]===4294967295)Y.sequenceNumber[1]=0,++Y.sequenceNumber[0];else++Y.sequenceNumber[1]}};return Y},X={read:Z(),write:Z()};if(X.read.update=function(Y,U){if(!X.read.cipherFunction(U,X.read))Y.error(Y,{message:"Could not decrypt record or bad MAC.",send:!0,alert:{level:F.Alert.Level.fatal,description:F.Alert.Description.bad_record_mac}});else if(!X.read.compressFunction(Y,U,X.read))Y.error(Y,{message:"Could not decompress record.",send:!0,alert:{level:F.Alert.Level.fatal,description:F.Alert.Description.decompression_failure}});return!Y.fail},X.write.update=function(Y,U){if(!X.write.compressFunction(Y,U,X.write))Y.error(Y,{message:"Could not compress record.",send:!1,alert:{level:F.Alert.Level.fatal,description:F.Alert.Description.internal_error}});else if(!X.write.cipherFunction(U,X.write))Y.error(Y,{message:"Could not encrypt record.",send:!1,alert:{level:F.Alert.Level.fatal,description:F.Alert.Description.internal_error}});return!Y.fail},J.session){var Q=J.session.sp;switch(J.session.cipherSuite.initSecurityParameters(Q),Q.keys=F.generateKeys(J,Q),X.read.macKey=$?Q.keys.server_write_MAC_key:Q.keys.client_write_MAC_key,X.write.macKey=$?Q.keys.client_write_MAC_key:Q.keys.server_write_MAC_key,J.session.cipherSuite.initConnectionState(X,J,Q),Q.compression_algorithm){case F.CompressionMethod.none:break;case F.CompressionMethod.deflate:X.read.compressFunction=vW,X.write.compressFunction=kW;break;default:throw new Error("Unsupported compression algorithm.")}}return X};F.createRandom=function(){var J=new Date,$=+J+J.getTimezoneOffset()*60000,Z=B.util.createBuffer();return Z.putInt32($),Z.putBytes(B.random.getBytes(28)),Z};F.createRecord=function(J,$){if(!$.data)return null;var Z={type:$.type,version:{major:J.version.major,minor:J.version.minor},length:$.data.length(),fragment:$.data};return Z};F.createAlert=function(J,$){var Z=B.util.createBuffer();return Z.putByte($.level),Z.putByte($.description),F.createRecord(J,{type:F.ContentType.alert,data:Z})};F.createClientHello=function(J){J.session.clientHelloVersion={major:J.version.major,minor:J.version.minor};var $=B.util.createBuffer();for(var Z=0;Z<J.cipherSuites.length;++Z){var X=J.cipherSuites[Z];$.putByte(X.id[0]),$.putByte(X.id[1])}var Q=$.length(),Y=B.util.createBuffer();Y.putByte(F.CompressionMethod.none);var U=Y.length(),G=B.util.createBuffer();if(J.virtualHost){var E=B.util.createBuffer();E.putByte(0),E.putByte(0);var W=B.util.createBuffer();W.putByte(0),Q$(W,2,B.util.createBuffer(J.virtualHost));var H=B.util.createBuffer();Q$(H,2,W),Q$(E,2,H),G.putBuffer(E)}var O=G.length();if(O>0)O+=2;var M=J.session.id,P=M.length+1+2+4+28+2+Q+1+U+O,z=B.util.createBuffer();if(z.putByte(F.HandshakeType.client_hello),z.putInt24(P),z.putByte(J.version.major),z.putByte(J.version.minor),z.putBytes(J.session.sp.client_random),Q$(z,1,B.util.createBuffer(M)),Q$(z,2,$),Q$(z,1,Y),O>0)Q$(z,2,G);return z};F.createServerHello=function(J){var $=J.session.id,Z=$.length+1+2+4+28+2+1,X=B.util.createBuffer();return X.putByte(F.HandshakeType.server_hello),X.putInt24(Z),X.putByte(J.version.major),X.putByte(J.version.minor),X.putBytes(J.session.sp.server_random),Q$(X,1,B.util.createBuffer($)),X.putByte(J.session.cipherSuite.id[0]),X.putByte(J.session.cipherSuite.id[1]),X.putByte(J.session.compressionMethod),X};F.createCertificate=function(J){var $=J.entity===F.ConnectionEnd.client,Z=null;if(J.getCertificate){var X;if($)X=J.session.certificateRequest;else X=J.session.extensions.server_name.serverNameList;Z=J.getCertificate(J,X)}var Q=B.util.createBuffer();if(Z!==null)try{if(!B.util.isArray(Z))Z=[Z];var Y=null;for(var U=0;U<Z.length;++U){var G=B.pem.decode(Z[U])[0];if(G.type!=="CERTIFICATE"&&G.type!=="X509 CERTIFICATE"&&G.type!=="TRUSTED CERTIFICATE"){var E=new Error('Could not convert certificate from PEM; PEM header type is not "CERTIFICATE", "X509 CERTIFICATE", or "TRUSTED CERTIFICATE".');throw E.headerType=G.type,E}if(G.procType&&G.procType.type==="ENCRYPTED")throw new Error("Could not convert certificate from PEM; PEM is encrypted.");var W=B.util.createBuffer(G.body);if(Y===null)Y=B.asn1.fromDer(W.bytes(),!1);var H=B.util.createBuffer();Q$(H,3,W),Q.putBuffer(H)}if(Z=B.pki.certificateFromAsn1(Y),$)J.session.clientCertificate=Z;else J.session.serverCertificate=Z}catch(P){return J.error(J,{message:"Could not send certificate list.",cause:P,send:!0,alert:{level:F.Alert.Level.fatal,description:F.Alert.Description.bad_certificate}})}var O=3+Q.length(),M=B.util.createBuffer();return M.putByte(F.HandshakeType.certificate),M.putInt24(O),Q$(M,3,Q),M};F.createClientKeyExchange=function(J){var $=B.util.createBuffer();$.putByte(J.session.clientHelloVersion.major),$.putByte(J.session.clientHelloVersion.minor),$.putBytes(B.random.getBytes(46));var Z=J.session.sp;Z.pre_master_secret=$.getBytes();var X=J.session.serverCertificate.publicKey;$=X.encrypt(Z.pre_master_secret);var Q=$.length+2,Y=B.util.createBuffer();return Y.putByte(F.HandshakeType.client_key_exchange),Y.putInt24(Q),Y.putInt16($.length),Y.putBytes($),Y};F.createServerKeyExchange=function(J){var $=0,Z=B.util.createBuffer();if($>0)Z.putByte(F.HandshakeType.server_key_exchange),Z.putInt24($);return Z};F.getClientSignature=function(J,$){var Z=B.util.createBuffer();Z.putBuffer(J.session.md5.digest()),Z.putBuffer(J.session.sha1.digest()),Z=Z.getBytes(),J.getSignature=J.getSignature||function(X,Q,Y){var U=null;if(X.getPrivateKey)try{U=X.getPrivateKey(X,X.session.clientCertificate),U=B.pki.privateKeyFromPem(U)}catch(G){X.error(X,{message:"Could not get private key.",cause:G,send:!0,alert:{level:F.Alert.Level.fatal,description:F.Alert.Description.internal_error}})}if(U===null)X.error(X,{message:"No private key set.",send:!0,alert:{level:F.Alert.Level.fatal,description:F.Alert.Description.internal_error}});else Q=U.sign(Q,null);Y(X,Q)},J.getSignature(J,Z,$)};F.createCertificateVerify=function(J,$){var Z=$.length+2,X=B.util.createBuffer();return X.putByte(F.HandshakeType.certificate_verify),X.putInt24(Z),X.putInt16($.length),X.putBytes($),X};F.createCertificateRequest=function(J){var $=B.util.createBuffer();$.putByte(1);var Z=B.util.createBuffer();for(var X in J.caStore.certs){var Q=J.caStore.certs[X],Y=B.pki.distinguishedNameToAsn1(Q.subject),U=B.asn1.toDer(Y);Z.putInt16(U.length()),Z.putBuffer(U)}var G=1+$.length()+2+Z.length(),E=B.util.createBuffer();return E.putByte(F.HandshakeType.certificate_request),E.putInt24(G),Q$(E,1,$),Q$(E,2,Z),E};F.createServerHelloDone=function(J){var $=B.util.createBuffer();return $.putByte(F.HandshakeType.server_hello_done),$.putInt24(0),$};F.createChangeCipherSpec=function(){var J=B.util.createBuffer();return J.putByte(1),J};F.createFinished=function(J){var $=B.util.createBuffer();$.putBuffer(J.session.md5.digest()),$.putBuffer(J.session.sha1.digest());var Z=J.entity===F.ConnectionEnd.client,X=J.session.sp,Q=12,Y=eX,U=Z?"client finished":"server finished";$=Y(X.master_secret,U,$.getBytes(),Q);var G=B.util.createBuffer();return G.putByte(F.HandshakeType.finished),G.putInt24($.length()),G.putBuffer($),G};F.createHeartbeat=function(J,$,Z){if(typeof Z==="undefined")Z=$.length;var X=B.util.createBuffer();X.putByte(J),X.putInt16(Z),X.putBytes($);var Q=X.length(),Y=Math.max(16,Q-Z-3);return X.putBytes(B.random.getBytes(Y)),X};F.queue=function(J,$){if(!$)return;if($.fragment.length()===0){if($.type===F.ContentType.handshake||$.type===F.ContentType.alert||$.type===F.ContentType.change_cipher_spec)return}if($.type===F.ContentType.handshake){var Z=$.fragment.bytes();J.session.md5.update(Z),J.session.sha1.update(Z),Z=null}var X;if($.fragment.length()<=F.MaxFragment)X=[$];else{X=[];var Q=$.fragment.bytes();while(Q.length>F.MaxFragment)X.push(F.createRecord(J,{type:$.type,data:B.util.createBuffer(Q.slice(0,F.MaxFragment))})),Q=Q.slice(F.MaxFragment);if(Q.length>0)X.push(F.createRecord(J,{type:$.type,data:B.util.createBuffer(Q)}))}for(var Y=0;Y<X.length&&!J.fail;++Y){var U=X[Y],G=J.state.current.write;if(G.update(J,U))J.records.push(U)}};F.flush=function(J){for(var $=0;$<J.records.length;++$){var Z=J.records[$];J.tlsData.putByte(Z.type),J.tlsData.putByte(Z.version.major),J.tlsData.putByte(Z.version.minor),J.tlsData.putInt16(Z.fragment.length()),J.tlsData.putBuffer(J.records[$].fragment)}return J.records=[],J.tlsDataReady(J)};var c0=function(J){switch(J){case!0:return!0;case B.pki.certificateError.bad_certificate:return F.Alert.Description.bad_certificate;case B.pki.certificateError.unsupported_certificate:return F.Alert.Description.unsupported_certificate;case B.pki.certificateError.certificate_revoked:return F.Alert.Description.certificate_revoked;case B.pki.certificateError.certificate_expired:return F.Alert.Description.certificate_expired;case B.pki.certificateError.certificate_unknown:return F.Alert.Description.certificate_unknown;case B.pki.certificateError.unknown_ca:return F.Alert.Description.unknown_ca;default:return F.Alert.Description.bad_certificate}},sW=function(J){switch(J){case!0:return!0;case F.Alert.Description.bad_certificate:return B.pki.certificateError.bad_certificate;case F.Alert.Description.unsupported_certificate:return B.pki.certificateError.unsupported_certificate;case F.Alert.Description.certificate_revoked:return B.pki.certificateError.certificate_revoked;case F.Alert.Description.certificate_expired:return B.pki.certificateError.certificate_expired;case F.Alert.Description.certificate_unknown:return B.pki.certificateError.certificate_unknown;case F.Alert.Description.unknown_ca:return B.pki.certificateError.unknown_ca;default:return B.pki.certificateError.bad_certificate}};F.verifyCertificateChain=function(J,$){try{var Z={};for(var X in J.verifyOptions)Z[X]=J.verifyOptions[X];Z.verify=function(Y,U,G){var E=c0(Y),W=J.verify(J,Y,U,G);if(W!==!0){if(typeof W==="object"&&!B.util.isArray(W)){var H=new Error("The application rejected the certificate.");if(H.send=!0,H.alert={level:F.Alert.Level.fatal,description:F.Alert.Description.bad_certificate},W.message)H.message=W.message;if(W.alert)H.alert.description=W.alert;throw H}if(W!==Y)W=sW(W)}return W},B.pki.verifyCertificateChain(J.caStore,$,Z)}catch(Y){var Q=Y;if(typeof Q!=="object"||B.util.isArray(Q))Q={send:!0,alert:{level:F.Alert.Level.fatal,description:c0(Y)}};if(!("send"in Q))Q.send=!0;if(!("alert"in Q))Q.alert={level:F.Alert.Level.fatal,description:c0(Q.error)};J.error(J,Q)}return!J.fail};F.createSessionCache=function(J,$){var Z=null;if(J&&J.getSession&&J.setSession&&J.order)Z=J;else{Z={},Z.cache=J||{},Z.capacity=Math.max($||100,1),Z.order=[];for(var X in J)if(Z.order.length<=$)Z.order.push(X);else delete J[X];Z.getSession=function(Q){var Y=null,U=null;if(Q)U=B.util.bytesToHex(Q);else if(Z.order.length>0)U=Z.order[0];if(U!==null&&U in Z.cache){Y=Z.cache[U],delete Z.cache[U];for(var G in Z.order)if(Z.order[G]===U){Z.order.splice(G,1);break}}return Y},Z.setSession=function(Q,Y){if(Z.order.length===Z.capacity){var U=Z.order.shift();delete Z.cache[U]}var U=B.util.bytesToHex(Q);Z.order.push(U),Z.cache[U]=Y}}return Z};F.createConnection=function(J){var $=null;if(J.caStore)if(B.util.isArray(J.caStore))$=B.pki.createCaStore(J.caStore);else $=J.caStore;else $=B.pki.createCaStore();var Z=J.cipherSuites||null;if(Z===null){Z=[];for(var X in F.CipherSuites)Z.push(F.CipherSuites[X])}var Q=J.server?F.ConnectionEnd.server:F.ConnectionEnd.client,Y=J.sessionCache?F.createSessionCache(J.sessionCache):null,U={version:{major:F.Version.major,minor:F.Version.minor},entity:Q,sessionId:J.sessionId,caStore:$,sessionCache:Y,cipherSuites:Z,connected:J.connected,virtualHost:J.virtualHost||null,verifyClient:J.verifyClient||!1,verify:J.verify||function(H,O,M,P){return O},verifyOptions:J.verifyOptions||{},getCertificate:J.getCertificate||null,getPrivateKey:J.getPrivateKey||null,getSignature:J.getSignature||null,input:B.util.createBuffer(),tlsData:B.util.createBuffer(),data:B.util.createBuffer(),tlsDataReady:J.tlsDataReady,dataReady:J.dataReady,heartbeatReceived:J.heartbeatReceived,closed:J.closed,error:function(H,O){if(O.origin=O.origin||(H.entity===F.ConnectionEnd.client?"client":"server"),O.send)F.queue(H,F.createAlert(H,O.alert)),F.flush(H);var M=O.fatal!==!1;if(M)H.fail=!0;if(J.error(H,O),M)H.close(!1)},deflate:J.deflate||null,inflate:J.inflate||null};U.reset=function(H){U.version={major:F.Version.major,minor:F.Version.minor},U.record=null,U.session=null,U.peerCertificate=null,U.state={pending:null,current:null},U.expect=U.entity===F.ConnectionEnd.client?yW:dW,U.fragmented=null,U.records=[],U.open=!1,U.handshakes=0,U.handshaking=!1,U.isConnected=!1,U.fail=!(H||typeof H==="undefined"),U.input.clear(),U.tlsData.clear(),U.data.clear(),U.state.current=F.createConnectionState(U)},U.reset();var G=function(H,O){var M=O.type-F.ContentType.change_cipher_spec,P=a0[H.entity][H.expect];if(M in P)P[M](H,O);else F.handleUnexpected(H,O)},E=function(H){var O=0,M=H.input,P=M.length();if(P<5)O=5-P;else{H.record={type:M.getByte(),version:{major:M.getByte(),minor:M.getByte()},length:M.getInt16(),fragment:B.util.createBuffer(),ready:!1};var z=H.record.version.major===H.version.major;if(z&&H.session&&H.session.version)z=H.record.version.minor===H.version.minor;if(!z)H.error(H,{message:"Incompatible TLS version.",send:!0,alert:{level:F.Alert.Level.fatal,description:F.Alert.Description.protocol_version}})}return O},W=function(H){var O=0,M=H.input,P=M.length();if(P<H.record.length)O=H.record.length-P;else{H.record.fragment.putBytes(M.getBytes(H.record.length)),M.compact();var z=H.state.current.read;if(z.update(H,H.record)){if(H.fragmented!==null)if(H.fragmented.type===H.record.type)H.fragmented.fragment.putBuffer(H.record.fragment),H.record=H.fragmented;else H.error(H,{message:"Invalid fragmented record.",send:!0,alert:{level:F.Alert.Level.fatal,description:F.Alert.Description.unexpected_message}});H.record.ready=!0}}return O};return U.handshake=function(H){if(U.entity!==F.ConnectionEnd.client)U.error(U,{message:"Cannot initiate handshake as a server.",fatal:!1});else if(U.handshaking)U.error(U,{message:"Handshake already in progress.",fatal:!1});else{if(U.fail&&!U.open&&U.handshakes===0)U.fail=!1;U.handshaking=!0,H=H||"";var O=null;if(H.length>0){if(U.sessionCache)O=U.sessionCache.getSession(H);if(O===null)H=""}if(H.length===0&&U.sessionCache){if(O=U.sessionCache.getSession(),O!==null)H=O.id}if(U.session={id:H,version:null,cipherSuite:null,compressionMethod:null,serverCertificate:null,certificateRequest:null,clientCertificate:null,sp:{},md5:B.md.md5.create(),sha1:B.md.sha1.create()},O)U.version=O.version,U.session.sp=O.sp;U.session.sp.client_random=F.createRandom().getBytes(),U.open=!0,F.queue(U,F.createRecord(U,{type:F.ContentType.handshake,data:F.createClientHello(U)})),F.flush(U)}},U.process=function(H){var O=0;if(H)U.input.putBytes(H);if(!U.fail){if(U.record!==null&&U.record.ready&&U.record.fragment.isEmpty())U.record=null;if(U.record===null)O=E(U);if(!U.fail&&U.record!==null&&!U.record.ready)O=W(U);if(!U.fail&&U.record!==null&&U.record.ready)G(U,U.record)}return O},U.prepare=function(H){return F.queue(U,F.createRecord(U,{type:F.ContentType.application_data,data:B.util.createBuffer(H)})),F.flush(U)},U.prepareHeartbeatRequest=function(H,O){if(H instanceof B.util.ByteBuffer)H=H.bytes();if(typeof O==="undefined")O=H.length;return U.expectedHeartbeatPayload=H,F.queue(U,F.createRecord(U,{type:F.ContentType.heartbeat,data:F.createHeartbeat(F.HeartbeatMessageType.heartbeat_request,H,O)})),F.flush(U)},U.close=function(H){if(!U.fail&&U.sessionCache&&U.session){var O={id:U.session.id,version:U.session.version,sp:U.session.sp};O.sp.keys=null,U.sessionCache.setSession(O.id,O)}if(U.open){if(U.open=!1,U.input.clear(),U.isConnected||U.handshaking)U.isConnected=U.handshaking=!1,F.queue(U,F.createAlert(U,{level:F.Alert.Level.warning,description:F.Alert.Description.close_notify})),F.flush(U);U.closed(U)}U.reset(H)},U};nQ.exports=B.tls=B.tls||{};for(rX in F)if(typeof F[rX]!=="function")B.tls[rX]=F[rX];var rX;B.tls.prf_tls1=eX;B.tls.hmac_sha1=xW;B.tls.createSessionCache=F.createSessionCache;B.tls.createConnection=F.createConnection});var iQ=c((jH,aQ)=>{var v$=o();L$();i0();var Y$=aQ.exports=v$.tls;Y$.CipherSuites.TLS_RSA_WITH_AES_128_CBC_SHA={id:[0,47],name:"TLS_RSA_WITH_AES_128_CBC_SHA",initSecurityParameters:function(J){J.bulk_cipher_algorithm=Y$.BulkCipherAlgorithm.aes,J.cipher_type=Y$.CipherType.block,J.enc_key_length=16,J.block_length=16,J.fixed_iv_length=16,J.record_iv_length=16,J.mac_algorithm=Y$.MACAlgorithm.hmac_sha1,J.mac_length=20,J.mac_key_length=20},initConnectionState:oQ};Y$.CipherSuites.TLS_RSA_WITH_AES_256_CBC_SHA={id:[0,53],name:"TLS_RSA_WITH_AES_256_CBC_SHA",initSecurityParameters:function(J){J.bulk_cipher_algorithm=Y$.BulkCipherAlgorithm.aes,J.cipher_type=Y$.CipherType.block,J.enc_key_length=32,J.block_length=16,J.fixed_iv_length=16,J.record_iv_length=16,J.mac_algorithm=Y$.MACAlgorithm.hmac_sha1,J.mac_length=20,J.mac_key_length=20},initConnectionState:oQ};function oQ(J,$,Z){var X=$.entity===v$.tls.ConnectionEnd.client;J.read.cipherState={init:!1,cipher:v$.cipher.createDecipher("AES-CBC",X?Z.keys.server_write_key:Z.keys.client_write_key),iv:X?Z.keys.server_write_IV:Z.keys.client_write_IV},J.write.cipherState={init:!1,cipher:v$.cipher.createCipher("AES-CBC",X?Z.keys.client_write_key:Z.keys.server_write_key),iv:X?Z.keys.client_write_IV:Z.keys.server_write_IV},J.read.cipherFunction=JE,J.write.cipherFunction=rW,J.read.macLength=J.write.macLength=Z.mac_length,J.read.macFunction=J.write.macFunction=Y$.hmac_sha1}function rW(J,$){var Z=!1,X=$.macFunction($.macKey,$.sequenceNumber,J);J.fragment.putBytes(X),$.updateSequenceNumber();var Q;if(J.version.minor===Y$.Versions.TLS_1_0.minor)Q=$.cipherState.init?null:$.cipherState.iv;else Q=v$.random.getBytesSync(16);$.cipherState.init=!0;var Y=$.cipherState.cipher;if(Y.start({iv:Q}),J.version.minor>=Y$.Versions.TLS_1_1.minor)Y.output.putBytes(Q);if(Y.update(J.fragment),Y.finish(tW))J.fragment=Y.output,J.length=J.fragment.length(),Z=!0;return Z}function tW(J,$,Z){if(!Z){var X=J-$.length()%J;$.fillWithByte(X-1,X)}return!0}function eW(J,$,Z){var X=!0;if(Z){var Q=$.length(),Y=$.last();for(var U=Q-1-Y;U<Q-1;++U)X=X&&$.at(U)==Y;if(X)$.truncate(Y+1)}return X}function JE(J,$){var Z=!1,X;if(J.version.minor===Y$.Versions.TLS_1_0.minor)X=$.cipherState.init?null:$.cipherState.iv;else X=J.fragment.getBytes(16);$.cipherState.init=!0;var Q=$.cipherState.cipher;Q.start({iv:X}),Q.update(J.fragment),Z=Q.finish(eW);var Y=$.macLength,U=v$.random.getBytesSync(Y),G=Q.output.length();if(G>=Y)J.fragment=Q.output.getBytes(G-Y),U=Q.output.getBytes(Y);else J.fragment=Q.output.getBytes();J.fragment=v$.util.createBuffer(J.fragment),J.length=J.fragment.length();var E=$.macFunction($.macKey,$.sequenceNumber,J);return $.updateSequenceNumber(),Z=$E($.macKey,U,E)&&Z,Z}function $E(J,$,Z){var X=v$.hmac.create();return X.start("SHA1",J),X.update($),$=X.digest().getBytes(),X.start(null,null),X.update(Z),Z=X.digest().getBytes(),$===Z}});var t0=c((xH,eQ)=>{var FJ=o();E$();XJ();var KX=eQ.exports=FJ.sha512=FJ.sha512||{};FJ.md.sha512=FJ.md.algorithms.sha512=KX;var rQ=FJ.sha384=FJ.sha512.sha384=FJ.sha512.sha384||{};rQ.create=function(){return KX.create("SHA-384")};FJ.md.sha384=FJ.md.algorithms.sha384=rQ;FJ.sha512.sha256=FJ.sha512.sha256||{create:function(){return KX.create("SHA-512/256")}};FJ.md["sha512/256"]=FJ.md.algorithms["sha512/256"]=FJ.sha512.sha256;FJ.sha512.sha224=FJ.sha512.sha224||{create:function(){return KX.create("SHA-512/224")}};FJ.md["sha512/224"]=FJ.md.algorithms["sha512/224"]=FJ.sha512.sha224;KX.create=function(J){if(!tQ)XE();if(typeof J==="undefined")J="SHA-512";if(!(J in l$))throw new Error("Invalid SHA-512 algorithm: "+J);var $=l$[J],Z=null,X=FJ.util.createBuffer(),Q=new Array(80);for(var Y=0;Y<80;++Y)Q[Y]=new Array(2);var U=64;switch(J){case"SHA-384":U=48;break;case"SHA-512/256":U=32;break;case"SHA-512/224":U=28;break}var G={algorithm:J.replace("-","").toLowerCase(),blockLength:128,digestLength:U,messageLength:0,fullMessageLength:null,messageLengthSize:16};return G.start=function(){G.messageLength=0,G.fullMessageLength=G.messageLength128=[];var E=G.messageLengthSize/4;for(var W=0;W<E;++W)G.fullMessageLength.push(0);X=FJ.util.createBuffer(),Z=new Array($.length);for(var W=0;W<$.length;++W)Z[W]=$[W].slice(0);return G},G.start(),G.update=function(E,W){if(W==="utf8")E=FJ.util.encodeUtf8(E);var H=E.length;G.messageLength+=H,H=[H/4294967296>>>0,H>>>0];for(var O=G.fullMessageLength.length-1;O>=0;--O)G.fullMessageLength[O]+=H[1],H[1]=H[0]+(G.fullMessageLength[O]/4294967296>>>0),G.fullMessageLength[O]=G.fullMessageLength[O]>>>0,H[0]=H[1]/4294967296>>>0;if(X.putBytes(E),sQ(Z,Q,X),X.read>2048||X.length()===0)X.compact();return G},G.digest=function(){var E=FJ.util.createBuffer();E.putBytes(X.bytes());var W=G.fullMessageLength[G.fullMessageLength.length-1]+G.messageLengthSize,H=W&G.blockLength-1;E.putBytes(s0.substr(0,G.blockLength-H));var O,M,P=G.fullMessageLength[0]*8;for(var z=0;z<G.fullMessageLength.length-1;++z)O=G.fullMessageLength[z+1]*8,M=O/4294967296>>>0,P+=M,E.putInt32(P>>>0),P=O>>>0;E.putInt32(P);var A=new Array(Z.length);for(var z=0;z<Z.length;++z)A[z]=Z[z].slice(0);sQ(A,Q,E);var T=FJ.util.createBuffer(),C;if(J==="SHA-512")C=A.length;else if(J==="SHA-384")C=A.length-2;else C=A.length-4;for(var z=0;z<C;++z)if(T.putInt32(A[z][0]),z!==C-1||J!=="SHA-512/224")T.putInt32(A[z][1]);return T},G};var s0=null,tQ=!1,r0=null,l$=null;function XE(){s0=String.fromCharCode(128),s0+=FJ.util.fillString(String.fromCharCode(0),128),r0=[[1116352408,3609767458],[1899447441,602891725],[3049323471,3964484399],[3921009573,2173295548],[961987163,4081628472],[1508970993,3053834265],[2453635748,2937671579],[2870763221,3664609560],[3624381080,2734883394],[310598401,1164996542],[607225278,1323610764],[1426881987,3590304994],[1925078388,4068182383],[2162078206,991336113],[2614888103,633803317],[3248222580,3479774868],[3835390401,2666613458],[4022224774,944711139],[264347078,2341262773],[604807628,2007800933],[770255983,1495990901],[1249150122,1856431235],[1555081692,3175218132],[1996064986,2198950837],[2554220882,3999719339],[2821834349,766784016],[2952996808,2566594879],[3210313671,3203337956],[3336571891,1034457026],[3584528711,2466948901],[113926993,3758326383],[338241895,168717936],[666307205,1188179964],[773529912,1546045734],[1294757372,1522805485],[1396182291,2643833823],[1695183700,2343527390],[1986661051,1014477480],[2177026350,1206759142],[2456956037,344077627],[2730485921,1290863460],[2820302411,3158454273],[3259730800,3505952657],[3345764771,106217008],[3516065817,3606008344],[3600352804,1432725776],[4094571909,1467031594],[275423344,851169720],[430227734,3100823752],[506948616,1363258195],[659060556,3750685593],[883997877,3785050280],[958139571,3318307427],[1322822218,3812723403],[1537002063,2003034995],[1747873779,3602036899],[1955562222,1575990012],[2024104815,1125592928],[2227730452,2716904306],[2361852424,442776044],[2428436474,593698344],[2756734187,3733110249],[3204031479,2999351573],[3329325298,3815920427],[3391569614,3928383900],[3515267271,566280711],[3940187606,3454069534],[4118630271,4000239992],[116418474,1914138554],[174292421,2731055270],[289380356,3203993006],[460393269,320620315],[685471733,587496836],[852142971,1086792851],[1017036298,365543100],[1126000580,2618297676],[1288033470,3409855158],[1501505948,4234509866],[1607167915,987167468],[1816402316,1246189591]],l$={},l$["SHA-512"]=[[1779033703,4089235720],[3144134277,2227873595],[1013904242,4271175723],[2773480762,1595750129],[1359893119,2917565137],[2600822924,725511199],[528734635,4215389547],[1541459225,327033209]],l$["SHA-384"]=[[3418070365,3238371032],[1654270250,914150663],[2438529370,812702999],[355462360,4144912697],[1731405415,4290775857],[2394180231,1750603025],[3675008525,1694076839],[1203062813,3204075428]],l$["SHA-512/256"]=[[573645204,4230739756],[2673172387,3360449730],[596883563,1867755857],[2520282905,1497426621],[2519219938,2827943907],[3193839141,1401305490],[721525244,746961066],[246885852,2177182882]],l$["SHA-512/224"]=[[2352822216,424955298],[1944164710,2312950998],[502970286,855612546],[1738396948,1479516111],[258812777,2077511080],[2011393907,79989058],[1067287976,1780299464],[286451373,2446758561]],tQ=!0}function sQ(J,$,Z){var X,Q,Y,U,G,E,W,H,O,M,P,z,A,T,C,L,w,f,v,x,p,a,YJ,UJ,EJ,VJ,pJ,eJ,GJ,DJ,b,_$,c$,PJ,KJ,AJ=Z.length();while(AJ>=128){for(GJ=0;GJ<16;++GJ)$[GJ][0]=Z.getInt32()>>>0,$[GJ][1]=Z.getInt32()>>>0;for(;GJ<80;++GJ)_$=$[GJ-2],DJ=_$[0],b=_$[1],X=((DJ>>>19|b<<13)^(b>>>29|DJ<<3)^DJ>>>6)>>>0,Q=((DJ<<13|b>>>19)^(b<<3|DJ>>>29)^(DJ<<26|b>>>6))>>>0,PJ=$[GJ-15],DJ=PJ[0],b=PJ[1],Y=((DJ>>>1|b<<31)^(DJ>>>8|b<<24)^DJ>>>7)>>>0,U=((DJ<<31|b>>>1)^(DJ<<24|b>>>8)^(DJ<<25|b>>>7))>>>0,c$=$[GJ-7],KJ=$[GJ-16],b=Q+c$[1]+U+KJ[1],$[GJ][0]=X+c$[0]+Y+KJ[0]+(b/4294967296>>>0)>>>0,$[GJ][1]=b>>>0;A=J[0][0],T=J[0][1],C=J[1][0],L=J[1][1],w=J[2][0],f=J[2][1],v=J[3][0],x=J[3][1],p=J[4][0],a=J[4][1],YJ=J[5][0],UJ=J[5][1],EJ=J[6][0],VJ=J[6][1],pJ=J[7][0],eJ=J[7][1];for(GJ=0;GJ<80;++GJ)W=((p>>>14|a<<18)^(p>>>18|a<<14)^(a>>>9|p<<23))>>>0,H=((p<<18|a>>>14)^(p<<14|a>>>18)^(a<<23|p>>>9))>>>0,O=(EJ^p&(YJ^EJ))>>>0,M=(VJ^a&(UJ^VJ))>>>0,G=((A>>>28|T<<4)^(T>>>2|A<<30)^(T>>>7|A<<25))>>>0,E=((A<<4|T>>>28)^(T<<30|A>>>2)^(T<<25|A>>>7))>>>0,P=(A&C|w&(A^C))>>>0,z=(T&L|f&(T^L))>>>0,b=eJ+H+M+r0[GJ][1]+$[GJ][1],X=pJ+W+O+r0[GJ][0]+$[GJ][0]+(b/4294967296>>>0)>>>0,Q=b>>>0,b=E+z,Y=G+P+(b/4294967296>>>0)>>>0,U=b>>>0,pJ=EJ,eJ=VJ,EJ=YJ,VJ=UJ,YJ=p,UJ=a,b=x+Q,p=v+X+(b/4294967296>>>0)>>>0,a=b>>>0,v=w,x=f,w=C,f=L,C=A,L=T,b=Q+U,A=X+Y+(b/4294967296>>>0)>>>0,T=b>>>0;b=J[0][1]+T,J[0][0]=J[0][0]+A+(b/4294967296>>>0)>>>0,J[0][1]=b>>>0,b=J[1][1]+L,J[1][0]=J[1][0]+C+(b/4294967296>>>0)>>>0,J[1][1]=b>>>0,b=J[2][1]+f,J[2][0]=J[2][0]+w+(b/4294967296>>>0)>>>0,J[2][1]=b>>>0,b=J[3][1]+x,J[3][0]=J[3][0]+v+(b/4294967296>>>0)>>>0,J[3][1]=b>>>0,b=J[4][1]+a,J[4][0]=J[4][0]+p+(b/4294967296>>>0)>>>0,J[4][1]=b>>>0,b=J[5][1]+UJ,J[5][0]=J[5][0]+YJ+(b/4294967296>>>0)>>>0,J[5][1]=b>>>0,b=J[6][1]+VJ,J[6][0]=J[6][0]+EJ+(b/4294967296>>>0)>>>0,J[6][1]=b>>>0,b=J[7][1]+eJ,J[7][0]=J[7][0]+pJ+(b/4294967296>>>0)>>>0,J[7][1]=b>>>0,AJ-=128}}});var JY=c((QE)=>{var ZE=o();G$();var LJ=ZE.asn1;QE.privateKeyValidator={name:"PrivateKeyInfo",tagClass:LJ.Class.UNIVERSAL,type:LJ.Type.SEQUENCE,constructed:!0,value:[{name:"PrivateKeyInfo.version",tagClass:LJ.Class.UNIVERSAL,type:LJ.Type.INTEGER,constructed:!1,capture:"privateKeyVersion"},{name:"PrivateKeyInfo.privateKeyAlgorithm",tagClass:LJ.Class.UNIVERSAL,type:LJ.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:LJ.Class.UNIVERSAL,type:LJ.Type.OID,constructed:!1,capture:"privateKeyOid"}]},{name:"PrivateKeyInfo",tagClass:LJ.Class.UNIVERSAL,type:LJ.Type.OCTETSTRING,constructed:!1,capture:"privateKey"}]};QE.publicKeyValidator={name:"SubjectPublicKeyInfo",tagClass:LJ.Class.UNIVERSAL,type:LJ.Type.SEQUENCE,constructed:!0,captureAsn1:"subjectPublicKeyInfo",value:[{name:"SubjectPublicKeyInfo.AlgorithmIdentifier",tagClass:LJ.Class.UNIVERSAL,type:LJ.Type.SEQUENCE,constructed:!0,value:[{name:"AlgorithmIdentifier.algorithm",tagClass:LJ.Class.UNIVERSAL,type:LJ.Type.OID,constructed:!1,capture:"publicKeyOid"}]},{tagClass:LJ.Class.UNIVERSAL,type:LJ.Type.BITSTRING,constructed:!1,composed:!0,captureBitStringValue:"ed25519PublicKey"}]}});var qY=c((vH,VY)=>{var BJ=o();MX();J$();t0();XJ();var UY=JY(),GE=UY.publicKeyValidator,WE=UY.privateKeyValidator;if(typeof $Y==="undefined")$Y=BJ.jsbn.BigInteger;var $Y,$Z=BJ.util.ByteBuffer,sJ=typeof Buffer==="undefined"?Uint8Array:Buffer;BJ.pki=BJ.pki||{};VY.exports=BJ.pki.ed25519=BJ.ed25519=BJ.ed25519||{};var t=BJ.ed25519;t.constants={};t.constants.PUBLIC_KEY_BYTE_LENGTH=32;t.constants.PRIVATE_KEY_BYTE_LENGTH=64;t.constants.SEED_BYTE_LENGTH=32;t.constants.SIGN_BYTE_LENGTH=64;t.constants.HASH_BYTE_LENGTH=64;t.generateKeyPair=function(J){J=J||{};var $=J.seed;if($===void 0)$=BJ.random.getBytesSync(t.constants.SEED_BYTE_LENGTH);else if(typeof $==="string"){if($.length!==t.constants.SEED_BYTE_LENGTH)throw new TypeError('"seed" must be '+t.constants.SEED_BYTE_LENGTH+" bytes in length.")}else if(!($ instanceof Uint8Array))throw new TypeError('"seed" must be a node.js Buffer, Uint8Array, or a binary string.');$=T$({message:$,encoding:"binary"});var Z=new sJ(t.constants.PUBLIC_KEY_BYTE_LENGTH),X=new sJ(t.constants.PRIVATE_KEY_BYTE_LENGTH);for(var Q=0;Q<32;++Q)X[Q]=$[Q];return VE(Z,X),{publicKey:Z,privateKey:X}};t.privateKeyFromAsn1=function(J){var $={},Z=[],X=BJ.asn1.validate(J,WE,$,Z);if(!X){var Q=new Error("Invalid Key.");throw Q.errors=Z,Q}var Y=BJ.asn1.derToOid($.privateKeyOid),U=BJ.oids.EdDSA25519;if(Y!==U)throw new Error('Invalid OID "'+Y+'"; OID must be "'+U+'".');var G=$.privateKey,E=T$({message:BJ.asn1.fromDer(G).value,encoding:"binary"});return{privateKeyBytes:E}};t.publicKeyFromAsn1=function(J){var $={},Z=[],X=BJ.asn1.validate(J,GE,$,Z);if(!X){var Q=new Error("Invalid Key.");throw Q.errors=Z,Q}var Y=BJ.asn1.derToOid($.publicKeyOid),U=BJ.oids.EdDSA25519;if(Y!==U)throw new Error('Invalid OID "'+Y+'"; OID must be "'+U+'".');var G=$.ed25519PublicKey;if(G.length!==t.constants.PUBLIC_KEY_BYTE_LENGTH)throw new Error("Key length is invalid.");return T$({message:G,encoding:"binary"})};t.publicKeyFromPrivateKey=function(J){J=J||{};var $=T$({message:J.privateKey,encoding:"binary"});if($.length!==t.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+t.constants.PRIVATE_KEY_BYTE_LENGTH);var Z=new sJ(t.constants.PUBLIC_KEY_BYTE_LENGTH);for(var X=0;X<Z.length;++X)Z[X]=$[32+X];return Z};t.sign=function(J){J=J||{};var $=T$(J),Z=T$({message:J.privateKey,encoding:"binary"});if(Z.length===t.constants.SEED_BYTE_LENGTH){var X=t.generateKeyPair({seed:Z});Z=X.privateKey}else if(Z.length!==t.constants.PRIVATE_KEY_BYTE_LENGTH)throw new TypeError('"options.privateKey" must have a byte length of '+t.constants.SEED_BYTE_LENGTH+" or "+t.constants.PRIVATE_KEY_BYTE_LENGTH);var Q=new sJ(t.constants.SIGN_BYTE_LENGTH+$.length);qE(Q,$,$.length,Z);var Y=new sJ(t.constants.SIGN_BYTE_LENGTH);for(var U=0;U<Y.length;++U)Y[U]=Q[U];return Y};t.verify=function(J){J=J||{};var $=T$(J);if(J.signature===void 0)throw new TypeError('"options.signature" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a binary string.');var Z=T$({message:J.signature,encoding:"binary"});if(Z.length!==t.constants.SIGN_BYTE_LENGTH)throw new TypeError('"options.signature" must have a byte length of '+t.constants.SIGN_BYTE_LENGTH);var X=T$({message:J.publicKey,encoding:"binary"});if(X.length!==t.constants.PUBLIC_KEY_BYTE_LENGTH)throw new TypeError('"options.publicKey" must have a byte length of '+t.constants.PUBLIC_KEY_BYTE_LENGTH);var Q=new sJ(t.constants.SIGN_BYTE_LENGTH+$.length),Y=new sJ(t.constants.SIGN_BYTE_LENGTH+$.length),U;for(U=0;U<t.constants.SIGN_BYTE_LENGTH;++U)Q[U]=Z[U];for(U=0;U<$.length;++U)Q[U+t.constants.SIGN_BYTE_LENGTH]=$[U];return FE(Y,Q,Q.length,X)>=0};function T$(J){var $=J.message;if($ instanceof Uint8Array||$ instanceof sJ)return $;var Z=J.encoding;if($===void 0)if(J.md)$=J.md.digest().getBytes(),Z="binary";else throw new TypeError('"options.message" or "options.md" not specified.');if(typeof $==="string"&&!Z)throw new TypeError('"options.encoding" must be "binary" or "utf8".');if(typeof $==="string"){if(typeof Buffer!=="undefined")return Buffer.from($,Z);$=new $Z($,Z)}else if(!($ instanceof $Z))throw new TypeError('"options.message" must be a node.js Buffer, a Uint8Array, a forge ByteBuffer, or a string with "options.encoding" specifying its encoding.');var X=new sJ($.length());for(var Q=0;Q<X.length;++Q)X[Q]=$.at(Q);return X}var XZ=g(),J0=g([1]),EE=g([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),HE=g([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),XY=g([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),ZY=g([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),e0=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]),OE=g([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function RX(J,$){var Z=BJ.md.sha512.create(),X=new $Z(J);Z.update(X.getBytes($),"binary");var Q=Z.digest().getBytes();if(typeof Buffer!=="undefined")return Buffer.from(Q,"binary");var Y=new sJ(t.constants.HASH_BYTE_LENGTH);for(var U=0;U<64;++U)Y[U]=Q.charCodeAt(U);return Y}function VE(J,$){var Z=[g(),g(),g(),g()],X,Q=RX($,32);Q[0]&=248,Q[31]&=127,Q[31]|=64,UZ(Z,Q),YZ(J,Z);for(X=0;X<32;++X)$[X+32]=J[X];return 0}function qE(J,$,Z,X){var Q,Y,U=new Float64Array(64),G=[g(),g(),g(),g()],E=RX(X,32);E[0]&=248,E[31]&=127,E[31]|=64;var W=Z+64;for(Q=0;Q<Z;++Q)J[64+Q]=$[Q];for(Q=0;Q<32;++Q)J[32+Q]=E[32+Q];var H=RX(J.subarray(32),Z+32);ZZ(H),UZ(G,H),YZ(J,G);for(Q=32;Q<64;++Q)J[Q]=X[Q];var O=RX(J,Z+64);ZZ(O);for(Q=32;Q<64;++Q)U[Q]=0;for(Q=0;Q<32;++Q)U[Q]=H[Q];for(Q=0;Q<32;++Q)for(Y=0;Y<32;Y++)U[Q+Y]+=O[Q]*E[Y];return GY(J.subarray(32),U),W}function FE(J,$,Z,X){var Q,Y,U=new sJ(32),G=[g(),g(),g(),g()],E=[g(),g(),g(),g()];if(Y=-1,Z<64)return-1;if(ME(E,X))return-1;for(Q=0;Q<Z;++Q)J[Q]=$[Q];for(Q=0;Q<32;++Q)J[Q+32]=X[Q];var W=RX(J,Z);if(ZZ(W),HY(G,E,W),UZ(E,$.subarray(32)),QZ(G,E),YZ(U,G),Z-=64,WY($,0,U,0)){for(Q=0;Q<Z;++Q)J[Q]=0;return-1}for(Q=0;Q<Z;++Q)J[Q]=$[Q+64];return Y=Z,Y}function GY(J,$){var Z,X,Q,Y;for(X=63;X>=32;--X){Z=0;for(Q=X-32,Y=X-12;Q<Y;++Q)$[Q]+=Z-16*$[X]*e0[Q-(X-32)],Z=$[Q]+128>>8,$[Q]-=Z*256;$[Q]+=Z,$[X]=0}Z=0;for(Q=0;Q<32;++Q)$[Q]+=Z-($[31]>>4)*e0[Q],Z=$[Q]>>8,$[Q]&=255;for(Q=0;Q<32;++Q)$[Q]-=Z*e0[Q];for(X=0;X<32;++X)$[X+1]+=$[X]>>8,J[X]=$[X]&255}function ZZ(J){var $=new Float64Array(64);for(var Z=0;Z<64;++Z)$[Z]=J[Z],J[Z]=0;GY(J,$)}function QZ(J,$){var Z=g(),X=g(),Q=g(),Y=g(),U=g(),G=g(),E=g(),W=g(),H=g();YX(Z,J[1],J[0]),YX(H,$[1],$[0]),WJ(Z,Z,H),QX(X,J[0],J[1]),QX(H,$[0],$[1]),WJ(X,X,H),WJ(Q,J[3],$[3]),WJ(Q,Q,HE),WJ(Y,J[2],$[2]),QX(Y,Y,Y),YX(U,X,Z),YX(G,Y,Q),QX(E,Y,Q),QX(W,X,Z),WJ(J[0],U,G),WJ(J[1],W,E),WJ(J[2],E,G),WJ(J[3],U,W)}function QY(J,$,Z){for(var X=0;X<4;++X)OY(J[X],$[X],Z)}function YZ(J,$){var Z=g(),X=g(),Q=g();KE(Q,$[2]),WJ(Z,$[0],Q),WJ(X,$[1],Q),$0(J,X),J[31]^=EY(Z)<<7}function $0(J,$){var Z,X,Q,Y=g(),U=g();for(Z=0;Z<16;++Z)U[Z]=$[Z];JZ(U),JZ(U),JZ(U);for(X=0;X<2;++X){Y[0]=U[0]-65517;for(Z=1;Z<15;++Z)Y[Z]=U[Z]-65535-(Y[Z-1]>>16&1),Y[Z-1]&=65535;Y[15]=U[15]-32767-(Y[14]>>16&1),Q=Y[15]>>16&1,Y[14]&=65535,OY(U,Y,1-Q)}for(Z=0;Z<16;Z++)J[2*Z]=U[Z]&255,J[2*Z+1]=U[Z]>>8}function ME(J,$){var Z=g(),X=g(),Q=g(),Y=g(),U=g(),G=g(),E=g();if(y$(J[2],J0),zE(J[1],$),p$(Q,J[1]),WJ(Y,Q,EE),YX(Q,Q,J[2]),QX(Y,J[2],Y),p$(U,Y),p$(G,U),WJ(E,G,U),WJ(Z,E,Q),WJ(Z,Z,Y),DE(Z,Z),WJ(Z,Z,Q),WJ(Z,Z,Y),WJ(Z,Z,Y),WJ(J[0],Z,Y),p$(X,J[0]),WJ(X,X,Y),YY(X,Q))WJ(J[0],J[0],OE);if(p$(X,J[0]),WJ(X,X,Y),YY(X,Q))return-1;if(EY(J[0])===$[31]>>7)YX(J[0],XZ,J[0]);return WJ(J[3],J[0],J[1]),0}function zE(J,$){var Z;for(Z=0;Z<16;++Z)J[Z]=$[2*Z]+($[2*Z+1]<<8);J[15]&=32767}function DE(J,$){var Z=g(),X;for(X=0;X<16;++X)Z[X]=$[X];for(X=250;X>=0;--X)if(p$(Z,Z),X!==1)WJ(Z,Z,$);for(X=0;X<16;++X)J[X]=Z[X]}function YY(J,$){var Z=new sJ(32),X=new sJ(32);return $0(Z,J),$0(X,$),WY(Z,0,X,0)}function WY(J,$,Z,X){return PE(J,$,Z,X,32)}function PE(J,$,Z,X,Q){var Y,U=0;for(Y=0;Y<Q;++Y)U|=J[$+Y]^Z[X+Y];return(1&U-1>>>8)-1}function EY(J){var $=new sJ(32);return $0($,J),$[0]&1}function HY(J,$,Z){var X,Q;y$(J[0],XZ),y$(J[1],J0),y$(J[2],J0),y$(J[3],XZ);for(Q=255;Q>=0;--Q)X=Z[Q/8|0]>>(Q&7)&1,QY(J,$,X),QZ($,J),QZ(J,J),QY(J,$,X)}function UZ(J,$){var Z=[g(),g(),g(),g()];y$(Z[0],XY),y$(Z[1],ZY),y$(Z[2],J0),WJ(Z[3],XY,ZY),HY(J,Z,$)}function y$(J,$){var Z;for(Z=0;Z<16;Z++)J[Z]=$[Z]|0}function KE(J,$){var Z=g(),X;for(X=0;X<16;++X)Z[X]=$[X];for(X=253;X>=0;--X)if(p$(Z,Z),X!==2&&X!==4)WJ(Z,Z,$);for(X=0;X<16;++X)J[X]=Z[X]}function JZ(J){var $,Z,X=1;for($=0;$<16;++$)Z=J[$]+X+65535,X=Math.floor(Z/65536),J[$]=Z-X*65536;J[0]+=X-1+37*(X-1)}function OY(J,$,Z){var X,Q=~(Z-1);for(var Y=0;Y<16;++Y)X=Q&(J[Y]^$[Y]),J[Y]^=X,$[Y]^=X}function g(J){var $,Z=new Float64Array(16);if(J)for($=0;$<J.length;++$)Z[$]=J[$];return Z}function QX(J,$,Z){for(var X=0;X<16;++X)J[X]=$[X]+Z[X]}function YX(J,$,Z){for(var X=0;X<16;++X)J[X]=$[X]-Z[X]}function p$(J,$){WJ(J,$,$)}function WJ(J,$,Z){var X,Q,Y=0,U=0,G=0,E=0,W=0,H=0,O=0,M=0,P=0,z=0,A=0,T=0,C=0,L=0,w=0,f=0,v=0,x=0,p=0,a=0,YJ=0,UJ=0,EJ=0,VJ=0,pJ=0,eJ=0,GJ=0,DJ=0,b=0,_$=0,c$=0,PJ=Z[0],KJ=Z[1],AJ=Z[2],xJ=Z[3],kJ=Z[4],vJ=Z[5],yJ=Z[6],_J=Z[7],hJ=Z[8],fJ=Z[9],uJ=Z[10],bJ=Z[11],mJ=Z[12],dJ=Z[13],gJ=Z[14],lJ=Z[15];X=$[0],Y+=X*PJ,U+=X*KJ,G+=X*AJ,E+=X*xJ,W+=X*kJ,H+=X*vJ,O+=X*yJ,M+=X*_J,P+=X*hJ,z+=X*fJ,A+=X*uJ,T+=X*bJ,C+=X*mJ,L+=X*dJ,w+=X*gJ,f+=X*lJ,X=$[1],U+=X*PJ,G+=X*KJ,E+=X*AJ,W+=X*xJ,H+=X*kJ,O+=X*vJ,M+=X*yJ,P+=X*_J,z+=X*hJ,A+=X*fJ,T+=X*uJ,C+=X*bJ,L+=X*mJ,w+=X*dJ,f+=X*gJ,v+=X*lJ,X=$[2],G+=X*PJ,E+=X*KJ,W+=X*AJ,H+=X*xJ,O+=X*kJ,M+=X*vJ,P+=X*yJ,z+=X*_J,A+=X*hJ,T+=X*fJ,C+=X*uJ,L+=X*bJ,w+=X*mJ,f+=X*dJ,v+=X*gJ,x+=X*lJ,X=$[3],E+=X*PJ,W+=X*KJ,H+=X*AJ,O+=X*xJ,M+=X*kJ,P+=X*vJ,z+=X*yJ,A+=X*_J,T+=X*hJ,C+=X*fJ,L+=X*uJ,w+=X*bJ,f+=X*mJ,v+=X*dJ,x+=X*gJ,p+=X*lJ,X=$[4],W+=X*PJ,H+=X*KJ,O+=X*AJ,M+=X*xJ,P+=X*kJ,z+=X*vJ,A+=X*yJ,T+=X*_J,C+=X*hJ,L+=X*fJ,w+=X*uJ,f+=X*bJ,v+=X*mJ,x+=X*dJ,p+=X*gJ,a+=X*lJ,X=$[5],H+=X*PJ,O+=X*KJ,M+=X*AJ,P+=X*xJ,z+=X*kJ,A+=X*vJ,T+=X*yJ,C+=X*_J,L+=X*hJ,w+=X*fJ,f+=X*uJ,v+=X*bJ,x+=X*mJ,p+=X*dJ,a+=X*gJ,YJ+=X*lJ,X=$[6],O+=X*PJ,M+=X*KJ,P+=X*AJ,z+=X*xJ,A+=X*kJ,T+=X*vJ,C+=X*yJ,L+=X*_J,w+=X*hJ,f+=X*fJ,v+=X*uJ,x+=X*bJ,p+=X*mJ,a+=X*dJ,YJ+=X*gJ,UJ+=X*lJ,X=$[7],M+=X*PJ,P+=X*KJ,z+=X*AJ,A+=X*xJ,T+=X*kJ,C+=X*vJ,L+=X*yJ,w+=X*_J,f+=X*hJ,v+=X*fJ,x+=X*uJ,p+=X*bJ,a+=X*mJ,YJ+=X*dJ,UJ+=X*gJ,EJ+=X*lJ,X=$[8],P+=X*PJ,z+=X*KJ,A+=X*AJ,T+=X*xJ,C+=X*kJ,L+=X*vJ,w+=X*yJ,f+=X*_J,v+=X*hJ,x+=X*fJ,p+=X*uJ,a+=X*bJ,YJ+=X*mJ,UJ+=X*dJ,EJ+=X*gJ,VJ+=X*lJ,X=$[9],z+=X*PJ,A+=X*KJ,T+=X*AJ,C+=X*xJ,L+=X*kJ,w+=X*vJ,f+=X*yJ,v+=X*_J,x+=X*hJ,p+=X*fJ,a+=X*uJ,YJ+=X*bJ,UJ+=X*mJ,EJ+=X*dJ,VJ+=X*gJ,pJ+=X*lJ,X=$[10],A+=X*PJ,T+=X*KJ,C+=X*AJ,L+=X*xJ,w+=X*kJ,f+=X*vJ,v+=X*yJ,x+=X*_J,p+=X*hJ,a+=X*fJ,YJ+=X*uJ,UJ+=X*bJ,EJ+=X*mJ,VJ+=X*dJ,pJ+=X*gJ,eJ+=X*lJ,X=$[11],T+=X*PJ,C+=X*KJ,L+=X*AJ,w+=X*xJ,f+=X*kJ,v+=X*vJ,x+=X*yJ,p+=X*_J,a+=X*hJ,YJ+=X*fJ,UJ+=X*uJ,EJ+=X*bJ,VJ+=X*mJ,pJ+=X*dJ,eJ+=X*gJ,GJ+=X*lJ,X=$[12],C+=X*PJ,L+=X*KJ,w+=X*AJ,f+=X*xJ,v+=X*kJ,x+=X*vJ,p+=X*yJ,a+=X*_J,YJ+=X*hJ,UJ+=X*fJ,EJ+=X*uJ,VJ+=X*bJ,pJ+=X*mJ,eJ+=X*dJ,GJ+=X*gJ,DJ+=X*lJ,X=$[13],L+=X*PJ,w+=X*KJ,f+=X*AJ,v+=X*xJ,x+=X*kJ,p+=X*vJ,a+=X*yJ,YJ+=X*_J,UJ+=X*hJ,EJ+=X*fJ,VJ+=X*uJ,pJ+=X*bJ,eJ+=X*mJ,GJ+=X*dJ,DJ+=X*gJ,b+=X*lJ,X=$[14],w+=X*PJ,f+=X*KJ,v+=X*AJ,x+=X*xJ,p+=X*kJ,a+=X*vJ,YJ+=X*yJ,UJ+=X*_J,EJ+=X*hJ,VJ+=X*fJ,pJ+=X*uJ,eJ+=X*bJ,GJ+=X*mJ,DJ+=X*dJ,b+=X*gJ,_$+=X*lJ,X=$[15],f+=X*PJ,v+=X*KJ,x+=X*AJ,p+=X*xJ,a+=X*kJ,YJ+=X*vJ,UJ+=X*yJ,EJ+=X*_J,VJ+=X*hJ,pJ+=X*fJ,eJ+=X*uJ,GJ+=X*bJ,DJ+=X*mJ,b+=X*dJ,_$+=X*gJ,c$+=X*lJ,Y+=38*v,U+=38*x,G+=38*p,E+=38*a,W+=38*YJ,H+=38*UJ,O+=38*EJ,M+=38*VJ,P+=38*pJ,z+=38*eJ,A+=38*GJ,T+=38*DJ,C+=38*b,L+=38*_$,w+=38*c$,Q=1,X=Y+Q+65535,Q=Math.floor(X/65536),Y=X-Q*65536,X=U+Q+65535,Q=Math.floor(X/65536),U=X-Q*65536,X=G+Q+65535,Q=Math.floor(X/65536),G=X-Q*65536,X=E+Q+65535,Q=Math.floor(X/65536),E=X-Q*65536,X=W+Q+65535,Q=Math.floor(X/65536),W=X-Q*65536,X=H+Q+65535,Q=Math.floor(X/65536),H=X-Q*65536,X=O+Q+65535,Q=Math.floor(X/65536),O=X-Q*65536,X=M+Q+65535,Q=Math.floor(X/65536),M=X-Q*65536,X=P+Q+65535,Q=Math.floor(X/65536),P=X-Q*65536,X=z+Q+65535,Q=Math.floor(X/65536),z=X-Q*65536,X=A+Q+65535,Q=Math.floor(X/65536),A=X-Q*65536,X=T+Q+65535,Q=Math.floor(X/65536),T=X-Q*65536,X=C+Q+65535,Q=Math.floor(X/65536),C=X-Q*65536,X=L+Q+65535,Q=Math.floor(X/65536),L=X-Q*65536,X=w+Q+65535,Q=Math.floor(X/65536),w=X-Q*65536,X=f+Q+65535,Q=Math.floor(X/65536),f=X-Q*65536,Y+=Q-1+37*(Q-1),Q=1,X=Y+Q+65535,Q=Math.floor(X/65536),Y=X-Q*65536,X=U+Q+65535,Q=Math.floor(X/65536),U=X-Q*65536,X=G+Q+65535,Q=Math.floor(X/65536),G=X-Q*65536,X=E+Q+65535,Q=Math.floor(X/65536),E=X-Q*65536,X=W+Q+65535,Q=Math.floor(X/65536),W=X-Q*65536,X=H+Q+65535,Q=Math.floor(X/65536),H=X-Q*65536,X=O+Q+65535,Q=Math.floor(X/65536),O=X-Q*65536,X=M+Q+65535,Q=Math.floor(X/65536),M=X-Q*65536,X=P+Q+65535,Q=Math.floor(X/65536),P=X-Q*65536,X=z+Q+65535,Q=Math.floor(X/65536),z=X-Q*65536,X=A+Q+65535,Q=Math.floor(X/65536),A=X-Q*65536,X=T+Q+65535,Q=Math.floor(X/65536),T=X-Q*65536,X=C+Q+65535,Q=Math.floor(X/65536),C=X-Q*65536,X=L+Q+65535,Q=Math.floor(X/65536),L=X-Q*65536,X=w+Q+65535,Q=Math.floor(X/65536),w=X-Q*65536,X=f+Q+65535,Q=Math.floor(X/65536),f=X-Q*65536,Y+=Q-1+37*(Q-1),J[0]=Y,J[1]=U,J[2]=G,J[3]=E,J[4]=W,J[5]=H,J[6]=O,J[7]=M,J[8]=P,J[9]=z,J[10]=A,J[11]=T,J[12]=C,J[13]=L,J[14]=w,J[15]=f}});var DY=c((yH,zY)=>{var tJ=o();XJ();J$();MX();zY.exports=tJ.kem=tJ.kem||{};var FY=tJ.jsbn.BigInteger;tJ.kem.rsa={};tJ.kem.rsa.create=function(J,$){$=$||{};var Z=$.prng||tJ.random,X={};return X.encrypt=function(Q,Y){var U=Math.ceil(Q.n.bitLength()/8),G;do G=new FY(tJ.util.bytesToHex(Z.getBytesSync(U)),16).mod(Q.n);while(G.compareTo(FY.ONE)<=0);G=tJ.util.hexToBytes(G.toString(16));var E=U-G.length;if(E>0)G=tJ.util.fillString(String.fromCharCode(0),E)+G;var W=Q.encrypt(G,"NONE"),H=J.generate(G,Y);return{encapsulation:W,key:H}},X.decrypt=function(Q,Y,U){var G=Q.decrypt(Y,"NONE");return J.generate(G,U)},X};tJ.kem.kdf1=function(J,$){MY(this,J,0,$||J.digestLength)};tJ.kem.kdf2=function(J,$){MY(this,J,1,$||J.digestLength)};function MY(J,$,Z,X){J.generate=function(Q,Y){var U=new tJ.util.ByteBuffer,G=Math.ceil(Y/X)+Z,E=new tJ.util.ByteBuffer;for(var W=Z;W<G;++W){E.putInt32(W),$.start(),$.update(Q+E.getBytes());var H=$.digest();U.putBytes(H.getBytes(X))}return U.truncate(U.length()-Y),U.getBytes()}}});var AY=c((_H,RY)=>{var e=o();XJ();RY.exports=e.log=e.log||{};e.log.levels=["none","error","warning","info","debug","verbose","max"];var X0={},EZ=[],TX=null;e.log.LEVEL_LOCKED=2;e.log.NO_LEVEL_CHECK=4;e.log.INTERPOLATE=8;for(D$=0;D$<e.log.levels.length;++D$)GZ=e.log.levels[D$],X0[GZ]={index:D$,name:GZ.toUpperCase()};var GZ,D$;e.log.logMessage=function(J){var $=X0[J.level].index;for(var Z=0;Z<EZ.length;++Z){var X=EZ[Z];if(X.flags&e.log.NO_LEVEL_CHECK)X.f(J);else{var Q=X0[X.level].index;if($<=Q)X.f(X,J)}}};e.log.prepareStandard=function(J){if(!("standard"in J))J.standard=X0[J.level].name+" ["+J.category+"] "+J.message};e.log.prepareFull=function(J){if(!("full"in J)){var $=[J.message];$=$.concat([]),J.full=e.util.format.apply(this,$)}};e.log.prepareStandardFull=function(J){if(!("standardFull"in J))e.log.prepareStandard(J),J.standardFull=J.standard};WZ=["error","warning","info","debug","verbose"];for(D$=0;D$<WZ.length;++D$)(function($){e.log[$]=function(Z,X){var Q=Array.prototype.slice.call(arguments).slice(2),Y={timestamp:new Date,level:$,category:Z,message:X,arguments:Q};e.log.logMessage(Y)}})(WZ[D$]);var WZ,D$;e.log.makeLogger=function(J){var $={flags:0,f:J};return e.log.setLevel($,"none"),$};e.log.setLevel=function(J,$){var Z=!1;if(J&&!(J.flags&e.log.LEVEL_LOCKED))for(var X=0;X<e.log.levels.length;++X){var Q=e.log.levels[X];if($==Q){J.level=$,Z=!0;break}}return Z};e.log.lock=function(J,$){if(typeof $==="undefined"||$)J.flags|=e.log.LEVEL_LOCKED;else J.flags&=~e.log.LEVEL_LOCKED};e.log.addLogger=function(J){EZ.push(J)};if(typeof console!=="undefined"&&"log"in console){if(console.error&&console.warn&&console.info&&console.debug)PY={error:console.error,warning:console.warn,info:console.info,debug:console.debug,verbose:console.debug},NX=function(J,$){e.log.prepareStandard($);var Z=PY[$.level],X=[$.standard];X=X.concat($.arguments.slice()),Z.apply(console,X)},UX=e.log.makeLogger(NX);else NX=function($,Z){e.log.prepareStandardFull(Z),console.log(Z.standardFull)},UX=e.log.makeLogger(NX);e.log.setLevel(UX,"debug"),e.log.addLogger(UX),TX=UX}else console={log:function(){}};var UX,PY,NX;if(TX!==null&&typeof window!=="undefined"&&window.location){if(AX=new URL(window.location.href).searchParams,AX.has("console.level"))e.log.setLevel(TX,AX.get("console.level").slice(-1)[0]);if(AX.has("console.lock")){if(KY=AX.get("console.lock").slice(-1)[0],KY=="true")e.log.lock(TX)}}var AX,KY;e.log.consoleLogger=TX});var NY=c((hH,TY)=>{TY.exports=E$();_X();e$();N0();t0()});var LY=c((fH,SY)=>{var y=o();L$();G$();qX();w$();f$();f0();J$();XJ();iX();var K=y.asn1,aJ=SY.exports=y.pkcs7=y.pkcs7||{};aJ.messageFromPem=function(J){var $=y.pem.decode(J)[0];if($.type!=="PKCS7"){var Z=new Error('Could not convert PKCS#7 message from PEM; PEM header type is not "PKCS#7".');throw Z.headerType=$.type,Z}if($.procType&&$.procType.type==="ENCRYPTED")throw new Error("Could not convert PKCS#7 message from PEM; PEM is encrypted.");var X=K.fromDer($.body);return aJ.messageFromAsn1(X)};aJ.messageToPem=function(J,$){var Z={type:"PKCS7",body:K.toDer(J.toAsn1()).getBytes()};return y.pem.encode(Z,{maxline:$})};aJ.messageFromAsn1=function(J){var $={},Z=[];if(!K.validate(J,aJ.asn1.contentInfoValidator,$,Z)){var X=new Error("Cannot read PKCS#7 message. ASN.1 object is not an PKCS#7 ContentInfo.");throw X.errors=Z,X}var Q=K.derToOid($.contentType),Y;switch(Q){case y.pki.oids.envelopedData:Y=aJ.createEnvelopedData();break;case y.pki.oids.encryptedData:Y=aJ.createEncryptedData();break;case y.pki.oids.signedData:Y=aJ.createSignedData();break;default:throw new Error("Cannot read PKCS#7 message. ContentType with OID "+Q+" is not (yet) supported.")}return Y.fromAsn1($.content.value[0]),Y};aJ.createSignedData=function(){var J=null;return J={type:y.pki.oids.signedData,version:1,certificates:[],crls:[],signers:[],digestAlgorithmIdentifiers:[],contentInfo:null,signerInfos:[],fromAsn1:function(X){if(OZ(J,X,aJ.asn1.signedDataValidator),J.certificates=[],J.crls=[],J.digestAlgorithmIdentifiers=[],J.contentInfo=null,J.signerInfos=[],J.rawCapture.certificates){var Q=J.rawCapture.certificates.value;for(var Y=0;Y<Q.length;++Y)J.certificates.push(y.pki.certificateFromAsn1(Q[Y]))}},toAsn1:function(){if(!J.contentInfo)J.sign();var X=[];for(var Q=0;Q<J.certificates.length;++Q)X.push(y.pki.certificateToAsn1(J.certificates[Q]));var Y=[],U=K.create(K.Class.CONTEXT_SPECIFIC,0,!0,[K.create(K.Class.UNIVERSAL,K.Type.SEQUENCE,!0,[K.create(K.Class.UNIVERSAL,K.Type.INTEGER,!1,K.integerToDer(J.version).getBytes()),K.create(K.Class.UNIVERSAL,K.Type.SET,!0,J.digestAlgorithmIdentifiers),J.contentInfo])]);if(X.length>0)U.value[0].value.push(K.create(K.Class.CONTEXT_SPECIFIC,0,!0,X));if(Y.length>0)U.value[0].value.push(K.create(K.Class.CONTEXT_SPECIFIC,1,!0,Y));return U.value[0].value.push(K.create(K.Class.UNIVERSAL,K.Type.SET,!0,J.signerInfos)),K.create(K.Class.UNIVERSAL,K.Type.SEQUENCE,!0,[K.create(K.Class.UNIVERSAL,K.Type.OID,!1,K.oidToDer(J.type).getBytes()),U])},addSigner:function(X){var{issuer:Q,serialNumber:Y}=X;if(X.certificate){var U=X.certificate;if(typeof U==="string")U=y.pki.certificateFromPem(U);Q=U.issuer.attributes,Y=U.serialNumber}var G=X.key;if(!G)throw new Error("Could not add PKCS#7 signer; no private key specified.");if(typeof G==="string")G=y.pki.privateKeyFromPem(G);var E=X.digestAlgorithm||y.pki.oids.sha1;switch(E){case y.pki.oids.sha1:case y.pki.oids.sha256:case y.pki.oids.sha384:case y.pki.oids.sha512:case y.pki.oids.md5:break;default:throw new Error("Could not add PKCS#7 signer; unknown message digest algorithm: "+E)}var W=X.authenticatedAttributes||[];if(W.length>0){var H=!1,O=!1;for(var M=0;M<W.length;++M){var P=W[M];if(!H&&P.type===y.pki.oids.contentType){if(H=!0,O)break;continue}if(!O&&P.type===y.pki.oids.messageDigest){if(O=!0,H)break;continue}}if(!H||!O)throw new Error("Invalid signer.authenticatedAttributes. If signer.authenticatedAttributes is specified, then it must contain at least two attributes, PKCS #9 content-type and PKCS #9 message-digest.")}J.signers.push({key:G,version:1,issuer:Q,serialNumber:Y,digestAlgorithm:E,signatureAlgorithm:y.pki.oids.rsaEncryption,signature:null,authenticatedAttributes:W,unauthenticatedAttributes:[]})},sign:function(X){if(X=X||{},typeof J.content!=="object"||J.contentInfo===null){if(J.contentInfo=K.create(K.Class.UNIVERSAL,K.Type.SEQUENCE,!0,[K.create(K.Class.UNIVERSAL,K.Type.OID,!1,K.oidToDer(y.pki.oids.data).getBytes())]),"content"in J){var Q;if(J.content instanceof y.util.ByteBuffer)Q=J.content.bytes();else if(typeof J.content==="string")Q=y.util.encodeUtf8(J.content);if(X.detached)J.detachedContent=K.create(K.Class.UNIVERSAL,K.Type.OCTETSTRING,!1,Q);else J.contentInfo.value.push(K.create(K.Class.CONTEXT_SPECIFIC,0,!0,[K.create(K.Class.UNIVERSAL,K.Type.OCTETSTRING,!1,Q)]))}}if(J.signers.length===0)return;var Y=$();Z(Y)},verify:function(){throw new Error("PKCS#7 signature verification not yet implemented.")},addCertificate:function(X){if(typeof X==="string")X=y.pki.certificateFromPem(X);J.certificates.push(X)},addCertificateRevokationList:function(X){throw new Error("PKCS#7 CRL support not yet implemented.")}},J;function $(){var X={};for(var Q=0;Q<J.signers.length;++Q){var Y=J.signers[Q],U=Y.digestAlgorithm;if(!(U in X))X[U]=y.md[y.pki.oids[U]].create();if(Y.authenticatedAttributes.length===0)Y.md=X[U];else Y.md=y.md[y.pki.oids[U]].create()}J.digestAlgorithmIdentifiers=[];for(var U in X)J.digestAlgorithmIdentifiers.push(K.create(K.Class.UNIVERSAL,K.Type.SEQUENCE,!0,[K.create(K.Class.UNIVERSAL,K.Type.OID,!1,K.oidToDer(U).getBytes()),K.create(K.Class.UNIVERSAL,K.Type.NULL,!1,"")]));return X}function Z(X){var Q;if(J.detachedContent)Q=J.detachedContent;else Q=J.contentInfo.value[1],Q=Q.value[0];if(!Q)throw new Error("Could not sign PKCS#7 message; there is no content to sign.");var Y=K.derToOid(J.contentInfo.value[0].value),U=K.toDer(Q);U.getByte(),K.getBerValueLength(U),U=U.getBytes();for(var G in X)X[G].start().update(U);var E=new Date;for(var W=0;W<J.signers.length;++W){var H=J.signers[W];if(H.authenticatedAttributes.length===0){if(Y!==y.pki.oids.data)throw new Error("Invalid signer; authenticatedAttributes must be present when the ContentInfo content type is not PKCS#7 Data.")}else{H.authenticatedAttributesAsn1=K.create(K.Class.CONTEXT_SPECIFIC,0,!0,[]);var O=K.create(K.Class.UNIVERSAL,K.Type.SET,!0,[]);for(var M=0;M<H.authenticatedAttributes.length;++M){var P=H.authenticatedAttributes[M];if(P.type===y.pki.oids.messageDigest)P.value=X[H.digestAlgorithm].digest();else if(P.type===y.pki.oids.signingTime){if(!P.value)P.value=E}O.value.push(HZ(P)),H.authenticatedAttributesAsn1.value.push(HZ(P))}U=K.toDer(O).getBytes(),H.md.start().update(U)}H.signature=H.key.sign(H.md,"RSASSA-PKCS1-V1_5")}J.signerInfos=SE(J.signers)}};aJ.createEncryptedData=function(){var J=null;return J={type:y.pki.oids.encryptedData,version:0,encryptedContent:{algorithm:y.pki.oids["aes256-CBC"]},fromAsn1:function($){OZ(J,$,aJ.asn1.encryptedDataValidator)},decrypt:function($){if($!==void 0)J.encryptedContent.key=$;CY(J)}},J};aJ.createEnvelopedData=function(){var J=null;return J={type:y.pki.oids.envelopedData,version:0,recipients:[],encryptedContent:{algorithm:y.pki.oids["aes256-CBC"]},fromAsn1:function($){var Z=OZ(J,$,aJ.asn1.envelopedDataValidator);J.recipients=TE(Z.recipientInfos.value)},toAsn1:function(){return K.create(K.Class.UNIVERSAL,K.Type.SEQUENCE,!0,[K.create(K.Class.UNIVERSAL,K.Type.OID,!1,K.oidToDer(J.type).getBytes()),K.create(K.Class.CONTEXT_SPECIFIC,0,!0,[K.create(K.Class.UNIVERSAL,K.Type.SEQUENCE,!0,[K.create(K.Class.UNIVERSAL,K.Type.INTEGER,!1,K.integerToDer(J.version).getBytes()),K.create(K.Class.UNIVERSAL,K.Type.SET,!0,NE(J.recipients)),K.create(K.Class.UNIVERSAL,K.Type.SEQUENCE,!0,LE(J.encryptedContent))])])])},findRecipient:function($){var Z=$.issuer.attributes;for(var X=0;X<J.recipients.length;++X){var Q=J.recipients[X],Y=Q.issuer;if(Q.serialNumber!==$.serialNumber)continue;if(Y.length!==Z.length)continue;var U=!0;for(var G=0;G<Z.length;++G)if(Y[G].type!==Z[G].type||Y[G].value!==Z[G].value){U=!1;break}if(U)return Q}return null},decrypt:function($,Z){if(J.encryptedContent.key===void 0&&$!==void 0&&Z!==void 0)switch($.encryptedContent.algorithm){case y.pki.oids.rsaEncryption:case y.pki.oids.desCBC:var X=Z.decrypt($.encryptedContent.content);J.encryptedContent.key=y.util.createBuffer(X);break;default:throw new Error("Unsupported asymmetric cipher, OID "+$.encryptedContent.algorithm)}CY(J)},addRecipient:function($){J.recipients.push({version:0,issuer:$.issuer.attributes,serialNumber:$.serialNumber,encryptedContent:{algorithm:y.pki.oids.rsaEncryption,key:$.publicKey}})},encrypt:function($,Z){if(J.encryptedContent.content===void 0){Z=Z||J.encryptedContent.algorithm,$=$||J.encryptedContent.key;var X,Q,Y;switch(Z){case y.pki.oids["aes128-CBC"]:X=16,Q=16,Y=y.aes.createEncryptionCipher;break;case y.pki.oids["aes192-CBC"]:X=24,Q=16,Y=y.aes.createEncryptionCipher;break;case y.pki.oids["aes256-CBC"]:X=32,Q=16,Y=y.aes.createEncryptionCipher;break;case y.pki.oids["des-EDE3-CBC"]:X=24,Q=8,Y=y.des.createEncryptionCipher;break;default:throw new Error("Unsupported symmetric cipher, OID "+Z)}if($===void 0)$=y.util.createBuffer(y.random.getBytes(X));else if($.length()!=X)throw new Error("Symmetric key has wrong length; got "+$.length()+" bytes, expected "+X+".");J.encryptedContent.algorithm=Z,J.encryptedContent.key=$,J.encryptedContent.parameter=y.util.createBuffer(y.random.getBytes(Q));var U=Y($);if(U.start(J.encryptedContent.parameter.copy()),U.update(J.content),!U.finish())throw new Error("Symmetric encryption failed.");J.encryptedContent.content=U.output}for(var G=0;G<J.recipients.length;++G){var E=J.recipients[G];if(E.encryptedContent.content!==void 0)continue;switch(E.encryptedContent.algorithm){case y.pki.oids.rsaEncryption:E.encryptedContent.content=E.encryptedContent.key.encrypt(J.encryptedContent.key.data);break;default:throw new Error("Unsupported asymmetric cipher, OID "+E.encryptedContent.algorithm)}}}},J};function RE(J){var $={},Z=[];if(!K.validate(J,aJ.asn1.recipientInfoValidator,$,Z)){var X=new Error("Cannot read PKCS#7 RecipientInfo. ASN.1 object is not an PKCS#7 RecipientInfo.");throw X.errors=Z,X}return{version:$.version.charCodeAt(0),issuer:y.pki.RDNAttributesAsArray($.issuer),serialNumber:y.util.createBuffer($.serial).toHex(),encryptedContent:{algorithm:K.derToOid($.encAlgorithm),parameter:$.encParameter?$.encParameter.value:void 0,content:$.encKey}}}function AE(J){return K.create(K.Class.UNIVERSAL,K.Type.SEQUENCE,!0,[K.create(K.Class.UNIVERSAL,K.Type.INTEGER,!1,K.integerToDer(J.version).getBytes()),K.create(K.Class.UNIVERSAL,K.Type.SEQUENCE,!0,[y.pki.distinguishedNameToAsn1({attributes:J.issuer}),K.create(K.Class.UNIVERSAL,K.Type.INTEGER,!1,y.util.hexToBytes(J.serialNumber))]),K.create(K.Class.UNIVERSAL,K.Type.SEQUENCE,!0,[K.create(K.Class.UNIVERSAL,K.Type.OID,!1,K.oidToDer(J.encryptedContent.algorithm).getBytes()),K.create(K.Class.UNIVERSAL,K.Type.NULL,!1,"")]),K.create(K.Class.UNIVERSAL,K.Type.OCTETSTRING,!1,J.encryptedContent.content)])}function TE(J){var $=[];for(var Z=0;Z<J.length;++Z)$.push(RE(J[Z]));return $}function NE(J){var $=[];for(var Z=0;Z<J.length;++Z)$.push(AE(J[Z]));return $}function CE(J){var $=K.create(K.Class.UNIVERSAL,K.Type.SEQUENCE,!0,[K.create(K.Class.UNIVERSAL,K.Type.INTEGER,!1,K.integerToDer(J.version).getBytes()),K.create(K.Class.UNIVERSAL,K.Type.SEQUENCE,!0,[y.pki.distinguishedNameToAsn1({attributes:J.issuer}),K.create(K.Class.UNIVERSAL,K.Type.INTEGER,!1,y.util.hexToBytes(J.serialNumber))]),K.create(K.Class.UNIVERSAL,K.Type.SEQUENCE,!0,[K.create(K.Class.UNIVERSAL,K.Type.OID,!1,K.oidToDer(J.digestAlgorithm).getBytes()),K.create(K.Class.UNIVERSAL,K.Type.NULL,!1,"")])]);if(J.authenticatedAttributesAsn1)$.value.push(J.authenticatedAttributesAsn1);if($.value.push(K.create(K.Class.UNIVERSAL,K.Type.SEQUENCE,!0,[K.create(K.Class.UNIVERSAL,K.Type.OID,!1,K.oidToDer(J.signatureAlgorithm).getBytes()),K.create(K.Class.UNIVERSAL,K.Type.NULL,!1,"")])),$.value.push(K.create(K.Class.UNIVERSAL,K.Type.OCTETSTRING,!1,J.signature)),J.unauthenticatedAttributes.length>0){var Z=K.create(K.Class.CONTEXT_SPECIFIC,1,!0,[]);for(var X=0;X<J.unauthenticatedAttributes.length;++X){var Q=J.unauthenticatedAttributes[X];Z.values.push(HZ(Q))}$.value.push(Z)}return $}function SE(J){var $=[];for(var Z=0;Z<J.length;++Z)$.push(CE(J[Z]));return $}function HZ(J){var $;if(J.type===y.pki.oids.contentType)$=K.create(K.Class.UNIVERSAL,K.Type.OID,!1,K.oidToDer(J.value).getBytes());else if(J.type===y.pki.oids.messageDigest)$=K.create(K.Class.UNIVERSAL,K.Type.OCTETSTRING,!1,J.value.bytes());else if(J.type===y.pki.oids.signingTime){var Z=new Date("1950-01-01T00:00:00Z"),X=new Date("2050-01-01T00:00:00Z"),Q=J.value;if(typeof Q==="string"){var Y=Date.parse(Q);if(!isNaN(Y))Q=new Date(Y);else if(Q.length===13)Q=K.utcTimeToDate(Q);else Q=K.generalizedTimeToDate(Q)}if(Q>=Z&&Q<X)$=K.create(K.Class.UNIVERSAL,K.Type.UTCTIME,!1,K.dateToUtcTime(Q));else $=K.create(K.Class.UNIVERSAL,K.Type.GENERALIZEDTIME,!1,K.dateToGeneralizedTime(Q))}return K.create(K.Class.UNIVERSAL,K.Type.SEQUENCE,!0,[K.create(K.Class.UNIVERSAL,K.Type.OID,!1,K.oidToDer(J.type).getBytes()),K.create(K.Class.UNIVERSAL,K.Type.SET,!0,[$])])}function LE(J){return[K.create(K.Class.UNIVERSAL,K.Type.OID,!1,K.oidToDer(y.pki.oids.data).getBytes()),K.create(K.Class.UNIVERSAL,K.Type.SEQUENCE,!0,[K.create(K.Class.UNIVERSAL,K.Type.OID,!1,K.oidToDer(J.algorithm).getBytes()),!J.parameter?void 0:K.create(K.Class.UNIVERSAL,K.Type.OCTETSTRING,!1,J.parameter.getBytes())]),K.create(K.Class.CONTEXT_SPECIFIC,0,!0,[K.create(K.Class.UNIVERSAL,K.Type.OCTETSTRING,!1,J.content.getBytes())])]}function OZ(J,$,Z){var X={},Q=[];if(!K.validate($,Z,X,Q)){var Y=new Error("Cannot read PKCS#7 message. ASN.1 object is not a supported PKCS#7 message.");throw Y.errors=Y,Y}var U=K.derToOid(X.contentType);if(U!==y.pki.oids.data)throw new Error("Unsupported PKCS#7 message. Only wrapped ContentType Data supported.");if(X.encryptedContent){var G="";if(y.util.isArray(X.encryptedContent))for(var E=0;E<X.encryptedContent.length;++E){if(X.encryptedContent[E].type!==K.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting encrypted content constructed of only OCTET STRING objects.");G+=X.encryptedContent[E].value}else G=X.encryptedContent;J.encryptedContent={algorithm:K.derToOid(X.encAlgorithm),parameter:y.util.createBuffer(X.encParameter.value),content:y.util.createBuffer(G)}}if(X.content){var G="";if(y.util.isArray(X.content))for(var E=0;E<X.content.length;++E){if(X.content[E].type!==K.Type.OCTETSTRING)throw new Error("Malformed PKCS#7 message, expecting content constructed of only OCTET STRING objects.");G+=X.content[E].value}else G=X.content;J.content=y.util.createBuffer(G)}return J.version=X.version.charCodeAt(0),J.rawCapture=X,X}function CY(J){if(J.encryptedContent.key===void 0)throw new Error("Symmetric key not available.");if(J.content===void 0){var $;switch(J.encryptedContent.algorithm){case y.pki.oids["aes128-CBC"]:case y.pki.oids["aes192-CBC"]:case y.pki.oids["aes256-CBC"]:$=y.aes.createDecryptionCipher(J.encryptedContent.key);break;case y.pki.oids.desCBC:case y.pki.oids["des-EDE3-CBC"]:$=y.des.createDecryptionCipher(J.encryptedContent.key);break;default:throw new Error("Unsupported symmetric cipher, OID "+J.encryptedContent.algorithm)}if($.start(J.encryptedContent.parameter),$.update(J.encryptedContent.content),!$.finish())throw new Error("Symmetric decryption failed.");J.content=$.output}}});var IY=c((uH,wY)=>{var RJ=o();L$();i$();_X();e$();XJ();var Q0=wY.exports=RJ.ssh=RJ.ssh||{};Q0.privateKeyToPutty=function(J,$,Z){Z=Z||"",$=$||"";var X="ssh-rsa",Q=$===""?"none":"aes256-cbc",Y="PuTTY-User-Key-File-2: "+X+`\r
`;Y+="Encryption: "+Q+`\r
`,Y+="Comment: "+Z+`\r
`;var U=RJ.util.createBuffer();GX(U,X),P$(U,J.e),P$(U,J.n);var G=RJ.util.encode64(U.bytes(),64),E=Math.floor(G.length/66)+1;Y+="Public-Lines: "+E+`\r
`,Y+=G;var W=RJ.util.createBuffer();P$(W,J.d),P$(W,J.p),P$(W,J.q),P$(W,J.qInv);var H;if(!$)H=RJ.util.encode64(W.bytes(),64);else{var O=W.length()+16-1;O-=O%16;var M=Z0(W.bytes());M.truncate(M.length()-O+W.length()),W.putBuffer(M);var P=RJ.util.createBuffer();P.putBuffer(Z0("\x00\x00\x00\x00",$)),P.putBuffer(Z0("\x00\x00\x00\x01",$));var z=RJ.aes.createEncryptionCipher(P.truncate(8),"CBC");z.start(RJ.util.createBuffer().fillWithByte(0,16)),z.update(W.copy()),z.finish();var A=z.output;A.truncate(16),H=RJ.util.encode64(A.bytes(),64)}E=Math.floor(H.length/66)+1,Y+=`\r
Private-Lines: `+E+`\r
`,Y+=H;var T=Z0("putty-private-key-file-mac-key",$),C=RJ.util.createBuffer();GX(C,X),GX(C,Q),GX(C,Z),C.putInt32(U.length()),C.putBuffer(U),C.putInt32(W.length()),C.putBuffer(W);var L=RJ.hmac.create();return L.start("sha1",T),L.update(C.bytes()),Y+=`\r
Private-MAC: `+L.digest().toHex()+`\r
`,Y};Q0.publicKeyToOpenSSH=function(J,$){var Z="ssh-rsa";$=$||"";var X=RJ.util.createBuffer();return GX(X,Z),P$(X,J.e),P$(X,J.n),Z+" "+RJ.util.encode64(X.bytes())+" "+$};Q0.privateKeyToOpenSSH=function(J,$){if(!$)return RJ.pki.privateKeyToPem(J);return RJ.pki.encryptRsaPrivateKey(J,$,{legacy:!0,algorithm:"aes128"})};Q0.getPublicKeyFingerprint=function(J,$){$=$||{};var Z=$.md||RJ.md.md5.create(),X="ssh-rsa",Q=RJ.util.createBuffer();GX(Q,X),P$(Q,J.e),P$(Q,J.n),Z.start(),Z.update(Q.getBytes());var Y=Z.digest();if($.encoding==="hex"){var U=Y.toHex();if($.delimiter)return U.match(/.{2}/g).join($.delimiter);return U}else if($.encoding==="binary")return Y.getBytes();else if($.encoding)throw new Error('Unknown encoding "'+$.encoding+'".');return Y};function P$(J,$){var Z=$.toString(16);if(Z[0]>="8")Z="00"+Z;var X=RJ.util.hexToBytes(Z);J.putInt32(X.length),J.putBytes(X)}function GX(J,$){J.putInt32($.length),J.putString($)}function Z0(){var J=RJ.md.sha1.create(),$=arguments.length;for(var Z=0;Z<$;++Z)J.update(arguments[Z]);return J.digest()}});var VZ=c((bH,BY)=>{BY.exports=o();L$();iQ();G$();IX();qX();qY();i$();DY();AY();NY();u0();bX();f$();k0();d0();LY();l0();y0();C0();nX();J$();w0();IY();i0();XJ()});import G0 from"node:os";import W0 from"node:path";import{resolve as bY}from"path";import mY from"process";function U0(J,$){if(Array.isArray($)&&!Array.isArray(J))return $;if(Array.isArray($)&&Array.isArray(J))return $.map((X,Q)=>{let Y=J[Q];if(n$(X)&&n$(Y))return U0(Y,X);return X});if(!n$($)||!n$(J))return $;let Z={...J};for(let X in $)if(Object.prototype.hasOwnProperty.call($,X)){let Q=$[X],Y=Z[X];if(Q===null||Q===void 0)Z[X]=Q;else if(n$(Q)&&n$(Y))Z[X]=U0(Y,Q);else Z[X]=Q}return Z}function n$(J){return Boolean(J&&typeof J==="object"&&!Array.isArray(J))}async function FZ({name:J,cwd:$,defaultConfig:Z}){let X=bY($||mY.cwd(),`${J}.config`);try{let Q=await import(X),Y=Q.default||Q;return U0(Z,Y)}catch(Q){return Z}}var dY={altNameIPs:["127.0.0.1"],altNameURIs:["localhost"],organizationName:"Local Development",countryName:"US",stateName:"California",localityName:"Playa Vista",commonName:"stacks.localhost",validityDays:825,hostCertCN:"stacks.localhost",domain:"stacks.localhost",rootCA:{certificate:"",privateKey:""},basePath:"",caCertPath:W0.join(G0.homedir(),".stacks","ssl","stacks.localhost.ca.crt"),certPath:W0.join(G0.homedir(),".stacks","ssl","stacks.localhost.crt"),keyPath:W0.join(G0.homedir(),".stacks","ssl","stacks.localhost.crt.key"),verbose:!1},TJ=await FZ({name:"tls",defaultConfig:dY});var kY=xY(VZ(),1);import{exec as wE}from"node:child_process";import CX from"node:fs";import jY from"node:os";import Y0 from"node:path";import IE from"node:process";import{promisify as BE}from"node:util";function oH(J,$){let Z=qZ(J),X=Z.getExtension("subjectAltName");if(X){for(let Q of X.altNames)if(Q.value===$)return!0}return Z.subject.getField("CN").value===$}function jE(J){return CX.readFileSync(J,"utf8")}function aH(J){let $=qZ(J);return{subject:$.subject.attributes,issuer:$.issuer.attributes,validFrom:$.validity.notBefore,validTo:$.validity.notAfter,serialNumber:$.serialNumber}}function iH(J){let $=qZ(J);return new Date>$.validity.notAfter}function qZ(J){let $;if(J.startsWith("-----BEGIN CERTIFICATE-----"))$=J;else $=jE(J);return kY.pki.certificateFromPem($)}function sH(J){let $=jY.platform(),Z;if(!J)if($==="darwin")Z="/etc/ssl/certs";else if($==="win32")Z="C:\\Windows\\System32\\certsrv\\CertEnroll";else if($==="linux")Z="/etc/ssl/certs";else throw new Error(`Unsupported platform: ${$}`);else Z=J;let X=CX.readdirSync(Z).filter((Y)=>Y.endsWith(".crt")).map((Y)=>Y0.join(Z,Y)),Q=Y0.join(jY.homedir(),".stacks","ssl");return X.push(...CX.readdirSync(Q).filter((Y)=>Y.endsWith(".crt")).map((Y)=>Y0.join(Q,Y))),X}function vY(J){let $=Number.parseInt(J[0],16);if($<8)return J;return $-=8,$.toString()+J.substring(1)}function yY(J,$){let Z=[];function X(Q){try{let Y=CX.readdirSync(Q);for(let U of Y){let G=Y0.join(Q,U);if(CX.lstatSync(G).isDirectory())X(G);else if(U===$)Z.push(Q)}}catch(Y){console.warn(`Error reading directory ${Q}: ${Y}`)}}return X(J),Z}function i(J,$,Z){if(Z||TJ.verbose)console.debug(`[tlsx:${J}] ${$}`)}var xE=BE(wE);async function SX(J,$={}){try{let{stdout:Z,stderr:X}=await xE(J,{cwd:$.cwd||IE.cwd(),timeout:$.timeout||30000});return{stdout:Z.trim(),stderr:X.trim()}}catch(Z){let X=new Error(`Failed to execute command: ${J}
Error: ${Z.message}`);throw X.stack=Z.stack,X}}function _Y(J){if(J.domain)return J.domain;if(J.domains?.length)return J.domains[0];throw new Error("Either domain or domains must be specified")}import N$ from"node:fs";import hY from"node:os";import WX from"node:path";var jJ=xY(VZ(),1);function kE(J){let $=[],Z=new Set;if(J.domain)Z.add(J.domain);if(J.domains?.length)J.domains.forEach((X)=>Z.add(X));for(let X of Z)$.push({type:2,value:X});if(J.altNameIPs?.length)for(let X of J.altNameIPs)$.push({type:7,value:X});if(J.altNameURIs?.length)for(let X of J.altNameURIs)$.push({type:6,value:X});if(J.subjectAltNames?.length)$.push(...J.subjectAltNames);return i("cert",`Generated ${$.length} Subject Alternative Names`,J.verbose),$}function fY(J){i("cert","Generating random serial number",J);let $=vY(jJ.default.util.bytesToHex(jJ.default.random.getBytesSync(20)));return i("cert",`Generated serial number: ${$}`,J),$}function uY(J){let $=J.notBeforeDays??2,Z=J.validityDays??(J.validityYears?J.validityYears*365:180);i("cert","Calculating certificate validity dates",J.verbose);let X=new Date(Date.now()-86400*$*1000),Q=new Date(X.getTime()+Z*24*60*60*1000);return X.setUTCHours(0,0,0,0),Q.setUTCHours(23,59,59,999),i("cert",`Validity period: ${X.toISOString()} to ${Q.toISOString()}`,J.verbose),{notBefore:X,notAfter:Q}}function vE(J){let $=[];$.push({name:"basicConstraints",cA:J.isCA??!1,critical:!0,...J.basicConstraints||{}});let Z=kE(J);if(Z.length>0)$.push({name:"subjectAltName",altNames:Z});if(J.keyUsage)$.push({name:"keyUsage",critical:!0,...J.keyUsage});if(J.extKeyUsage)$.push({name:"extKeyUsage",...J.extKeyUsage});return $}async function QO(J={}){i("ca","Creating new Root CA Certificate",J.verbose);let $=J.keySize||2048;i("ca",`Generating ${$}-bit RSA key pair`,J.verbose);let{privateKey:Z,publicKey:X}=jJ.pki.rsa.generateKeyPair($),Q=[{shortName:"C",value:J.countryName||TJ.countryName},{shortName:"ST",value:J.stateName||TJ.stateName},{shortName:"L",value:J.localityName||TJ.localityName},{shortName:"O",value:J.organization||"Local Development CA"},{shortName:"OU",value:J.organizationalUnit||"Certificate Authority"},{shortName:"CN",value:J.commonName||"Local Development Root CA"},...J.extraAttributes||[]],{notBefore:Y,notAfter:U}=uY({validityYears:J.validityYears||100,verbose:J.verbose}),G=jJ.pki.createCertificate();return G.publicKey=X,G.serialNumber=fY(J.verbose),G.validity.notBefore=Y,G.validity.notAfter=U,G.setSubject(Q),G.setIssuer(Q),G.setExtensions([{name:"basicConstraints",cA:!0,critical:!0},{name:"keyUsage",keyCertSign:!0,cRLSign:!0,critical:!0},{name:"subjectKeyIdentifier"}]),G.sign(Z,jJ.default.md.sha256.create()),{certificate:jJ.pki.certificateToPem(G),privateKey:jJ.pki.privateKeyToPem(Z),notBefore:Y,notAfter:U}}async function YO(J){if(i("cert","Generating new certificate",J.verbose),i("cert",`Options: ${JSON.stringify(J)}`,J.verbose),!J.domain&&!J.domains?.length)throw new Error("Either domain or domains must be specified");if(!J.rootCA?.certificate||!J.rootCA?.privateKey)throw new Error("Root CA certificate and private key are required");let $=jJ.pki.certificateFromPem(J.rootCA.certificate),Z=jJ.pki.privateKeyFromPem(J.rootCA.privateKey);i("cert","Generating 2048-bit RSA key pair for host certificate",J.verbose);let X=2048,{privateKey:Q,publicKey:Y}=jJ.pki.rsa.generateKeyPair(X),U=J.commonName||_Y(J),G=J.certificateAttributes||[{shortName:"C",value:J.countryName||TJ.countryName},{shortName:"ST",value:J.stateName||TJ.stateName},{shortName:"L",value:J.localityName||TJ.localityName},{shortName:"O",value:J.organizationName||TJ.organizationName},{shortName:"CN",value:U}],{notBefore:E,notAfter:W}=uY({validityDays:J.validityDays,verbose:J.verbose}),H=jJ.pki.createCertificate();return H.publicKey=Y,H.serialNumber=fY(J.verbose),H.validity.notBefore=E,H.validity.notAfter=W,H.setSubject(G),H.setIssuer($.subject.attributes),H.setExtensions(vE(J)),H.sign(Z,jJ.default.md.sha256.create()),{certificate:jJ.pki.certificateToPem(H),privateKey:jJ.pki.privateKeyToPem(Q),notBefore:E,notAfter:W}}async function UO(J,$,Z){i("trust",`Adding certificate to system trust store with options: ${JSON.stringify(Z)}`,Z?.verbose),i("trust","Storing certificate and private key",Z?.verbose);let X=yE(J,Z);i("trust","Storing CA certificate",Z?.verbose);let Q=_E($,Z),Y=hY.platform();i("trust",`Detected platform: ${Y}`,Z?.verbose);let U="TC, C, C";if(Y==="darwin")i("trust","Adding certificate to macOS keychain",Z?.verbose),await SX(`sudo security add-trusted-cert -d -r trustRoot -k /Library/Keychains/System.keychain ${Q}`);else if(Y==="win32")i("trust","Adding certificate to Windows certificate store",Z?.verbose),await SX(`certutil -f -v -addstore -enterprise Root ${Q}`);else if(Y==="linux"){i("trust","Adding certificate to Linux certificate store",Z?.verbose);let G=hY.homedir(),E="cert9.db";i("trust",`Searching for certificate databases in ${G}`,Z?.verbose);let W=yY(G,E);for(let H of W){i("trust",`Processing certificate database in ${H}`,Z?.verbose);try{i("trust",`Attempting to delete existing cert for ${TJ.commonName}`,Z?.verbose),await SX(`certutil -d sql:${H} -D -n ${TJ.commonName}`)}catch(O){i("trust",`Warning: Error deleting existing cert: ${O}`,Z?.verbose),console.warn(`Error deleting existing cert: ${O}`)}i("trust",`Adding new certificate to ${H}`,Z?.verbose),await SX(`certutil -d sql:${H} -A -t ${U} -n ${TJ.commonName} -i ${Q}`),LX.info(`Cert added to ${H}`)}}else throw i("trust",`Error: Unsupported platform ${Y}`,Z?.verbose),new Error(`Unsupported platform: ${Y}`);return i("trust","Certificate successfully added to system trust store",Z?.verbose),X}function yE(J,$){i("storage",`Storing certificate and private key with options: ${JSON.stringify($)}`,$?.verbose);let Z=WX.join($?.basePath||TJ.basePath,$?.certPath||TJ.certPath),X=WX.join($?.basePath||TJ.basePath,$?.keyPath||TJ.keyPath);i("storage",`Certificate path: ${Z}`,$?.verbose),i("storage",`Private key path: ${X}`,$?.verbose);let Q=WX.dirname(Z);if(!N$.existsSync(Q))i("storage",`Creating certificate directory: ${Q}`,$?.verbose),N$.mkdirSync(Q,{recursive:!0});i("storage","Writing certificate file",$?.verbose),N$.writeFileSync(Z,J.certificate);let Y=WX.dirname(X);if(!N$.existsSync(Y))i("storage",`Creating private key directory: ${Y}`,$?.verbose),N$.mkdirSync(Y,{recursive:!0});return i("storage","Writing private key file",$?.verbose),N$.writeFileSync(X,J.privateKey),i("storage","Certificate and private key stored successfully",$?.verbose),Z}function _E(J,$){i("storage","Storing CA certificate",$?.verbose);let Z=WX.join($?.basePath||TJ.basePath,$?.caCertPath||TJ.caCertPath);i("storage",`CA certificate path: ${Z}`,$?.verbose);let X=WX.dirname(Z);if(!N$.existsSync(X))i("storage",`Creating CA certificate directory: ${X}`,$?.verbose),N$.mkdirSync(X,{recursive:!0});return i("storage","Writing CA certificate file",$?.verbose),N$.writeFileSync(Z,J),i("storage","CA certificate stored successfully",$?.verbose),Z}
export{dY as a,TJ as b,oH as c,jE as d,aH as e,iH as f,qZ as g,sH as h,vY as i,yY as j,i as k,SX as l,_Y as m,jJ as n,fY as o,uY as p,QO as q,YO as r,UO as s,yE as t,_E as u};
